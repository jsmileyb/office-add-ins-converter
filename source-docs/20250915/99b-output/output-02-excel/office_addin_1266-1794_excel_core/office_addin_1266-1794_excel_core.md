{0}------------------------------------------------

# **excel package**

# **Classes**

| Excel.AllowEdit<br>Range                 | Represents an AllowEditRange object found in a worksheet. This object works with<br>worksheet protection properties. When worksheet protection is enabled, an<br>AllowEditRange object can be used to allow editing of a specific range, while<br>maintaining protection on the rest of the worksheet.                    |
|------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.AllowEdit<br>RangeCollection       | Represents the set of AllowEditRange objects found in a worksheet. AllowEditRange<br>objects work with worksheet protection properties. When worksheet protection is<br>enabled, an AllowEditRange object can be used to allow editing of a specific range,<br>while maintaining protection on the rest of the worksheet. |
| Excel.<br>Application                    | Represents the Excel application that manages the workbook.                                                                                                                                                                                                                                                               |
| Excel.AutoFilter                         | Represents the AutoFilter object. AutoFilter turns the values in Excel column into<br>specific filters based on the cell contents.                                                                                                                                                                                        |
| Excel.Binding                            | Represents an Office.js binding that is defined in the workbook.                                                                                                                                                                                                                                                          |
| Excel.Binding<br>Collection              | Represents the collection of all the binding objects that are part of the workbook.                                                                                                                                                                                                                                       |
| Excel.CellValue<br>Conditional<br>Format | Represents a cell value conditional format.                                                                                                                                                                                                                                                                               |
| Excel.Chart                              | Represents a chart object in a workbook. To learn more about the chart object model,<br>see Work with charts using the Excel JavaScript API.                                                                                                                                                                              |
| Excel.ChartArea<br>Format                | Encapsulates the format properties for the overall chart area.                                                                                                                                                                                                                                                            |
| Excel.ChartAxes                          | Represents the chart axes.                                                                                                                                                                                                                                                                                                |
| Excel.ChartAxis                          | Represents a single axis in a chart.                                                                                                                                                                                                                                                                                      |
| Excel.ChartAxis<br>Format                | Encapsulates the format properties for the chart axis.                                                                                                                                                                                                                                                                    |
| Excel.ChartAxis<br>Title                 | Represents the title of a chart axis.                                                                                                                                                                                                                                                                                     |
| Excel.ChartAxis<br>TitleFormat           | Represents the chart axis title formatting.                                                                                                                                                                                                                                                                               |

{1}------------------------------------------------

| Excel.ChartBin<br>Options            | Encapsulates the bin options for histogram charts and pareto charts.                                        |
|--------------------------------------|-------------------------------------------------------------------------------------------------------------|
| Excel.Chart<br>Border                | Represents the border formatting of a chart element.                                                        |
| Excel.Chart<br>Boxwhisker<br>Options | Represents the properties of a box and whisker chart.                                                       |
| Excel.Chart<br>Collection            | A collection of all the chart objects on a worksheet.                                                       |
| Excel.ChartData<br>Label             | Represents the data label of a chart point.                                                                 |
| Excel.ChartData<br>LabelAnchor       | Represents the chart data label anchor.                                                                     |
| Excel.ChartData<br>LabelFormat       | Encapsulates the format properties for the chart data labels.                                               |
| Excel.ChartData<br>Labels            | Represents a collection of all the data labels on a chart point.                                            |
| Excel.ChartData<br>Table             | Represents the data table object of a chart.                                                                |
| Excel.ChartData<br>TableFormat       | Represents the format of a chart data table.                                                                |
| Excel.ChartError<br>Bars             | This object represents the attributes for a chart's error bars.                                             |
| Excel.ChartError<br>BarsFormat       | Encapsulates the format properties for chart error bars.                                                    |
| Excel.ChartFill                      | Represents the fill formatting for a chart element.                                                         |
| Excel.ChartFont                      | This object represents the font attributes (such as font name, font size, and color) for a<br>chart object. |
| Excel.Chart                          | Represents the substring in chart related objects that contain text, like a ChartTitle                      |
| FormatString                         | object or ChartAxisTitle object.                                                                            |
| Excel.Chart<br>Gridlines             | Represents major or minor gridlines on a chart axis.                                                        |
| Excel.Chart<br>GridlinesFormat       | Encapsulates the format properties for chart gridlines.                                                     |

{2}------------------------------------------------

| Excel.Chart<br>LeaderLines               | Gets an object that represents the formatting of chart leader lines. |
|------------------------------------------|----------------------------------------------------------------------|
| Excel.Chart<br>LeaderLines<br>Format     | Encapsulates the format properties for leader lines.                 |
| Excel.Chart<br>Legend                    | Represents the legend in a chart.                                    |
| Excel.Chart<br>LegendEntry               | Represents the legend entry in legendEntryCollection .               |
| Excel.Chart<br>LegendEntry<br>Collection | Represents a collection of legend entries.                           |
| Excel.Chart<br>LegendFormat              | Encapsulates the format properties of a chart legend.                |
| Excel.ChartLine<br>Format                | Encapsulates the formatting options for line elements.               |
| Excel.ChartMap<br>Options                | Encapsulates the properties for a region map chart.                  |
| Excel.ChartPivot<br>Options              | Encapsulates the options for the pivot chart.                        |
| Excel.ChartPlot<br>Area                  | This object represents the attributes for a chart plot area.         |
| Excel.ChartPlot<br>AreaFormat            | Represents the format properties for a chart plot area.              |
| Excel.ChartPoint                         | Represents a point of a series in a chart.                           |
| Excel.ChartPoint<br>Format               | Represents the formatting object for chart points.                   |
| Excel.Chart<br>PointsCollection          | A collection of all the chart points within a series inside a chart. |
| Excel.Chart<br>Series                    | Represents a series in a chart.                                      |
| Excel.Chart<br>SeriesCollection          | Represents a collection of chart series.                             |
| Excel.Chart<br>SeriesFormat              | Encapsulates the format properties for the chart series              |

{3}------------------------------------------------

| Excel.ChartTitle                                   | Represents a chart title object of a chart.                                         |
|----------------------------------------------------|-------------------------------------------------------------------------------------|
| Excel.ChartTitle<br>Format                         | Provides access to the formatting options for a chart title.                        |
| Excel.Chart<br>Trendline                           | This object represents the attributes for a chart trendline object.                 |
| Excel.Chart<br>Trendline<br>Collection             | Represents a collection of chart trendlines.                                        |
| Excel.Chart<br>TrendlineFormat                     | Represents the format properties for the chart trendline.                           |
| Excel.Chart<br>TrendlineLabel                      | This object represents the attributes for a chart trendline label object.           |
| Excel.Chart<br>TrendlineLabel<br>Format            | Encapsulates the format properties for the chart trendline label.                   |
| Excel.ColorScale<br>Conditional<br>Format          | Represents the color scale criteria for conditional formatting.                     |
| Excel.Comment                                      | Represents a comment in the workbook.                                               |
| Excel.Comment<br>Collection                        | Represents a collection of comment objects that are part of the workbook.           |
| Excel.Comment<br>Reply                             | Represents a comment reply in the workbook.                                         |
| Excel.Comment<br>ReplyCollection                   | Represents a collection of comment reply objects that are part of the comment.      |
| Excel.<br>ConditionalData<br>BarNegative<br>Format | Represents a conditional format for the negative side of the data bar.              |
| Excel.<br>ConditionalData<br>BarPositive<br>Format | Represents a conditional format for the positive side of the data bar.              |
| Excel.                                             | An object encapsulating a conditional format's range, format, rule, and other       |
| Conditional                                        | properties. To learn more about the conditional formatting object model, read Apply |
| Format                                             | conditional formatting to Excel ranges.                                             |

{4}------------------------------------------------

| Excel.<br>Conditional<br>Format<br>Collection      | Represents a collection of all the conditional formats that are overlap the range.                          |
|----------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
| Excel.<br>Conditional<br>FormatRule                | Represents a rule, for all traditional rule/format pairings.                                                |
| Excel.<br>Conditional<br>RangeBorder               | Represents the border of an object.                                                                         |
| Excel.<br>Conditional<br>RangeBorder<br>Collection | Represents the border objects that make up range border.                                                    |
| Excel.<br>Conditional<br>RangeFill                 | Represents the background of a conditional range object.                                                    |
| Excel.<br>Conditional<br>RangeFont                 | This object represents the font attributes (font style, color, etc.) for an object.                         |
| Excel.<br>Conditional<br>RangeFormat               | A format object encapsulating the conditional formats range's font, fill, borders, and<br>other properties. |
| Excel.Culture                                      | Provides information based on current system culture settings. This includes the                            |
| Info                                               | culture names, number formatting, and other culturally dependent settings.                                  |
| Excel.Custom<br>Conditional<br>Format              | Represents a custom conditional format type.                                                                |
| Excel.Custom<br>Function<br>Manager                | Manages settings on custom functions.                                                                       |
| Excel.Custom<br>Property                           | Represents a custom property.                                                                               |
| Excel.Custom<br>Property<br>Collection             | Contains the collection of custom properties.                                                               |
| Excel.Custom<br>XmlPart                            | Represents a custom XML part object in a workbook.                                                          |

{5}------------------------------------------------

| Excel.Custom<br>XmlPart<br>Collection      | A collection of custom XML parts.                                                     |
|--------------------------------------------|---------------------------------------------------------------------------------------|
| Excel.Custom                               | A scoped collection of custom XML parts. A scoped collection is the result of some    |
| XmlPartScoped                              | operation (e.g., filtering by namespace). A scoped collection cannot be scoped any    |
| Collection                                 | further.                                                                              |
| Excel.DataBar<br>Conditional<br>Format     | Represents an Excel conditional data bar type.                                        |
| Excel.Data<br>Connection<br>Collection     | Represents a collection of all the data connections that are part of the workbook.    |
| Excel.DataPivot<br>Hierarchy               | Represents the Excel DataPivotHierarchy.                                              |
| Excel.DataPivot<br>Hierarchy<br>Collection | Represents a collection of DataPivotHierarchy items associated with the PivotTable.   |
| Excel.Data                                 | Represents the data validation applied to the current range. To learn more about the  |
| Validation                                 | data validation object model, read Add data validation to Excel ranges.               |
| Excel.Datetime                             | Defines the culturally appropriate format of displaying numbers. This is based on     |
| FormatInfo                                 | current system culture settings.                                                      |
| Excel.Document<br>Properties               | Represents workbook properties.                                                       |
| Excel.Document<br>Task                     | Represents a task.                                                                    |
| Excel.Document<br>TaskChange               | Represents a recorded change to the task.                                             |
| Excel.Document<br>TaskChange<br>Collection | Represents a collection of change records for a task.                                 |
| Excel.Document<br>TaskCollection           | Represents a collection of tasks.                                                     |
| Excel.Filter                               | Manages the filtering of a table's column.                                            |
| Excel.FilterPivot<br>Hierarchy             | Represents the Excel FilterPivotHierarchy.                                            |
| Excel.FilterPivot<br>Hierarchy             | Represents a collection of FilterPivotHierarchy items associated with the PivotTable. |

{6}------------------------------------------------

| Collection                             |                                                                                                                                                                                                                                                                                                                                                                                                                 |
|----------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Format<br>Protection             | Represents the format protection of a range object.                                                                                                                                                                                                                                                                                                                                                             |
| Excel.Function<br>Result               | An object containing the result of a function-evaluation operation                                                                                                                                                                                                                                                                                                                                              |
| Excel.Functions                        | An object for evaluating Excel functions.                                                                                                                                                                                                                                                                                                                                                                       |
| Excel.Geometric<br>Shape               | Represents a geometric shape inside a worksheet. A geometric shape can be a<br>rectangle, block arrow, equation symbol, flowchart item, star, banner, callout, or any<br>other basic shape in Excel.                                                                                                                                                                                                            |
| Excel.Group<br>ShapeCollection         | Represents the shape collection inside a shape group.                                                                                                                                                                                                                                                                                                                                                           |
| Excel.HeaderFooter                     |                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Excel.HeaderFooterGroup                |                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Excel.IconSet<br>Conditional<br>Format | Represents an icon set criteria for conditional formatting.                                                                                                                                                                                                                                                                                                                                                     |
| Excel.Image                            | Represents an image in the worksheet. To get the corresponding Shape object, use<br>Image.shape .                                                                                                                                                                                                                                                                                                               |
| Excel.Iterative<br>Calculation         | Represents the iterative calculation settings.                                                                                                                                                                                                                                                                                                                                                                  |
| Excel.Line                             | Represents a line inside a worksheet. To get the corresponding Shape object, use<br>Line.shape .                                                                                                                                                                                                                                                                                                                |
| Excel.Linked                           | Represents a linked data type. A linked data type is a data type connected to an online                                                                                                                                                                                                                                                                                                                         |
| DataType                               | data source.                                                                                                                                                                                                                                                                                                                                                                                                    |
| Excel.Linked<br>DataType<br>Collection | Represents a collection of linked data types.                                                                                                                                                                                                                                                                                                                                                                   |
| Excel.Linked<br>EntityData<br>Domain   | Represents a specific category or field of information that shares some common<br>characteristics or attributes. A data domain is linked to a data provider, that acts as the<br>data source for LinkedEntityCellValue objects in the workbook. A data domain is a<br>category of data, such as stocks, geography, or currencies. A data provider is a service,<br>such as Bing, Power BI, or an Office Add-in. |
| Excel.Linked                           | Represents a collection of LinkedEntityDataDomain objects. The collection can contain                                                                                                                                                                                                                                                                                                                           |
| EntityData                             | linked entity data domains such as stocks, geography, or currencies defined by service                                                                                                                                                                                                                                                                                                                          |
| Domain                                 | data providers, such as Bing or Power BI, or linked entity data domains defined by                                                                                                                                                                                                                                                                                                                              |
| Collection                             | Office Add-ins.                                                                                                                                                                                                                                                                                                                                                                                                 |

{7}------------------------------------------------

| Excel.Linked<br>Workbook               | Contains information about a linked workbook. If a workbook has links pointing to<br>data in another workbook, the second workbook is linked to the first workbook. In this<br>scenario, the second workbook is called the "linked workbook".     |
|----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Linked<br>Workbook<br>Collection | Represents a collection of linked workbook objects.                                                                                                                                                                                               |
| Excel.Local<br>Image                   | Provides information about the local image.                                                                                                                                                                                                       |
| Excel.Named<br>Item                    | Represents a defined name for a range of cells or value. Names can be primitive<br>named objects (as seen in the type below), range object, or a reference to a range. This<br>object can be used to obtain range object associated with names.   |
| Excel.Named<br>ItemArrayValues         | Represents an object containing values and types of a named item.                                                                                                                                                                                 |
| Excel.Named                            | A collection of all the NamedItem objects that are part of the workbook or worksheet,                                                                                                                                                             |
| ItemCollection                         | depending on how it was reached.                                                                                                                                                                                                                  |
| Excel.Named<br>SheetView               | Represents a named sheet view of a worksheet. A sheet view stores the sort and filter<br>rules for a particular worksheet. Every sheet view (even a temporary sheet view) has a<br>unique, worksheet-scoped name that is used to access the view. |
| Excel.Named<br>SheetView<br>Collection | Represents the collection of sheet views in the worksheet.                                                                                                                                                                                        |
| Excel.Note                             | Represents a note in the workbook or worksheet.                                                                                                                                                                                                   |
| Excel.Note<br>Collection               | Represents a collection of note objects that are part of the workbook.                                                                                                                                                                            |
| Excel.Number                           | Defines the culturally appropriate format of displaying numbers. This is based on                                                                                                                                                                 |
| FormatInfo                             | current system culture settings.                                                                                                                                                                                                                  |
| Excel.PageBreak                        |                                                                                                                                                                                                                                                   |
| Excel.PageBreakCollection              |                                                                                                                                                                                                                                                   |
| Excel.Page<br>Layout                   | Represents layout and print settings that are not dependent on any printer-specific<br>implementation. These settings include margins, orientation, page numbering, title<br>rows, and print area.                                                |
| Excel.PivotField                       | Represents the Excel PivotField.                                                                                                                                                                                                                  |
| Excel.PivotField<br>Collection         | Represents a collection of all the PivotFields that are part of a PivotTable's hierarchy.                                                                                                                                                         |
| Excel.Pivot<br>Hierarchy               | Represents the Excel PivotHierarchy.                                                                                                                                                                                                              |

{8}------------------------------------------------

| Excel.Pivot<br>Hierarchy<br>Collection            | Represents a collection of all the PivotHierarchies that are part of the PivotTable.                                                                                                                                          |
|---------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.PivotItem                                   | Represents the Excel PivotItem.                                                                                                                                                                                               |
| Excel.PivotItem<br>Collection                     | Represents a collection of all the PivotItems related to their parent PivotField.                                                                                                                                             |
| Excel.Pivot<br>Layout                             | Represents the visual layout of the PivotTable.                                                                                                                                                                               |
| Excel.PivotTable                                  | Represents an Excel PivotTable. To learn more about the PivotTable object model, read<br>Work with PivotTables using the Excel JavaScript API.                                                                                |
| Excel.PivotTable                                  | Represents a collection of all the PivotTables that are part of the workbook or                                                                                                                                               |
| Collection                                        | worksheet.                                                                                                                                                                                                                    |
| Excel.PivotTable                                  | Represents a scoped collection of PivotTables. The PivotTables are sorted based on the                                                                                                                                        |
| Scoped                                            | location of the PivotTable's top-left corner. They are ordered top-to-bottom and then                                                                                                                                         |
| Collection                                        | left-to-right.                                                                                                                                                                                                                |
| Excel.PivotTable<br>Style                         | Represents a PivotTable style, which defines style elements by PivotTable region.                                                                                                                                             |
| Excel.PivotTable<br>StyleCollection               | Represents a collection of PivotTable styles.                                                                                                                                                                                 |
| Excel.Preset<br>Criteria<br>Conditional<br>Format | Represents the preset criteria conditional format such as above average, below<br>average, unique values, contains blank, nonblank, error, and noerror.                                                                       |
| Excel.Query                                       | Represents a Power Query query.                                                                                                                                                                                               |
| Excel.Query<br>Collection                         | Represents the collection of queries in the workbook.                                                                                                                                                                         |
| Excel.Range                                       | Range represents a set of one or more contiguous cells such as a cell, a row, a column,<br>or a block of cells. To learn more about how ranges are used throughout the API, start<br>with Ranges in the Excel JavaScript API. |
| Excel.Range<br>Areas                              | RangeAreas represents a collection of one or more rectangular ranges in the same<br>worksheet. To learn how to use discontiguous ranges, read Work with multiple ranges<br>simultaneously in Excel add-ins.                   |
| Excel.Range<br>AreasCollection                    | Contains the collection of cross-workbook level ranges.                                                                                                                                                                       |
| Excel.Range<br>Border                             | Represents the border of an object.                                                                                                                                                                                           |

{9}------------------------------------------------

| Excel.Range<br>Border<br>Collection                 | Represents the border objects that make up the range border.                                                                                                                                                                                                                                                                                                                                                  |  |
|-----------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Excel.RangeCollection                               |                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Excel.RangeFill                                     | Represents the background of a range object.                                                                                                                                                                                                                                                                                                                                                                  |  |
| Excel.RangeFont                                     | This object represents the font attributes (font name, font size, color, etc.) for an<br>object.                                                                                                                                                                                                                                                                                                              |  |
| Excel.Range                                         | A format object encapsulating the range's font, fill, borders, alignment, and other                                                                                                                                                                                                                                                                                                                           |  |
| Format                                              | properties.                                                                                                                                                                                                                                                                                                                                                                                                   |  |
| Excel.RangeSort                                     | Manages sorting operations on Range objects.                                                                                                                                                                                                                                                                                                                                                                  |  |
| Excel.RangeView                                     | RangeView represents a set of visible cells of the parent range.                                                                                                                                                                                                                                                                                                                                              |  |
| Excel.RangeView<br>Collection                       | Represents a collection of RangeView objects.                                                                                                                                                                                                                                                                                                                                                                 |  |
| Excel.Remove                                        | Represents the results from Range.removeDuplicates                                                                                                                                                                                                                                                                                                                                                            |  |
| DuplicatesResult                                    |                                                                                                                                                                                                                                                                                                                                                                                                               |  |
| Excel.Request<br>Context                            | The RequestContext object facilitates requests to the Excel application. Since the Office<br>add-in and the Excel application run in two different processes, the request context is<br>required to get access to the Excel object model from the add-in.                                                                                                                                                     |  |
| Excel.Row<br>ColumnPivot<br>Hierarchy               | Represents the Excel RowColumnPivotHierarchy.                                                                                                                                                                                                                                                                                                                                                                 |  |
| Excel.Row<br>ColumnPivot<br>Hierarchy<br>Collection | Represents a collection of RowColumnPivotHierarchy items associated with the<br>PivotTable.                                                                                                                                                                                                                                                                                                                   |  |
| Excel.Runtime                                       | Represents the Excel Runtime class.                                                                                                                                                                                                                                                                                                                                                                           |  |
| Excel.Setting                                       | Setting represents a key-value pair of a setting persisted to the document (per file, per<br>add-in). These custom key-value pair can be used to store state or lifecycle<br>information needed by the content or task-pane add-in. Note that settings are<br>persisted in the document and hence it is not a place to store any sensitive or<br>protected information such as user information and password. |  |
| Excel.Setting                                       | Represents a collection of key-value pair setting objects that are part of the workbook.                                                                                                                                                                                                                                                                                                                      |  |
| Collection                                          | The scope is limited to per file and add-in (task-pane or content) combination.                                                                                                                                                                                                                                                                                                                               |  |
| Excel.Shape                                         | Represents a generic shape object in the worksheet. A shape could be a geometric<br>shape, a line, a group of shapes, etc. To learn more about the shape object model,<br>read Work with shapes using the Excel JavaScript API.                                                                                                                                                                               |  |

{10}------------------------------------------------

| Excel.Shape<br>Collection           | Represents a collection of all the shapes in the worksheet.                                                                                                            |
|-------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.ShapeFill                     | Represents the fill formatting of a shape object.                                                                                                                      |
| Excel.ShapeFont                     | Represents the font attributes, such as font name, font size, and color, for a shape's<br>TextRange object.                                                            |
| Excel.Shape<br>Group                | Represents a shape group inside a worksheet. To get the corresponding Shape object,<br>use ShapeGroup.shape                                                            |
| Excel.ShapeLine                     | Represents the line formatting for the shape object. For images and geometric shapes,                                                                                  |
| Format                              | line formatting represents the border of the shape.                                                                                                                    |
| Excel.Slicer                        | Represents a Slicer object in the workbook.                                                                                                                            |
| Excel.Slicer<br>Collection          | Represents a collection of all the slicer objects in the workbook or a worksheet.                                                                                      |
| Excel.SlicerItem                    | Represents a slicer item in a slicer.                                                                                                                                  |
| Excel.SlicerItem<br>Collection      | Represents a collection of all the slicer item objects in the slicer.                                                                                                  |
| Excel.SlicerStyle                   | Represents a slicer style, which defines style elements by region of the slicer.                                                                                       |
| Excel.SlicerStyle<br>Collection     | Represents a collection of SlicerStyle objects.                                                                                                                        |
| Excel.Style                         | An object encapsulating a style's format and other properties.                                                                                                         |
| Excel.Style<br>Collection           | Represents a collection of all the styles.                                                                                                                             |
| Excel.Table                         | Represents an Excel table. To learn more about the table object model, read Work with<br>tables using the Excel JavaScript API.                                        |
| Excel.Table                         | Represents a collection of all the tables that are part of the workbook or worksheet,                                                                                  |
| Collection                          | depending on how it was reached.                                                                                                                                       |
| Excel.Table<br>Column               | Represents a column in a table.                                                                                                                                        |
| Excel.Table<br>Column<br>Collection | Represents a collection of all the columns that are part of the table.                                                                                                 |
| Excel.TableRow                      | Represents a row in a table.                                                                                                                                           |
|                                     | Note that unlike ranges or columns, which will adjust if new rows or columns are<br>added before them, a TableRow object represents the physical location of the table |

{11}------------------------------------------------

|                                          | row, but not the data. That is, if the data is sorted or if new rows are added, a table<br>row will continue to point at the index for which it was created.                                                                                                                                                                           |
|------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.TableRow<br>Collection             | Represents a collection of all the rows that are part of the table.                                                                                                                                                                                                                                                                    |
|                                          | Note that unlike ranges or columns, which will adjust if new rows or columns are<br>added before them, a TableRow object represents the physical location of the table<br>row, but not the data. That is, if the data is sorted or if new rows are added, a table<br>row will continue to point at the index for which it was created. |
| Excel.Table                              | Represents a scoped collection of tables. For each table its top-left corner is                                                                                                                                                                                                                                                        |
| Scoped                                   | considered its anchor location, and the tables are sorted top-to-bottom and then left                                                                                                                                                                                                                                                  |
| Collection                               | to-right.                                                                                                                                                                                                                                                                                                                              |
| Excel.TableSort                          | Manages sorting operations on Table objects.                                                                                                                                                                                                                                                                                           |
| Excel.TableStyle                         | Represents a table style, which defines the style elements by region of the table.                                                                                                                                                                                                                                                     |
| Excel.TableStyle<br>Collection           | Represents a collection of table styles.                                                                                                                                                                                                                                                                                               |
| Excel.Text<br>Conditional<br>Format      | Represents a specific text conditional format.                                                                                                                                                                                                                                                                                         |
| Excel.TextFrame                          | Represents the text frame of a shape object.                                                                                                                                                                                                                                                                                           |
| Excel.TextRange                          | Contains the text that is attached to a shape, in addition to properties and methods<br>for manipulating the text.                                                                                                                                                                                                                     |
| Excel.Timeline                           | Represents a TimelineStyle                                                                                                                                                                                                                                                                                                             |
| Style                                    | , which defines style elements by region in the timeline.                                                                                                                                                                                                                                                                              |
| Excel.Timeline<br>StyleCollection        | Represents a collection of timeline styles.                                                                                                                                                                                                                                                                                            |
| Excel.TopBottom<br>Conditional<br>Format | Represents a top/bottom conditional format.                                                                                                                                                                                                                                                                                            |
| Excel.Workbook                           | Workbook is the top level object which contains related workbook objects such as<br>worksheets, tables, and ranges. To learn more about the workbook object model, read<br>Work with workbooks using the Excel JavaScript API.                                                                                                         |
| Excel.Workbook                           | The WorkbookCreated object is the top level object created by                                                                                                                                                                                                                                                                          |
| Created                                  | Application.CreateWorkbook . A WorkbookCreated object is a special Workbook object.                                                                                                                                                                                                                                                    |
| Excel.Workbook<br>Protection             | Represents the protection of a workbook object.                                                                                                                                                                                                                                                                                        |
| Excel.Workbook<br>RangeAreas             | Represents a collection of one or more rectangular ranges in multiple worksheets.                                                                                                                                                                                                                                                      |

{12}------------------------------------------------

| Excel.Worksheet                                 | An Excel worksheet is a grid of cells. It can contain data, tables, charts, etc. To learn<br>more about the worksheet object model, read Work with worksheets using the Excel<br>JavaScript API. |  |
|-------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Excel.Worksheet<br>Collection                   | Represents a collection of worksheet objects that are part of the workbook.                                                                                                                      |  |
| Excel.Worksheet<br>CustomProperty               | Represents a worksheet-level custom property.                                                                                                                                                    |  |
| Excel.Worksheet<br>CustomProperty<br>Collection | Contains the collection of worksheet-level custom property.                                                                                                                                      |  |
| Excel.WorksheetFreezePanes                      |                                                                                                                                                                                                  |  |
| Excel.Worksheet<br>Protection                   | Represents the protection of a worksheet object.                                                                                                                                                 |  |

### **Interfaces**

| Excel.AllowEdit<br>RangeOptions       | The interface used to construct optional fields of the AllowEditRange object.     |
|---------------------------------------|-----------------------------------------------------------------------------------|
| Excel.ArrayCellValue                  | Represents a 2D array of cell values.                                             |
| Excel.<br>Base64Encoded<br>Image      | The Base64-encoded type and data of an image.                                     |
| Excel.BasicCard<br>Layout             | Represents a card layout used for the Boolean, double, and string basic types.    |
| Excel.BasicCompact<br>Layout          | The basic compact layout properties.                                              |
| Excel.BasicData<br>Validation         | Represents the basic type data validation criteria.                               |
| Excel.BasicView<br>Layouts            | Represents layout information for various views of the value and its properties.  |
| Excel.BindingData<br>ChangedEventArgs | Provides information about the binding that raised the data changed event.        |
| Excel.Binding<br>SelectionChanged     | Provides information about the selection that raised the selection changed event. |

{13}------------------------------------------------

| EventArgs                                         | Note*: If multiple, discontiguous cells are selected, Binding.onSelectionChanged<br>only reports row and column information for one selection. Use<br>Worksheet.onSelectionChanged for multiple selected ranges.                                  |
|---------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.BlockedError<br>CellValue                   | Represents the value of a cell containing a #BLOCKED! error.                                                                                                                                                                                      |
| Excel.BooleanCell<br>Value                        | Represents the value of a cell containing a Boolean.                                                                                                                                                                                              |
| Excel.BusyErrorCell<br>Value                      | Represents the value of a cell containing a #BUSY! error.                                                                                                                                                                                         |
| Excel.CalcErrorCell<br>Value                      | Represents the value of a cell containing a #CALC! error.                                                                                                                                                                                         |
| Excel.CardLayoutList<br>Section                   | Represents a section of a card that is arranged as a list in card view.                                                                                                                                                                           |
| Excel.CardLayout<br>PropertyReference             | Represents a reference to a property used by the card layout.                                                                                                                                                                                     |
| Excel.CardLayout<br>SectionStandard<br>Properties | Properties of a card layout relevant to most card layouts.                                                                                                                                                                                        |
| Excel.CardLayout<br>StandardProperties            | Properties of a card layout relevant to most card layouts.                                                                                                                                                                                        |
| Excel.CardLayout<br>TableSection                  | Represents a section of a card that is arranged as a table in card view.                                                                                                                                                                          |
| Excel.CardLayout<br>TwoColumnSection              | Represents a section of a card that is arranged as two columns in card view.                                                                                                                                                                      |
| Excel.CellBorder                                  | Represents the properties of a single border returned by getCellProperties<br>,<br>getRowProperties , and getColumnProperties , or the border property input<br>parameter of setCellProperties<br>, setRowProperties<br>, and setColumnProperties |
| Excel.CellBorder<br>Collection                    | Represents the format.borders properties of getCellProperties<br>,<br>getRowProperties , and getColumnProperties<br>, or the format.borders input<br>parameter of setCellProperties<br>, setRowProperties<br>, and setColumnProperties            |
| Excel.CellProperties                              | Represents the returned properties of getCellProperties.                                                                                                                                                                                          |
|                                                   | [ API set: ExcelApi 1.9 ]                                                                                                                                                                                                                         |
| Excel.CellProperties<br>BorderLoadOptions         | Specifies which properties to load on the format.borders object.                                                                                                                                                                                  |
| Excel.CellProperties<br>Fill                      | Represents the format.fill properties of getCellProperties<br>, getRowProperties<br>,<br>and getColumnProperties or the format.fill input parameter of                                                                                            |

{14}------------------------------------------------

|                                                   | setCellProperties , setRowProperties<br>, and setColumnProperties                                                                                                                                                                            |
|---------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.CellProperties<br>FillLoadOptions           | Specifies which properties to load on the format.fill object.                                                                                                                                                                                |
| Excel.CellProperties<br>Font                      | Represents the format.font properties of getCellProperties<br>, getRowProperties<br>,<br>and getColumnProperties<br>, or the format.font input parameter of<br>setCellProperties , setRowProperties , and setColumnProperties .              |
| Excel.CellProperties<br>FontLoadOptions           | Specifies which properties to load on the format.font object.                                                                                                                                                                                |
| Excel.CellProperties                              | Represents the returned format properties of getCellProperties or format input                                                                                                                                                               |
| Format                                            | parameter of setCellProperties.                                                                                                                                                                                                              |
|                                                   | [ API set: ExcelApi 1.9 ]                                                                                                                                                                                                                    |
| Excel.CellProperties<br>FormatLoadOptions         | Represents which properties to load on the format object.                                                                                                                                                                                    |
|                                                   | [ API set: ExcelApi 1.9 ]                                                                                                                                                                                                                    |
| Excel.CellProperties                              | Represents which cell properties to load, when used as part of a                                                                                                                                                                             |
| LoadOptions                                       | "range.getCellProperties" method.                                                                                                                                                                                                            |
|                                                   | [ API set: ExcelApi 1.9 ]                                                                                                                                                                                                                    |
|                                                   |                                                                                                                                                                                                                                              |
| Excel.CellProperties<br>Protection                | Represents the format.protection properties of getCellProperties<br>,<br>getRowProperties , and getColumnProperties<br>, or the format.protection input<br>parameter of setCellProperties<br>, setRowProperties<br>, and setColumnProperties |
| Excel.CellValue                                   | The attribution attributes object represents the set of details that can be used to                                                                                                                                                          |
| Attribution                                       | describe where information came from, if the information comes from a public                                                                                                                                                                 |
| Attributes                                        | source.                                                                                                                                                                                                                                      |
| Excel.CellValueExtra<br>Properties                | These extra properties may appear on a CellValue and provide information about<br>that CellValue<br>, but the extra properties are not part of the value in the cell.                                                                        |
| Excel.CellValue                                   | Metadata about a property in EntityCellValue.properties                                                                                                                                                                                      |
| PropertyMetadata                                  |                                                                                                                                                                                                                                              |
| Excel.CellValue<br>PropertyMetadata<br>Exclusions | Represents the exclusion of a property in EntityCellValue.properties from<br>features of Excel.                                                                                                                                              |
| Excel.CellValue<br>ProviderAttributes             | The provider attributes object represents the set of details used in card view to<br>provide specified branding information for a CellValue type that supports<br>provider attributes.                                                       |

{15}------------------------------------------------

| Excel.Change                              | Represents the direction that existing or remaining cells in a worksheet will shift                                                                                                       |
|-------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DirectionState                            | when cells are inserted into or deleted from a worksheet.                                                                                                                                 |
| Excel.ChartActivated<br>EventArgs         | Provides information about the chart that raised the activated event.                                                                                                                     |
| Excel.ChartAdded<br>EventArgs             | Provides information about the chart that raised the added event.                                                                                                                         |
| Excel.Chart<br>DeactivatedEvent<br>Args   | Provides information about the chart that raised the deactivated event.                                                                                                                   |
| Excel.ChartDeleted<br>EventArgs           | Provides information about the chart that raised the deleted event.                                                                                                                       |
| Excel.CheckboxCell                        | Represents a checkbox. This is a cell control that allows a user to toggle the                                                                                                            |
| Control                                   | boolean value in a cell.                                                                                                                                                                  |
| Excel.Column                              | Represents the returned properties of getColumnProperties.                                                                                                                                |
| Properties                                | [ API set: ExcelApi 1.9 ]                                                                                                                                                                 |
| Excel.Column<br>PropertiesLoad<br>Options | Represents which column properties to load, when used as part of a<br>"range.getColumnProperties" method.                                                                                 |
|                                           | [ API set: ExcelApi 1.9 ]                                                                                                                                                                 |
| Excel.Comment<br>AddedEventArgs           | Provides information about the comments that raised the comment added event.                                                                                                              |
| Excel.Comment<br>ChangedEventArgs         | Occurs when existing comments are changed.                                                                                                                                                |
| Excel.Comment<br>DeletedEventArgs         | Provides information about the comments that raised the comment deleted event.                                                                                                            |
| Excel.Comment<br>Detail                   | A structure for the comment ID and IDs of its related replies.                                                                                                                            |
| Excel.Comment<br>Mention                  | Represents the entity that is mentioned in comments.                                                                                                                                      |
| Excel.CommentRich<br>Content              | Represents the content contained within a comment or comment reply. Rich<br>content incudes the text string and any other objects contained within the<br>comment body, such as mentions. |
| Excel.Conditional<br>CellValueRule        | Represents a cell value conditional format rule.                                                                                                                                          |
| Excel.Conditional<br>ColorScaleCriteria   | Represents the criteria of the color scale.                                                                                                                                               |

{16}------------------------------------------------

| Excel.Conditional<br>ColorScaleCriterion      | Represents a color scale criterion which contains a type, value, and a color.        |
|-----------------------------------------------|--------------------------------------------------------------------------------------|
| Excel.Conditional<br>DataBarRule              | Represents a rule-type for a data bar.                                               |
| Excel.Conditional                             | Represents an icon criterion which contains a type, value, an operator, and an       |
| IconCriterion                                 | optional custom icon, if not using an icon set.                                      |
| Excel.Conditional<br>PresetCriteriaRule       | Represents the preset criteria conditional format rule.                              |
| Excel.Conditional<br>TextComparisonRule       | Represents a cell value conditional format rule.                                     |
| Excel.ConditionalTop<br>BottomRule            | Represents the rule of the top/bottom conditional format.                            |
| Excel.ConnectError<br>CellValue               | Represents the value of a cell containing a #CONNECT! error.                         |
| Excel.CustomData<br>Validation                | Represents the custom data validation criteria.                                      |
| Excel.Custom<br>FunctionVisibility<br>Options | Represents which custom functions to show or hide in Excel AutoComplete.             |
| Excel.DataValidation<br>ErrorAlert            | Represents the error alert properties for the data validation.                       |
| Excel.DataValidation<br>Prompt                | Represents the user prompt properties for the data validation.                       |
| Excel.DataValidation                          | A data validation rule contains different types of data validation. You can only use |
| Rule                                          | one of them at a time according the Excel.DataValidationType .                       |
| Excel.DateTimeData<br>Validation              | Represents the date data validation criteria.                                        |
| Excel.Div0ErrorCell<br>Value                  | Represents the value of a cell containing a #DIV/0! error.                           |
| Excel.DocumentTask<br>Schedule                | Represents information about a task's schedule.                                      |
| Excel.DoubleCell<br>Value                     | Represents the value of a cell containing a double.                                  |
| Excel.EmailIdentity                           | Represents information about a user's identity.                                      |

{17}------------------------------------------------

| Excel.EmptyCell                                  | Represents an empty cell control. This represents the state where a cell does not                                                                                                                                                                |
|--------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Control                                          | have a control.                                                                                                                                                                                                                                  |
| Excel.EmptyCell<br>Value                         | Represents the value of a cell that's empty and has no formulas or data.                                                                                                                                                                         |
| Excel.EntityArray<br>CardLayout                  | Represents a card layout that is best used for an array.                                                                                                                                                                                         |
| Excel.EntityCard<br>Layout                       | Represents a card layout that is best used for an entity.                                                                                                                                                                                        |
| Excel.EntityCellValue                            | Represents a set of properties without a schema or defined structure.                                                                                                                                                                            |
| Excel.EntityCompact<br>Layout                    | The compact layout properties for an entity.                                                                                                                                                                                                     |
| Excel.EntityProperty<br>ExtraProperties          | Properties used by CellValueAndPropertyMetadata . These properties refer to the<br>metadata and not to a CellValue                                                                                                                               |
| Excel.EntityView<br>Layouts                      | Represents layout information for various views of the entity.                                                                                                                                                                                   |
| Excel.ExternalCode<br>ServiceObjectCell<br>Value | Represents the value of a cell containing an External Code Service Object, such as<br>Python code formula.                                                                                                                                       |
| Excel.ExternalError<br>CellValue                 | Represents the value of a cell containing an #EXTERNAL! error.                                                                                                                                                                                   |
| Excel.FieldErrorCell<br>Value                    | Represents the value of a cell containing a #FIELD! error.                                                                                                                                                                                       |
| Excel.FilterCriteria                             | Represents the filtering criteria applied to a column.                                                                                                                                                                                           |
| Excel.FilterDatetime                             | Represents how to filter a date when filtering on values.                                                                                                                                                                                        |
| Excel.FiveArrows<br>GraySet                      | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                        |
| Excel.FiveArrowsSet                              | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                        |
| Excel.FiveBoxesSet                               | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                        |
| Excel.FiveQuarters<br>Set                        | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                        |
| Excel.FiveRatingSet                              | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                        |
| Excel.Formatted<br>NumberCellValue               | Represents the value of a cell containing a number with a format string. Number<br>format strings must conform to Excel guidelines. To learn more, see Review<br>guidelines for customizing a number format<br>. In this scenario, the format is |

{18}------------------------------------------------

|                                                                  | applied to the value and not to the cell, so the value retains its format string<br>throughout calculation.                                                                                                                                                                                                                  |
|------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Formula<br>ChangedEventDetail                              | Provides information about a changed formula during a formula changed event.                                                                                                                                                                                                                                                 |
| Excel.FourArrows<br>GraySet                                      | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                                                                                                    |
| Excel.FourArrowsSet                                              | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                                                                                                    |
| Excel.FourRatingSet                                              | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                                                                                                    |
| Excel.FourRed<br>ToBlackSet                                      | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                                                                                                    |
| Excel.FourTraffic<br>LightsSet                                   | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                                                                                                    |
| Excel.GettingData<br>ErrorCellValue                              | Represents the value of a cell containing a #GETTING_DATA error.                                                                                                                                                                                                                                                             |
| Excel.Icon                                                       | Represents a cell icon.                                                                                                                                                                                                                                                                                                      |
| Excel.Icon<br>Collections                                        | [ API set: ExcelApi 1.2 ]                                                                                                                                                                                                                                                                                                    |
|                                                                  |                                                                                                                                                                                                                                                                                                                              |
| Excel.Identity                                                   | Represents information about a user's identity.                                                                                                                                                                                                                                                                              |
| Excel.Insert                                                     | The options that define which worksheets to insert and where in the workbook the                                                                                                                                                                                                                                             |
| WorksheetOptions                                                 | new worksheets will be inserted.                                                                                                                                                                                                                                                                                             |
| Excel.Interfaces.<br>AllowEditRange<br>CollectionData            | An interface describing the data returned by calling<br>allowEditRangeCollection.toJSON() .                                                                                                                                                                                                                                  |
| Excel.Interfaces.<br>AllowEditRange<br>CollectionLoad<br>Options | Represents the set of AllowEditRange objects found in a worksheet.<br>AllowEditRange objects work with worksheet protection properties. When<br>worksheet protection is enabled, an AllowEditRange object can be used to allow<br>editing of a specific range, while maintaining protection on the rest of the<br>worksheet. |
| Excel.Interfaces.<br>AllowEditRange<br>CollectionUpdate<br>Data  | An interface for updating data on the AllowEditRangeCollection object, for use in<br>allowEditRangeCollection.set({  }) .                                                                                                                                                                                                    |
| Excel.Interfaces.<br>AllowEditRangeData                          | An interface describing the data returned by calling allowEditRange.toJSON() .                                                                                                                                                                                                                                               |

{19}------------------------------------------------

| Options                                                        | AllowEditRange object can be used to allow editing of a specific range, while<br>maintaining protection on the rest of the worksheet. |
|----------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>AllowEditRange<br>UpdateData              | An interface for updating data on the AllowEditRange object, for use in<br>allowEditRange.set({  }) .                                 |
| Excel.Interfaces.                                              | An interface describing the data returned by calling application.toJSON()                                                             |
| ApplicationData                                                |                                                                                                                                       |
| Excel.Interfaces.<br>ApplicationLoad<br>Options                | Represents the Excel application that manages the workbook.                                                                           |
| Excel.Interfaces.<br>ApplicationUpdate<br>Data                 | An interface for updating data on the Application object, for use in<br>application.set({  }) .                                       |
| Excel.Interfaces.Auto                                          | An interface describing the data returned by calling autoFilter.toJSON()                                                              |
| FilterData                                                     |                                                                                                                                       |
| Excel.Interfaces.Auto                                          | Represents the AutoFilter object. AutoFilter turns the values in Excel column into                                                    |
| FilterLoadOptions                                              | specific filters based on the cell contents.                                                                                          |
| Excel.Interfaces.<br>BindingCollection<br>Data                 | An interface describing the data returned by calling bindingCollection.toJSON()                                                       |
| Excel.Interfaces.<br>BindingCollection<br>LoadOptions          | Represents the collection of all the binding objects that are part of the workbook.                                                   |
| Excel.Interfaces.<br>BindingCollection<br>UpdateData           | An interface for updating data on the BindingCollection object, for use in<br>bindingCollection.set({  }) .                           |
| Excel.Interfaces.                                              | An interface describing the data returned by calling binding.toJSON()                                                                 |
| BindingData                                                    |                                                                                                                                       |
| Excel.Interfaces.<br>BindingLoadOptions                        | Represents an Office.js binding that is defined in the workbook.                                                                      |
| Excel.Interfaces.Cell<br>ValueConditional<br>FormatData        | An interface describing the data returned by calling<br>cellValueConditionalFormat.toJSON() .                                         |
| Excel.Interfaces.Cell<br>ValueConditional<br>FormatLoadOptions | Represents a cell value conditional format.                                                                                           |
| Excel.Interfaces.Cell                                          | An interface for updating data on the CellValueConditionalFormat object, for use                                                      |
| ValueConditional                                               | in cellValueConditionalFormat.set({  }) .                                                                                             |

{20}------------------------------------------------

| FormatUpdateData                                    |                                                                                                         |
|-----------------------------------------------------|---------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartAreaFormat<br>Data        | An interface describing the data returned by calling chartAreaFormat.toJSON()                           |
| Excel.Interfaces.<br>ChartAreaFormat<br>LoadOptions | Encapsulates the format properties for the overall chart area.                                          |
| Excel.Interfaces.<br>ChartAreaFormat<br>UpdateData  | An interface for updating data on the ChartAreaFormat object, for use in<br>chartAreaFormat.set({  }) . |
| Excel.Interfaces.                                   | An interface describing the data returned by calling chartAxes.toJSON()                                 |
| ChartAxesData                                       |                                                                                                         |
| Excel.Interfaces.<br>ChartAxesLoad<br>Options       | Represents the chart axes.                                                                              |
| Excel.Interfaces.<br>ChartAxesUpdate<br>Data        | An interface for updating data on the ChartAxes object, for use in chartAxes.set({<br>}) .              |
| Excel.Interfaces.                                   | An interface describing the data returned by calling chartAxis.toJSON()                                 |
| ChartAxisData                                       |                                                                                                         |
| Excel.Interfaces.<br>ChartAxisFormat<br>Data        | An interface describing the data returned by calling chartAxisFormat.toJSON()                           |
| Excel.Interfaces.<br>ChartAxisFormat<br>LoadOptions | Encapsulates the format properties for the chart axis.                                                  |
| Excel.Interfaces.<br>ChartAxisFormat<br>UpdateData  | An interface for updating data on the ChartAxisFormat object, for use in<br>chartAxisFormat.set({  }) . |
| Excel.Interfaces.<br>ChartAxisLoad<br>Options       | Represents a single axis in a chart.                                                                    |
| Excel.Interfaces.                                   | An interface describing the data returned by calling chartAxisTitle.toJSON()                            |
| ChartAxisTitleData                                  |                                                                                                         |
| Excel.Interfaces.<br>ChartAxisTitle<br>FormatData   | An interface describing the data returned by calling<br>chartAxisTitleFormat.toJSON() .                 |

{21}------------------------------------------------

| Excel.Interfaces.<br>ChartAxisTitle<br>FormatLoadOptions       | Represents the chart axis title formatting.                                                                       |
|----------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartAxisTitle<br>FormatUpdateData        | An interface for updating data on the ChartAxisTitleFormat object, for use in<br>chartAxisTitleFormat.set({  }) . |
| Excel.Interfaces.<br>ChartAxisTitleLoad<br>Options             | Represents the title of a chart axis.                                                                             |
| Excel.Interfaces.<br>ChartAxisTitle<br>UpdateData              | An interface for updating data on the ChartAxisTitle object, for use in<br>chartAxisTitle.set({  }) .             |
| Excel.Interfaces.<br>ChartAxisUpdate<br>Data                   | An interface for updating data on the ChartAxis object, for use in chartAxis.set({<br>}) .                        |
| Excel.Interfaces.<br>ChartBinOptions<br>Data                   | An interface describing the data returned by calling chartBinOptions.toJSON() .                                   |
| Excel.Interfaces.<br>ChartBinOptions<br>LoadOptions            | Encapsulates the bin options for histogram charts and pareto charts.                                              |
| Excel.Interfaces.<br>ChartBinOptions<br>UpdateData             | An interface for updating data on the ChartBinOptions object, for use in<br>chartBinOptions.set({  }) .           |
| Excel.Interfaces.<br>ChartBorderData                           | An interface describing the data returned by calling chartBorder.toJSON() .                                       |
| Excel.Interfaces.<br>ChartBorderLoad<br>Options                | Represents the border formatting of a chart element.                                                              |
| Excel.Interfaces.<br>ChartBorderUpdate<br>Data                 | An interface for updating data on the ChartBorder object, for use in<br>chartBorder.set({  }) .                   |
| Excel.Interfaces.<br>ChartBoxwhisker<br>OptionsData            | An interface describing the data returned by calling<br>chartBoxwhiskerOptions.toJSON() .                         |
| Excel.Interfaces.<br>ChartBoxwhisker<br>OptionsLoad<br>Options | Represents the properties of a box and whisker chart.                                                             |

{22}------------------------------------------------

| Excel.Interfaces.<br>ChartBoxwhisker<br>OptionsUpdateData | An interface for updating data on the ChartBoxwhiskerOptions object, for use in<br>chartBoxwhiskerOptions.set({  }) . |
|-----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartCollectionData                  | An interface describing the data returned by calling chartCollection.toJSON() .                                       |
| Excel.Interfaces.<br>ChartCollectionLoad<br>Options       | A collection of all the chart objects on a worksheet.                                                                 |
| Excel.Interfaces.<br>ChartCollection<br>UpdateData        | An interface for updating data on the ChartCollection object, for use in<br>chartCollection.set({  }) .               |
| Excel.Interfaces.<br>ChartData                            | An interface describing the data returned by calling chart.toJSON() .                                                 |
| Excel.Interfaces.<br>ChartDataLabel<br>AnchorData         | An interface describing the data returned by calling<br>chartDataLabelAnchor.toJSON() .                               |
| Excel.Interfaces.<br>ChartDataLabel<br>AnchorLoadOptions  | Represents the chart data label anchor.                                                                               |
| Excel.Interfaces.<br>ChartDataLabel<br>AnchorUpdateData   | An interface for updating data on the ChartDataLabelAnchor object, for use in<br>chartDataLabelAnchor.set({  }) .     |
| Excel.Interfaces.                                         | An interface describing the data returned by calling chartDataLabel.toJSON() .                                        |
| ChartDataLabelData                                        |                                                                                                                       |
| Excel.Interfaces.<br>ChartDataLabel<br>FormatData         | An interface describing the data returned by calling<br>chartDataLabelFormat.toJSON() .                               |
| Excel.Interfaces.<br>ChartDataLabel<br>FormatLoadOptions  | Encapsulates the format properties for the chart data labels.                                                         |
| Excel.Interfaces.<br>ChartDataLabel<br>FormatUpdateData   | An interface for updating data on the ChartDataLabelFormat object, for use in<br>chartDataLabelFormat.set({  }) .     |
| Excel.Interfaces.<br>ChartDataLabelLoad<br>Options        | Represents the data label of a chart point.                                                                           |

{23}------------------------------------------------

| Data                                                     |                                                                                                                   |
|----------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartDataLabels<br>LoadOptions      | Represents a collection of all the data labels on a chart point.                                                  |
| Excel.Interfaces.<br>ChartDataLabels<br>UpdateData       | An interface for updating data on the ChartDataLabels object, for use in<br>chartDataLabels.set({  }) .           |
| Excel.Interfaces.<br>ChartDataLabel<br>UpdateData        | An interface for updating data on the ChartDataLabel object, for use in<br>chartDataLabel.set({  }) .             |
| Excel.Interfaces.                                        | An interface describing the data returned by calling chartDataTable.toJSON()                                      |
| ChartDataTableData                                       |                                                                                                                   |
| Excel.Interfaces.<br>ChartDataTable<br>FormatData        | An interface describing the data returned by calling<br>chartDataTableFormat.toJSON() .                           |
| Excel.Interfaces.<br>ChartDataTable<br>FormatLoadOptions | Represents the format of a chart data table.                                                                      |
| Excel.Interfaces.<br>ChartDataTable<br>FormatUpdateData  | An interface for updating data on the ChartDataTableFormat object, for use in<br>chartDataTableFormat.set({  }) . |
| Excel.Interfaces.<br>ChartDataTableLoad<br>Options       | Represents the data table object of a chart.                                                                      |
| Excel.Interfaces.<br>ChartDataTable<br>UpdateData        | An interface for updating data on the ChartDataTable object, for use in<br>chartDataTable.set({  }) .             |
| Excel.Interfaces.                                        | An interface describing the data returned by calling chartErrorBars.toJSON()                                      |
| ChartErrorBarsData                                       |                                                                                                                   |
| Excel.Interfaces.<br>ChartErrorBars<br>FormatData        | An interface describing the data returned by calling<br>chartErrorBarsFormat.toJSON() .                           |
| Excel.Interfaces.<br>ChartErrorBars<br>FormatLoadOptions | Encapsulates the format properties for chart error bars.                                                          |
| Excel.Interfaces.<br>ChartErrorBars<br>FormatUpdateData  | An interface for updating data on the ChartErrorBarsFormat object, for use in<br>chartErrorBarsFormat.set({  }) . |

{24}------------------------------------------------

| Excel.Interfaces.<br>ChartErrorBarsLoad<br>Options       | This object represents the attributes for a chart's error bars.                                                            |
|----------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartErrorBars<br>UpdateData        | An interface for updating data on the ChartErrorBars object, for use in<br>chartErrorBars.set({  }) .                      |
| Excel.Interfaces.<br>ChartFontData                       | An interface describing the data returned by calling chartFont.toJSON() .                                                  |
| Excel.Interfaces.<br>ChartFontLoad<br>Options            | This object represents the font attributes (such as font name, font size, and color)<br>for a chart object.                |
| Excel.Interfaces.<br>ChartFontUpdate<br>Data             | An interface for updating data on the ChartFont object, for use in chartFont.set({<br>}) .                                 |
| Excel.Interfaces.<br>ChartFormatString<br>Data           | An interface describing the data returned by calling chartFormatString.toJSON() .                                          |
| Excel.Interfaces.<br>ChartFormatString<br>LoadOptions    | Represents the substring in chart related objects that contain text, like a<br>ChartTitle object or ChartAxisTitle object. |
| Excel.Interfaces.<br>ChartFormatString<br>UpdateData     | An interface for updating data on the ChartFormatString object, for use in<br>chartFormatString.set({  }) .                |
| Excel.Interfaces.<br>ChartGridlinesData                  | An interface describing the data returned by calling chartGridlines.toJSON() .                                             |
| Excel.Interfaces.<br>ChartGridlines<br>FormatData        | An interface describing the data returned by calling<br>chartGridlinesFormat.toJSON() .                                    |
| Excel.Interfaces.<br>ChartGridlines<br>FormatLoadOptions | Encapsulates the format properties for chart gridlines.                                                                    |
| Excel.Interfaces.<br>ChartGridlines<br>FormatUpdateData  | An interface for updating data on the ChartGridlinesFormat object, for use in<br>chartGridlinesFormat.set({  }) .          |
| Excel.Interfaces.<br>ChartGridlinesLoad<br>Options       | Represents major or minor gridlines on a chart axis.                                                                       |

{25}------------------------------------------------

| Excel.Interfaces.<br>ChartGridlines<br>UpdateData                  | An interface for updating data on the ChartGridlines object, for use in<br>chartGridlines.set({  }) .                           |
|--------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartLeaderLines<br>Data                      | An interface describing the data returned by calling chartLeaderLines.toJSON() .                                                |
| Excel.Interfaces.<br>ChartLeaderLines<br>FormatData                | An interface describing the data returned by calling<br>chartLeaderLinesFormat.toJSON() .                                       |
| Excel.Interfaces.<br>ChartLeaderLines<br>FormatLoadOptions         | Encapsulates the format properties for leader lines.                                                                            |
| Excel.Interfaces.<br>ChartLeaderLines<br>FormatUpdateData          | An interface for updating data on the ChartLeaderLinesFormat object, for use in<br>chartLeaderLinesFormat.set({  }) .           |
| Excel.Interfaces.<br>ChartLeaderLines<br>LoadOptions               | Gets an object that represents the formatting of chart leader lines.                                                            |
| Excel.Interfaces.<br>ChartLeaderLines<br>UpdateData                | An interface for updating data on the ChartLeaderLines object, for use in<br>chartLeaderLines.set({  }) .                       |
| Excel.Interfaces.<br>ChartLegendData                               | An interface describing the data returned by calling chartLegend.toJSON() .                                                     |
| Excel.Interfaces.<br>ChartLegendEntry<br>CollectionData            | An interface describing the data returned by calling<br>chartLegendEntryCollection.toJSON() .                                   |
| Excel.Interfaces.<br>ChartLegendEntry<br>CollectionLoad<br>Options | Represents a collection of legend entries.                                                                                      |
| Excel.Interfaces.<br>ChartLegendEntry<br>CollectionUpdate<br>Data  | An interface for updating data on the ChartLegendEntryCollection object, for use<br>in chartLegendEntryCollection.set({<br>}) . |
| Excel.Interfaces.<br>ChartLegendEntry<br>Data                      | An interface describing the data returned by calling chartLegendEntry.toJSON() .                                                |
| Excel.Interfaces.<br>ChartLegendEntry                              | Represents the legend entry in legendEntryCollection .                                                                          |

{26}------------------------------------------------

| LoadOptions                                           |                                                                                                             |
|-------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartLegendEntry<br>UpdateData   | An interface for updating data on the ChartLegendEntry object, for use in<br>chartLegendEntry.set({  }) .   |
| Excel.Interfaces.<br>ChartLegendFormat<br>Data        | An interface describing the data returned by calling chartLegendFormat.toJSON()                             |
| Excel.Interfaces.<br>ChartLegendFormat<br>LoadOptions | Encapsulates the format properties of a chart legend.                                                       |
| Excel.Interfaces.<br>ChartLegendFormat<br>UpdateData  | An interface for updating data on the ChartLegendFormat object, for use in<br>chartLegendFormat.set({  }) . |
| Excel.Interfaces.<br>ChartLegendLoad<br>Options       | Represents the legend in a chart.                                                                           |
| Excel.Interfaces.<br>ChartLegendUpdate<br>Data        | An interface for updating data on the ChartLegend object, for use in<br>chartLegend.set({  }) .             |
| Excel.Interfaces.<br>ChartLineFormat<br>Data          | An interface describing the data returned by calling chartLineFormat.toJSON()                               |
| Excel.Interfaces.<br>ChartLineFormat<br>LoadOptions   | Encapsulates the formatting options for line elements.                                                      |
| Excel.Interfaces.<br>ChartLineFormat<br>UpdateData    | An interface for updating data on the ChartLineFormat object, for use in<br>chartLineFormat.set({  }) .     |
| Excel.Interfaces.                                     | Represents a chart object in a workbook. To learn more about the chart object                               |
| ChartLoadOptions                                      | model, see Work with charts using the Excel JavaScript API.                                                 |
| Excel.Interfaces.<br>ChartMapOptions<br>Data          | An interface describing the data returned by calling chartMapOptions.toJSON()                               |
| Excel.Interfaces.<br>ChartMapOptions<br>LoadOptions   | Encapsulates the properties for a region map chart.                                                         |
| Excel.Interfaces.<br>ChartMapOptions<br>UpdateData    | An interface for updating data on the ChartMapOptions object, for use in<br>chartMapOptions.set({  }) .     |

{27}------------------------------------------------

| Excel.Interfaces.<br>ChartPivotOptions<br>Data          | An interface describing the data returned by calling chartPivotOptions.toJSON() .                               |
|---------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartPivotOptions<br>LoadOptions   | Encapsulates the options for the pivot chart.                                                                   |
| Excel.Interfaces.<br>ChartPivotOptions<br>UpdateData    | An interface for updating data on the ChartPivotOptions object, for use in<br>chartPivotOptions.set({  }) .     |
| Excel.Interfaces.<br>ChartPlotAreaData                  | An interface describing the data returned by calling chartPlotArea.toJSON() .                                   |
| Excel.Interfaces.<br>ChartPlotArea<br>FormatData        | An interface describing the data returned by calling<br>chartPlotAreaFormat.toJSON() .                          |
| Excel.Interfaces.<br>ChartPlotArea<br>FormatLoadOptions | Represents the format properties for a chart plot area.                                                         |
| Excel.Interfaces.<br>ChartPlotArea<br>FormatUpdateData  | An interface for updating data on the ChartPlotAreaFormat object, for use in<br>chartPlotAreaFormat.set({  }) . |
| Excel.Interfaces.<br>ChartPlotAreaLoad<br>Options       | This object represents the attributes for a chart plot area.                                                    |
| Excel.Interfaces.<br>ChartPlotArea<br>UpdateData        | An interface for updating data on the ChartPlotArea object, for use in<br>chartPlotArea.set({  }) .             |
| Excel.Interfaces.<br>ChartPointData                     | An interface describing the data returned by calling chartPoint.toJSON() .                                      |
| Excel.Interfaces.<br>ChartPointFormat<br>Data           | An interface describing the data returned by calling chartPointFormat.toJSON() .                                |
| Excel.Interfaces.<br>ChartPointFormat<br>LoadOptions    | Represents the formatting object for chart points.                                                              |
| Excel.Interfaces.<br>ChartPointFormat<br>UpdateData     | An interface for updating data on the ChartPointFormat object, for use in<br>chartPointFormat.set({  }) .       |
| Excel.Interfaces.<br>ChartPointLoad                     | Represents a point of a series in a chart.                                                                      |

{28}------------------------------------------------

| Options                                                       |                                                                                                                     |
|---------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartPoints<br>CollectionData            | An interface describing the data returned by calling<br>chartPointsCollection.toJSON() .                            |
| Excel.Interfaces.<br>ChartPoints<br>CollectionLoad<br>Options | A collection of all the chart points within a series inside a chart.                                                |
| Excel.Interfaces.<br>ChartPoints<br>CollectionUpdate<br>Data  | An interface for updating data on the ChartPointsCollection object, for use in<br>chartPointsCollection.set({  }) . |
| Excel.Interfaces.<br>ChartPointUpdate<br>Data                 | An interface for updating data on the ChartPoint object, for use in<br>chartPoint.set({  }) .                       |
| Excel.Interfaces.<br>ChartSeries<br>CollectionData            | An interface describing the data returned by calling<br>chartSeriesCollection.toJSON() .                            |
| Excel.Interfaces.<br>ChartSeries<br>CollectionLoad<br>Options | Represents a collection of chart series.                                                                            |
| Excel.Interfaces.<br>ChartSeries<br>CollectionUpdate<br>Data  | An interface for updating data on the ChartSeriesCollection object, for use in<br>chartSeriesCollection.set({  }) . |
| Excel.Interfaces.                                             | An interface describing the data returned by calling chartSeries.toJSON()                                           |
| ChartSeriesData                                               |                                                                                                                     |
| Excel.Interfaces.<br>ChartSeriesFormat<br>Data                | An interface describing the data returned by calling chartSeriesFormat.toJSON()                                     |
| Excel.Interfaces.<br>ChartSeriesFormat<br>LoadOptions         | Encapsulates the format properties for the chart series                                                             |
| Excel.Interfaces.<br>ChartSeriesFormat<br>UpdateData          | An interface for updating data on the ChartSeriesFormat object, for use in<br>chartSeriesFormat.set({  }) .         |
| Excel.Interfaces.<br>ChartSeriesLoad                          | Represents a series in a chart.                                                                                     |

{29}------------------------------------------------

| Options                                                          |                                                                                                                           |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartSeriesUpdate<br>Data                   | An interface for updating data on the ChartSeries object, for use in<br>chartSeries.set({  }) .                           |
| Excel.Interfaces.                                                | An interface describing the data returned by calling chartTitle.toJSON()                                                  |
| ChartTitleData                                                   |                                                                                                                           |
| Excel.Interfaces.<br>ChartTitleFormat<br>Data                    | An interface describing the data returned by calling chartTitleFormat.toJSON()                                            |
| Excel.Interfaces.<br>ChartTitleFormat<br>LoadOptions             | Provides access to the formatting options for a chart title.                                                              |
| Excel.Interfaces.<br>ChartTitleFormat<br>UpdateData              | An interface for updating data on the ChartTitleFormat object, for use in<br>chartTitleFormat.set({  }) .                 |
| Excel.Interfaces.<br>ChartTitleLoad<br>Options                   | Represents a chart title object of a chart.                                                                               |
| Excel.Interfaces.<br>ChartTitleUpdate<br>Data                    | An interface for updating data on the ChartTitle object, for use in<br>chartTitle.set({  }) .                             |
| Excel.Interfaces.<br>ChartTrendline<br>CollectionData            | An interface describing the data returned by calling<br>chartTrendlineCollection.toJSON() .                               |
| Excel.Interfaces.<br>ChartTrendline<br>CollectionLoad<br>Options | Represents a collection of chart trendlines.                                                                              |
| Excel.Interfaces.<br>ChartTrendline<br>CollectionUpdate<br>Data  | An interface for updating data on the ChartTrendlineCollection object, for use in<br>chartTrendlineCollection.set({  }) . |
| Excel.Interfaces.                                                | An interface describing the data returned by calling chartTrendline.toJSON()                                              |
| ChartTrendlineData                                               |                                                                                                                           |
| Excel.Interfaces.<br>ChartTrendline<br>FormatData                | An interface describing the data returned by calling<br>chartTrendlineFormat.toJSON() .                                   |
| Excel.Interfaces.<br>ChartTrendline                              | Represents the format properties for the chart trendline.                                                                 |

{30}------------------------------------------------

| FormatLoadOptions                                             |                                                                                                                             |
|---------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ChartTrendline<br>FormatUpdateData       | An interface for updating data on the ChartTrendlineFormat object, for use in<br>chartTrendlineFormat.set({  }) .           |
| Excel.Interfaces.<br>ChartTrendlineLabel<br>Data              | An interface describing the data returned by calling<br>chartTrendlineLabel.toJSON() .                                      |
| Excel.Interfaces.<br>ChartTrendlineLabel<br>FormatData        | An interface describing the data returned by calling<br>chartTrendlineLabelFormat.toJSON() .                                |
| Excel.Interfaces.<br>ChartTrendlineLabel<br>FormatLoadOptions | Encapsulates the format properties for the chart trendline label.                                                           |
| Excel.Interfaces.<br>ChartTrendlineLabel<br>FormatUpdateData  | An interface for updating data on the ChartTrendlineLabelFormat object, for use in<br>chartTrendlineLabelFormat.set({  }) . |
| Excel.Interfaces.<br>ChartTrendlineLabel<br>LoadOptions       | This object represents the attributes for a chart trendline label object.                                                   |
| Excel.Interfaces.<br>ChartTrendlineLabel<br>UpdateData        | An interface for updating data on the ChartTrendlineLabel object, for use in<br>chartTrendlineLabel.set({  }) .             |
| Excel.Interfaces.<br>ChartTrendlineLoad<br>Options            | This object represents the attributes for a chart trendline object.                                                         |
| Excel.Interfaces.<br>ChartTrendline<br>UpdateData             | An interface for updating data on the ChartTrendline object, for use in<br>chartTrendline.set({  }) .                       |
| Excel.Interfaces.                                             | An interface for updating data on the Chart object, for use in chart.set({                                                  |
| ChartUpdateData                                               | }) .                                                                                                                        |
| Excel.Interfaces.<br>CollectionLoad<br>Options                | Provides ways to load properties of only a subset of members of a collection.                                               |
| Excel.Interfaces.<br>ColorScale<br>ConditionalFormat<br>Data  | An interface describing the data returned by calling<br>colorScaleConditionalFormat.toJSON() .                              |
| Excel.Interfaces.<br>ColorScale                               | Represents the color scale criteria for conditional formatting.                                                             |

{31}------------------------------------------------

| ConditionalFormat<br>LoadOptions                                   |                                                                                                                                   |
|--------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ColorScale<br>ConditionalFormat<br>UpdateData | An interface for updating data on the ColorScaleConditionalFormat object, for use<br>in colorScaleConditionalFormat.set({<br>}) . |
| Excel.Interfaces.<br>CommentCollection<br>Data                     | An interface describing the data returned by calling commentCollection.toJSON()                                                   |
| Excel.Interfaces.<br>CommentCollection<br>LoadOptions              | Represents a collection of comment objects that are part of the workbook.                                                         |
| Excel.Interfaces.<br>CommentCollection<br>UpdateData               | An interface for updating data on the CommentCollection object, for use in<br>commentCollection.set({  }) .                       |
| Excel.Interfaces.                                                  | An interface describing the data returned by calling comment.toJSON()                                                             |
| CommentData                                                        |                                                                                                                                   |
| Excel.Interfaces.<br>CommentLoad<br>Options                        | Represents a comment in the workbook.                                                                                             |
| Excel.Interfaces.<br>CommentReply<br>CollectionData                | An interface describing the data returned by calling<br>commentReplyCollection.toJSON() .                                         |
| Excel.Interfaces.<br>CommentReply<br>CollectionLoad<br>Options     | Represents a collection of comment reply objects that are part of the comment.                                                    |
| Excel.Interfaces.<br>CommentReply<br>CollectionUpdate<br>Data      | An interface for updating data on the CommentReplyCollection object, for use in<br>commentReplyCollection.set({  }) .             |
| Excel.Interfaces.                                                  | An interface describing the data returned by calling commentReply.toJSON()                                                        |
| CommentReplyData                                                   |                                                                                                                                   |
| Excel.Interfaces.<br>CommentReplyLoad<br>Options                   | Represents a comment reply in the workbook.                                                                                       |
| Excel.Interfaces.<br>CommentReply<br>UpdateData                    | An interface for updating data on the CommentReply object, for use in<br>commentReply.set({  }) .                                 |

{32}------------------------------------------------

| Excel.Interfaces.<br>CommentUpdate<br>Data                               | An interface for updating data on the Comment object, for use in comment.set({<br>}) .                                                      |
|--------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ConditionalDataBar<br>NegativeFormat<br>Data        | An interface describing the data returned by calling<br>conditionalDataBarNegativeFormat.toJSON() .                                         |
| Excel.Interfaces.<br>ConditionalDataBar<br>NegativeFormat<br>LoadOptions | Represents a conditional format for the negative side of the data bar.                                                                      |
| Excel.Interfaces.<br>ConditionalDataBar<br>NegativeFormat<br>UpdateData  | An interface for updating data on the ConditionalDataBarNegativeFormat object,<br>for use in conditionalDataBarNegativeFormat.set({<br>}) . |
| Excel.Interfaces.<br>ConditionalDataBar<br>PositiveFormatData            | An interface describing the data returned by calling<br>conditionalDataBarPositiveFormat.toJSON() .                                         |
| Excel.Interfaces.<br>ConditionalDataBar<br>PositiveFormatLoad<br>Options | Represents a conditional format for the positive side of the data bar.                                                                      |
| Excel.Interfaces.<br>ConditionalDataBar<br>PositiveFormat<br>UpdateData  | An interface for updating data on the ConditionalDataBarPositiveFormat object,<br>for use in conditionalDataBarPositiveFormat.set({<br>}) . |
| Excel.Interfaces.<br>ConditionalFormat<br>CollectionData                 | An interface describing the data returned by calling<br>conditionalFormatCollection.toJSON() .                                              |
| Excel.Interfaces.<br>ConditionalFormat<br>CollectionLoad<br>Options      | Represents a collection of all the conditional formats that are overlap the range.                                                          |
| Excel.Interfaces.<br>ConditionalFormat<br>CollectionUpdate<br>Data       | An interface for updating data on the ConditionalFormatCollection object, for use<br>in conditionalFormatCollection.set({<br>}) .           |
| Excel.Interfaces.<br>ConditionalFormat<br>Data                           | An interface describing the data returned by calling conditionalFormat.toJSON() .                                                           |

{33}------------------------------------------------

| Excel.Interfaces.                                                        | An object encapsulating a conditional format's range, format, rule, and other                                                               |
|--------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|
| ConditionalFormat                                                        | properties. To learn more about the conditional formatting object model, read                                                               |
| LoadOptions                                                              | Apply conditional formatting to Excel ranges.                                                                                               |
| Excel.Interfaces.<br>ConditionalFormat<br>RuleData                       | An interface describing the data returned by calling<br>conditionalFormatRule.toJSON() .                                                    |
| Excel.Interfaces.<br>ConditionalFormat<br>RuleLoadOptions                | Represents a rule, for all traditional rule/format pairings.                                                                                |
| Excel.Interfaces.<br>ConditionalFormat<br>RuleUpdateData                 | An interface for updating data on the ConditionalFormatRule object, for use in<br>conditionalFormatRule.set({  }) .                         |
| Excel.Interfaces.<br>ConditionalFormat<br>UpdateData                     | An interface for updating data on the ConditionalFormat object, for use in<br>conditionalFormat.set({  }) .                                 |
| Excel.Interfaces.<br>ConditionalRange<br>BorderCollection<br>Data        | An interface describing the data returned by calling<br>conditionalRangeBorderCollection.toJSON() .                                         |
| Excel.Interfaces.<br>ConditionalRange<br>BorderCollection<br>LoadOptions | Represents the border objects that make up range border.                                                                                    |
| Excel.Interfaces.<br>ConditionalRange<br>BorderCollection<br>UpdateData  | An interface for updating data on the ConditionalRangeBorderCollection object,<br>for use in conditionalRangeBorderCollection.set({<br>}) . |
| Excel.Interfaces.<br>ConditionalRange<br>BorderData                      | An interface describing the data returned by calling<br>conditionalRangeBorder.toJSON() .                                                   |
| Excel.Interfaces.<br>ConditionalRange<br>BorderLoadOptions               | Represents the border of an object.                                                                                                         |
| Excel.Interfaces.<br>ConditionalRange<br>BorderUpdateData                | An interface for updating data on the ConditionalRangeBorder object, for use in<br>conditionalRangeBorder.set({  }) .                       |
| Excel.Interfaces.<br>ConditionalRangeFill<br>Data                        | An interface describing the data returned by calling<br>conditionalRangeFill.toJSON() .                                                     |

{34}------------------------------------------------

| Excel.Interfaces.<br>ConditionalRangeFill<br>LoadOptions    | Represents the background of a conditional range object.                                                                                                       |
|-------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ConditionalRangeFill<br>UpdateData     | An interface for updating data on the ConditionalRangeFill object, for use in<br>conditionalRangeFill.set({  }) .                                              |
| Excel.Interfaces.<br>ConditionalRange<br>FontData           | An interface describing the data returned by calling<br>conditionalRangeFont.toJSON() .                                                                        |
| Excel.Interfaces.<br>ConditionalRange<br>FontLoadOptions    | This object represents the font attributes (font style, color, etc.) for an object.                                                                            |
| Excel.Interfaces.<br>ConditionalRange<br>FontUpdateData     | An interface for updating data on the ConditionalRangeFont object, for use in<br>conditionalRangeFont.set({  }) .                                              |
| Excel.Interfaces.<br>ConditionalRange<br>FormatData         | An interface describing the data returned by calling<br>conditionalRangeFormat.toJSON() .                                                                      |
| Excel.Interfaces.<br>ConditionalRange<br>FormatLoadOptions  | A format object encapsulating the conditional formats range's font, fill, borders,<br>and other properties.                                                    |
| Excel.Interfaces.<br>ConditionalRange<br>FormatUpdateData   | An interface for updating data on the ConditionalRangeFormat object, for use in<br>conditionalRangeFormat.set({  }) .                                          |
| Excel.Interfaces.<br>CultureInfoData                        | An interface describing the data returned by calling cultureInfo.toJSON() .                                                                                    |
| Excel.Interfaces.<br>CultureInfoLoad<br>Options             | Provides information based on current system culture settings. This includes the<br>culture names, number formatting, and other culturally dependent settings. |
| Excel.Interfaces.<br>CustomConditional<br>FormatData        | An interface describing the data returned by calling<br>customConditionalFormat.toJSON() .                                                                     |
| Excel.Interfaces.<br>CustomConditional<br>FormatLoadOptions | Represents a custom conditional format type.                                                                                                                   |
| Excel.Interfaces.<br>CustomConditional<br>FormatUpdateData  | An interface for updating data on the CustomConditionalFormat object, for use in<br>customConditionalFormat.set({  }) .                                        |

{35}------------------------------------------------

| Excel.Interfaces.<br>CustomFunction<br>ManagerData               | An interface describing the data returned by calling<br>customFunctionManager.toJSON() .                                  |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>CustomProperty<br>CollectionData            | An interface describing the data returned by calling<br>customPropertyCollection.toJSON() .                               |
| Excel.Interfaces.<br>CustomProperty<br>CollectionLoad<br>Options | Contains the collection of custom properties.                                                                             |
| Excel.Interfaces.<br>CustomProperty<br>CollectionUpdate<br>Data  | An interface for updating data on the CustomPropertyCollection object, for use in<br>customPropertyCollection.set({  }) . |
| Excel.Interfaces.<br>CustomProperty<br>Data                      | An interface describing the data returned by calling customProperty.toJSON() .                                            |
| Excel.Interfaces.<br>CustomProperty<br>LoadOptions               | Represents a custom property.                                                                                             |
| Excel.Interfaces.<br>CustomProperty<br>UpdateData                | An interface for updating data on the CustomProperty object, for use in<br>customProperty.set({  }) .                     |
| Excel.Interfaces.<br>CustomXmlPart<br>CollectionData             | An interface describing the data returned by calling<br>customXmlPartCollection.toJSON() .                                |
| Excel.Interfaces.<br>CustomXmlPart<br>CollectionLoad<br>Options  | A collection of custom XML parts.                                                                                         |
| Excel.Interfaces.<br>CustomXmlPart<br>CollectionUpdate<br>Data   | An interface for updating data on the CustomXmlPartCollection object, for use in<br>customXmlPartCollection.set({  }) .   |
| Excel.Interfaces.<br>CustomXmlPartData                           | An interface describing the data returned by calling customXmlPart.toJSON() .                                             |
| Excel.Interfaces.<br>CustomXmlPartLoad<br>Options                | Represents a custom XML part object in a workbook.                                                                        |

{36}------------------------------------------------

| Excel.Interfaces.<br>CustomXmlPart<br>ScopedCollection<br>Data        | An interface describing the data returned by calling<br>customXmlPartScopedCollection.toJSON() .                                                                                     |
|-----------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>CustomXmlPart<br>ScopedCollection<br>LoadOptions | A scoped collection of custom XML parts. A scoped collection is the result of some<br>operation (e.g., filtering by namespace). A scoped collection cannot be scoped any<br>further. |
| Excel.Interfaces.<br>CustomXmlPart<br>ScopedCollection<br>UpdateData  | An interface for updating data on the CustomXmlPartScopedCollection object, for<br>use in customXmlPartScopedCollection.set({<br>}) .                                                |
| Excel.Interfaces.Data<br>BarConditional<br>FormatData                 | An interface describing the data returned by calling<br>dataBarConditionalFormat.toJSON() .                                                                                          |
| Excel.Interfaces.Data<br>BarConditional<br>FormatLoadOptions          | Represents an Excel conditional data bar type.                                                                                                                                       |
| Excel.Interfaces.Data<br>BarConditional<br>FormatUpdateData           | An interface for updating data on the DataBarConditionalFormat object, for use in<br>dataBarConditionalFormat.set({  }) .                                                            |
| Excel.Interfaces.Data<br>PivotHierarchy<br>CollectionData             | An interface describing the data returned by calling<br>dataPivotHierarchyCollection.toJSON() .                                                                                      |
| Excel.Interfaces.Data<br>PivotHierarchy<br>CollectionLoad<br>Options  | Represents a collection of DataPivotHierarchy items associated with the PivotTable.                                                                                                  |
| Excel.Interfaces.Data<br>PivotHierarchy<br>CollectionUpdate<br>Data   | An interface for updating data on the DataPivotHierarchyCollection object, for<br>use in dataPivotHierarchyCollection.set({<br>}) .                                                  |
| Excel.Interfaces.Data<br>PivotHierarchyData                           | An interface describing the data returned by calling dataPivotHierarchy.toJSON() .                                                                                                   |
| Excel.Interfaces.Data<br>PivotHierarchyLoad<br>Options                | Represents the Excel DataPivotHierarchy.                                                                                                                                             |
| Excel.Interfaces.Data<br>PivotHierarchy<br>UpdateData                 | An interface for updating data on the DataPivotHierarchy object, for use in<br>dataPivotHierarchy.set({  }) .                                                                        |

{37}------------------------------------------------

| Excel.Interfaces.Data<br>ValidationData                              | An interface describing the data returned by calling dataValidation.toJSON() .                                                                                  |
|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.Data<br>ValidationLoad<br>Options                   | Represents the data validation applied to the current range. To learn more about<br>the data validation object model, read Add data validation to Excel ranges. |
| Excel.Interfaces.Data<br>ValidationUpdate<br>Data                    | An interface for updating data on the DataValidation object, for use in<br>dataValidation.set({  }) .                                                           |
| Excel.Interfaces.<br>DatetimeFormatInfo<br>Data                      | An interface describing the data returned by calling datetimeFormatInfo.toJSON() .                                                                              |
| Excel.Interfaces.<br>DatetimeFormatInfo<br>LoadOptions               | Defines the culturally appropriate format of displaying numbers. This is based on<br>current system culture settings.                                           |
| Excel.Interfaces.<br>DocumentProperties<br>Data                      | An interface describing the data returned by calling documentProperties.toJSON() .                                                                              |
| Excel.Interfaces.<br>DocumentProperties<br>LoadOptions               | Represents workbook properties.                                                                                                                                 |
| Excel.Interfaces.<br>DocumentProperties<br>UpdateData                | An interface for updating data on the DocumentProperties object, for use in<br>documentProperties.set({  }) .                                                   |
| Excel.Interfaces.<br>DocumentTask<br>ChangeCollection<br>Data        | An interface describing the data returned by calling<br>documentTaskChangeCollection.toJSON() .                                                                 |
| Excel.Interfaces.<br>DocumentTask<br>ChangeCollection<br>LoadOptions | Represents a collection of change records for a task.                                                                                                           |
| Excel.Interfaces.<br>DocumentTask<br>ChangeCollection<br>UpdateData  | An interface for updating data on the DocumentTaskChangeCollection object, for<br>use in documentTaskChangeCollection.set({<br>}) .                             |
| Excel.Interfaces.<br>DocumentTask<br>ChangeData                      | An interface describing the data returned by calling documentTaskChange.toJSON() .                                                                              |

{38}------------------------------------------------

| Excel.Interfaces.<br>DocumentTask<br>ChangeLoadOptions                 | Represents a recorded change to the task.                                                                                               |
|------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>DocumentTask<br>CollectionData                    | An interface describing the data returned by calling<br>documentTaskCollection.toJSON() .                                               |
| Excel.Interfaces.<br>DocumentTask<br>CollectionLoad<br>Options         | Represents a collection of tasks.                                                                                                       |
| Excel.Interfaces.<br>DocumentTask<br>CollectionUpdate<br>Data          | An interface for updating data on the DocumentTaskCollection object, for use in<br>documentTaskCollection.set({  }) .                   |
| Excel.Interfaces.<br>DocumentTaskData                                  | An interface describing the data returned by calling documentTask.toJSON() .                                                            |
| Excel.Interfaces.<br>DocumentTaskLoad<br>Options                       | Represents a task.                                                                                                                      |
| Excel.Interfaces.<br>DocumentTask<br>UpdateData                        | An interface for updating data on the DocumentTask object, for use in<br>documentTask.set({  }) .                                       |
| Excel.Interfaces.Filter<br>Data                                        | An interface describing the data returned by calling filter.toJSON() .                                                                  |
| Excel.Interfaces.Filter<br>LoadOptions                                 | Manages the filtering of a table's column.                                                                                              |
| Excel.Interfaces.Filter<br>PivotHierarchy<br>CollectionData            | An interface describing the data returned by calling<br>filterPivotHierarchyCollection.toJSON() .                                       |
| Excel.Interfaces.Filter<br>PivotHierarchy<br>CollectionLoad<br>Options | Represents a collection of FilterPivotHierarchy items associated with the<br>PivotTable.                                                |
| Excel.Interfaces.Filter<br>PivotHierarchy<br>CollectionUpdate<br>Data  | An interface for updating data on the FilterPivotHierarchyCollection object, for<br>use in filterPivotHierarchyCollection.set({<br>}) . |
| Excel.Interfaces.Filter                                                | An interface describing the data returned by calling                                                                                    |
| PivotHierarchyData                                                     | filterPivotHierarchy.toJSON() .                                                                                                         |

{39}------------------------------------------------

| Excel.Interfaces.Filter<br>PivotHierarchyLoad<br>Options     | Represents the Excel FilterPivotHierarchy.                                                                        |
|--------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.Filter<br>PivotHierarchy<br>UpdateData      | An interface for updating data on the FilterPivotHierarchy object, for use in<br>filterPivotHierarchy.set({  }) . |
| Excel.Interfaces.<br>FormatProtection<br>Data                | An interface describing the data returned by calling formatProtection.toJSON() .                                  |
| Excel.Interfaces.<br>FormatProtection<br>LoadOptions         | Represents the format protection of a range object.                                                               |
| Excel.Interfaces.<br>FormatProtection<br>UpdateData          | An interface for updating data on the FormatProtection object, for use in<br>formatProtection.set({  }) .         |
| Excel.Interfaces.<br>FunctionResultData                      | An interface describing the data returned by calling functionResult.toJSON() .                                    |
| Excel.Interfaces.<br>FunctionResultLoad<br>Options           | An object containing the result of a function-evaluation operation                                                |
| Excel.Interfaces.<br>GeometricShape<br>Data                  | An interface describing the data returned by calling geometricShape.toJSON() .                                    |
| Excel.Interfaces.                                            | Represents a geometric shape inside a worksheet. A geometric shape can be a                                       |
| GeometricShape                                               | rectangle, block arrow, equation symbol, flowchart item, star, banner, callout, or                                |
| LoadOptions                                                  | any other basic shape in Excel.                                                                                   |
| Excel.Interfaces.<br>GroupShape<br>CollectionData            | An interface describing the data returned by calling<br>groupShapeCollection.toJSON() .                           |
| Excel.Interfaces.<br>GroupShape<br>CollectionLoad<br>Options | Represents the shape collection inside a shape group.                                                             |
| Excel.Interfaces.<br>GroupShape<br>CollectionUpdate<br>Data  | An interface for updating data on the GroupShapeCollection object, for use in<br>groupShapeCollection.set({  }) . |
| Excel.Interfaces.<br>HeaderFooterData                        | An interface describing the data returned by calling headerFooter.toJSON() .                                      |

{40}------------------------------------------------

| Excel.Interfaces.<br>HeaderFooterGroup<br>Data               | An interface describing the data returned by calling headerFooterGroup.toJSON() .                                         |  |  |  |
|--------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|--|--|--|
| Excel.Interfaces.HeaderFooterGroupLoadOptions                |                                                                                                                           |  |  |  |
| Excel.Interfaces.<br>HeaderFooterGroup<br>UpdateData         | An interface for updating data on the HeaderFooterGroup object, for use in<br>headerFooterGroup.set({  }) .               |  |  |  |
| Excel.Interfaces.HeaderFooterLoadOptions                     |                                                                                                                           |  |  |  |
| Excel.Interfaces.<br>HeaderFooter<br>UpdateData              | An interface for updating data on the HeaderFooter object, for use in<br>headerFooter.set({  }) .                         |  |  |  |
| Excel.Interfaces.Icon<br>SetConditional<br>FormatData        | An interface describing the data returned by calling<br>iconSetConditionalFormat.toJSON() .                               |  |  |  |
| Excel.Interfaces.Icon<br>SetConditional<br>FormatLoadOptions | Represents an icon set criteria for conditional formatting.                                                               |  |  |  |
| Excel.Interfaces.Icon<br>SetConditional<br>FormatUpdateData  | An interface for updating data on the IconSetConditionalFormat object, for use in<br>iconSetConditionalFormat.set({  }) . |  |  |  |
| Excel.Interfaces.<br>ImageData                               | An interface describing the data returned by calling image.toJSON() .                                                     |  |  |  |
| Excel.Interfaces.                                            | Represents an image in the worksheet. To get the corresponding Shape object, use                                          |  |  |  |
| ImageLoadOptions                                             | Image.shape .                                                                                                             |  |  |  |
| Excel.Interfaces.<br>IterativeCalculation<br>Data            | An interface describing the data returned by calling<br>iterativeCalculation.toJSON() .                                   |  |  |  |
| Excel.Interfaces.<br>IterativeCalculation<br>LoadOptions     | Represents the iterative calculation settings.                                                                            |  |  |  |
| Excel.Interfaces.<br>IterativeCalculation<br>UpdateData      | An interface for updating data on the IterativeCalculation object, for use in<br>iterativeCalculation.set({  }) .         |  |  |  |
| Excel.Interfaces.Line                                        | An interface describing the data returned by calling line.toJSON()                                                        |  |  |  |
| Data                                                         |                                                                                                                           |  |  |  |
| Excel.Interfaces.Line                                        | Represents a line inside a worksheet. To get the corresponding Shape object, use                                          |  |  |  |
| LoadOptions                                                  | Line.shape .                                                                                                              |  |  |  |

{41}------------------------------------------------

| Excel.Interfaces.Line<br>UpdateData                                     | An interface for updating data on the Line object, for use in line.set({  }) .                                                                                                                                                                                                                                                                                                                                  |
|-------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>LinkedDataType<br>CollectionData                   | An interface describing the data returned by calling<br>linkedDataTypeCollection.toJSON() .                                                                                                                                                                                                                                                                                                                     |
| Excel.Interfaces.<br>LinkedDataType<br>CollectionLoad<br>Options        | Represents a collection of linked data types.                                                                                                                                                                                                                                                                                                                                                                   |
| Excel.Interfaces.<br>LinkedDataType<br>CollectionUpdate<br>Data         | An interface for updating data on the LinkedDataTypeCollection object, for use in<br>linkedDataTypeCollection.set({  }) .                                                                                                                                                                                                                                                                                       |
| Excel.Interfaces.<br>LinkedDataTypeData                                 | An interface describing the data returned by calling linkedDataType.toJSON() .                                                                                                                                                                                                                                                                                                                                  |
| Excel.Interfaces.<br>LinkedDataType<br>LoadOptions                      | Represents a linked data type. A linked data type is a data type connected to an<br>online data source.                                                                                                                                                                                                                                                                                                         |
| Excel.Interfaces.<br>LinkedEntityData<br>DomainCollection<br>Data       | An interface describing the data returned by calling<br>linkedEntityDataDomainCollection.toJSON() .                                                                                                                                                                                                                                                                                                             |
| Excel.Interfaces.                                                       | Represents a collection of LinkedEntityDataDomain objects. The collection can                                                                                                                                                                                                                                                                                                                                   |
| LinkedEntityData                                                        | contain linked entity data domains such as stocks, geography, or currencies                                                                                                                                                                                                                                                                                                                                     |
| DomainCollection                                                        | defined by service data providers, such as Bing or Power BI, or linked entity data                                                                                                                                                                                                                                                                                                                              |
| LoadOptions                                                             | domains defined by Office Add-ins.                                                                                                                                                                                                                                                                                                                                                                              |
| Excel.Interfaces.<br>LinkedEntityData<br>DomainCollection<br>UpdateData | An interface for updating data on the LinkedEntityDataDomainCollection object,<br>for use in linkedEntityDataDomainCollection.set({<br>}) .                                                                                                                                                                                                                                                                     |
| Excel.Interfaces.<br>LinkedEntityData<br>DomainData                     | An interface describing the data returned by calling<br>linkedEntityDataDomain.toJSON() .                                                                                                                                                                                                                                                                                                                       |
| Excel.Interfaces.<br>LinkedEntityData<br>DomainLoad<br>Options          | Represents a specific category or field of information that shares some common<br>characteristics or attributes. A data domain is linked to a data provider, that acts as<br>the data source for LinkedEntityCellValue objects in the workbook. A data<br>domain is a category of data, such as stocks, geography, or currencies. A data<br>provider is a service, such as Bing, Power BI, or an Office Add-in. |
| Excel.Interfaces.                                                       | An interface for updating data on the LinkedEntityDataDomain object, for use in                                                                                                                                                                                                                                                                                                                                 |
| LinkedEntityData                                                        | linkedEntityDataDomain.set({  }) .                                                                                                                                                                                                                                                                                                                                                                              |

{42}------------------------------------------------

| DomainUpdateData                                                 |                                                                                                                           |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>LinkedWorkbook<br>CollectionData            | An interface describing the data returned by calling<br>linkedWorkbookCollection.toJSON() .                               |
| Excel.Interfaces.<br>LinkedWorkbook<br>CollectionLoad<br>Options | Represents a collection of linked workbook objects.                                                                       |
| Excel.Interfaces.<br>LinkedWorkbook<br>CollectionUpdate<br>Data  | An interface for updating data on the LinkedWorkbookCollection object, for use in<br>linkedWorkbookCollection.set({  }) . |
| Excel.Interfaces.<br>LinkedWorkbook<br>Data                      | An interface describing the data returned by calling linkedWorkbook.toJSON()                                              |
| Excel.Interfaces.                                                | Contains information about a linked workbook. If a workbook has links pointing to                                         |
| LinkedWorkbook                                                   | data in another workbook, the second workbook is linked to the first workbook. In                                         |
| LoadOptions                                                      | this scenario, the second workbook is called the "linked workbook".                                                       |
| Excel.Interfaces.<br>NamedItemArray<br>ValuesData                | An interface describing the data returned by calling<br>namedItemArrayValues.toJSON() .                                   |
| Excel.Interfaces.<br>NamedItemArray<br>ValuesLoadOptions         | Represents an object containing values and types of a named item.                                                         |
| Excel.Interfaces.<br>NamedItem<br>CollectionData                 | An interface describing the data returned by calling<br>namedItemCollection.toJSON() .                                    |
| Excel.Interfaces.<br>NamedItem<br>CollectionLoad<br>Options      | A collection of all the NamedItem objects that are part of the workbook or<br>worksheet, depending on how it was reached. |
| Excel.Interfaces.<br>NamedItem<br>CollectionUpdate<br>Data       | An interface for updating data on the NamedItemCollection object, for use in<br>namedItemCollection.set({  }) .           |
| Excel.Interfaces.                                                | An interface describing the data returned by calling namedItem.toJSON()                                                   |
| NamedItemData                                                    |                                                                                                                           |
| Excel.Interfaces.                                                | Represents a defined name for a range of cells or value. Names can be primitive                                           |
| NamedItemLoad                                                    | named objects (as seen in the type below), range object, or a reference to a range.                                       |

{43}------------------------------------------------

| Options                                                          | This object can be used to obtain range object associated with names.                                                     |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>NamedItemUpdate<br>Data                     | An interface for updating data on the NamedItem object, for use in namedItem.set({<br>}) .                                |
| Excel.Interfaces.<br>NamedSheetView<br>CollectionData            | An interface describing the data returned by calling<br>namedSheetViewCollection.toJSON() .                               |
| Excel.Interfaces.<br>NamedSheetView<br>CollectionLoad<br>Options | Represents the collection of sheet views in the worksheet.                                                                |
| Excel.Interfaces.<br>NamedSheetView<br>CollectionUpdate<br>Data  | An interface for updating data on the NamedSheetViewCollection object, for use in<br>namedSheetViewCollection.set({  }) . |
| Excel.Interfaces.<br>NamedSheetView<br>Data                      | An interface describing the data returned by calling namedSheetView.toJSON()                                              |
| Excel.Interfaces.                                                | Represents a named sheet view of a worksheet. A sheet view stores the sort and                                            |
| NamedSheetView                                                   | filter rules for a particular worksheet. Every sheet view (even a temporary sheet                                         |
| LoadOptions                                                      | view) has a unique, worksheet-scoped name that is used to access the view.                                                |
| Excel.Interfaces.<br>NamedSheetView<br>UpdateData                | An interface for updating data on the NamedSheetView object, for use in<br>namedSheetView.set({  }) .                     |
| Excel.Interfaces.Note                                            | An interface describing the data returned by calling noteCollection.toJSON()                                              |
| CollectionData                                                   |                                                                                                                           |
| Excel.Interfaces.Note<br>CollectionLoad<br>Options               | Represents a collection of note objects that are part of the workbook.                                                    |
| Excel.Interfaces.Note<br>CollectionUpdate<br>Data                | An interface for updating data on the NoteCollection object, for use in<br>noteCollection.set({  }) .                     |
| Excel.Interfaces.Note                                            | An interface describing the data returned by calling note.toJSON()                                                        |
| Data                                                             |                                                                                                                           |
| Excel.Interfaces.Note<br>LoadOptions                             | Represents a note in the workbook or worksheet.                                                                           |
| Excel.Interfaces.Note                                            | An interface for updating data on the Note object, for use in note.set({                                                  |
| UpdateData                                                       | }) .                                                                                                                      |

{44}------------------------------------------------

| Excel.Interfaces.<br>NumberFormatInfo<br>Data            | An interface describing the data returned by calling numberFormatInfo.toJSON() .                                                                                                                   |  |
|----------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Excel.Interfaces.<br>NumberFormatInfo<br>LoadOptions     | Defines the culturally appropriate format of displaying numbers. This is based on<br>current system culture settings.                                                                              |  |
| Excel.Interfaces.Page                                    | An interface describing the data returned by calling                                                                                                                                               |  |
| BreakCollectionData                                      | pageBreakCollection.toJSON() .                                                                                                                                                                     |  |
| Excel.Interfaces.PageBreakCollectionLoadOptions          |                                                                                                                                                                                                    |  |
| Excel.Interfaces.Page<br>BreakCollection<br>UpdateData   | An interface for updating data on the PageBreakCollection object, for use in<br>pageBreakCollection.set({  }) .                                                                                    |  |
| Excel.Interfaces.Page                                    | An interface describing the data returned by calling pageBreak.toJSON()                                                                                                                            |  |
| BreakData                                                |                                                                                                                                                                                                    |  |
| Excel.Interfaces.PageBreakLoadOptions                    |                                                                                                                                                                                                    |  |
| Excel.Interfaces.Page                                    | An interface describing the data returned by calling pageLayout.toJSON()                                                                                                                           |  |
| LayoutData                                               |                                                                                                                                                                                                    |  |
| Excel.Interfaces.Page<br>LayoutLoadOptions               | Represents layout and print settings that are not dependent on any printer<br>specific implementation. These settings include margins, orientation, page<br>numbering, title rows, and print area. |  |
| Excel.Interfaces.Page                                    | An interface for updating data on the PageLayout object, for use in                                                                                                                                |  |
| LayoutUpdateData                                         | pageLayout.set({  }) .                                                                                                                                                                             |  |
| Excel.Interfaces.Pivot                                   | An interface describing the data returned by calling                                                                                                                                               |  |
| FieldCollectionData                                      | pivotFieldCollection.toJSON() .                                                                                                                                                                    |  |
| Excel.Interfaces.Pivot<br>FieldCollectionLoad<br>Options | Represents a collection of all the PivotFields that are part of a PivotTable's<br>hierarchy.                                                                                                       |  |
| Excel.Interfaces.Pivot<br>FieldCollection<br>UpdateData  | An interface for updating data on the PivotFieldCollection object, for use in<br>pivotFieldCollection.set({  }) .                                                                                  |  |
| Excel.Interfaces.Pivot                                   | An interface describing the data returned by calling pivotField.toJSON()                                                                                                                           |  |
| FieldData                                                |                                                                                                                                                                                                    |  |
| Excel.Interfaces.Pivot<br>FieldLoadOptions               | Represents the Excel PivotField.                                                                                                                                                                   |  |
| Excel.Interfaces.Pivot                                   | An interface for updating data on the PivotField object, for use in                                                                                                                                |  |
| FieldUpdateData                                          | pivotField.set({  }) .                                                                                                                                                                             |  |

{45}------------------------------------------------

| Excel.Interfaces.Pivot<br>HierarchyCollection<br>Data        | An interface describing the data returned by calling<br>pivotHierarchyCollection.toJSON() .                               |
|--------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.Pivot<br>HierarchyCollection<br>LoadOptions | Represents a collection of all the PivotHierarchies that are part of the PivotTable.                                      |
| Excel.Interfaces.Pivot<br>HierarchyCollection<br>UpdateData  | An interface for updating data on the PivotHierarchyCollection object, for use in<br>pivotHierarchyCollection.set({  }) . |
| Excel.Interfaces.Pivot<br>HierarchyData                      | An interface describing the data returned by calling pivotHierarchy.toJSON() .                                            |
| Excel.Interfaces.Pivot<br>HierarchyLoad<br>Options           | Represents the Excel PivotHierarchy.                                                                                      |
| Excel.Interfaces.Pivot<br>HierarchyUpdate<br>Data            | An interface for updating data on the PivotHierarchy object, for use in<br>pivotHierarchy.set({  }) .                     |
| Excel.Interfaces.Pivot                                       | An interface describing the data returned by calling                                                                      |
| ItemCollectionData                                           | pivotItemCollection.toJSON() .                                                                                            |
|                                                              |                                                                                                                           |
| Excel.Interfaces.Pivot<br>ItemCollectionLoad<br>Options      | Represents a collection of all the PivotItems related to their parent PivotField.                                         |
| Excel.Interfaces.Pivot<br>ItemCollection<br>UpdateData       | An interface for updating data on the PivotItemCollection object, for use in<br>pivotItemCollection.set({  }) .           |
| Excel.Interfaces.Pivot                                       | An interface describing the data returned by calling pivotItem.toJSON()                                                   |
| ItemData                                                     |                                                                                                                           |
| Excel.Interfaces.Pivot<br>ItemLoadOptions                    | Represents the Excel PivotItem.                                                                                           |
| Excel.Interfaces.Pivot                                       | An interface for updating data on the PivotItem object, for use in pivotItem.set({                                        |
| ItemUpdateData                                               | }) .                                                                                                                      |
| Excel.Interfaces.Pivot                                       | An interface describing the data returned by calling pivotLayout.toJSON()                                                 |
| LayoutData                                                   |                                                                                                                           |
| Excel.Interfaces.Pivot<br>LayoutLoadOptions                  | Represents the visual layout of the PivotTable.                                                                           |

{46}------------------------------------------------

| Excel.Interfaces.Pivot                                             | An interface describing the data returned by calling                                                                                                                                              |
|--------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| TableCollectionData                                                | pivotTableCollection.toJSON() .                                                                                                                                                                   |
| Excel.Interfaces.Pivot<br>TableCollectionLoad<br>Options           | Represents a collection of all the PivotTables that are part of the workbook or<br>worksheet.                                                                                                     |
| Excel.Interfaces.Pivot<br>TableCollection<br>UpdateData            | An interface for updating data on the PivotTableCollection object, for use in<br>pivotTableCollection.set({  }) .                                                                                 |
| Excel.Interfaces.Pivot                                             | An interface describing the data returned by calling pivotTable.toJSON()                                                                                                                          |
| TableData                                                          |                                                                                                                                                                                                   |
| Excel.Interfaces.Pivot                                             | Represents an Excel PivotTable. To learn more about the PivotTable object model,                                                                                                                  |
| TableLoadOptions                                                   | read Work with PivotTables using the Excel JavaScript API.                                                                                                                                        |
| Excel.Interfaces.Pivot<br>TableScoped<br>CollectionData            | An interface describing the data returned by calling<br>pivotTableScopedCollection.toJSON() .                                                                                                     |
| Excel.Interfaces.Pivot<br>TableScoped<br>CollectionLoad<br>Options | Represents a scoped collection of PivotTables. The PivotTables are sorted based on<br>the location of the PivotTable's top-left corner. They are ordered top-to-bottom<br>and then left-to-right. |
| Excel.Interfaces.Pivot<br>TableScoped<br>CollectionUpdate<br>Data  | An interface for updating data on the PivotTableScopedCollection object, for use<br>in pivotTableScopedCollection.set({<br>}) .                                                                   |
| Excel.Interfaces.Pivot<br>TableStyleCollection<br>Data             | An interface describing the data returned by calling<br>pivotTableStyleCollection.toJSON() .                                                                                                      |
| Excel.Interfaces.Pivot<br>TableStyleCollection<br>LoadOptions      | Represents a collection of PivotTable styles.                                                                                                                                                     |
| Excel.Interfaces.Pivot<br>TableStyleCollection<br>UpdateData       | An interface for updating data on the PivotTableStyleCollection object, for use in<br>pivotTableStyleCollection.set({  }) .                                                                       |
| Excel.Interfaces.Pivot                                             | An interface describing the data returned by calling pivotTableStyle.toJSON()                                                                                                                     |
| TableStyleData                                                     |                                                                                                                                                                                                   |
| Excel.Interfaces.Pivot<br>TableStyleLoad<br>Options                | Represents a PivotTable style, which defines style elements by PivotTable region.                                                                                                                 |

{47}------------------------------------------------

| Excel.Interfaces.Pivot<br>TableStyleUpdate<br>Data                      | An interface for updating data on the PivotTableStyle object, for use in<br>pivotTableStyle.set({  }) .                                                 |
|-------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.Pivot                                                  | An interface for updating data on the PivotTable object, for use in                                                                                     |
| TableUpdateData                                                         | pivotTable.set({  }) .                                                                                                                                  |
| Excel.Interfaces.<br>PresetCriteria<br>ConditionalFormat<br>Data        | An interface describing the data returned by calling<br>presetCriteriaConditionalFormat.toJSON() .                                                      |
| Excel.Interfaces.<br>PresetCriteria<br>ConditionalFormat<br>LoadOptions | Represents the preset criteria conditional format such as above average, below<br>average, unique values, contains blank, nonblank, error, and noerror. |
| Excel.Interfaces.<br>PresetCriteria<br>ConditionalFormat<br>UpdateData  | An interface for updating data on the PresetCriteriaConditionalFormat object, for<br>use in presetCriteriaConditionalFormat.set({<br>}) .               |
| Excel.Interfaces.<br>QueryCollection<br>Data                            | An interface describing the data returned by calling queryCollection.toJSON()                                                                           |
| Excel.Interfaces.<br>QueryCollection<br>LoadOptions                     | Represents the collection of queries in the workbook.                                                                                                   |
| Excel.Interfaces.<br>QueryCollection<br>UpdateData                      | An interface for updating data on the QueryCollection object, for use in<br>queryCollection.set({  }) .                                                 |
| Excel.Interfaces.                                                       | An interface describing the data returned by calling query.toJSON()                                                                                     |
| QueryData                                                               |                                                                                                                                                         |
| Excel.Interfaces.<br>QueryLoadOptions                                   | Represents a Power Query query.                                                                                                                         |
| Excel.Interfaces.                                                       | An interface for updating data on the Query object, for use in query.set({                                                                              |
| QueryUpdateData                                                         | }) .                                                                                                                                                    |
| Excel.Interfaces.<br>RangeAreas<br>CollectionData                       | An interface describing the data returned by calling<br>rangeAreasCollection.toJSON() .                                                                 |
| Excel.Interfaces.<br>RangeAreas<br>CollectionLoad<br>Options            | Contains the collection of cross-workbook level ranges.                                                                                                 |

{48}------------------------------------------------

| Excel.Interfaces.<br>RangeAreas<br>CollectionUpdate<br>Data   | An interface for updating data on the RangeAreasCollection object, for use in<br>rangeAreasCollection.set({  }) .   |  |
|---------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|--|
| Excel.Interfaces.<br>RangeAreasData                           | An interface describing the data returned by calling rangeAreas.toJSON() .                                          |  |
| Excel.Interfaces.                                             | RangeAreas represents a collection of one or more rectangular ranges in the same                                    |  |
| RangeAreasLoad                                                | worksheet. To learn how to use discontiguous ranges, read Work with multiple                                        |  |
| Options                                                       | ranges simultaneously in Excel add-ins.                                                                             |  |
| Excel.Interfaces.<br>RangeAreasUpdate<br>Data                 | An interface for updating data on the RangeAreas object, for use in<br>rangeAreas.set({  }) .                       |  |
| Excel.Interfaces.<br>RangeBorder<br>CollectionData            | An interface describing the data returned by calling<br>rangeBorderCollection.toJSON() .                            |  |
| Excel.Interfaces.<br>RangeBorder<br>CollectionLoad<br>Options | Represents the border objects that make up the range border.                                                        |  |
| Excel.Interfaces.<br>RangeBorder<br>CollectionUpdate<br>Data  | An interface for updating data on the RangeBorderCollection object, for use in<br>rangeBorderCollection.set({  }) . |  |
| Excel.Interfaces.                                             | An interface describing the data returned by calling rangeBorder.toJSON()                                           |  |
| RangeBorderData                                               |                                                                                                                     |  |
| Excel.Interfaces.<br>RangeBorderLoad<br>Options               | Represents the border of an object.                                                                                 |  |
| Excel.Interfaces.<br>RangeBorderUpdate<br>Data                | An interface for updating data on the RangeBorder object, for use in<br>rangeBorder.set({  }) .                     |  |
| Excel.Interfaces.<br>RangeCollection<br>Data                  | An interface describing the data returned by calling rangeCollection.toJSON()                                       |  |
| Excel.Interfaces.RangeCollectionLoadOptions                   |                                                                                                                     |  |
| Excel.Interfaces.<br>RangeCollection<br>UpdateData            | An interface for updating data on the RangeCollection object, for use in<br>rangeCollection.set({  }) .             |  |

{49}------------------------------------------------

| Excel.Interfaces.<br>RangeData                              | An interface describing the data returned by calling range.toJSON() .                                                                                                                                                         |
|-------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>RangeFillData                          | An interface describing the data returned by calling rangeFill.toJSON() .                                                                                                                                                     |
| Excel.Interfaces.<br>RangeFillLoad<br>Options               | Represents the background of a range object.                                                                                                                                                                                  |
| Excel.Interfaces.<br>RangeFillUpdate<br>Data                | An interface for updating data on the RangeFill object, for use in rangeFill.set({<br>}) .                                                                                                                                    |
| Excel.Interfaces.<br>RangeFontData                          | An interface describing the data returned by calling rangeFont.toJSON() .                                                                                                                                                     |
| Excel.Interfaces.<br>RangeFontLoad<br>Options               | This object represents the font attributes (font name, font size, color, etc.) for an<br>object.                                                                                                                              |
| Excel.Interfaces.<br>RangeFontUpdate<br>Data                | An interface for updating data on the RangeFont object, for use in rangeFont.set({<br>}) .                                                                                                                                    |
| Excel.Interfaces.<br>RangeFormatData                        | An interface describing the data returned by calling rangeFormat.toJSON() .                                                                                                                                                   |
| Excel.Interfaces.<br>RangeFormatLoad<br>Options             | A format object encapsulating the range's font, fill, borders, alignment, and other<br>properties.                                                                                                                            |
| Excel.Interfaces.<br>RangeFormat<br>UpdateData              | An interface for updating data on the RangeFormat object, for use in<br>rangeFormat.set({  }) .                                                                                                                               |
| Excel.Interfaces.<br>RangeLoadOptions                       | Range represents a set of one or more contiguous cells such as a cell, a row, a<br>column, or a block of cells. To learn more about how ranges are used throughout<br>the API, start with Ranges in the Excel JavaScript API. |
| Excel.Interfaces.<br>RangeUpdateData                        | An interface for updating data on the Range object, for use in range.set({  }) .                                                                                                                                              |
| Excel.Interfaces.<br>RangeView<br>CollectionData            | An interface describing the data returned by calling<br>rangeViewCollection.toJSON() .                                                                                                                                        |
| Excel.Interfaces.<br>RangeView<br>CollectionLoad<br>Options | Represents a collection of RangeView objects.                                                                                                                                                                                 |

{50}------------------------------------------------

| Excel.Interfaces.<br>RangeView<br>CollectionUpdate<br>Data                | An interface for updating data on the RangeViewCollection object, for use in<br>rangeViewCollection.set({  }) .                               |
|---------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>RangeViewData                                        | An interface describing the data returned by calling rangeView.toJSON() .                                                                     |
| Excel.Interfaces.<br>RangeViewLoad<br>Options                             | RangeView represents a set of visible cells of the parent range.                                                                              |
| Excel.Interfaces.<br>RangeViewUpdate<br>Data                              | An interface for updating data on the RangeView object, for use in rangeView.set({<br>}) .                                                    |
| Excel.Interfaces.<br>RemoveDuplicates<br>ResultData                       | An interface describing the data returned by calling<br>removeDuplicatesResult.toJSON() .                                                     |
| Excel.Interfaces.<br>RemoveDuplicates<br>ResultLoadOptions                | Represents the results from Range.removeDuplicates .                                                                                          |
| Excel.Interfaces.Row<br>ColumnPivot<br>HierarchyCollection<br>Data        | An interface describing the data returned by calling<br>rowColumnPivotHierarchyCollection.toJSON() .                                          |
| Excel.Interfaces.Row<br>ColumnPivot<br>HierarchyCollection<br>LoadOptions | Represents a collection of RowColumnPivotHierarchy items associated with the<br>PivotTable.                                                   |
| Excel.Interfaces.Row<br>ColumnPivot<br>HierarchyCollection<br>UpdateData  | An interface for updating data on the RowColumnPivotHierarchyCollection object,<br>for use in rowColumnPivotHierarchyCollection.set({<br>}) . |
| Excel.Interfaces.Row<br>ColumnPivot<br>HierarchyData                      | An interface describing the data returned by calling<br>rowColumnPivotHierarchy.toJSON() .                                                    |
| Excel.Interfaces.Row<br>ColumnPivot<br>HierarchyLoad<br>Options           | Represents the Excel RowColumnPivotHierarchy.                                                                                                 |
| Excel.Interfaces.Row                                                      | An interface for updating data on the RowColumnPivotHierarchy object, for use in                                                              |
| ColumnPivot                                                               | rowColumnPivotHierarchy.set({  }) .                                                                                                           |

{51}------------------------------------------------

| HierarchyUpdate<br>Data                              |                                                                                                                                                                                                                                                                                                                                                                                                               |
|------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.                                    | An interface describing the data returned by calling runtime.toJSON()                                                                                                                                                                                                                                                                                                                                         |
| RuntimeData                                          |                                                                                                                                                                                                                                                                                                                                                                                                               |
| Excel.Interfaces.<br>RuntimeLoad<br>Options          | Represents the Excel Runtime class.                                                                                                                                                                                                                                                                                                                                                                           |
| Excel.Interfaces.<br>RuntimeUpdateData               | An interface for updating data on the Runtime object, for use in runtime.set({<br><br>}) .                                                                                                                                                                                                                                                                                                                    |
| Excel.Interfaces.<br>SettingCollection<br>Data       | An interface describing the data returned by calling settingCollection.toJSON()                                                                                                                                                                                                                                                                                                                               |
| Excel.Interfaces.                                    | Represents a collection of key-value pair setting objects that are part of the                                                                                                                                                                                                                                                                                                                                |
| SettingCollection                                    | workbook. The scope is limited to per file and add-in (task-pane or content)                                                                                                                                                                                                                                                                                                                                  |
| LoadOptions                                          | combination.                                                                                                                                                                                                                                                                                                                                                                                                  |
| Excel.Interfaces.<br>SettingCollection<br>UpdateData | An interface for updating data on the SettingCollection object, for use in<br>settingCollection.set({  }) .                                                                                                                                                                                                                                                                                                   |
| Excel.Interfaces.                                    | An interface describing the data returned by calling setting.toJSON()                                                                                                                                                                                                                                                                                                                                         |
| SettingData                                          |                                                                                                                                                                                                                                                                                                                                                                                                               |
| Excel.Interfaces.<br>SettingLoadOptions              | Setting represents a key-value pair of a setting persisted to the document (per file,<br>per add-in). These custom key-value pair can be used to store state or lifecycle<br>information needed by the content or task-pane add-in. Note that settings are<br>persisted in the document and hence it is not a place to store any sensitive or<br>protected information such as user information and password. |
| Excel.Interfaces.<br>SettingUpdateData               | An interface for updating data on the Setting object, for use in setting.set({<br><br>}) .                                                                                                                                                                                                                                                                                                                    |
| Excel.Interfaces.<br>ShapeCollection<br>Data         | An interface describing the data returned by calling shapeCollection.toJSON()                                                                                                                                                                                                                                                                                                                                 |
| Excel.Interfaces.<br>ShapeCollection<br>LoadOptions  | Represents a collection of all the shapes in the worksheet.                                                                                                                                                                                                                                                                                                                                                   |
| Excel.Interfaces.<br>ShapeCollection<br>UpdateData   | An interface for updating data on the ShapeCollection object, for use in<br>shapeCollection.set({  }) .                                                                                                                                                                                                                                                                                                       |
| Excel.Interfaces.                                    | An interface describing the data returned by calling shape.toJSON()                                                                                                                                                                                                                                                                                                                                           |
| ShapeData                                            |                                                                                                                                                                                                                                                                                                                                                                                                               |

{52}------------------------------------------------

| Excel.Interfaces.<br>ShapeFillData                  | An interface describing the data returned by calling shapeFill.toJSON() .                                                                                                                                                       |
|-----------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>ShapeFillLoad<br>Options       | Represents the fill formatting of a shape object.                                                                                                                                                                               |
| Excel.Interfaces.<br>ShapeFillUpdate<br>Data        | An interface for updating data on the ShapeFill object, for use in shapeFill.set({<br>}) .                                                                                                                                      |
| Excel.Interfaces.<br>ShapeFontData                  | An interface describing the data returned by calling shapeFont.toJSON() .                                                                                                                                                       |
| Excel.Interfaces.<br>ShapeFontLoad<br>Options       | Represents the font attributes, such as font name, font size, and color, for a<br>shape's TextRange object.                                                                                                                     |
| Excel.Interfaces.<br>ShapeFontUpdate<br>Data        | An interface for updating data on the ShapeFont object, for use in shapeFont.set({<br>}) .                                                                                                                                      |
| Excel.Interfaces.<br>ShapeGroupData                 | An interface describing the data returned by calling shapeGroup.toJSON() .                                                                                                                                                      |
| Excel.Interfaces.                                   | Represents a shape group inside a worksheet. To get the corresponding Shape                                                                                                                                                     |
| ShapeGroupLoad                                      | object, use ShapeGroup.shape                                                                                                                                                                                                    |
| Options                                             |                                                                                                                                                                                                                                 |
| Excel.Interfaces.<br>ShapeLineFormat<br>Data        | An interface describing the data returned by calling shapeLineFormat.toJSON() .                                                                                                                                                 |
| Excel.Interfaces.<br>ShapeLineFormat<br>LoadOptions | Represents the line formatting for the shape object. For images and geometric<br>shapes, line formatting represents the border of the shape.                                                                                    |
| Excel.Interfaces.<br>ShapeLineFormat<br>UpdateData  | An interface for updating data on the ShapeLineFormat object, for use in<br>shapeLineFormat.set({  }) .                                                                                                                         |
| Excel.Interfaces.<br>ShapeLoadOptions               | Represents a generic shape object in the worksheet. A shape could be a geometric<br>shape, a line, a group of shapes, etc. To learn more about the shape object model,<br>read Work with shapes using the Excel JavaScript API. |
| Excel.Interfaces.<br>ShapeUpdateData                | An interface for updating data on the Shape object, for use in shape.set({  }) .                                                                                                                                                |
| Excel.Interfaces.<br>SlicerCollectionData           | An interface describing the data returned by calling slicerCollection.toJSON() .                                                                                                                                                |

{53}------------------------------------------------

| Excel.Interfaces.<br>SlicerCollectionLoad<br>Options      | Represents a collection of all the slicer objects in the workbook or a worksheet.                                   |
|-----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>SlicerCollection<br>UpdateData       | An interface for updating data on the SlicerCollection object, for use in<br>slicerCollection.set({  }) .           |
| Excel.Interfaces.<br>SlicerData                           | An interface describing the data returned by calling slicer.toJSON() .                                              |
| Excel.Interfaces.<br>SlicerItemCollection<br>Data         | An interface describing the data returned by calling<br>slicerItemCollection.toJSON() .                             |
| Excel.Interfaces.<br>SlicerItemCollection<br>LoadOptions  | Represents a collection of all the slicer item objects in the slicer.                                               |
| Excel.Interfaces.<br>SlicerItemCollection<br>UpdateData   | An interface for updating data on the SlicerItemCollection object, for use in<br>slicerItemCollection.set({  }) .   |
| Excel.Interfaces.<br>SlicerItemData                       | An interface describing the data returned by calling slicerItem.toJSON() .                                          |
|                                                           |                                                                                                                     |
| Excel.Interfaces.<br>SlicerItemLoad<br>Options            | Represents a slicer item in a slicer.                                                                               |
| Excel.Interfaces.<br>SlicerItemUpdate<br>Data             | An interface for updating data on the SlicerItem object, for use in<br>slicerItem.set({  }) .                       |
| Excel.Interfaces.<br>SlicerLoadOptions                    | Represents a Slicer object in the workbook.                                                                         |
| Excel.Interfaces.<br>SlicerStyleCollection<br>Data        | An interface describing the data returned by calling<br>slicerStyleCollection.toJSON() .                            |
| Excel.Interfaces.<br>SlicerStyleCollection<br>LoadOptions | Represents a collection of SlicerStyle objects.                                                                     |
| Excel.Interfaces.<br>SlicerStyleCollection<br>UpdateData  | An interface for updating data on the SlicerStyleCollection object, for use in<br>slicerStyleCollection.set({  }) . |

{54}------------------------------------------------

| Excel.Interfaces.<br>SlicerStyleLoad<br>Options               | Represents a slicer style, which defines style elements by region of the slicer.                                          |
|---------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>SlicerStyleUpdate<br>Data                | An interface for updating data on the SlicerStyle object, for use in<br>slicerStyle.set({  }) .                           |
| Excel.Interfaces.                                             | An interface for updating data on the Slicer object, for use in slicer.set({                                              |
| SlicerUpdateData                                              | }) .                                                                                                                      |
| Excel.Interfaces.Style                                        | An interface describing the data returned by calling styleCollection.toJSON()                                             |
| CollectionData                                                |                                                                                                                           |
| Excel.Interfaces.Style<br>CollectionLoad<br>Options           | Represents a collection of all the styles.                                                                                |
| Excel.Interfaces.Style<br>CollectionUpdate<br>Data            | An interface for updating data on the StyleCollection object, for use in<br>styleCollection.set({  }) .                   |
| Excel.Interfaces.Style                                        | An interface describing the data returned by calling style.toJSON()                                                       |
| Data                                                          |                                                                                                                           |
| Excel.Interfaces.Style<br>LoadOptions                         | An object encapsulating a style's format and other properties.                                                            |
| Excel.Interfaces.Style                                        | An interface for updating data on the Style object, for use in style.set({                                                |
| UpdateData                                                    | }) .                                                                                                                      |
| Excel.Interfaces.                                             | An interface describing the data returned by calling tableCollection.toJSON()                                             |
| TableCollectionData                                           |                                                                                                                           |
| Excel.Interfaces.<br>TableCollectionLoad<br>Options           | Represents a collection of all the tables that are part of the workbook or<br>worksheet, depending on how it was reached. |
| Excel.Interfaces.<br>TableCollection<br>UpdateData            | An interface for updating data on the TableCollection object, for use in<br>tableCollection.set({  }) .                   |
| Excel.Interfaces.<br>TableColumn<br>CollectionData            | An interface describing the data returned by calling<br>tableColumnCollection.toJSON() .                                  |
| Excel.Interfaces.<br>TableColumn<br>CollectionLoad<br>Options | Represents a collection of all the columns that are part of the table.                                                    |

{55}------------------------------------------------

| Excel.Interfaces.<br>TableColumn<br>CollectionUpdate<br>Data | An interface for updating data on the TableColumnCollection object, for use in<br>tableColumnCollection.set({  }) .                                                                                                                                                                                                                                                                                           |
|--------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>TableColumnData                         | An interface describing the data returned by calling tableColumn.toJSON() .                                                                                                                                                                                                                                                                                                                                   |
| Excel.Interfaces.<br>TableColumnLoad<br>Options              | Represents a column in a table.                                                                                                                                                                                                                                                                                                                                                                               |
| Excel.Interfaces.<br>TableColumnUpdate<br>Data               | An interface for updating data on the TableColumn object, for use in<br>tableColumn.set({  }) .                                                                                                                                                                                                                                                                                                               |
| Excel.Interfaces.<br>TableData                               | An interface describing the data returned by calling table.toJSON() .                                                                                                                                                                                                                                                                                                                                         |
| Excel.Interfaces.                                            | Represents an Excel table. To learn more about the table object model, read Work                                                                                                                                                                                                                                                                                                                              |
| TableLoadOptions                                             | with tables using the Excel JavaScript API.                                                                                                                                                                                                                                                                                                                                                                   |
| Excel.Interfaces.<br>TableRowCollection<br>Data              | An interface describing the data returned by calling tableRowCollection.toJSON() .                                                                                                                                                                                                                                                                                                                            |
| Excel.Interfaces.<br>TableRowCollection<br>LoadOptions       | Represents a collection of all the rows that are part of the table.<br>Note that unlike ranges or columns, which will adjust if new rows or columns are<br>added before them, a TableRow object represents the physical location of the table<br>row, but not the data. That is, if the data is sorted or if new rows are added, a table<br>row will continue to point at the index for which it was created. |
| Excel.Interfaces.<br>TableRowCollection<br>UpdateData        | An interface for updating data on the TableRowCollection object, for use in<br>tableRowCollection.set({  }) .                                                                                                                                                                                                                                                                                                 |
| Excel.Interfaces.                                            | An interface describing the data returned by calling tableRow.toJSON()                                                                                                                                                                                                                                                                                                                                        |
| TableRowData                                                 |                                                                                                                                                                                                                                                                                                                                                                                                               |
| Excel.Interfaces.<br>TableRowLoad<br>Options                 | Represents a row in a table.<br>Note that unlike ranges or columns, which will adjust if new rows or columns are<br>added before them, a TableRow object represents the physical location of the table<br>row, but not the data. That is, if the data is sorted or if new rows are added, a table<br>row will continue to point at the index for which it was created.                                        |
| Excel.Interfaces.<br>TableRowUpdate<br>Data                  | An interface for updating data on the TableRow object, for use in tableRow.set({<br>}) .                                                                                                                                                                                                                                                                                                                      |

{56}------------------------------------------------

| Excel.Interfaces.<br>TableScoped<br>CollectionData            | An interface describing the data returned by calling<br>tableScopedCollection.toJSON() .                                                                                              |
|---------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>TableScoped<br>CollectionLoad<br>Options | Represents a scoped collection of tables. For each table its top-left corner is<br>considered its anchor location, and the tables are sorted top-to-bottom and then<br>left-to-right. |
| Excel.Interfaces.<br>TableScoped<br>CollectionUpdate<br>Data  | An interface for updating data on the TableScopedCollection object, for use in<br>tableScopedCollection.set({  }) .                                                                   |
| Excel.Interfaces.<br>TableSortData                            | An interface describing the data returned by calling tableSort.toJSON() .                                                                                                             |
| Excel.Interfaces.<br>TableSortLoad<br>Options                 | Manages sorting operations on Table objects.                                                                                                                                          |
| Excel.Interfaces.<br>TableStyleCollection<br>Data             | An interface describing the data returned by calling<br>tableStyleCollection.toJSON() .                                                                                               |
| Excel.Interfaces.<br>TableStyleCollection<br>LoadOptions      | Represents a collection of table styles.                                                                                                                                              |
| Excel.Interfaces.<br>TableStyleCollection<br>UpdateData       | An interface for updating data on the TableStyleCollection object, for use in<br>tableStyleCollection.set({  }) .                                                                     |
| Excel.Interfaces.<br>TableStyleData                           | An interface describing the data returned by calling tableStyle.toJSON() .                                                                                                            |
| Excel.Interfaces.<br>TableStyleLoad<br>Options                | Represents a table style, which defines the style elements by region of the table.                                                                                                    |
| Excel.Interfaces.<br>TableStyleUpdate<br>Data                 | An interface for updating data on the TableStyle object, for use in<br>tableStyle.set({  }) .                                                                                         |
| Excel.Interfaces.<br>TableUpdateData                          | An interface for updating data on the Table object, for use in table.set({  }) .                                                                                                      |
| Excel.Interfaces.Text<br>ConditionalFormat<br>Data            | An interface describing the data returned by calling<br>textConditionalFormat.toJSON() .                                                                                              |

{57}------------------------------------------------

| Excel.Interfaces.Text<br>ConditionalFormat<br>LoadOptions       | Represents a specific text conditional format.                                                                          |
|-----------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.Text<br>ConditionalFormat<br>UpdateData        | An interface for updating data on the TextConditionalFormat object, for use in<br>textConditionalFormat.set({  }) .     |
| Excel.Interfaces.Text<br>FrameData                              | An interface describing the data returned by calling textFrame.toJSON() .                                               |
| Excel.Interfaces.Text<br>FrameLoadOptions                       | Represents the text frame of a shape object.                                                                            |
| Excel.Interfaces.Text                                           | An interface for updating data on the TextFrame object, for use in textFrame.set({                                      |
| FrameUpdateData                                                 | }) .                                                                                                                    |
| Excel.Interfaces.Text                                           | An interface describing the data returned by calling textRange.toJSON()                                                 |
| RangeData                                                       |                                                                                                                         |
| Excel.Interfaces.Text                                           | Contains the text that is attached to a shape, in addition to properties and                                            |
| RangeLoadOptions                                                | methods for manipulating the text.                                                                                      |
| Excel.Interfaces.Text                                           | An interface for updating data on the TextRange object, for use in textRange.set({                                      |
| RangeUpdateData                                                 | }) .                                                                                                                    |
| Excel.Interfaces.<br>TimelineStyle<br>CollectionData            | An interface describing the data returned by calling<br>timelineStyleCollection.toJSON() .                              |
| Excel.Interfaces.<br>TimelineStyle<br>CollectionLoad<br>Options | Represents a collection of timeline styles.                                                                             |
| Excel.Interfaces.<br>TimelineStyle<br>CollectionUpdate<br>Data  | An interface for updating data on the TimelineStyleCollection object, for use in<br>timelineStyleCollection.set({  }) . |
| Excel.Interfaces.                                               | An interface describing the data returned by calling timelineStyle.toJSON()                                             |
| TimelineStyleData                                               |                                                                                                                         |
| Excel.Interfaces.                                               | Represents a TimelineStyle                                                                                              |
| TimelineStyleLoad                                               | , which defines style elements by region in the                                                                         |
| Options                                                         | timeline.                                                                                                               |
| Excel.Interfaces.<br>TimelineStyleUpdate<br>Data                | An interface for updating data on the TimelineStyle object, for use in<br>timelineStyle.set({  }) .                     |

{58}------------------------------------------------

| Excel.Interfaces.Top<br>BottomConditional<br>FormatData        | An interface describing the data returned by calling<br>topBottomConditionalFormat.toJSON() . |
|----------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| Excel.Interfaces.Top<br>BottomConditional<br>FormatLoadOptions | Represents a top/bottom conditional format.                                                   |
| Excel.Interfaces.Top                                           | An interface for updating data on the TopBottomConditionalFormat object, for use              |
| BottomConditional                                              | in topBottomConditionalFormat.set({                                                           |
| FormatUpdateData                                               | }) .                                                                                          |
| Excel.Interfaces.<br>WorkbookCreated<br>Data                   | An interface describing the data returned by calling workbookCreated.toJSON() .               |
| Excel.Interfaces.<br>WorkbookData                              | An interface describing the data returned by calling workbook.toJSON() .                      |
| Excel.Interfaces.                                              | Workbook is the top level object which contains related workbook objects such as              |
| WorkbookLoad                                                   | worksheets, tables, and ranges. To learn more about the workbook object model,                |
| Options                                                        | read Work with workbooks using the Excel JavaScript API.                                      |
| Excel.Interfaces.<br>Workbook<br>ProtectionData                | An interface describing the data returned by calling workbookProtection.toJSON() .            |
| Excel.Interfaces.<br>Workbook<br>ProtectionLoad<br>Options     | Represents the protection of a workbook object.                                               |
| Excel.Interfaces.<br>WorkbookRange<br>AreasData                | An interface describing the data returned by calling workbookRangeAreas.toJSON() .            |
| Excel.Interfaces.<br>WorkbookRange<br>AreasLoadOptions         | Represents a collection of one or more rectangular ranges in multiple worksheets.             |
| Excel.Interfaces.<br>WorkbookUpdate<br>Data                    | An interface for updating data on the Workbook object, for use in workbook.set({<br>}) .      |
| Excel.Interfaces.<br>WorksheetCollection<br>Data               | An interface describing the data returned by calling<br>worksheetCollection.toJSON() .        |
| Excel.Interfaces.<br>WorksheetCollection<br>LoadOptions        | Represents a collection of worksheet objects that are part of the workbook.                   |

{59}------------------------------------------------

| Excel.Interfaces.<br>WorksheetCollection<br>UpdateData                    | An interface for updating data on the WorksheetCollection object, for use in<br>worksheetCollection.set({  }) .                               |
|---------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Interfaces.<br>WorksheetCustom<br>PropertyCollection<br>Data        | An interface describing the data returned by calling<br>worksheetCustomPropertyCollection.toJSON() .                                          |
| Excel.Interfaces.<br>WorksheetCustom<br>PropertyCollection<br>LoadOptions | Contains the collection of worksheet-level custom property.                                                                                   |
| Excel.Interfaces.<br>WorksheetCustom<br>PropertyCollection<br>UpdateData  | An interface for updating data on the WorksheetCustomPropertyCollection object,<br>for use in worksheetCustomPropertyCollection.set({<br>}) . |
| Excel.Interfaces.<br>WorksheetCustom<br>PropertyData                      | An interface describing the data returned by calling<br>worksheetCustomProperty.toJSON() .                                                    |
| Excel.Interfaces.<br>WorksheetCustom<br>PropertyLoad<br>Options           | Represents a worksheet-level custom property.                                                                                                 |
| Excel.Interfaces.<br>WorksheetCustom<br>PropertyUpdateData                | An interface for updating data on the WorksheetCustomProperty object, for use in<br>worksheetCustomProperty.set({  }) .                       |
| Excel.Interfaces.<br>WorksheetData                                        | An interface describing the data returned by calling worksheet.toJSON() .                                                                     |
| Excel.Interfaces.                                                         | An Excel worksheet is a grid of cells. It can contain data, tables, charts, etc. To learn                                                     |
| WorksheetLoad                                                             | more about the worksheet object model, read Work with worksheets using the                                                                    |
| Options                                                                   | Excel JavaScript API.                                                                                                                         |
| Excel.Interfaces.<br>Worksheet<br>ProtectionData                          | An interface describing the data returned by calling<br>worksheetProtection.toJSON() .                                                        |
| Excel.Interfaces.<br>Worksheet<br>ProtectionLoad<br>Options               | Represents the protection of a worksheet object.                                                                                              |
| Excel.Interfaces.<br>WorksheetUpdate<br>Data                              | An interface for updating data on the Worksheet object, for use in worksheet.set({<br>}) .                                                    |

{60}------------------------------------------------

| Excel.JavaScript<br>CustomFunction<br>ReferenceCellValue            | Represents a reference to a JavaScript custom function.                                                                                     |
|---------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.LinkedData<br>TypeAddedEvent<br>Args                          | The argument that is passed to the event handler after a new linked data type is<br>added to the workbook.                                  |
| Excel.LinkedEntity<br>CellValue                                     | Represents a value whose properties derive from a service.                                                                                  |
| Excel.LinkedEntity<br>DataDomainAdded<br>EventArgs                  | Provides information about the identity of the linked entity data domain that was<br>just added to the workbook.                            |
| Excel.LinkedEntity                                                  | Represents options that are used to create the LinkedEntityDataDomain object                                                                |
| DataDomainCreate                                                    | being added to the LinkedEntityDataDomainCollection                                                                                         |
| Options                                                             |                                                                                                                                             |
| Excel.LinkedEntity<br>DataDomainRefresh<br>CompletedEvent<br>Args   | Provides information about the linked entity data domain whose<br>LinkedEntityCellValue objects were refreshed.                             |
| Excel.LinkedEntity<br>DataDomainRefresh<br>ModeChangedEvent<br>Args | Provides information about the linked entity data domain whose refresh mode<br>was changed.                                                 |
| Excel.LinkedEntityId                                                | The linked entity ID object represents a set of properties that describes a service<br>and culture for locating this service defined value. |
| Excel.LinkedEntity<br>IdCulture                                     | Represents the entity ID and culture for a LinkedEntityCellValue object.                                                                    |
| Excel.LinkedEntity                                                  | Represents a request to @linkedEntityLoadService custom function to load                                                                    |
| LoadServiceRequest                                                  | LinkedEntityCellValue objects.                                                                                                              |
| Excel.LinkedEntity                                                  | Represents the result of a request to @linkedEntityLoadService custom function to                                                           |
| LoadServiceResult                                                   | load LinkedEntityCellValue objects.                                                                                                         |
| Excel.ListData<br>Validation                                        | Represents the List data validation criteria.                                                                                               |
| Excel.LocalImageCell<br>Value                                       | Represents the value of a cell containing a locally stored or generated image.                                                              |
| Excel.LocalImageCell<br>ValueCacheId                                | The UID of a previously cached image.                                                                                                       |
| Excel.MixedCell                                                     | Represents the result of a query that resulted in multiple cell controls. If the result                                                     |

{61}------------------------------------------------

| Control                              | has multiple controls, then they can't be represented as a single result.                                                                                                                                             |
|--------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.NameErrorCell<br>Value         | Represents the value of a cell containing a #NAME? error.                                                                                                                                                             |
| Excel.NotAvailable<br>ErrorCellValue | Represents the value of a cell containing a #N/A error.                                                                                                                                                               |
| Excel.NullErrorCell<br>Value         | Represents the value of a cell containing a #NULL! error.                                                                                                                                                             |
| Excel.NumErrorCell<br>Value          | Represents the value of a cell containing a #NUM! error.                                                                                                                                                              |
| Excel.PageLayout<br>MarginOptions    | Represents the options in page layout margins.                                                                                                                                                                        |
| Excel.PageLayout<br>ZoomOptions      | Represents page zoom properties.                                                                                                                                                                                      |
| Excel.PivotDateFilter                | Configurable template for a date filter to apply to a PivotField. The condition<br>defines what criteria need to be set in order for the filter to operate.                                                           |
| Excel.PivotFilters                   | An interface representing all PivotFilters currently applied to a given PivotField.                                                                                                                                   |
| Excel.PivotLabel                     | Configurable template for a label filter to apply to a PivotField. The condition                                                                                                                                      |
| Filter                               | defines what criteria need to be set in order for the filter to operate.                                                                                                                                              |
| Excel.PivotManual                    | Configurable template for a manual filter to apply to a PivotField. The condition                                                                                                                                     |
| Filter                               | defines what criteria need to be set in order for the filter to operate.                                                                                                                                              |
| Excel.PivotValue                     | Configurable template for a value filter to apply to a PivotField. The condition                                                                                                                                      |
| Filter                               | defines what criteria need to be set in order for the filter to operate.                                                                                                                                              |
| Excel.Placeholder                    | Represents the value of a cell containing a #BUSY! error. This type of error is used                                                                                                                                  |
| ErrorCellValue                       | as a placeholder while the value of a cell is downloaded.                                                                                                                                                             |
| Excel.PythonError<br>CellValue       | Represents the value of a cell containing a #PYTHON! error.                                                                                                                                                           |
| Excel.Range<br>Hyperlink             | Represents the necessary strings to get/set a hyperlink (XHL) object.                                                                                                                                                 |
| Excel.Range                          | Represents a string reference of the form "SheetName!A1:B5", or a global or local                                                                                                                                     |
| Reference                            | named range.                                                                                                                                                                                                          |
| Excel.RangeTextRun                   | Represents a sequence of one or more characters that share the same font<br>attributes in a cell. Can be used as the textRuns properties of getCellProperties<br>or the textRuns input parameter of setCellProperties |
| Excel.ReferenceCell<br>Value         | Represents a reference into referencedValues<br>. One scenario for using this<br>reference is to avoid duplicating cell value objects (such as an EntityCellValue<br>).                                               |

{62}------------------------------------------------

|                                                | Define a cell value object once in referencedValues<br>, and then refer to that cell<br>value from many places by using a ReferenceCellValue where the duplicated value<br>would have appeared. |
|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.RefErrorCell<br>Value                    | Represents the value of a cell containing a #REF! error.                                                                                                                                        |
| Excel.RefreshMode                              | Represents information about a newly added linked data type, such as source and                                                                                                                 |
| ChangedEventArgs                               | ID.                                                                                                                                                                                             |
| Excel.Refresh<br>RequestCompleted<br>EventArgs | The argument that is passed to the event handler upon completion of refresh<br>request to an external service or link.                                                                          |
| Excel.ReplaceCriteria                          | Represents the replace criteria to be used.                                                                                                                                                     |
| Excel.RootReference                            | Represents a reference to the value which contains referencedValues                                                                                                                             |
| CellValue                                      |                                                                                                                                                                                                 |
| Excel.RowProperties                            | Represents the returned properties of getRowProperties.                                                                                                                                         |
|                                                | [ API set: ExcelApi 1.9 ]                                                                                                                                                                       |
| Excel.RowProperties                            | Represents which row properties to load, when used as part of a                                                                                                                                 |
| LoadOptions                                    | "range.getRowProperties" method.                                                                                                                                                                |
|                                                | [ API set: ExcelApi 1.9 ]                                                                                                                                                                       |
| Excel.RunOptions                               |                                                                                                                                                                                                 |
| Excel.SearchCriteria                           | Represents the search criteria to be used.                                                                                                                                                      |
| Excel.Selection<br>ChangedEventArgs            | Provides information about the document that raised the selection changed event.                                                                                                                |
| Excel.Session                                  |                                                                                                                                                                                                 |
| Excel.SettableCell                             | Represents the input parameter of setCellProperties.                                                                                                                                            |
| Properties                                     | [ API set: ExcelApi 1.9 ]                                                                                                                                                                       |
| Excel.Settable                                 | Represents the input parameter of setColumnProperties.                                                                                                                                          |
| ColumnProperties                               | [ API set: ExcelApi 1.9 ]                                                                                                                                                                       |
| Excel.SettableRow                              | Represents the input parameter of setRowProperties.                                                                                                                                             |
| Properties                                     | [ API set: ExcelApi 1.9 ]                                                                                                                                                                       |
| Excel.Settings<br>ChangedEventArgs             | Provides information about the setting that raised the settings changed event                                                                                                                   |
| Excel.Shape                                    | Provides information about the shape that raised the activated event.                                                                                                                           |

{63}------------------------------------------------

| ActivatedEventArgs                       |                                                                               |
|------------------------------------------|-------------------------------------------------------------------------------|
| Excel.Shape<br>DeactivatedEvent<br>Args  | Provides information about the shape that raised the deactivated event.       |
| Excel.ShowAsRule                         |                                                                               |
| Excel.SortField                          | Represents a condition in a sorting operation.                                |
| Excel.SpillErrorCell<br>Value            | Represents the value of a cell containing a #SPILL! error.                    |
| Excel.StringCellValue                    | Represents the value of a cell containing a string.                           |
| Excel.Subtotals                          | Subtotals for the Pivot Field.                                                |
| Excel.TableAdded<br>EventArgs            | Provides information about the table that raised the added event.             |
| Excel.TableChanged<br>EventArgs          | Provides information about the table that raised the changed event.           |
| Excel.TableDeleted<br>EventArgs          | Provides information about the table that raised the deleted event.           |
| Excel.TableFiltered<br>EventArgs         | Provides information about the table that raised the filter applied event.    |
| Excel.TableSelection<br>ChangedEventArgs | Provides information about the table that raised the selection changed event. |
| Excel.ThreeArrows<br>GraySet             | [ API set: ExcelApi 1.2 ]                                                     |
| Excel.ThreeArrows                        | [ API set: ExcelApi 1.2 ]                                                     |
| Set                                      |                                                                               |
| Excel.ThreeFlagsSet                      | [ API set: ExcelApi 1.2 ]                                                     |
| Excel.ThreeSignsSet                      | [ API set: ExcelApi 1.2 ]                                                     |
| Excel.ThreeStarsSet                      | [ API set: ExcelApi 1.2 ]                                                     |
| Excel.Three<br>Symbols2Set               | [ API set: ExcelApi 1.2 ]                                                     |
| Excel.ThreeSymbols<br>Set                | [ API set: ExcelApi 1.2 ]                                                     |

{64}------------------------------------------------

| Excel.ThreeTraffic<br>Lights2Set                      | [ API set: ExcelApi 1.2 ]                                                                                                                                                                             |
|-------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.ThreeTriangles<br>Set                           | [ API set: ExcelApi 1.2 ]                                                                                                                                                                             |
| Excel.TimeoutError<br>CellValue                       | Represents the value of a cell containing a #TIMEOUT! error.                                                                                                                                          |
| Excel.UnknownCell<br>Control                          | Represents an unknown cell control. This represents a control that was added in a<br>future version of Excel, and the current version of Excel doesn't know how to<br>display this control.           |
| Excel.ValueErrorCell<br>Value                         | Represents the value of a cell containing a #VALUE! error.                                                                                                                                            |
| Excel.ValueTypeNot<br>AvailableCellValue              | Represents the value of a cell containing a type of value which cannot be<br>serialized. For example, an #UNKNOWN! error which represents a type of rich<br>value not known to this version of Excel. |
| Excel.WebImageCell<br>Value                           | Represents the value of a cell containing an image downloaded from the internet.                                                                                                                      |
| Excel.Workbook<br>ActivatedEventArgs                  | Provides information about the workbook that raised the activated event.                                                                                                                              |
| Excel.Workbook<br>AutoSaveSetting<br>ChangedEventArgs | Provides information about the workbook's onAutoSaveSettingChanged event.                                                                                                                             |
| Excel.Worksheet<br>ActivatedEventArgs                 | Provides information about the worksheet that raised the activated event.                                                                                                                             |
| Excel.Worksheet<br>AddedEventArgs                     | Provides information about the worksheet that raised the added event.                                                                                                                                 |
| Excel.Worksheet<br>CalculatedEventArgs                | Provides information about the worksheet that raised the calculated event.                                                                                                                            |
| Excel.Worksheet<br>ChangedEventArgs                   | Provides information about the worksheet that raised the changed event.                                                                                                                               |
| Excel.Worksheet<br>ColumnSortedEvent<br>Args          | Provides information about the column-sorted event and its related worksheet.                                                                                                                         |
| Excel.Worksheet<br>DeactivatedEvent<br>Args           | Provides information about the worksheet that raised the deactivated event.                                                                                                                           |
| Excel.Worksheet<br>DeletedEventArgs                   | Provides information about the worksheet that raised the deleted event.                                                                                                                               |

{65}------------------------------------------------

| Excel.Worksheet<br>FilteredEventArgs              | Provides information about the worksheet that raised the filter applied event.                                                                                                                                                                                                                                                                                                                                                                     |
|---------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.Worksheet<br>FormatChanged<br>EventArgs     | Provides information about the worksheet format change event.                                                                                                                                                                                                                                                                                                                                                                                      |
| Excel.Worksheet<br>FormulaChanged<br>EventArgs    | Provides information about the worksheet and formulas that raised the formula<br>changed event.                                                                                                                                                                                                                                                                                                                                                    |
| Excel.Worksheet<br>MovedEventArgs                 | Notifies when a worksheet is moved within a workbook.                                                                                                                                                                                                                                                                                                                                                                                              |
|                                                   | If a worksheet is moved from one position within the workbook to another via the<br>Excel UI, then this API will trigger an event. Note that if the position of a worksheet<br>changes as a result of moving a different worksheet, then this event won't trigger<br>for both position changes. This event only triggers for the primary worksheet<br>move, and not any worksheet position changes that occur as a result of that<br>primary move. |
| Excel.Worksheet<br>NameChangedEvent<br>Args       | Provides information about the worksheet whose name has changed.                                                                                                                                                                                                                                                                                                                                                                                   |
| Excel.Worksheet<br>ProtectionChanged<br>EventArgs | Provides information about the worksheet that raised the protection status<br>changed event, which fires when the protection status is updated in a worksheet.                                                                                                                                                                                                                                                                                     |
| Excel.Worksheet<br>ProtectionOptions              | Represents the options in sheet protection.                                                                                                                                                                                                                                                                                                                                                                                                        |
| Excel.WorksheetRow<br>HiddenChanged<br>EventArgs  | Provides information about the worksheet's row hidden change event.                                                                                                                                                                                                                                                                                                                                                                                |
| Excel.WorksheetRow<br>SortedEventArgs             | Provides information about the row-sorted event and its related worksheet.                                                                                                                                                                                                                                                                                                                                                                         |
| Excel.Worksheet<br>SearchCriteria                 | Represents the worksheet search criteria to be used.                                                                                                                                                                                                                                                                                                                                                                                               |
| Excel.Worksheet<br>SelectionChanged<br>EventArgs  | Provides information about the worksheet that raised the selection changed event.                                                                                                                                                                                                                                                                                                                                                                  |
| Excel.Worksheet<br>SingleClickedEvent<br>Args     | Provides information about the left-clicked/tapped event and its related<br>worksheet.                                                                                                                                                                                                                                                                                                                                                             |
| Excel.Worksheet<br>VisibilityChanged              | Provides information about the worksheet whose visibility has changed.                                                                                                                                                                                                                                                                                                                                                                             |

{66}------------------------------------------------

### **Type Aliases**

####  **Expand table**

| Excel.CardLayout             | Represents the layout of a card in card view.                                   |
|------------------------------|---------------------------------------------------------------------------------|
| Excel.CardLayout<br>Section  | Represents the layout of a section of a card in card view.                      |
| Excel.CellControl            | Represents an interactable control inside of a cell.                            |
| Excel.CellValue              | Represents the value in a cell.                                                 |
| Excel.CellValueAnd           | Represents the value and metadata of a property. The metadata applies to the    |
| PropertyMetadata             | property (and not the value), but it is combined with the value in this type.   |
| Excel.CompactLayout          | Represents the layout used when there is limited space to represent the entity. |
| Excel.EntityProperty<br>Type | Represents the value of a property.                                             |
| Excel.ErrorCellValue         | Represents a cell value which contains an error.                                |
| Excel.FunctionCellValue      | Represents a cell value which can be evaluated as a function.                   |
| Excel.ReferencedValue        | Represents the value in a cell.                                                 |

## **Enums**

| Excel.Aggregation            | Aggregation function for the DataPivotHierarchy                      |
|------------------------------|----------------------------------------------------------------------|
| Function                     |                                                                      |
| Excel.ArrowheadLength        |                                                                      |
| Excel.ArrowheadStyle         |                                                                      |
| Excel.ArrowheadWidth         |                                                                      |
| Excel.AutoFillType           | The behavior types when AutoFill is used on a range in the workbook. |
| Excel.Base64Encoding<br>Type | The file type represented by the Base64 encoding.                    |
| Excel.BindingType            |                                                                      |

{67}------------------------------------------------

| Excel.BlockedErrorCell<br>ValueSubType | Represents types of #BLOCKED! errors.                                    |
|----------------------------------------|--------------------------------------------------------------------------|
| Excel.BorderIndex                      |                                                                          |
| Excel.BorderLineStyle                  |                                                                          |
| Excel.BorderWeight                     |                                                                          |
| Excel.BuiltInPivotTable<br>Style       | Represents a built-in PivotTable style                                   |
| Excel.BuiltInSlicerStyle               | Represents a built-in slicer style.                                      |
| Excel.BuiltInStyle                     |                                                                          |
| Excel.BuiltInTableStyle                | Represents a built-in table style.                                       |
| Excel.BusyErrorCell<br>ValueSubType    | Represents types of #BUSY! errors.                                       |
| Excel.CalcErrorCell<br>ValueSubType    | Represents types of #CALC! errors.                                       |
| Excel.CalculationMode                  |                                                                          |
| Excel.CalculationState                 | Represents the state of calculation across the entire Excel application. |
| Excel.CalculationType                  |                                                                          |
| Excel.CellControlType                  | Represents the type of cell control.                                     |
| Excel.CellValueType                    | Represents the types of the CellValue object.                            |
| Excel.ChartAxis<br>CategoryType        | Specifies the type of the category axis.                                 |
| Excel.ChartAxisDisplayUnit             |                                                                          |
| Excel.ChartAxisGroup                   |                                                                          |
| Excel.ChartAxisPosition                |                                                                          |
| Excel.ChartAxisScaleType               |                                                                          |
| Excel.ChartAxisTickLabelPosition       |                                                                          |
| Excel.ChartAxisTickMark                |                                                                          |
| Excel.ChartAxisTime<br>Unit            | Specifies the unit of time for chart axes and data series.               |
| Excel.ChartAxisType                    |                                                                          |

{68}------------------------------------------------

| Excel.ChartBinType              | Specifies the bin type of a histogram chart or pareto chart series.                                                                                                                                                                                                     |  |
|---------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| Excel.ChartBox                  | Represents the quartile calculation type of chart series layout. Only applies to a                                                                                                                                                                                      |  |
| QuartileCalculation             | box and whisker chart.                                                                                                                                                                                                                                                  |  |
| Excel.ChartColorScheme          |                                                                                                                                                                                                                                                                         |  |
| Excel.ChartDataLabelPosition    |                                                                                                                                                                                                                                                                         |  |
| Excel.ChartData<br>SourceType   | Specifies the data source type of the chart series.                                                                                                                                                                                                                     |  |
| Excel.ChartDisplayBlanksAs      |                                                                                                                                                                                                                                                                         |  |
| Excel.ChartErrorBars<br>Include | Represents which parts of the error bar to include.                                                                                                                                                                                                                     |  |
| Excel.ChartErrorBars<br>Type    | Represents the range type for error bars.                                                                                                                                                                                                                               |  |
| Excel.ChartGradient             | Represents the gradient style of a chart series. This is only applicable for region                                                                                                                                                                                     |  |
| Style                           | map charts.                                                                                                                                                                                                                                                             |  |
| Excel.ChartGradient             | Represents the gradient style type of a chart series. This is only applicable for                                                                                                                                                                                       |  |
| StyleType                       | region map charts.                                                                                                                                                                                                                                                      |  |
| Excel.ChartLegendPosition       |                                                                                                                                                                                                                                                                         |  |
| Excel.ChartLineStyle            |                                                                                                                                                                                                                                                                         |  |
| Excel.ChartMapArea              | Represents the mapping level of a chart series. This only applies to region map                                                                                                                                                                                         |  |
| Level                           | charts.                                                                                                                                                                                                                                                                 |  |
| Excel.ChartMapLabel             | Represents the region level of a chart series layout. This only applies to region                                                                                                                                                                                       |  |
| Strategy                        | map charts.                                                                                                                                                                                                                                                             |  |
| Excel.ChartMap                  | Represents the region projection type of a chart series layout. This only applies                                                                                                                                                                                       |  |
| ProjectionType                  | to region map charts.                                                                                                                                                                                                                                                   |  |
| Excel.ChartMarkerStyle          |                                                                                                                                                                                                                                                                         |  |
| Excel.ChartParent               | Represents the parent label strategy of the chart series layout. This only applies                                                                                                                                                                                      |  |
| LabelStrategy                   | to treemap charts                                                                                                                                                                                                                                                       |  |
| Excel.ChartPlotAreaPosition     |                                                                                                                                                                                                                                                                         |  |
| Excel.ChartPlotBy               |                                                                                                                                                                                                                                                                         |  |
| Excel.ChartSeriesBy             | Specifies whether the series are by rows or by columns. In Excel on desktop, the<br>"auto" option will inspect the source data shape to automatically guess whether<br>the data is by rows or columns. In Excel on the web, "auto" will simply default to<br>"columns". |  |

{69}------------------------------------------------

| Excel.ChartSeries<br>Dimension                    | Represents the dimensions when getting values from chart series.        |  |  |
|---------------------------------------------------|-------------------------------------------------------------------------|--|--|
| Excel.ChartSplitType                              |                                                                         |  |  |
| Excel.ChartText<br>HorizontalAlignment            | Represents the horizontal alignment for the specified object.           |  |  |
| Excel.ChartTextVertical<br>Alignment              | Represents the vertical alignment for the specified object.             |  |  |
|                                                   | Excel.ChartTickLabelAlignment                                           |  |  |
| Excel.ChartTitle<br>Position                      | Represents the position of the chart title.                             |  |  |
| Excel.ChartTrendlineType                          |                                                                         |  |  |
| Excel.ChartType                                   |                                                                         |  |  |
| Excel.ChartUnderlineStyle                         |                                                                         |  |  |
| Excel.ClearApplyTo                                |                                                                         |  |  |
| Excel.CloseBehavior                               | Specifies the close behavior for Workbook.close .                       |  |  |
| Excel.Comment<br>ChangeType                       | Represents how the comments in the event were changed.                  |  |  |
| Excel.ConditionalCell<br>ValueOperator            | Represents the operator of the text conditional format type.            |  |  |
| Excel.ConditionalData<br>BarAxisFormat            | Represents the format options for a data bar axis.                      |  |  |
| Excel.ConditionalData<br>BarDirection             | Represents the data bar direction within a cell.                        |  |  |
| Excel.Conditional<br>FormatColorCriterion<br>Type | Represents the types of color criterion for conditional formatting.     |  |  |
| Excel.Conditional<br>FormatDirection              | Represents the direction for a selection.                               |  |  |
| Excel.Conditional<br>FormatIconRuleType           | Represents the types of icon conditional format.                        |  |  |
| Excel.Conditional<br>FormatPresetCriterion        | Represents the criteria of the preset criteria conditional format type. |  |  |
| Excel.Conditional                                 | Represents the types of conditional format values.                      |  |  |

{70}------------------------------------------------

| FormatRuleType                              |                                                                                  |  |
|---------------------------------------------|----------------------------------------------------------------------------------|--|
| Excel.ConditionalFormatType                 |                                                                                  |  |
| Excel.ConditionalIcon<br>CriterionOperator  | Represents the operator for each icon criteria.                                  |  |
| Excel.ConditionalRangeBorderIndex           |                                                                                  |  |
| Excel.ConditionalRangeBorderLineStyle       |                                                                                  |  |
| Excel.ConditionalRangeFontUnderlineStyle    |                                                                                  |  |
| Excel.ConditionalText<br>Operator           | Represents the operator of the text conditional format type.                     |  |
| Excel.ConditionalTop<br>BottomCriterionType | Represents the criteria for the above/below average conditional format type.     |  |
| Excel.ConnectError<br>CellValueSubType      | Represents types of #CONNECT! errors.                                            |  |
| Excel.ConnectorType                         |                                                                                  |  |
| Excel.ContentType                           |                                                                                  |  |
| Excel.DataChangeType                        |                                                                                  |  |
| Excel.DataSourceType                        | Represents a command type of DataConnection                                      |  |
| Excel.DataValidation                        | Represents the data validation error alert style. The default is Stop            |  |
| AlertStyle                                  |                                                                                  |  |
| Excel.DataValidation<br>Operator            | Represents the data validation operator enum.                                    |  |
| Excel.DataValidation<br>Type                | Represents the data validation type enum.                                        |  |
| Excel.DateFilter                            | Enum representing all accepted conditions by which a date filter can be applied. |  |
| Condition                                   | Used to configure the type of PivotFilter that is applied to the field.          |  |
| Excel.DeleteShiftDirection                  |                                                                                  |  |
| Excel.DocumentPropertyItem                  |                                                                                  |  |
| Excel.DocumentPropertyType                  |                                                                                  |  |
| Excel.DocumentTask<br>ChangeAction          | Represents the type of change recorded in the task change record.                |  |
| Excel.DynamicFilterCriteria                 |                                                                                  |  |

{71}------------------------------------------------

| Excel.EntityCard<br>LayoutType          | Types of entity card layouts.                                                                                                                                                                                                                                                                |
|-----------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.EntityCompact<br>LayoutIcons      | The list of icons available for EntityCompactLayout . An icon displays in the Excel<br>UI, either to the left of the title in a cell that contains an entity card, or to the left<br>of the title of a referenced entity inside an entity card. Selecting the icon opens<br>the entity card. |
| Excel.ErrorCellValue<br>Type            | Represents the types of the ErrorCellValue object.                                                                                                                                                                                                                                           |
| Excel.ErrorCodes                        |                                                                                                                                                                                                                                                                                              |
| Excel.EventSource                       |                                                                                                                                                                                                                                                                                              |
| Excel.EventTriggerSource                |                                                                                                                                                                                                                                                                                              |
| Excel.EventType                         |                                                                                                                                                                                                                                                                                              |
| Excel.ExternalErrorCell<br>ValueSubType | Represents types of #EXTERNAL! errors.                                                                                                                                                                                                                                                       |
| Excel.FieldErrorCell<br>ValueSubType    | Represents types of #FIELD! errors.                                                                                                                                                                                                                                                          |
| Excel.FillPattern                       |                                                                                                                                                                                                                                                                                              |
| Excel.FilterDatetimeSpecificity         |                                                                                                                                                                                                                                                                                              |
| Excel.FilterOn                          |                                                                                                                                                                                                                                                                                              |
| Excel.FilterOperator                    |                                                                                                                                                                                                                                                                                              |
| Excel.FunctionCell<br>ValueType         | Represents the types of the FunctionCellValue object.                                                                                                                                                                                                                                        |
| Excel.GeometricShape<br>Type            | Specifies the shape type for a GeometricShape object.                                                                                                                                                                                                                                        |
| Excel.GroupOption                       |                                                                                                                                                                                                                                                                                              |
| Excel.HeaderFooterState                 |                                                                                                                                                                                                                                                                                              |
| Excel.HorizontalAlignment               |                                                                                                                                                                                                                                                                                              |
| Excel.IconSet                           |                                                                                                                                                                                                                                                                                              |
| Excel.ImageFittingMode                  |                                                                                                                                                                                                                                                                                              |
| Excel.InsertShift                       | Determines the direction in which existing cells will be shifted to accommodate                                                                                                                                                                                                              |
| Direction                               | what is being inserted.                                                                                                                                                                                                                                                                      |
| Excel.KeyboardDirection                 |                                                                                                                                                                                                                                                                                              |

{72}------------------------------------------------

| Excel.LabelFilter<br>Condition                  | Enum representing all accepted conditions by which a label filter can be applied.<br>Used to configure the type of PivotFilter that is applied to the field.<br>PivotFilter.criteria.exclusive can be set to true to invert many of these<br>conditions. |
|-------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.LinkedDataType<br>RefreshMode             | Representation of a refresh mode.                                                                                                                                                                                                                        |
| Excel.LinkedDataTypeState                       |                                                                                                                                                                                                                                                          |
| Excel.LinkedEntity<br>DataDomainRefresh<br>Mode | Represents the refresh mode setting for the LinkedEntityCellValue objects of a<br>LinkedEntityDataDomain .                                                                                                                                               |
| Excel.LoadToType                                | An enum that specifies the query load to destination.                                                                                                                                                                                                    |
| Excel.NamedItemScope                            |                                                                                                                                                                                                                                                          |
| Excel.NamedItemType                             |                                                                                                                                                                                                                                                          |
| Excel.NameErrorCell<br>ValueSubType             | Represents types of #NAME? errors.                                                                                                                                                                                                                       |
| Excel.NotAvailable<br>ErrorCellValueSub<br>Type | Represents types of #N/A errors.                                                                                                                                                                                                                         |
| Excel.NumberFormat<br>Category                  | Represents a category of number formats.                                                                                                                                                                                                                 |
| Excel.NumErrorCell<br>ValueSubType              | Represents types of #NUM! errors.                                                                                                                                                                                                                        |
| Excel.PageOrientation                           |                                                                                                                                                                                                                                                          |
| Excel.PaperType                                 |                                                                                                                                                                                                                                                          |
| Excel.PictureFormat                             | The format of the image.                                                                                                                                                                                                                                 |
| Excel.PivotAxis                                 | Represents the axis from which to get the PivotItems.                                                                                                                                                                                                    |
| Excel.PivotFilterTop<br>BottomCriterion         | Represents the criteria for the top/bottom values filter.                                                                                                                                                                                                |
| Excel.PivotFilterType                           | A simple enum that represents a type of filter for a PivotField.                                                                                                                                                                                         |
| Excel.PivotLayoutType                           |                                                                                                                                                                                                                                                          |
| Excel.PivotTableDate<br>GroupBy                 | Represents the DateTime Grouping condition.                                                                                                                                                                                                              |
| Excel.Placement                                 | Specifies the way that an object is attached to its underlying cells.                                                                                                                                                                                    |

{73}------------------------------------------------

| Excel.PrintComments                |                                                                                   |  |
|------------------------------------|-----------------------------------------------------------------------------------|--|
| Excel.PrintErrorType               |                                                                                   |  |
| Excel.PrintMarginUnit              |                                                                                   |  |
| Excel.PrintOrder                   |                                                                                   |  |
| Excel.ProtectionSelectionMode      |                                                                                   |  |
| Excel.PythonMarshal<br>Mode        | Specifies what an =PY formula returns, such as an Excel value or a Python object. |  |
| Excel.QueryError                   | An enum that specifies the query load error message.                              |  |
| Excel.RangeCopyType                |                                                                                   |  |
| Excel.RangeUnderlineStyle          |                                                                                   |  |
| Excel.RangeValueType               |                                                                                   |  |
| Excel.ReadingOrder                 |                                                                                   |  |
| Excel.ReferenceValue<br>Type       | Represents the types of the ReferenceValue object.                                |  |
| Excel.RefErrorCell<br>ValueSubType | Represents types of #REF! errors.                                                 |  |
| Excel.RibbonTab                    |                                                                                   |  |
| Excel.RowHiddenChangeType          |                                                                                   |  |
| Excel.SaveBehavior                 | Specifies the save behavior for Workbook.save .                                   |  |
| Excel.SearchDirection              | Specifies the search direction.                                                   |  |
| Excel.ShapeAutoSize                | Determines the type of automatic sizing allowed.                                  |  |
| Excel.ShapeFillType                | Specifies a shape's fill type.                                                    |  |
| Excel.ShapeFont<br>UnderlineStyle  | The type of underline applied to a font.                                          |  |
| Excel.ShapeLineDash<br>Style       | The dash style for a line.                                                        |  |
| Excel.ShapeLineStyle               | The style for a line.                                                             |  |
| Excel.ShapeScaleFrom               | Specifies which part of the shape retains its position when the shape is scaled.  |  |
| Excel.ShapeScaleType               | Specifies whether the shape is scaled relative to its original or current size.   |  |

{74}------------------------------------------------

| Excel.ShapeText<br>HorizontalAlignment | Specifies the horizontal alignment for the text frame in a shape.                |  |
|----------------------------------------|----------------------------------------------------------------------------------|--|
| Excel.ShapeText<br>HorizontalOverflow  | Specifies the horizontal overflow for the text frame in a shape.                 |  |
| Excel.ShapeText<br>Orientation         | Specifies the orientation for the text frame in a shape.                         |  |
| Excel.ShapeText<br>ReadingOrder        | Specifies the reading order for the text frame in a shape.                       |  |
| Excel.ShapeText<br>VerticalAlignment   | Specifies the vertical alignment for the text frame in a shape.                  |  |
| Excel.ShapeText<br>VerticalOverflow    | Specifies the vertical overflow for the text frame in a shape.                   |  |
| Excel.ShapeType                        | Specifies the type of a shape.                                                   |  |
| Excel.ShapeZOrder                      | Specifies where in the z-order a shape should be moved relative to other shapes. |  |
| Excel.SheetVisibility                  |                                                                                  |  |
| Excel.Show<br>AsCalculation            | The ShowAs calculation function for the DataPivotField.                          |  |
| Excel.SlicerSortType                   | Specifies the slicer sort behavior for Slicer.sortBy .                           |  |
| Excel.SortBy                           | Represents the sort direction.                                                   |  |
| Excel.SortDataOption                   |                                                                                  |  |
| Excel.SortMethod                       | Represents the ordering method to be used when sorting Chinese characters.       |  |
| Excel.SortOn                           | Represents the part of the cell used as the sorting criteria.                    |  |
| Excel.SortOrientation                  |                                                                                  |  |
| Excel.SpecialCellType                  |                                                                                  |  |
| Excel.SpecialCellValueType             |                                                                                  |  |
| Excel.SpillErrorCell<br>ValueSubType   | Represents types of #SPILL! errors.                                              |  |
| Excel.SubtotalLocationType             |                                                                                  |  |
| Excel.TimeoutErrorCell<br>ValueSubType | Represents types of #TIMEOUT! errors.                                            |  |
| Excel.TopBottom                        | A simple enum for top/bottom filters to select whether to filter by the top N or |  |
| SelectionType                          | bottom N percent, number, or sum of values.                                      |  |

{75}------------------------------------------------

| Excel.ValueErrorCell<br>ValueSubType | Represents types of #VALUE! errors.                                                                                                                                                                                                          |
|--------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.ValueFilter<br>Condition       | Enum representing all accepted conditions by which a value filter can be applied.<br>Used to configure the type of PivotFilter that is applied to the field.<br>PivotFilter.exclusive can be set to true to invert many of these conditions. |
| Excel.VerticalAlignment              |                                                                                                                                                                                                                                              |
| Excel.WorkbookLinks<br>RefreshMode   | Represents the refresh mode of the workbook links.                                                                                                                                                                                           |
| Excel.Worksheet                      | The position of a worksheet relative to another worksheet or the entire                                                                                                                                                                      |
| PositionType                         | worksheet collection.                                                                                                                                                                                                                        |

### **Functions**

| Excel.create<br>Workbook(base64)                          | Creates and opens a new workbook. Optionally, the workbook can be pre<br>populated with a Base64-encoded .xlsx file. The extensionHardening Windows<br>registry key affects the base64File param. The file extension defined by the<br>param must match the real file type of the file. If extensionHardening is set to<br>deny mismatches and the file extension does not match the real file type, this<br>API throws the following error: "This operation is not allowed due to the<br>extension hardening policy." Note: Macros can be a security risk. If this API is<br>used to create a workbook that includes a macro, the add-in user will be<br>prompted with a "Trust this add-in?" dialog in the Excel UI. The user must<br>select the "Trust add-in" button to proceed.<br>[ API set: ExcelApi 1.8 ] |
|-----------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.getDataCommon<br>Postprocess(response,<br>callArgs) |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Excel.postprocess<br>Binding<br>Descriptor(response)      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Excel.run(batch)                                          | Executes a batch script that performs actions on the Excel object model, using<br>a new RequestContext. When the promise is resolved, any tracked objects that<br>were automatically allocated during execution will be released.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Excel.run(object, batch)                                  | Executes a batch script that performs actions on the Excel object model, using<br>the RequestContext of a previously-created API object. When the promise is<br>resolved, any tracked objects that were automatically allocated during<br>execution will be released.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

{76}------------------------------------------------

| Excel.run(objects, batch) | Executes a batch script that performs actions on the Excel object model, using<br>the RequestContext of previously-created API objects.                                                                                                                               |
|---------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Excel.run(options, batch) | Executes a batch script that performs actions on the Excel object model, using<br>the RequestContext of a previously-created API object. When the promise is<br>resolved, any tracked objects that were automatically allocated during<br>execution will be released. |
| Excel.run(context, batch) | Executes a batch script that performs actions on the Excel object model, using<br>the RequestContext of a previously-created object. When the promise is<br>resolved, any tracked objects that were automatically allocated during<br>execution will be released.     |

### **Function Details**

### **Excel.createWorkbook(base64)**

Creates and opens a new workbook. Optionally, the workbook can be pre-populated with a Base64-encoded .xlsx file. The extensionHardening Windows registry key affects the base64File param. The file extension defined by the param must match the real file type of the file. If extensionHardening is set to deny mismatches and the file extension does not match the real file type, this API throws the following error: "This operation is not allowed due to the extension hardening policy." Note: Macros can be a security risk. If this API is used to create a workbook that includes a macro, the add-in user will be prompted with a "Trust this add-in?" dialog in the Excel UI. The user must select the "Trust add-in" button to proceed.

#### [ [API set: ExcelApi 1.8](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/excel-api-requirement-sets) ]

#### TypeScript

export function createWorkbook(base64?: string): Promise<void>;

#### **Parameters**

**base64** string

#### **Returns**

Promise<void>

#### **Examples**

{77}------------------------------------------------

```
TypeScript
const myFile = <HTMLInputElement>document.getElementById("file");
const reader = new FileReader();
reader.onload = (event) => {
 Excel.run((context) => {
 // Remove the metadata before the base64-encoded string.
 const startIndex = reader.result.toString().indexOf("base64,");
 const mybase64 = reader.result.toString().substr(startIndex + 7);
 Excel.createWorkbook(mybase64);
 return context.sync();
 });
};
// Read in the file as a data URL so we can parse the base64-encoded string.
reader.readAsDataURL(myFile.files[0]);
```
#### **Excel.getDataCommonPostprocess(response, callArgs)**

TypeScript

export function getDataCommonPostprocess(response: any, callArgs: any): any;

#### **Parameters**

**response** any

**callArgs** any

#### **Returns**

any

#### **Excel.postprocessBindingDescriptor(response)**

TypeScript export function postprocessBindingDescriptor(response: any): any;

#### **Parameters**

**response** any

{78}------------------------------------------------

#### **Returns**

any

### **Excel.run(batch)**

Executes a batch script that performs actions on the Excel object model, using a new RequestContext. When the promise is resolved, any tracked objects that were automatically allocated during execution will be released.

TypeScript

```
export function run<T>(batch: (context: Excel.RequestContext) => Promise<T>): 
Promise<T>;
```
#### **Parameters**

**batch** (context: [Excel.RequestContext](https://learn.microsoft.com/en-us/javascript/api/excel/excel.requestcontext?view=excel-js-preview)) => Promise<T>

A function that takes in a RequestContext and returns a promise (typically, just the result of "context.sync()"). The context parameter facilitates requests to the Excel application. Since the Office add-in and the Excel application run in two different processes, the RequestContext is required to get access to the Excel object model from the add-in.

#### **Returns**

Promise<T>

### **Excel.run(object, batch)**

Executes a batch script that performs actions on the Excel object model, using the RequestContext of a previously-created API object. When the promise is resolved, any tracked objects that were automatically allocated during execution will be released.

TypeScript

```
export function run<T>(object: OfficeExtension.ClientObject, batch: (context:
Excel.RequestContext) => Promise<T>): Promise<T>;
```
#### **Parameters**

**object** [OfficeExtension.ClientObject](https://learn.microsoft.com/en-us/javascript/api/office/officeextension.clientobject?view=excel-js-preview)

{79}------------------------------------------------

A previously-created API object. The batch will use the same RequestContext as the passedin object, which means that any changes applied to the object will be picked up by "context.sync()".

#### **batch** (context: [Excel.RequestContext](https://learn.microsoft.com/en-us/javascript/api/excel/excel.requestcontext?view=excel-js-preview)) => Promise<T>

A function that takes in a RequestContext and returns a promise (typically, just the result of "context.sync()"). The context parameter facilitates requests to the Excel application. Since the Office add-in and the Excel application run in two different processes, the RequestContext is required to get access to the Excel object model from the add-in.

#### **Returns**

Promise<T>

#### **Excel.run(objects, batch)**

Executes a batch script that performs actions on the Excel object model, using the RequestContext of previously-created API objects.

TypeScript

```
export function run<T>(objects: OfficeExtension.ClientObject[], batch:
(context: Excel.RequestContext) => Promise<T>): Promise<T>;
```
#### **Parameters**

#### **objects** [OfficeExtension.ClientObject](https://learn.microsoft.com/en-us/javascript/api/office/officeextension.clientobject?view=excel-js-preview)[]

An array of previously-created API objects. The array will be validated to make sure that all of the objects share the same context. The batch will use this shared RequestContext, which means that any changes applied to these objects will be picked up by "context.sync()".

#### **batch** (context: [Excel.RequestContext](https://learn.microsoft.com/en-us/javascript/api/excel/excel.requestcontext?view=excel-js-preview)) => Promise<T>

A function that takes in a RequestContext and returns a promise (typically, just the result of "context.sync()"). The context parameter facilitates requests to the Excel application. Since the Office add-in and the Excel application run in two different processes, the RequestContext is required to get access to the Excel object model from the add-in.

#### **Returns**

Promise<T>

{80}------------------------------------------------

#### **Excel.run(options, batch)**

Executes a batch script that performs actions on the Excel object model, using the RequestContext of a previously-created API object. When the promise is resolved, any tracked objects that were automatically allocated during execution will be released.

TypeScript

export function run<T>(options: Excel.RunOptions, batch: (context: Excel.RequestContext) => Promise<T>): Promise<T>;

#### **Parameters**

#### **options** [Excel.RunOptions](https://learn.microsoft.com/en-us/javascript/api/excel/excel.runoptions?view=excel-js-preview)

The additional options for this Excel.run which specify previous objects, whether to delay the request for cell edit, session info, etc.

#### **batch** (context: [Excel.RequestContext](https://learn.microsoft.com/en-us/javascript/api/excel/excel.requestcontext?view=excel-js-preview)) => Promise<T>

A function that takes in a RequestContext and returns a promise (typically, just the result of "context.sync()"). The context parameter facilitates requests to the Excel application. Since the Office add-in and the Excel application run in two different processes, the RequestContext is required to get access to the Excel object model from the add-in.

#### **Returns**

Promise<T>

### **Excel.run(context, batch)**

Executes a batch script that performs actions on the Excel object model, using the RequestContext of a previously-created object. When the promise is resolved, any tracked objects that were automatically allocated during execution will be released.

TypeScript

```
export function run<T>(context: OfficeExtension.ClientRequestContext, batch:
(context: Excel.RequestContext) => Promise<T>): Promise<T>;
```
#### **Parameters**

**context** [OfficeExtension.ClientRequestContext](https://learn.microsoft.com/en-us/javascript/api/office/officeextension.clientrequestcontext?view=excel-js-preview)

{81}------------------------------------------------

A previously-created object. The batch will use the same RequestContext as the passed-in object, which means that any changes applied to the object will be picked up by "context.sync()".

#### **batch** (context: [Excel.RequestContext](https://learn.microsoft.com/en-us/javascript/api/excel/excel.requestcontext?view=excel-js-preview)) => Promise<T>

A function that takes in a RequestContext and returns a promise (typically, just the result of "context.sync()"). The context parameter facilitates requests to the Excel application. Since the Office add-in and the Excel application run in two different processes, the RequestContext is required to get access to the Excel object model from the add-in.

#### **Returns**

Promise<T>

{82}------------------------------------------------

# **Excel JavaScript object model in Office Add-ins**

Article  03/21/2023

This article describes how to use the Excel JavaScript API to build add-ins for Excel 2016 or later. It introduces core concepts that are fundamental to using the API and provides guidance for performing specific tasks such as reading or writing to a large range, updating all cells in range, and more.

#### ) **Important**

See **Using the application-specific API model** to learn about the asynchronous nature of the Excel APIs and how they work with the workbook.

## **Office.js APIs for Excel**

An Excel add-in interacts with objects in Excel by using the Office JavaScript API, which includes two JavaScript object models:

- **Excel JavaScript API**: Introduced with Office 2016, the Excel JavaScript API provides strongly-typed Excel objects that you can use to access worksheets, ranges, tables, charts, and more.
- **Common API**: Introduced with Office 2013, the Common API enables you to access features such as UI, dialogs, and client settings that are common across multiple types of Office applications. The limited functionality for Excel interaction in the Common API has been replaced by the Excel JavaScript API.

While you'll likely use the Excel JavaScript API to develop the majority of functionality, you'll also use objects in the Common API. For example:

- [Context:](https://learn.microsoft.com/en-us/javascript/api/office/office.context) The Context object represents the runtime environment of the add-in and provides access to key objects of the API. It consists of workbook configuration details such as contentLanguage and officeTheme and also provides information about the add-in's runtime environment such as host and platform . Additionally, it provides the requirements.isSetSupported() method, which you can use to check whether the specified requirement set is supported by the Excel application where the add-in is running.

{83}------------------------------------------------

- [Document:](https://learn.microsoft.com/en-us/javascript/api/office/office.document) The Document object provides the getFileAsync() method, which you can use to download the Excel file where the add-in is running.
The following image illustrates when you might use the Excel JavaScript API or the Common APIs.

| Excel API                 |             | Common API                     |         |                     |                                |
|---------------------------|-------------|--------------------------------|---------|---------------------|--------------------------------|
| Limited to Excel objects, |             | Shared objects across multiple |         |                     |                                |
| such as:                  |             | host applications, such as:    |         |                     |                                |
|                           |             |                                |         |                     |                                |
| Cells                     | Worksheets  | Charts                         | Dialogs | Document<br>objects | Context/Runtime<br>environment |
| =SUM(A1:A5)               | 1<br>Sheetl |                                |         |                     |                                |

## **Excel-specific object model**

To understand the Excel APIs, you must understand how the components of a workbook are related to one another.

- A **Workbook** contains one or more **Worksheets**.
- A **Worksheet** contains collections of those data objects that are present in the individual sheet, and gives access to cells through **Range** objects.
- A **Range** represents a group of contiguous cells.
- **Ranges** are used to create and place **Tables**, **Charts**, **Shapes**, and other data visualization or organization objects.
- **Workbooks** contain collections of some of those data objects (such as **Tables**) for the entire **Workbook**.

#### 7 **Note**

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, the Excel JavaScript API defines all Excel cells as Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API. A single Range object can also contain multiple contiguous cells. See **Work with cells using the Excel JavaScript API** to learn more.

{84}------------------------------------------------

#### **Ranges**

A range is a group of contiguous cells in the workbook. Add-ins typically use A1-style notation (e.g. **B3** for the single cell in column **B** and row **3** or **C2:F4** for the cells from columns **C** through **F** and rows **2** through **4**) to define ranges.

Ranges have three core properties: values , formulas , and format . These properties get or set the cell values, formulas to be evaluated, and the visual formatting of the cells.

#### **Range sample**

The following sample shows how to create sales records. This function uses Range objects to set the values, formulas, and formats.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 // Create the headers and format them to stand out.
 let headers = [
 ["Product", "Quantity", "Unit Price", "Totals"]
 ];
 let headerRange = sheet.getRange("B2:E2");
 headerRange.values = headers;
 headerRange.format.fill.color = "#4472C4";
 headerRange.format.font.color = "white";
 // Create the product data rows.
 let productData = [
 ["Almonds", 6, 7.5],
 ["Coffee", 20, 34.5],
 ["Chocolate", 10, 9.56],
 ];
 let dataRange = sheet.getRange("B3:D5");
 dataRange.values = productData;
 // Create the formulas to total the amounts sold.
 let totalFormulas = [
 ["=C3 * D3"],
 ["=C4 * D4"],
 ["=C5 * D5"],
 ["=SUM(E3:E5)"]
 ];
 let totalRange = sheet.getRange("E3:E6");
 totalRange.formulas = totalFormulas;
 totalRange.format.font.bold = true;
 // Display the totals as US dollar amounts.
 totalRange.numberFormat = [["$0.00"]];
```

{85}------------------------------------------------

```
 await context.sync();
});
```
This sample creates the following data in the current worksheet.

|   | A | B         | C  | D                            | E       |
|---|---|-----------|----|------------------------------|---------|
| 1 |   |           |    |                              |         |
|  |   | Product   |    | Quantity   Unit Price Totals |         |
| 3 |   | Almonds   | 6  | 7.5                          | $45.00  |
| 4 |   | Coffee    | 20 | 34.5                         | $690.00 |
| 5 |   | Chocolate | 10 | 9.56                         | $95.60  |
| 6 |   |           |    |                              | $830.60 |
|   |   |           |    |                              |         |

For more information, see Set and get range values, text, or formulas using the Excel JavaScript API.

### **Charts, tables, and other data objects**

The Excel JavaScript APIs can create and manipulate the data structures and visualizations within Excel. Tables and charts are two of the more commonly used objects, but the APIs support PivotTables, shapes, images, and more.

#### **Creating a table**

JavaScript

Create tables by using data-filled ranges. Formatting and table controls (such as filters) are automatically applied to the range.

The following sample creates a table using the ranges from the previous sample.

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 sheet.tables.add("B2:E5", true);
 await context.sync();
});
```
Using this sample code on the worksheet with the previous data creates the following table.

{86}------------------------------------------------

|   | A | B         | C  | D                                        | E       |  |
|---|---|-----------|----|------------------------------------------|---------|--|
| 1 |   |           |    |                                          |         |  |
|  |   |           |    | Product > Quantity > Unit Price > Totals |         |  |
| 3 |   | Almonds   | 6  | 7.5                                      | $45.00  |  |
|  |   | Coffee    | 20 | 34.5                                     | $690.00 |  |
|  |   | Chocolate | 10 | 9.56                                     | $95.60  |  |
| 6 |   |           |    |                                          | $830.60 |  |

For more information, see Work with tables using the Excel JavaScript API.

#### **Creating a chart**

Create charts to visualize the data in a range. The APIs support dozens of chart varieties, each of which can be customized to suit your needs.

The following sample creates a simple column chart for three items and places it 100 pixels below the top of the worksheet.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let chart = sheet.charts.add(Excel.ChartType.columnStacked,
sheet.getRange("B3:C5"));
 chart.top = 100;
 await context.sync();
});
```
Running this sample on the worksheet with the previous table creates the following chart.

For more information, see Work with charts using the Excel JavaScript API.

{87}------------------------------------------------

## **See also**

- Build your first Excel add-in
- [Excel add-ins code samples](https://developer.microsoft.com/office/gallery/?filterBy=Samples,Excel)
- Excel JavaScript API performance optimization
- Excel JavaScript API reference

{88}------------------------------------------------

# **Blank and null values in Excel add-ins**

Article  03/22/2022

null and empty strings have special implications in the Excel JavaScript APIs. They're used to represent empty cells, no formatting, or default values. This section details the use of null and empty string when getting and setting properties.

## **null input in 2-D Array**

In Excel, a range is represented by a 2-D array, where the first dimension is rows and the second dimension is columns. To set values, number format, or formula for only specific cells within a range, specify the values, number format, or formula for those cells in the 2-D array, and specify null for all other cells in the 2-D array.

For example, to update the number format for only one cell within a range, and retain the existing number format for all other cells in the range, specify the new number format for the cell to update, and specify null for all other cells. The following code snippet sets a new number format for the fourth cell in the range, and leaves the number format unchanged for the first three cells in the range.

JavaScript

range.values = [['Eurasia', '29.96', '0.25', '15-Feb' ]]; range.numberFormat = [[null, null, null, 'm/d/yyyy;@']];

## **null input for a property**

null is not a valid input for single property. For example, the following code snippet is not valid, as the values property of the range cannot be set to null .

JavaScript range.values = null; // This is not a valid snippet.

Likewise, the following code snippet is not valid, as null is not a valid value for the color property.

JavaScript

range.format.fill.color = null; // This is not a valid snippet.

{89}------------------------------------------------

## **null property values in the response**

Formatting properties such as size and color will contain null values in the response when different values exist in the specified range. For example, if you retrieve a range and load its format.font.color property:

- If all cells in the range have the same font color, range.format.font.color specifies that color.
- If multiple font colors are present within the range, range.format.font.color is null .

# **Blank input for a property**

When you specify a blank value for a property (i.e., two quotation marks with no space in-between '' ), it will be interpreted as an instruction to clear or reset the property. For example:

- If you specify a blank value for the values property of a range, the content of the range is cleared.
- If you specify a blank value for the numberFormat property, the number format is reset to General .
- If you specify a blank value for the formula property and formulaLocale property, the formula values are cleared.

## **Blank property values in the response**

For read operations, a blank property value in the response (i.e., two quotation marks with no space in-between '' ) indicates that cell contains no data or value. In the first example below, the first and last cell in the range contain no data. In the second example, the first two cells in the range do not contain a formula.

```
JavaScript
```

```
range.values = [['', 'some', 'data', 'in', 'other', 'cells', '']];
```
JavaScript

```
range.formula = [['', '', '=Rand()']];
```

{90}------------------------------------------------

# **Call built-in Excel worksheet functions**

Article  03/22/2022

This article explains how to call built-in Excel worksheet functions such as VLOOKUP and SUM using the Excel JavaScript API. It also provides the full list of built-in Excel worksheet functions that can be called using the Excel JavaScript API.

#### 7 **Note**

For information about how to create *custom functions* in Excel using the Excel JavaScript API, see **Create custom functions in Excel**.

## **Calling a worksheet function**

The following code snippet shows how to call a worksheet function, where sampleFunction() is a placeholder that should be replaced with the name of the function to call and the input parameters that the function requires. The value property of the FunctionResult object that's returned by a worksheet function contains the result of the specified function. As this example shows, you must load the value property of the FunctionResult object before you can read it. In this example, the result of the function is simply being written to the console.

```
JavaScript
await Excel.run(async (context) => {
 let functionResult = context.workbook.functions.sampleFunction();
 functionResult.load('value');
 await context.sync();
 console.log('Result of the function: ' + functionResult.value);
});
```
#### **Tip**

See the **Supported worksheet functions** section of this article for a list of functions that can be called using the Excel JavaScript API.

## **Sample data**

{91}------------------------------------------------

The following image shows a table in an Excel worksheet that contains sales data for various types of tools over a three month period. Each number in the table represents the number of units sold for a specific tool in a specific month. The examples that follow will show how to apply built-in worksheet functions to this data.

|       | IULL   | C   | ><br>JA |         |   |
|-------|--------|-----|---------|---------|---|
|       | A      | B   | C       | D       | F |
| 1     |        | Nov | Dec     | January |   |
|       | Hammer | 23  | 18      | 17      |   |
|       | Wrench | 12  | 11      | 14      |   |
| 2 w N | Saw    | 5   | 15      | 19      |   |
| 5     |        |     |         |         |   |

## **Example 1: Single function**

The following code sample applies the VLOOKUP function to the sample data described previously to identify the number of wrenches sold in November.

```
JavaScript
await Excel.run(async (context) => {
 let range =
context.workbook.worksheets.getItem("Sheet1").getRange("A1:D4");
 let unitSoldInNov = context.workbook.functions.vlookup("Wrench", range, 
2, false);
 unitSoldInNov.load('value');
 await context.sync();
 console.log(' Number of wrenches sold in November = ' +
unitSoldInNov.value);
});
```
### **Example 2: Nested functions**

The following code sample applies the VLOOKUP function to the sample data described previously to identify the number of wrenches sold in November and the number of wrenches sold in December, and then applies the SUM function to calculate the total number of wrenches sold during those two months.

As this example shows, when one or more function calls are nested within another function call, you only need to load the final result that you subsequently want to read (in this example, sumOfTwoLookups ). Any intermediate results (in this example, the result of each VLOOKUP function) will be calculated and used to calculate the final result.

{92}------------------------------------------------

```
JavaScript
```

```
await Excel.run(async (context) => {
 let range =
context.workbook.worksheets.getItem("Sheet1").getRange("A1:D4");
 let sumOfTwoLookups = context.workbook.functions.sum(
 context.workbook.functions.vlookup("Wrench", range, 2, false),
 context.workbook.functions.vlookup("Wrench", range, 3, false)
 );
 sumOfTwoLookups.load('value');
 await context.sync();
 console.log(' Number of wrenches sold in November and December = ' +
sumOfTwoLookups.value);
});
```
## **Supported worksheet functions**

The following built-in Excel worksheet functions can be called using the Excel JavaScript API.

| Function           | Description                                                                                |
|--------------------|--------------------------------------------------------------------------------------------|
| ABS function       | Returns the absolute value of a number                                                     |
| ACCRINT function   | Returns the accrued interest for a security that pays periodic<br>interest                 |
| ACCRINTM function  | Returns the accrued interest for a security that pays interest at<br>maturity              |
| ACOS function      | Returns the arccosine of a number                                                          |
| ACOSH function     | Returns the inverse hyperbolic cosine of a number                                          |
| ACOT function      | Returns the arccotangent of a number                                                       |
| ACOTH function     | Returns the hyperbolic arccotangent of a number                                            |
| AMORDEGRC function | Returns the depreciation for each accounting period by using a<br>depreciation coefficient |
| AMORLINC function  | Returns the depreciation for each accounting period                                        |
| AND function       | Returns TRUE if all of its arguments are true                                              |
| ARABIC function    | Converts a Roman number to Arabic, as a number                                             |

{93}------------------------------------------------

| Function            | Description                                                                                                                      |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------|
| AREAS function      | Returns the number of areas in a reference                                                                                       |
| ASC function        | Changes full-width (double-byte) English letters or katakana within<br>a character string to half-width (single-byte) characters |
| ASIN function       | Returns the arcsine of a number                                                                                                  |
| ASINH function      | Returns the inverse hyperbolic sine of a number                                                                                  |
| ATAN function       | Returns the arctangent of a number                                                                                               |
| ATAN2 function      | Returns the arctangent from x- and y-coordinates                                                                                 |
| ATANH function      | Returns the inverse hyperbolic tangent of a number                                                                               |
| AVEDEV function     | Returns the average of the absolute deviations of data points from<br>their mean                                                 |
| AVERAGE function    | Returns the average of its arguments                                                                                             |
| AVERAGEA function   | Returns the average of its arguments, including numbers, text, and<br>logical values                                             |
| AVERAGEIF function  | Returns the average (arithmetic mean) of all the cells in a range<br>that meet a given criteria                                  |
| AVERAGEIFS function | Returns the average (arithmetic mean) of all cells that meet<br>multiple criteria                                                |
| BAHTTEXT function   | Converts a number to text, using the  (baht) currency format                                                                    |
| BASE function       | Converts a number into a text representation with the given radix<br>(base)                                                      |
| BESSELI function    | Returns the modified Bessel function In(x)                                                                                       |
| BESSELJ function    | Returns the Bessel function Jn(x)                                                                                                |
| BESSELK function    | Returns the modified Bessel function Kn(x)                                                                                       |
| BESSELY function    | Returns the Bessel function Yn(x)                                                                                                |
| BETA.DIST function  | Returns the beta cumulative distribution function                                                                                |
| BETA.INV function   | Returns the inverse of the cumulative distribution function for a<br>specified beta distribution                                 |
| BIN2DEC function    | Converts a binary number to decimal                                                                                              |
| BIN2HEX function    | Converts a binary number to hexadecimal                                                                                          |

{94}------------------------------------------------

| Function                 | Description                                                                                                                                           |
|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| BIN2OCT function         | Converts a binary number to octal                                                                                                                     |
| BINOM.DIST function      | Returns the individual term binomial distribution probability                                                                                         |
| BINOM.DIST.RANGE         | Returns the probability of a trial result using a binomial                                                                                            |
| function                 | distribution                                                                                                                                          |
| BINOM.INV function       | Returns the smallest value for which the cumulative binomial<br>distribution is less than or equal to a criterion value                               |
| BITAND function          | Returns a 'Bitwise And' of two numbers                                                                                                                |
| BITLSHIFT function       | Returns a value number shifted left by shift_amount bits                                                                                              |
| BITOR function           | Returns a bitwise OR of 2 numbers                                                                                                                     |
| BITRSHIFT function       | Returns a value number shifted right by shift_amount bits                                                                                             |
| BITXOR function          | Returns a bitwise 'Exclusive Or' of two numbers                                                                                                       |
| CEILING.MATH,            | Rounds a number up, to the nearest integer or to the nearest                                                                                          |
| ECMA_CEILING functions   | multiple of significance                                                                                                                              |
| CEILING.PRECISE function | Rounds a number the nearest integer or to the nearest multiple of<br>significance. Regardless of the sign of the number, the number is<br>rounded up. |
| CHAR function            | Returns the character specified by the code number                                                                                                    |
| CHISQ.DIST function      | Returns the cumulative beta probability density function                                                                                              |
| CHISQ.DIST.RT function   | Returns the one-tailed probability of the chi-squared distribution                                                                                    |
| CHISQ.INV function       | Returns the cumulative beta probability density function                                                                                              |
| CHISQ.INV.RT function    | Returns the inverse of the one-tailed probability of the chi<br>squared distribution                                                                  |
| CHOOSE function          | Chooses a value from a list of values                                                                                                                 |
| CLEAN function           | Removes all nonprintable characters from text                                                                                                         |
| CODE function            | Returns a numeric code for the first character in a text string                                                                                       |
| COLUMNS function         | Returns the number of columns in a reference                                                                                                          |
| COMBIN function          | Returns the number of combinations for a given number of<br>objects                                                                                   |
| COMBINA function         | Returns the number of combinations with repetitions for a given<br>number of items                                                                    |

{95}------------------------------------------------

| Function                    | Description                                                                                  |
|-----------------------------|----------------------------------------------------------------------------------------------|
| COMPLEX function            | Converts real and imaginary coefficients into a complex number                               |
| CONCATENATE function        | Joins several text items into one text item                                                  |
| CONFIDENCE.NORM<br>function | Returns the confidence interval for a population mean                                        |
| CONFIDENCE.T function       | Returns the confidence interval for a population mean, using a<br>Student's t distribution   |
| CONVERT function            | Converts a number from one measurement system to another                                     |
| COS function                | Returns the cosine of a number                                                               |
| COSH function               | Returns the hyperbolic cosine of a number                                                    |
| COT function                | Returns the cotangent of an angle                                                            |
| COTH function               | Returns the hyperbolic cotangent of a number                                                 |
| COUNT function              | Counts how many numbers are in the list of arguments                                         |
| COUNTA function             | Counts how many values are in the list of arguments                                          |
| COUNTBLANK function         | Counts the number of blank cells within a range                                              |
| COUNTIF function            | Counts the number of cells within a range that meet the given<br>criteria                    |
| COUNTIFS function           | Counts the number of cells within a range that meet multiple<br>criteria                     |
| COUPDAYBS function          | Returns the number of days from the beginning of the coupon<br>period to the settlement date |
| COUPDAYS function           | Returns the number of days in the coupon period that contains<br>the settlement date         |
| COUPDAYSNC function         | Returns the number of days from the settlement date to the next<br>coupon date               |
| COUPNCD function            | Returns the next coupon date after the settlement date                                       |
| COUPNUM function            | Returns the number of coupons payable between the settlement<br>date and maturity date       |
| COUPPCD function            | Returns the previous coupon date before the settlement date                                  |
| CSC function                | Returns the cosecant of an angle                                                             |
| CSCH function               | Returns the hyperbolic cosecant of an angle                                                  |

{96}------------------------------------------------

| Function           | Description                                                                                                                                          |
|--------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|
| CUMIPMT function   | Returns the cumulative interest paid between two periods                                                                                             |
| CUMPRINC function  | Returns the cumulative principal paid on a loan between two<br>periods                                                                               |
| DATE function      | Returns the serial number of a particular date                                                                                                       |
| DATEVALUE function | Converts a date in the form of text to a serial number                                                                                               |
| DAVERAGE function  | Returns the average of selected database entries                                                                                                     |
| DAY function       | Converts a serial number to a day of the month                                                                                                       |
| DAYS function      | Returns the number of days between two dates                                                                                                         |
| DAYS360 function   | Calculates the number of days between two dates based on a 360-<br>day year                                                                          |
| DB function        | Returns the depreciation of an asset for a specified period by<br>using the fixed-declining balance method                                           |
| DBCS function      | Changes half-width (single-byte) English letters or katakana within<br>a character string to full-width (double-byte) characters                     |
| DCOUNT function    | Counts the cells that contain numbers in a database                                                                                                  |
| DCOUNTA function   | Counts nonblank cells in a database                                                                                                                  |
| DDB function       | Returns the depreciation of an asset for a specified period by<br>using the double-declining balance method or some other<br>method that you specify |
| DEC2BIN function   | Converts a decimal number to binary                                                                                                                  |
| DEC2HEX function   | Converts a decimal number to hexadecimal                                                                                                             |
| DEC2OCT function   | Converts a decimal number to octal                                                                                                                   |
| DECIMAL function   | Converts a text representation of a number in a given base into a<br>decimal number                                                                  |
| DEGREES function   | Converts radians to degrees                                                                                                                          |
| DELTA function     | Tests whether two values are equal                                                                                                                   |
| DEVSQ function     | Returns the sum of squares of deviations                                                                                                             |
| DGET function      | Extracts from a database a single record that matches the specified<br>criteria                                                                      |
| DISC function      | Returns the discount rate for a security                                                                                                             |

{97}------------------------------------------------

| Function                      | Description                                                                                                    |
|-------------------------------|----------------------------------------------------------------------------------------------------------------|
| DMAX function                 | Returns the maximum value from selected database entries                                                       |
| DMIN function                 | Returns the minimum value from selected database entries                                                       |
| DOLLAR, USDOLLAR<br>functions | Converts a number to text, using the $ (dollar) currency format                                                |
| DOLLARDE function             | Converts a dollar price, expressed as a fraction, into a dollar price,<br>expressed as a decimal number        |
| DOLLARFR function             | Converts a dollar price, expressed as a decimal number, into a<br>dollar price, expressed as a fraction        |
| DPRODUCT function             | Multiplies the values in a particular field of records that match the<br>criteria in a database                |
| DSTDEV function               | Estimates the standard deviation based on a sample of selected<br>database entries                             |
| DSTDEVP function              | Calculates the standard deviation based on the entire population<br>of selected database entries               |
| DSUM function                 | Adds the numbers in the field column of records in the database<br>that match the criteria                     |
| DURATION function             | Returns the annual duration of a security with periodic interest<br>payments                                   |
| Dlet function                 | Estimates variance based on a sample from selected database<br>entries                                         |
| DVARP function                | Calculates variance based on the entire population of selected<br>database entries                             |
| EDATE function                | Returns the serial number of the date that is the indicated number<br>of months before or after the start date |
| EFFECT function               | Returns the effective annual interest rate                                                                     |
| EOMONTH function              | Returns the serial number of the last day of the month before or<br>after a specified number of months         |
| ERF function                  | Returns the error function                                                                                     |
| ERF.PRECISE function          | Returns the error function                                                                                     |
| ERFC function                 | Returns the complementary error function                                                                       |
| ERFC.PRECISE function         | Returns the complementary ERF function integrated between x<br>and infinity                                    |

{98}------------------------------------------------

| Function               | Description                                                                                                                                                     |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ERROR.TYPE function    | Returns a number corresponding to an error type                                                                                                                 |
| EVEN function          | Rounds a number up to the nearest even integer                                                                                                                  |
| EXACT function         | Checks to see if two text values are identical                                                                                                                  |
| EXP function           | Returns e raised to the power of a given number                                                                                                                 |
| EXPON.DIST function    | Returns the exponential distribution                                                                                                                            |
| F.DIST function        | Returns the F probability distribution                                                                                                                          |
| F.DIST.RT function     | Returns the F probability distribution                                                                                                                          |
| F.INV function         | Returns the inverse of the F probability distribution                                                                                                           |
| F.INV.RT function      | Returns the inverse of the F probability distribution                                                                                                           |
| FACT function          | Returns the factorial of a number                                                                                                                               |
| FACTDOUBLE function    | Returns the double factorial of a number                                                                                                                        |
| FALSE function         | Returns the logical value FALSE                                                                                                                                 |
| FIND, FINDB functions  | Finds one text value within another (case-sensitive)                                                                                                            |
| FISHER function        | Returns the Fisher transformation                                                                                                                               |
| FISHERINV function     | Returns the inverse of the Fisher transformation                                                                                                                |
| FIXED function         | Formats a number as text with a fixed number of decimals                                                                                                        |
| FLOOR.MATH function    | Rounds a number down, to the nearest integer or to the nearest<br>multiple of significance                                                                      |
| FLOOR.PRECISE function | Rounds a number down to the nearest integer or to the nearest<br>multiple of significance. Regardless of the sign of the number, the<br>number is rounded down. |
| FV function            | Returns the future value of an investment                                                                                                                       |
| FVSCHEDULE function    | Returns the future value of an initial principal after applying a<br>series of compound interest rates                                                          |
| GAMMA function         | Returns the Gamma function value                                                                                                                                |
| GAMMA.DIST function    | Returns the gamma distribution                                                                                                                                  |
| GAMMA.INV function     | Returns the inverse of the gamma cumulative distribution                                                                                                        |
| GAMMALN function       | Returns the natural logarithm of the gamma function, (x)                                                                                                       |

{99}------------------------------------------------

| Function                    | Description                                                                                                  |
|-----------------------------|--------------------------------------------------------------------------------------------------------------|
| GAMMALN.PRECISE<br>function | Returns the natural logarithm of the gamma function, (x)                                                    |
| GAUSS function              | Returns 0.5 less than the standard normal cumulative distribution                                            |
| GCD function                | Returns the greatest common divisor                                                                          |
| GEOMEAN function            | Returns the geometric mean                                                                                   |
| GESTEP function             | Tests whether a number is greater than a threshold value                                                     |
| HARMEAN function            | Returns the harmonic mean                                                                                    |
| HEX2BIN function            | Converts a hexadecimal number to binary                                                                      |
| HEX2DEC function            | Converts a hexadecimal number to decimal                                                                     |
| HEX2OCT function            | Converts a hexadecimal number to octal                                                                       |
| HLOOKUP function            | Looks in the top row of an array and returns the value of the<br>indicated cell                              |
| HOUR function               | Converts a serial number to an hour                                                                          |
| HYPERLINK function          | Creates a shortcut or jump that opens a document stored on a<br>network server, an intranet, or the Internet |
| HYPGEOM.DIST function       | Returns the hypergeometric distribution                                                                      |
| IF function                 | Specifies a logical test to perform                                                                          |
| IMABS function              | Returns the absolute value (modulus) of a complex number                                                     |
| IMAGINARY function          | Returns the imaginary coefficient of a complex number                                                        |
| IMARGUMENT function         | Returns the argument theta, an angle expressed in radians                                                    |
| IMCONJUGATE function        | Returns the complex conjugate of a complex number                                                            |
| IMCOS function              | Returns the cosine of a complex number                                                                       |
| IMCOSH function             | Returns the hyperbolic cosine of a complex number                                                            |
| IMCOT function              | Returns the cotangent of a complex number                                                                    |
| IMCSC function              | Returns the cosecant of a complex number                                                                     |
| IMCSCH function             | Returns the hyperbolic cosecant of a complex number                                                          |
| IMDIV function              | Returns the quotient of two complex numbers                                                                  |

{100}------------------------------------------------

| Function           | Description                                                               |
|--------------------|---------------------------------------------------------------------------|
| IMEXP function     | Returns the exponential of a complex number                               |
| IMLN function      | Returns the natural logarithm of a complex number                         |
| IMLOG10 function   | Returns the base-10 logarithm of a complex number                         |
| IMLOG2 function    | Returns the base-2 logarithm of a complex number                          |
| IMPOWER function   | Returns a complex number raised to an integer power                       |
| IMPRODUCT function | Returns the product of from 2 to 255 complex numbers                      |
| IMREAL function    | Returns the real coefficient of a complex number                          |
| IMSEC function     | Returns the secant of a complex number                                    |
| IMSECH function    | Returns the hyperbolic secant of a complex number                         |
| IMSIN function     | Returns the sine of a complex number                                      |
| IMSINH function    | Returns the hyperbolic sine of a complex number                           |
| IMSQRT function    | Returns the square root of a complex number                               |
| IMSUB function     | Returns the difference between two complex numbers                        |
| IMSUM function     | Returns the sum of complex numbers                                        |
| IMTAN function     | Returns the tangent of a complex number                                   |
| INT function       | Rounds a number down to the nearest integer                               |
| INTRATE function   | Returns the interest rate for a fully invested security                   |
| IPMT function      | Returns the interest payment for an investment for a given period         |
| IRR function       | Returns the internal rate of return for a series of cash flows            |
| ISERR function     | Returns TRUE if the value is any error value except #N/A                  |
| ISERROR function   | Returns TRUE if the value is any error value                              |
| ISEVEN function    | Returns TRUE if the number is even                                        |
| ISFORMULA function | Returns TRUE if there is a reference to a cell that contains a<br>formula |
| ISLOGICAL function | Returns TRUE if the value is a logical value                              |
| ISNA function      | Returns TRUE if the value is the #N/A error value                         |
| ISNONTEXT function | Returns TRUE if the value is not text                                     |

{101}------------------------------------------------

| Function              | Description                                                                                              |
|-----------------------|----------------------------------------------------------------------------------------------------------|
| ISNUMBER function     | Returns TRUE if the value is a number                                                                    |
| ISO.CEILING function  | Returns a number that is rounded up to the nearest integer or to<br>the nearest multiple of significance |
| ISODD function        | Returns TRUE if the number is odd                                                                        |
| ISOWEEKNUM function   | Returns the number of the ISO week number of the year for a<br>given date                                |
| ISPMT function        | Calculates the interest paid during a specific period of an<br>investment                                |
| ISREF function        | Returns TRUE if the value is a reference                                                                 |
| ISTEXT function       | Returns TRUE if the value is text                                                                        |
| KURT function         | Returns the kurtosis of a data set                                                                       |
| LARGE function        | Returns the k-th largest value in a data set                                                             |
| LCM function          | Returns the least common multiple                                                                        |
| LEFT, LEFTB functions | Returns the leftmost characters from a text value                                                        |
| LEN, LENB functions   | Returns the number of characters in a text string                                                        |
| LN function           | Returns the natural logarithm of a number                                                                |
| LOG function          | Returns the logarithm of a number to a specified base                                                    |
| LOG10 function        | Returns the base-10 logarithm of a number                                                                |
| LOGNORM.DIST function | Returns the cumulative lognormal distribution                                                            |
| LOGNORM.INV function  | Returns the inverse of the lognormal cumulative distribution                                             |
| LOOKUP function       | Looks up values in a vector or array                                                                     |
| LOWER function        | Converts text to lowercase                                                                               |
| MATCH function        | Looks up values in a reference or array                                                                  |
| MAX function          | Returns the maximum value in a list of arguments                                                         |
| MAXA function         | Returns the maximum value in a list of arguments, including<br>numbers, text, and logical values         |
| MDURATION function    | Returns the Macauley modified duration for a security with an<br>assumed par value of $100               |
| MEDIAN function       | Returns the median of the given numbers                                                                  |

{102}------------------------------------------------

| Function                     | Description                                                                                                                        |
|------------------------------|------------------------------------------------------------------------------------------------------------------------------------|
| MID, MIDB functions          | Returns a specific number of characters from a text string starting<br>at the position you specify                                 |
| MIN function                 | Returns the minimum value in a list of arguments                                                                                   |
| MINA function                | Returns the smallest value in a list of arguments, including<br>numbers, text, and logical values                                  |
| MINUTE function              | Converts a serial number to a minute                                                                                               |
| MIRR function                | Returns the internal rate of return where positive and negative<br>cash flows are financed at different rates                      |
| MOD function                 | Returns the remainder from division                                                                                                |
| MONTH function               | Converts a serial number to a month                                                                                                |
| MROUND function              | Returns a number rounded to the desired multiple                                                                                   |
| MULTINOMIAL function         | Returns the multinomial of a set of numbers                                                                                        |
| N function                   | Returns a value converted to a number                                                                                              |
| NA function                  | Returns the error value #N/A                                                                                                       |
| NEGBINOM.DIST function       | Returns the negative binomial distribution                                                                                         |
| NETWORKDAYS function         | Returns the number of whole workdays between two dates                                                                             |
| NETWORKDAYS.INTL<br>function | Returns the number of whole workdays between two dates using<br>parameters to indicate which and how many days are weekend<br>days |
| NOMINAL function             | Returns the annual nominal interest rate                                                                                           |
| NORM.DIST function           | Returns the normal cumulative distribution                                                                                         |
| NORM.INV function            | Returns the inverse of the normal cumulative distribution                                                                          |
| NORM.S.DIST function         | Returns the standard normal cumulative distribution                                                                                |
| NORM.S.INV function          | Returns the inverse of the standard normal cumulative distribution                                                                 |
| NOT function                 | Reverses the logic of its argument                                                                                                 |
| NOW function                 | Returns the serial number of the current date and time                                                                             |
| NPER function                | Returns the number of periods for an investment                                                                                    |
| NPV function                 | Returns the net present value of an investment based on a series<br>of periodic cash flows and a discount rate                     |

{103}------------------------------------------------

| Function                 | Description                                                                                                                        |
|--------------------------|------------------------------------------------------------------------------------------------------------------------------------|
| NUMBERVALUE function     | Converts text to number in a locale-independent manner                                                                             |
| OCT2BIN function         | Converts an octal number to binary                                                                                                 |
| OCT2DEC function         | Converts an octal number to decimal                                                                                                |
| OCT2HEX function         | Converts an octal number to hexadecimal                                                                                            |
| ODD function             | Rounds a number up to the nearest odd integer                                                                                      |
| ODDFPRICE function       | Returns the price per $100 face value of a security with an odd first<br>period                                                    |
| ODDFYIELD function       | Returns the yield of a security with an odd first period                                                                           |
| ODDLPRICE function       | Returns the price per $100 face value of a security with an odd last<br>period                                                     |
| ODDLYIELD function       | Returns the yield of a security with an odd last period                                                                            |
| OR function              | Returns TRUE if any argument is true                                                                                               |
| PDURATION function       | Returns the number of periods required by an investment to reach<br>a specified value                                              |
| PERCENTILE.EXC function  | Returns the k-th percentile of values in a range, where k is in the<br>range 01, exclusive                                         |
| PERCENTILE.INC function  | Returns the k-th percentile of values in a range                                                                                   |
| PERCENTRANK.EXC function | Returns the rank of a value in a data set as a percentage (01,<br>exclusive) of the data set                                       |
| PERCENTRANK.INC function | Returns the percentage rank of a value in a data set                                                                               |
| PERMUT function          | Returns the number of permutations for a given number of objects                                                                   |
| PERMUTATIONA function    | Returns the number of permutations for a given number of objects<br>(with repetitions) that can be selected from the total objects |
| PHI function             | Returns the value of the density function for a standard normal<br>distribution                                                    |
| PI function              | Returns the value of pi                                                                                                            |
| PMT function             | Returns the periodic payment for an annuity                                                                                        |
| POISSON.DIST function    | Returns the Poisson distribution                                                                                                   |
| POWER function           | Returns the result of a number raised to a power                                                                                   |

{104}------------------------------------------------

| Function                       | Description                                                                            |  |
|--------------------------------|----------------------------------------------------------------------------------------|--|
| PPMT function                  | Returns the payment on the principal for an investment for a given<br>period           |  |
| PRICE function                 | Returns the price per $100 face value of a security that pays<br>periodic interest     |  |
| PRICEDISC function             | Returns the price per $100 face value of a discounted security                         |  |
| PRICEMAT function              | Returns the price per $100 face value of a security that pays<br>interest at maturity  |  |
| PRODUCT function               | Multiplies its arguments                                                               |  |
| PROPER function                | Capitalizes the first letter in each word of a text value                              |  |
| PV function                    | Returns the present value of an investment                                             |  |
| QUARTILE.EXC function          | Returns the quartile of the data set, based on percentile values<br>from 01, exclusive |  |
| QUARTILE.INC function          | Returns the quartile of a data set                                                     |  |
| QUOTIENT function              | Returns the integer portion of a division                                              |  |
| RADIANS function               | Converts degrees to radians                                                            |  |
| RAND function                  | Returns a random number between 0 and 1                                                |  |
| RANDBETWEEN function           | Returns a random number between the numbers you specify                                |  |
| RANK.AVG function              | Returns the rank of a number in a list of numbers                                      |  |
| RANK.EQ function               | Returns the rank of a number in a list of numbers                                      |  |
| RATE function                  | Returns the interest rate per period of an annuity                                     |  |
| RECEIVED function              | Returns the amount received at maturity for a fully invested<br>security               |  |
| REPLACE, REPLACEB<br>functions | Replaces characters within text                                                        |  |
| REPT function                  | Repeats text a given number of times                                                   |  |
| RIGHT, RIGHTB functions        | Returns the rightmost characters from a text value                                     |  |
| ROMAN function                 | Converts an Arabic numeral to Roman, as text                                           |  |
| ROUND function                 | Rounds a number to a specified number of digits                                        |  |
| ROUNDDOWN function             | Rounds a number down, toward zero                                                      |  |

{105}------------------------------------------------

| Function             | Description                                                                                                                                         |  |  |
|----------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|--|--|
| ROUNDUP function     | Rounds a number up, away from zero                                                                                                                  |  |  |
| ROWS function        | Returns the number of rows in a reference                                                                                                           |  |  |
| RRI function         | Returns an equivalent interest rate for the growth of an investment                                                                                 |  |  |
| SEC function         | Returns the secant of an angle                                                                                                                      |  |  |
| SECH function        | Returns the hyperbolic secant of an angle                                                                                                           |  |  |
| SECOND function      | Converts a serial number to a second                                                                                                                |  |  |
| SERIESSUM function   | Returns the sum of a power series based on the formula                                                                                              |  |  |
| SHEET function       | Returns the sheet number of the referenced sheet                                                                                                    |  |  |
| SHEETS function      | Returns the number of sheets in a reference                                                                                                         |  |  |
| SIGN function        | Returns the sign of a number                                                                                                                        |  |  |
| SIN function         | Returns the sine of the given angle                                                                                                                 |  |  |
| SINH function        | Returns the hyperbolic sine of a number                                                                                                             |  |  |
| SKEW function        | Returns the skewness of a distribution                                                                                                              |  |  |
| SKEW.P function      | Returns the skewness of a distribution based on a population: a<br>characterization of the degree of asymmetry of a distribution<br>around its mean |  |  |
| SLN function         | Returns the straight-line depreciation of an asset for one period                                                                                   |  |  |
| SMALL function       | Returns the k-th smallest value in a data set                                                                                                       |  |  |
| SQRT function        | Returns a positive square root                                                                                                                      |  |  |
| SQRTPI function      | Returns the square root of (number * pi)                                                                                                            |  |  |
| STANDARDIZE function | Returns a normalized value                                                                                                                          |  |  |
| STDEV.P function     | Calculates standard deviation based on the entire population                                                                                        |  |  |
| STDEV.S function     | Estimates standard deviation based on a sample                                                                                                      |  |  |
| STDEVA function      | Estimates standard deviation based on a sample, including<br>numbers, text, and logical values                                                      |  |  |
| STDEVPA function     | Calculates standard deviation based on the entire population,<br>including numbers, text, and logical values                                        |  |  |
| SUBSTITUTE function  | Substitutes new text for old text in a text string                                                                                                  |  |  |

{106}------------------------------------------------

| Function            | Description                                                                                                        |  |
|---------------------|--------------------------------------------------------------------------------------------------------------------|--|
| SUBTOTAL function   | Returns a subtotal in a list or database                                                                           |  |
| SUM function        | Adds its arguments                                                                                                 |  |
| SUMIF function      | Adds the cells specified by a given criteria                                                                       |  |
| SUMIFS function     | Adds the cells in a range that meet multiple criteria                                                              |  |
| SUMSQ function      | Returns the sum of the squares of the arguments                                                                    |  |
| SYD function        | Returns the sum-of-years' digits depreciation of an asset for a<br>specified period                                |  |
| T function          | Converts its arguments to text                                                                                     |  |
| T.DIST function     | Returns the Percentage Points (probability) for the Student t<br>distribution                                      |  |
| T.DIST.2T function  | Returns the Percentage Points (probability) for the Student t<br>distribution                                      |  |
| T.DIST.RT function  | Returns the Student's t-distribution                                                                               |  |
| T.INV function      | Returns the t-value of the Student's t-distribution as a function of<br>the probability and the degrees of freedom |  |
| T.INV.2T function   | Returns the inverse of the Student's t-distribution                                                                |  |
| TAN function        | Returns the tangent of a number                                                                                    |  |
| TANH function       | Returns the hyperbolic tangent of a number                                                                         |  |
| TBILLEQ function    | Returns the bond-equivalent yield for a Treasury bill                                                              |  |
| TBILLPRICE function | Returns the price per $100 face value for a Treasury bill                                                          |  |
| TBILLYIELD function | Returns the yield for a Treasury bill                                                                              |  |
| TEXT function       | Formats a number and converts it to text                                                                           |  |
| TIME function       | Returns the serial number of a particular time                                                                     |  |
| TIMEVALUE function  | Converts a time in the form of text to a serial number                                                             |  |
| TODAY function      | Returns the serial number of today's date                                                                          |  |
| TRIM function       | Removes spaces from text                                                                                           |  |
| TRIMMEAN function   | Returns the mean of the interior of a data set                                                                     |  |
| TRUE function       | Returns the logical value TRUE                                                                                     |  |

{107}------------------------------------------------

| Function              | Description                                                                                                                                                      |  |
|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|--|
| TRUNC function        | Truncates a number to an integer                                                                                                                                 |  |
| TYPE function         | Returns a number indicating the data type of a value                                                                                                             |  |
| UNICHAR function      | Returns the Unicode character that is references by the given<br>numeric value                                                                                   |  |
| UNICODE function      | Returns the number (code point) that corresponds to the first<br>character of the text                                                                           |  |
| UPPER function        | Converts text to uppercase                                                                                                                                       |  |
| VALUE function        | Converts a text argument to a number                                                                                                                             |  |
| VAR.P function        | Calculates variance based on the entire population                                                                                                               |  |
| VAR.S function        | Estimates variance based on a sample                                                                                                                             |  |
| VARA function         | Estimates variance based on a sample, including numbers, text,<br>and logical values                                                                             |  |
| VARPA function        | Calculates variance based on the entire population, including<br>numbers, text, and logical values                                                               |  |
| VDB function          | Returns the depreciation of an asset for a specified or partial<br>period by using a declining balance method                                                    |  |
| VLOOKUP function      | Looks in the first column of an array and moves across the row to<br>return the value of a cell                                                                  |  |
| WEEKDAY function      | Converts a serial number to a day of the week                                                                                                                    |  |
| WEEKNUM function      | Converts a serial number to a number representing where the<br>week falls numerically with a year                                                                |  |
| WEIBULL.DIST function | Returns the Weibull distribution                                                                                                                                 |  |
| WORKDAY function      | Returns the serial number of the date before or after a specified<br>number of workdays                                                                          |  |
| WORKDAY.INTL function | Returns the serial number of the date before or after a specified<br>number of workdays using parameters to indicate which and how<br>many days are weekend days |  |
| XIRR function         | Returns the internal rate of return for a schedule of cash flows that<br>is not necessarily periodic                                                             |  |
| XNPV function         | Returns the net present value for a schedule of cash flows that is<br>not necessarily periodic                                                                   |  |

{108}------------------------------------------------

| Function           | Description                                                                                        |  |
|--------------------|----------------------------------------------------------------------------------------------------|--|
| XOR function       | Returns a logical exclusive OR of all arguments                                                    |  |
| YEAR function      | Converts a serial number to a year                                                                 |  |
| YEARFRAC function  | Returns the year fraction representing the number of whole days<br>between start_date and end_date |  |
| YIELD function     | Returns the yield on a security that pays periodic interest                                        |  |
| YIELDDISC function | Returns the annual yield for a discounted security; for example, a<br>Treasury bill                |  |
| YIELDMAT function  | Returns the annual yield of a security that pays interest at maturity                              |  |
| Z.TEST function    | Returns the one-tailed probability-value of a z-test                                               |  |

## **See also**

- Excel JavaScript object model in Office Add-ins
- [Functions Class (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.functions)
- [Workbook Functions Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.workbook#excel-excel-workbook-functions-member)

{109}------------------------------------------------

# **Work with cells using the Excel JavaScript API**

Article  05/02/2023

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, all Excel cells are Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API.

A Range object can also contain multiple, contiguous cells. Contiguous cells form an unbroken rectangle (including single rows or columns). To learn about working with cells that are not contiguous, see Work with discontiguous cells using the RangeAreas object.

For the complete list of properties and methods that the Range object supports, see [Range Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

## **Work with discontiguous cells using the RangeAreas object**

The [RangeAreas](https://learn.microsoft.com/en-us/javascript/api/excel/excel.rangeareas) object lets your add-in perform operations on multiple ranges at once. These ranges may be contiguous, but they don't have to be. RangeAreas are further discussed in the article Work with multiple ranges simultaneously in Excel add-ins.

## **See also**

- Excel JavaScript object model in Office Add-ins
- Get a range using the Excel JavaScript API
- Work with multiple ranges simultaneously in Excel add-ins

{110}------------------------------------------------

# **Work with charts using the Excel JavaScript API**

Article  04/14/2025

This article provides code samples that show how to perform common tasks with charts using the Excel JavaScript API. For the complete list of properties and methods that the Chart and ChartCollection objects support, see [Chart Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chart) and [Chart](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartcollection) [Collection Object (JavaScript API for Excel).](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartcollection)

### **Create a chart**

The following code sample creates a chart in the worksheet named **Sample**. The chart is a **Line** chart that is based upon data in the range **A1:B13**.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let dataRange = sheet.getRange("A1:B13");
 let chart = sheet.charts.add(
 Excel.ChartType.line, 
 dataRange, 
 Excel.ChartSeriesBy.auto);
 chart.title.text = "Sales Data";
 chart.legend.position = Excel.ChartLegendPosition.right;
 chart.legend.format.fill.setSolidColor("white");
 chart.dataLabels.format.font.size = 15;
 chart.dataLabels.format.font.color = "black";
 await context.sync();
});
```
**New line chart**

{111}------------------------------------------------

### **Add a data series to a chart**

The following code sample adds a data series to the first chart in the worksheet. The new data series corresponds to the column named **2016** and is based upon data in the range **D2:D5**.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let chart = sheet.charts.getItemAt(0);
 let dataRange = sheet.getRange("D2:D5");
 let newSeries = chart.series.add("2016");
 newSeries.setValues(dataRange);
```

{112}------------------------------------------------

### **Chart before the 2016 data series is added**

### **Chart after the 2016 data series is added**

{113}------------------------------------------------

### **Set chart title**

The following code sample sets the title of the first chart in the worksheet to **Sales Data by Year**.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let chart = sheet.charts.getItemAt(0);
 chart.title.text = "Sales Data by Year";
 await context.sync();
});
```
**Chart after title is set**

{114}------------------------------------------------

### **Set properties of an axis in a chart**

Charts that use the [Cartesian coordinate system](https://en.wikipedia.org/wiki/Cartesian_coordinate_system) such as column charts, bar charts, and scatter charts contain a category axis and a value axis. These examples show how to set the title and display unit of an axis in a chart.

#### **Set axis title**

The following code sample sets the title of the category axis for the first chart in the worksheet to **Product**.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let chart = sheet.charts.getItemAt(0);
 chart.axes.categoryAxis.title.text = "Product";
 await context.sync();
});
```
### **Chart after title of category axis is set**

{115}------------------------------------------------

### **Set axis display unit**

The following code sample sets the display unit of the value axis for the first chart in the worksheet to **Hundreds**.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let chart = sheet.charts.getItemAt(0);
 chart.axes.valueAxis.displayUnit = "Hundreds";
 await context.sync();
});
```
**Chart after display unit of value axis is set**

{116}------------------------------------------------

## **Set visibility of gridlines in a chart**

The following code sample hides the major gridlines for the value axis of the first chart in the worksheet. You can show the major gridlines for the value axis of the chart, by setting chart.axes.valueAxis.majorGridlines.visible to true .

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let chart = sheet.charts.getItemAt(0);
 chart.axes.valueAxis.majorGridlines.visible = false;
 await context.sync();
});
```
### **Chart with gridlines hidden**

{117}------------------------------------------------

## **Chart trendlines**

### **Add a trendline**

The following code sample adds a moving average trendline to the first series in the first chart in the worksheet named **Sample**. The trendline shows a moving average over 5 periods.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let chart = sheet.charts.getItemAt(0);
 let seriesCollection = chart.series;

seriesCollection.getItemAt(0).trendlines.add("MovingAverage").movingAveragePeriod
= 5;
 await context.sync();
});
```
**Chart with moving average trendline**

{118}------------------------------------------------

#### **Update a trendline**

The following code sample sets the trendline to type Linear for the first series in the first chart in the worksheet named **Sample**.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let chart = sheet.charts.getItemAt(0);
 let seriesCollection = chart.series;
 let series = seriesCollection.getItemAt(0);
 series.trendlines.getItem(0).type = "Linear";
 await context.sync();
});
```
#### **Chart with linear trendline**

{119}------------------------------------------------

### **Add and format a chart data table**

You can access the data table element of a chart with the [Chart.getDataTableOrNullObject](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chart#excel-excel-chart-getdatatableornullobject-member(1)) method. This method returns the [ChartDataTable](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartdatatable) object. The ChartDataTable object has boolean formatting properties such as visible , showLegendKey , and showHorizontalBorder .

The ChartDataTable.format property returns the [ChartDataTableFormat](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartdatatableformat) object, which allows you to further format and style the data table. The ChartDataTableFormat object offers border , fill , and font properties.

The following code sample shows how to add a data table to a chart and then format that data table using the ChartDataTable and ChartDataTableFormat objects.

```
JavaScript
// This code sample adds a data table to a chart that already exists on the
worksheet, 
// and then adjusts the display and format of that data table.
await Excel.run(async (context) => {
 // Retrieve the chart on the "Sample" worksheet.
 let chart = context.workbook.worksheets.getItem("Sample").charts.getItemAt(0);
 // Get the chart data table object and load its properties.
 let chartDataTable = chart.getDataTableOrNullObject();
 chartDataTable.load();
 // Set the display properties of the chart data table.
 chartDataTable.visible = true;
 chartDataTable.showLegendKey = true;
```

{120}------------------------------------------------

```
 chartDataTable.showHorizontalBorder = false;
 chartDataTable.showVerticalBorder = true;
 chartDataTable.showOutlineBorder = true;
 // Retrieve the chart data table format object and set font and border
properties. 
 let chartDataTableFormat = chartDataTable.format;
 chartDataTableFormat.font.color = "#B76E79";
 chartDataTableFormat.font.name = "Comic Sans";
 chartDataTableFormat.border.color = "blue";
 await context.sync();
});
```
The following screenshot shows the data table that the preceding code sample creates.

## **Export a chart as an image**

Charts can be rendered as images outside of Excel. Chart.getImage returns the chart as a base64-encoded string representing the chart as a JPEG image. The following code shows how to get the image string and log it to the console.

```
await Excel.run(async (context) => {
 let chart =
context.workbook.worksheets.getItem("Sheet1").charts.getItem("Chart1");
 let imageAsString = chart.getImage();
 await context.sync();

 console.log(imageAsString.value);
 // Instead of logging, your add-in may use the base64-encoded string to save
the image as a file or insert it in HTML.
});
```
Chart.getImage takes three optional parameters: width, height, and the fitting mode.

JavaScript

{121}------------------------------------------------

getImage(width?: number, height?: number, fittingMode?: Excel.ImageFittingMode): OfficeExtension.ClientResult<string>;

These parameters determine the size of the image. Images are always proportionally scaled. The width and height parameters put upper or lower bounds on the scaled image. ImageFittingMode has three values with the following behaviors.

- Fill : The image's minimum height or width is the specified height or width (whichever is reached first when scaling the image). This is the default behavior when no fitting mode is specified.
- Fit : The image's maximum height or width is the specified height or width (whichever is reached first when scaling the image).
- FitAndCenter : The image's maximum height or width is the specified height or width (whichever is reached first when scaling the image). The resulting image is centered relative to the other dimension.

## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with data labels in charts using the Excel JavaScript API

{122}------------------------------------------------

# **Work with data labels in charts using the Excel JavaScript API**

Article  05/02/2025

Add data labels to Excel charts to provide a better visualization experience about important aspects of the chart. To learn more about data labels, see [Add or remove data labels in a](https://support.microsoft.com/office/add-or-remove-data-labels-in-a-chart-884bf2f1-2e29-454e-8b42-f467c9f4eb2d) [chart](https://support.microsoft.com/office/add-or-remove-data-labels-in-a-chart-884bf2f1-2e29-454e-8b42-f467c9f4eb2d) .

The following code sample sets up the sample data and **Bicycle Part Production** chart used in this article.

```
JavaScript
```

```
async function setup() {
 await Excel.run(async (context) => {
 context.workbook.worksheets.getItemOrNullObject("Sample").delete();
 const sheet = context.workbook.worksheets.add("Sample");
 let salesTable = sheet.tables.add("A1:E1", true);
 salesTable.name = "SalesTable";
 salesTable.getHeaderRowRange().values = [["Product", "Qtr1", "Qtr2", "Qtr3", 
"Qtr4"]];
 salesTable.rows.add(null, [
 ["Frames", 5000, 7000, 6544, 5377],
 ["Saddles", 400, 323, 276, 1451],
 ["Brake levers", 9000, 8766, 8456, 9812],
 ["Chains", 1550, 1088, 692, 2553],
 ["Mirrors", 225, 600, 923, 344],
 ["Spokes", 6005, 7634, 4589, 8765]
 ]);
 sheet.activate();
 createChart(context);
 });
}
async function createChart(context: Excel.RequestContext) {
 const worksheet = context.workbook.worksheets.getActiveWorksheet();
 const chart = worksheet.charts.add(
 Excel.ChartType.lineMarkers,
 worksheet.getRange("A1:E7"),
 Excel.ChartSeriesBy.rows
 );
 chart.axes.categoryAxis.setCategoryNames(worksheet.getRange("B1:E1"));
 chart.name = "PartChart";
 // Place the chart below sample data.
 chart.top = 125;
```

{123}------------------------------------------------

```
 chart.left = 5;
 chart.height = 300;
 chart.width = 450;
 chart.title.text = "Bicycle Part Production";
 chart.legend.position = "Bottom";
 await context.sync();
}
```
This image shows how the chart should display after running the sample code.

### **Add data labels**

To add data labels to a chart, get the series of data points you want to change, and set the hasDataLabels property to true .

```
JavaScript
async function addDataLabels() {
 await Excel.run(async (context) => {
 const worksheet = context.workbook.worksheets.getActiveWorksheet();
 const chart = worksheet.charts.getItem("PartChart");
 await context.sync();
 // Get spokes data series.
 const series = chart.series.getItemAt(5);
 // Turn on data labels and set location.
```

{124}------------------------------------------------

```
 series.hasDataLabels = true;
 series.dataLabels.position = Excel.ChartDataLabelPosition.top;
 await context.sync();
 });
```
}

### **Format data label size, shape, and text**

You can change attributes on data labels using the following APIs.

- Change data label shapes by setting the [geometricShapeType](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartdatalabel) property.
- Change height and width using the [setWidth and setHeight](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartdatalabel) methods.
- Change the text using the [text](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartdatalabel) property.
- Change the text formatting using the [format](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartdatalabel) property. You can change the [border, fill,](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartdatalabelformat) [and font](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartdatalabelformat) properties.

The following code sample shows how to set the shape type, height and width, and font formatting for the data labels.

```
JavaScript
 await Excel.run(async (context) => {
 const worksheet = context.workbook.worksheets.getActiveWorksheet();
 const chart = worksheet.charts.getItem("PartChart");
 const series = chart.series.getItemAt(5);
 // Set geometric shape of data labels to cubes.
```

{125}------------------------------------------------

```
 series.dataLabels.geometricShapeType = Excel.GeometricShapeType.cube;
 series.points.load("count");
 await context.sync();
 let pointsLoaded = series.points.count;
 // Change height, width, and font size of all data labels.
 for (let j = 0; j < pointsLoaded; j++) {
 series.points.getItemAt(j).dataLabel.setWidth(60);
 series.points.getItemAt(j).dataLabel.setHeight(30);
 series.points.getItemAt(j).dataLabel.format.font.size = 12;
 }
 // Set text of a data label.
 series.points.getItemAt(2).dataLabel.setWidth(80);
 series.points.getItemAt(2).dataLabel.setHeight(50);
 series.points.getItemAt(2).dataLabel.text = "Spokes Qtr3: 4589 ";
 await context.sync();
});
```
In the following screenshot, the chart now includes *count* data labels for the **Spokes** data, with custom text at the third data point.

You can also change the formatting of text in a data label. The following code sample shows how to use the [getSubstring](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartdatalabel) method to get part of data label text and apply font formatting.

```
JavaScript
await Excel.run(async (context) => {
 const worksheet = context.workbook.worksheets.getActiveWorksheet();
```

{126}------------------------------------------------

```
 const chart = worksheet.charts.getItem("PartChart");
 const series = chart.series.getItemAt(5);
 // Get the "Spokes" data label.
 let label = series.points.getItemAt(2).dataLabel;
 label.load();
 await context.sync();
 // Change border weight of this label.
 label.format.border.weight = 2;
 // Format "Qtr3" as bold and italicized. 
 label.getSubstring(7, 4).font.bold = true;
 label.getSubstring(7, 4).font.italic = true;
 // Format "Spokes" as green.
 label.getSubstring(0, 6).font.color = "green";
 // Format "4589" as red.
 label.getSubstring(12).font.color = "red";
 // Move label up by 15 points.
 label.top = label.top - 15;
 await context.sync();
```

```
});
```
## **Format leader lines**

Leader lines connect data labels to their respective data points and make it easier to see what they refer to in the chart. Turn leader lines on using the [showLeaderLines](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartseries) property. You can set the format of leader lines with the [leaderLines.format](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chartleaderlines) property.

{127}------------------------------------------------

```
JavaScript
```

```
await Excel.run(async (context) => {
 const worksheet = context.workbook.worksheets.getActiveWorksheet();
 const chart = worksheet.charts.getItem("PartChart");
 const series = chart.series.getItemAt(5);

 // Show leader lines.
 series.showLeaderLines = true;
 await context.sync();

 // Format leader lines as dotted orange lines with weight 2.
 series.dataLabels.leaderLines.format.line.lineStyle =
Excel.ChartLineStyle.dot;
 series.dataLabels.leaderLines.format.line.color = "orange";
 series.dataLabels.leaderLines.format.line.weight = 2;
});
```
# **Create callouts**

A callout is a data label that connects to the data point using a bubble-shaped pointer. A callout has an anchor which can be moved from the data point to other locations on the chart.

The following code sample shows how to change data labels in a series to use [Excel.GeometricShapeType.wedgeRectCallout.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.geometricshapetype) Note that leader lines are turned off to avoid showing two indicators to the same data label.

JavaScript

{128}------------------------------------------------

```
await Excel.run(async (context) => {
 const worksheet = context.workbook.worksheets.getActiveWorksheet();
 const chart = worksheet.charts.getItem("PartChart");
 const series = chart.series.getItemAt(5);
 // Change to a wedge rectangle style callout.
 series.dataLabels.geometricShapeType =
Excel.GeometricShapeType.wedgeRectCallout;
 series.showLeaderLines = false;
 await context.sync();
});
```
The following code sample shows how to change the anchor location of a data label.

```
JavaScript
await Excel.run(async (context) => {
 const worksheet = context.workbook.worksheets.getActiveWorksheet();
 const chart = worksheet.charts.getItem("PartChart");
 const series = chart.series.getItemAt(5);
 let label = series.points.getItemAt(2).dataLabel;
 let point = series.points.getItemAt(2);
 label.load();
 await context.sync();
 let anchor = label.getTailAnchor();
 anchor.load();
 await context.sync();
```

{129}------------------------------------------------

```
 anchor.top = anchor.top - 10;
 anchor.left = 40;
});
```
This screenshot demonstrates how the anchor of the third data label is adjusted by the preceding code sample.

## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with charts using the Excel JavaScript API

{130}------------------------------------------------

# **Coauthoring in Excel add-ins**

Article  03/22/2022

With [coauthoring](https://support.microsoft.com/office/7152aa8b-b791-414c-a3bb-3024e46fb104) , multiple people can work together and edit the same Excel workbook simultaneously. All coauthors of a workbook can see another coauthor's changes as soon as that coauthor saves the workbook. To coauthor an Excel workbook, the workbook must be stored in OneDrive, OneDrive for Business, or SharePoint Online.

#### ) **Important**

In Excel for Microsoft 365, you will notice AutoSave in the upper-left corner. When AutoSave is turned on, coauthors see your changes in real time. Consider the impact of this behavior on the design of your Excel add-in. Users can turn off AutoSave via the switch in the upper left of the Excel window.

## **Coauthoring overview**

When you change a workbook's content, Excel automatically synchronizes those changes across all coauthors. Coauthors can change the content of a workbook, but so can code running within an Excel add-in. For example, when the following JavaScript code runs in an Office Add-in, the value of a range is set to Contoso.

```
JavaScript
```

```
range.values = [['Contoso']];
```
After 'Contoso' synchronizes across all coauthors, any user or add-in running in the same workbook will see the new value of the range.

Coauthoring only synchronizes the content within the shared workbook. Values copied from the workbook to JavaScript variables in an Excel add-in are not synchronized. For example, if your add-in stores the value of a cell (such as 'Contoso') in a JavaScript variable, and then a coauthor changes the value of the cell to 'Example', after synchronization all coauthors see 'Example' in the cell. However, the value of the JavaScript variable is still set to 'Contoso'. Furthermore, when multiple coauthors use the same add-in, each coauthor has their own copy of the variable, which is not synchronized. When you use variables that use workbook content, be sure you check for updated values in the workbook before you use the variable.

{131}------------------------------------------------

## **Use events to manage the in-memory state of your add-in**

Excel add-ins can read workbook content (from hidden worksheets and a setting object), and then store it in data structures such as variables. After the original values are copied into any of these data structures, coauthors can update the original workbook content. This means that the copied values in the data structures are now out of sync with the workbook content. When you build your add-ins, be sure to account for this separation of workbook content and values stored in data structures.

For example, you might build a content add-in that displays custom visualizations. The state of your custom visualizations might be saved in a hidden worksheet. When coauthors use the same workbook, the following scenario can occur.

- User A opens the document and the custom visualizations are shown in the workbook. The custom visualizations read data from a hidden worksheet (for example, the color of the visualizations is set to blue).
- User B opens the same document, and starts modifying the custom visualizations. User B sets the color of the custom visualizations to orange. Orange is saved to the hidden worksheet.
- User A's hidden worksheet is updated with the new value of orange.
- User A's custom visualizations are still blue.

If you want User A's custom visualizations to respond to changes made by coauthors on the hidden worksheet, use the [BindingDataChanged](https://learn.microsoft.com/en-us/javascript/api/office/office.bindingdatachangedeventargs) event. This ensures that changes to workbook content made by coauthors is reflected in the state of your add-in.

## **Caveats to using events with coauthoring**

As described earlier, in some scenarios, triggering events for all coauthors provides an improved user experience. However, be aware that in some scenarios this behavior can produce poor user experiences.

For example, in data validation scenarios, it is common to display UI in response to events. The [BindingDataChanged](https://learn.microsoft.com/en-us/javascript/api/office/office.bindingdatachangedeventargs) event described in the previous section runs when either a local user or coauthor (remote) changes the workbook content within the binding. If the event handler of the BindingDataChanged event displays UI, users will see UI that is unrelated to changes they were working on in the workbook, leading to a poor user experience. Avoid displaying UI when using events in your add-in.

{132}------------------------------------------------

## **Avoid table row coauthoring conflicts**

It is a known issue that calls to the [TableRowCollection.add](https://learn.microsoft.com/en-us/javascript/api/excel/excel.tablerowcollection#excel-excel-tablerowcollection-add-member(1)) API can cause coauthoring conflicts. We do not recommend using that API if you anticipate your add-in will be run while other users are editing the add-in's workbook (specifically, if they are editing the table or any range under the table). The following guidance should help you avoid issues with the TableRowCollection.add method (and avoid triggering the yellow bar Excel shows that asks users to refresh).

- 1. Use [Range.values](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-values-member) instead of [TableRowCollection.add](https://learn.microsoft.com/en-us/javascript/api/excel/excel.tablerowcollection#excel-excel-tablerowcollection-add-member(1)). Setting the Range values directly below the table automatically expands the table. Otherwise, adding table rows through the Table APIs results in merge conflicts for coauth users.
- 2. There should be no [data validation rules](https://support.microsoft.com/office/29fecbcc-d1b9-42c1-9d76-eff3ce5f7249) applied to cells below the table, unless the data validation is applied to the entire column.
- 3. If there is data under the table, the add-in needs to handle that before setting the range value. Using [Range.insert](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-insert-member(1)) to insert an empty row will move the data and make space for the expanding table. Otherwise, you risk overwriting cells below the table.
- 4. You cannot add an empty row to a table with Range.values . The table only automatically expands if data is present in the cells directly below the table. Use either temporary data or hidden columns as a workaround to add an empty table row.

## **See also**

- [About coauthoring in Excel (VBA)](https://learn.microsoft.com/en-us/office/vba/excel/concepts/about-coauthoring-in-excel)
- [How AutoSave impacts add-ins and macros (VBA)](https://learn.microsoft.com/en-us/office/vba/library-reference/concepts/how-autosave-impacts-addins-and-macros)

{133}------------------------------------------------

# **Work with comments using the Excel JavaScript API**

Article  04/07/2025

This article describes how to add, read, modify, and remove comments in a workbook with the Excel JavaScript API. You can learn more about the comment feature from the [Insert comments](https://support.microsoft.com/office/bdcc9f5d-38e2-45b4-9a92-0b2b5c7bf6f8) [and notes in Excel](https://support.microsoft.com/office/bdcc9f5d-38e2-45b4-9a92-0b2b5c7bf6f8) article.

In the Excel JavaScript API, a comment includes both the single initial comment and the connected threaded discussion. It is tied to an individual cell. Anyone viewing the workbook with sufficient permissions can reply to a comment. A [Comment](https://learn.microsoft.com/en-us/javascript/api/excel/excel.comment) object stores those replies as [CommentReply](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentreply) objects. You should consider a comment to be a thread and that a thread must have a special entry as the starting point.

| 1.234.00 |  | Dave Ludwig<br>Is this figure correct?<br>7/25/2018 4:31 PM | Comment            |
|----------|--|-------------------------------------------------------------|--------------------|
|          |  | Amy Smith<br>Let me check<br>8/1/2018 4:31 PM               | Comment.replies[0] |
|          |  | Chris Johnson<br>Yes it's correct.<br>AA                    | Comment.replies[1] |

Comments within a workbook are tracked by the Workbook.comments property. This includes comments created by users and also comments created by your add-in. The Workbook.comments property is a [CommentCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentcollection) object that contains a collection of [Comment](https://learn.microsoft.com/en-us/javascript/api/excel/excel.comment) objects. Comments are also accessible at the [Worksheet](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet) level. The samples in this article work with comments at the workbook level, but they can be easily modified to use the Worksheet.comments property.

**Tip**

{134}------------------------------------------------

To learn about adding and editing notes with the Excel JavaScript API, see **Work with notes using the Excel JavaScript API**.

### **Add comments**

Use the CommentCollection.add method to add comments to a workbook. This method takes up to three parameters:

- cellAddress : The cell where the comment is added. This can either be a string or [Range](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range) object. The range must be a single cell.
- content : The comment's content. Use a string for plain text comments. Use a [CommentRichContent](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentrichcontent) object for comments with mentions.
- contentType : A [ContentType](https://learn.microsoft.com/en-us/javascript/api/excel/excel.contenttype) enum specifying type of content. The default value is ContentType.plain .

The following code sample adds a comment to cell **A2**.

```
JavaScript
await Excel.run(async (context) => {
 // Add a comment to A2 on the "MyWorksheet" worksheet.
 let comments = context.workbook.comments;
 // Note that an InvalidArgument error will be thrown if multiple cells passed
to `Comment.add`.
 comments.add("MyWorksheet!A2", "TODO: add data.");
 await context.sync();
});
```
#### 7 **Note**

Comments added by an add-in are attributed to the current user of that add-in.

### **Add comment replies**

A Comment object is a comment thread that contains zero or more replies. Comment objects have a replies property, which is a [CommentReplyCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentreplycollection) that contains [CommentReply](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentreply) objects. To add a reply to a comment, use the CommentReplyCollection.add method, passing in the text of the reply. Replies are displayed in the order they are added. They are also attributed to the current user of the add-in.

{135}------------------------------------------------

The following code sample adds a reply to the first comment in the workbook.

```
await Excel.run(async (context) => {
 // Get the first comment added to the workbook.
 let comment = context.workbook.comments.getItemAt(0);
 comment.replies.add("Thanks for the reminder!");
 await context.sync();
});
```
### **Edit comments**

JavaScript

JavaScript

To edit a comment or comment reply, set its Comment.content property or

CommentReply.content property.

```
await Excel.run(async (context) => {
 // Edit the first comment in the workbook.
 let comment = context.workbook.comments.getItemAt(0);
 comment.content = "PLEASE add headers here.";
 await context.sync();
});
```
#### **Edit comment replies**

To edit a comment reply, set its CommentReply.content property.

```
JavaScript
await Excel.run(async (context) => {
 // Edit the first comment reply on the first comment in the workbook.
 let comment = context.workbook.comments.getItemAt(0);
 let reply = comment.replies.getItemAt(0);
 reply.content = "Never mind";
 await context.sync();
});
```
### **Delete comments**

To delete a comment use the Comment.delete method. Deleting a comment also deletes the replies associated with that comment.

{136}------------------------------------------------

```
JavaScript
```

```
await Excel.run(async (context) => {
 // Delete the comment thread at A2 on the "MyWorksheet" worksheet.
 context.workbook.comments.getItemByCell("MyWorksheet!A2").delete();
 await context.sync();
});
```
### **Delete comment replies**

To delete a comment reply, use the CommentReply.delete method.

```
JavaScript
await Excel.run(async (context) => {
 // Delete the first comment reply from this worksheet's first comment.
 let comment = context.workbook.comments.getItemAt(0);
 comment.replies.getItemAt(0).delete();
 await context.sync();
});
```
## **Resolve comment threads**

A comment thread has a configurable boolean value, resolved , to indicate if it is resolved. A value of true means the comment thread is resolved. A value of false means the comment thread is either new or reopened.

```
JavaScript
await Excel.run(async (context) => {
 // Resolve the first comment thread in the workbook.
 context.workbook.comments.getItemAt(0).resolved = true;
 await context.sync();
});
```
Comment replies have a read-only resolved property. Its value is always equal to that of the rest of the thread.

# **Comment metadata**

Each comment contains metadata about its creation, such as the author and creation date. Comments created by your add-in are considered to be authored by the current user.

{137}------------------------------------------------

The following sample shows how to display the author's email, author's name, and creation date of a comment at **A2**.

```
JavaScript
await Excel.run(async (context) => {
 // Get the comment at cell A2 in the "MyWorksheet" worksheet.
 let comment = context.workbook.comments.getItemByCell("MyWorksheet!A2");
 // Load and print the following values.
 comment.load(["authorEmail", "authorName", "creationDate"]);
 await context.sync();

 console.log(`${comment.creationDate.toDateString()}: ${comment.authorName}
(${comment.authorEmail})`);
});
```
### **Comment reply metadata**

Comment replies store the same types of metadata as the initial comment.

The following sample shows how to display the author's email, author's name, and creation date of the latest comment reply at **A2**.

```
JavaScript
await Excel.run(async (context) => {
 // Get the comment at cell A2 in the "MyWorksheet" worksheet.
 let comment = context.workbook.comments.getItemByCell("MyWorksheet!A2");
 let replyCount = comment.replies.getCount();
 // Sync to get the current number of comment replies.
 await context.sync();
 // Get the last comment reply in the comment thread.
 let reply = comment.replies.getItemAt(replyCount.value - 1);
 reply.load(["authorEmail", "authorName", "creationDate"]);
 // Sync to load the reply metadata to print.
 await context.sync();
 console.log(`Latest reply: ${reply.creationDate.toDateString()}: 
${reply.authorName} ${reply.authorEmail})`);
 await context.sync();
});
```
## **Mentions**

{138}------------------------------------------------

[Mentions](https://support.microsoft.com/office/644bf689-31a0-4977-a4fb-afe01820c1fd) are used to tag colleagues in a comment. This sends them notifications with your comment's content. Your add-in can create these mentions on your behalf.

Comments with mentions need to be created with [CommentRichContent](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentrichcontent) objects. Call CommentCollection.add with a CommentRichContent containing one or more mentions and specify ContentType.mention as the contentType parameter. The content string also needs to be formatted to insert the mention into the text. The format for a mention is: <at id=" {replyIndex}">{mentionName}</at> .

#### 7 **Note**

Currently, only the mention's exact name can be used as the text of the mention link. Support for shortened versions of a name will be added later.

The following example shows a comment with a single mention.

```
JavaScript
await Excel.run(async (context) => {
 // Add an "@mention" for "Kate Kristensen" to cell A1 in the "MyWorksheet"
worksheet.
 let mention = {
 email: "kakri@contoso.com",
 id: 0,
 name: "Kate Kristensen"
 };
 // This will tag the mention's name using the '@' syntax.
 // They will be notified via email.
 let commentBody = {
 mentions: [mention],
 richContent: '<at id="0">' + mention.name + "</at> - Can you take a
look?"
 };
 // Note that an InvalidArgument error will be thrown if multiple cells passed
to `comment.add`.
 context.workbook.comments.add("MyWorksheet!A1", commentBody,
Excel.ContentType.mention);
 await context.sync();
});
```
### **Comment events**

Your add-in can listen for comment additions, changes, and deletions. [Comment events](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentcollection#event-details) occur on the CommentCollection object. To listen for comment events, register the onAdded ,

{139}------------------------------------------------

onChanged , or onDeleted comment event handler. When a comment event is detected, use this event handler to retrieve data about the added, changed, or deleted comment. The onChanged event also handles comment reply additions, changes, and deletions.

Each comment event only triggers once when multiple additions, changes, or deletions are performed at the same time. All the [CommentAddedEventArgs](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentaddedeventargs), [CommentChangedEventArgs,](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentchangedeventargs) and [CommentDeletedEventArgs](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentdeletedeventargs) objects contain arrays of comment IDs to map the event actions back to the comment collections.

See the Work with Events using the Excel JavaScript API article for additional information about registering event handlers, handling events, and removing event handlers.

### **Comment addition events**

The onAdded event is triggered when one or more new comments are added to the comment collection. This event is *not* triggered when replies are added to a comment thread (see Comment change events to learn about comment reply events).

The following sample shows how to register the onAdded event handler and then use the CommentAddedEventArgs object to retrieve the commentDetails array of the added comment.

7 **Note**

This sample only works when a single comment is added.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let comments = context.workbook.worksheets.getActiveWorksheet().comments;
 // Register the onAdded comment event handler.
 comments.onAdded.add(commentAdded);
 await context.sync();
});
async function commentAdded() {
 await Excel.run(async (context) => {
 // Retrieve the added comment using the comment ID.
 // Note: This method assumes only a single comment is added at a time. 
 let addedComment =
context.workbook.comments.getItem(event.commentDetails[0].commentId);
 // Load the added comment's data.
 addedComment.load(["content", "authorName"]);
```

{140}------------------------------------------------

```
 await context.sync();
 // Print out the added comment's data.
 console.log(`A comment was added. ID: 
${event.commentDetails[0].commentId}. Comment content:${addedComment.content}.
Comment author:${addedComment.authorName}`);
 await context.sync();
 });
}
```
#### **Comment change events**

The onChanged comment event is triggered in the following scenarios.

- A comment's content is updated.
- A comment thread is resolved.
- A comment thread is reopened.
- A reply is added to a comment thread.
- A reply is updated in a comment thread.
- A reply is deleted in a comment thread.

The following sample shows how to register the onChanged event handler and then use the CommentChangedEventArgs object to retrieve the commentDetails array of the changed comment.

```
7 Note
```
This sample only works when a single comment is changed.

```
JavaScript
await Excel.run(async (context) => {
 let comments = context.workbook.worksheets.getActiveWorksheet().comments;
 // Register the onChanged comment event handler.
 comments.onChanged.add(commentChanged);
 await context.sync();
});
async function commentChanged() {
 await Excel.run(async (context) => {
 // Retrieve the changed comment using the comment ID.
 // Note: This method assumes only a single comment is changed at a time. 
 let changedComment =
context.workbook.comments.getItem(event.commentDetails[0].commentId);
```
// Load the changed comment's data.

{141}------------------------------------------------

```
 changedComment.load(["content", "authorName"]);
 await context.sync();
 // Print out the changed comment's data.
 console.log(`A comment was changed. ID: 
${event.commentDetails[0].commentId}. Updated comment content: 
${changedComment.content}. Comment author: ${changedComment.authorName}`);
 await context.sync();
 });
}
```
#### **Comment deletion events**

The onDeleted event is triggered when a comment is deleted from the comment collection. Once a comment has been deleted, its metadata is no longer available. The [CommentDeletedEventArgs](https://learn.microsoft.com/en-us/javascript/api/excel/excel.commentdeletedeventargs) object provides comment IDs, in case your add-in is managing individual comments.

The following sample shows how to register the onDeleted event handler and then use the CommentDeletedEventArgs object to retrieve the commentDetails array of the deleted comment.

7 **Note**

This sample only works when a single comment is deleted.

JavaScript

```
await Excel.run(async (context) => {
 let comments = context.workbook.worksheets.getActiveWorksheet().comments;
 // Register the onDeleted comment event handler.
 comments.onDeleted.add(commentDeleted);
 await context.sync();
});
async function commentDeleted() {
 await Excel.run(async (context) => {
 // Print out the deleted comment's ID.
 // Note: This method assumes only a single comment is deleted at a time. 
 console.log(`A comment was deleted. ID: 
${event.commentDetails[0].commentId}`);
 });
}
```

{142}------------------------------------------------

## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with workbooks using the Excel JavaScript API
- Work with Events using the Excel JavaScript API
- [Insert comments and notes in Excel](https://support.microsoft.com/office/bdcc9f5d-38e2-45b4-9a92-0b2b5c7bf6f8)

{143}------------------------------------------------

# **Overview of data types in Excel add-ins**

Article  01/22/2025

Data types organize complex data structures as objects. This includes formatted number values, web images, and entities as entity cards.

The following screenshot highlights one of the primary features of data types: an entity card. In this case, the entity card shows expanded information about the **Chef Anton's Gumbo Mix** product from a list of grocery store products.

|    | A                                 | B                      |                                |  |
|----|-----------------------------------|------------------------|--------------------------------|--|
| 1  | Product                           | ProductID              |  ProductName                  |  |
| 2  | Chai                              |                        | 1 Chai                         |  |
| 3  | 0 Chang                           |                        | 2 Chang                        |  |
| 4  |  Aniseed Syrup                  |                        | 3 Aniseed Syrup                |  |
| 5  | Chef Anton's Cajun Seasoning      |                        | 4 Chef Anton's Cajun Seasoning |  |
| 6  | Chef Anton's Gumbo Mix            |                        |                                |  |
| 7  |  Grandma's Boysenberry Spread   |                        |                                |  |
| 8  | 0 Uncle Bob's Organic Dried Pears |                        |                                |  |
| 9  | 0 Northwoods Cranberry Sauce      |                        |                                |  |
| 10 |  Mishi Kobe Niku                |                        |                                |  |
| 11 | 0 Ikura                           |                        |                                |  |
| 12 | 0 Queso Cabrales                  |                        |                                |  |
| 13 | 0 Queso Manchego La Pastora       | Chef Anton's Gumbo Mix |                                |  |
| 14 |  Konbu                           | Product ID             |                                |  |
| 15 |  Tofu                           | 5                      |                                |  |
| 16 | Genen Shouyu                      |                        |                                |  |
| 17 |  Pavlova                        | Category               |                                |  |
| 18 | Alice Mutton                      | Condiments<br>     |                                |  |
| 19 | Carnarvon Tigers                  |                        |                                |  |
| 20 | 0 Teatime Chocolate Biscuits      | Quantity and price     |                                |  |
| 21 | 0 Sir Rodney's Marmalade          |                        |                                |  |
| 22 |                                   |                        |                                |  |
| 23 |                                   | Quantity Per Unit      |                                |  |
| 24 |                                   | 36 boxes               |                                |  |
| 25 |                                   | Unit Price             |                                |  |
| 26 |                                   |                        |                                |  |
| 27 |                                   |                        |                                |  |

#### 7 **Note**

To start experimenting with data types right away, install **Script Lab** in Excel and check out the **Data types** section in our **Samples** library. You can also explore the 

{144}------------------------------------------------

Prior to the data types addition, the Excel JavaScript API supported string, number, boolean, and error data types. The Excel UI formatting layer is capable of adding currency, date, and other types of formatting to cells that contain the four original data types, but this formatting layer only controls the display of the original data types in the Excel UI. The underlying number value is not changed, even when a cell in the Excel UI is formatted as currency or a date. This gap between an underlying value and the formatted display in the Excel UI can result in confusion and errors during add-in calculations. The data types APIs are a solution to this gap.

Data types expand Excel JavaScript API support beyond the four original data types (string, number, boolean, and error) to include web images, formatted number values, entities, arrays within entities, and improved error data types as flexible data structures. These types, which power many [linked data types](https://support.microsoft.com/office/what-linked-data-types-are-available-in-excel-6510ab58-52f6-4368-ba0f-6a76c0190772) experiences, allow for precision and simplicity during add-in calculations and extend the potential of Excel add-ins beyond a 2-dimensional grid.

#### **Tip**

Check out examples of **linked data types**, which are available to all Excel users, in the following sample workbook: **[linked-data-types-sample-workbook.xlsx](https://learn.microsoft.com/en-us/office/dev/add-ins/files/linked-data-types-sample-workbook.xlsx)**.

## **Resources**

Explore data types with the following resources.

- 1. Learn data types basics in the Excel data types core concepts article.
- 2. Install Script Lab in Excel and explore the **Data types** section in our **Samples** library.
- 3. Learn how to extend Excel beyond a 2-dimensional grid with entity data types in the Use cards with entity value data types article.
- 4. Try the [Create and explore data types in Excel](https://github.com/OfficeDev/Office-Add-in-samples/tree/main/Samples/excel-data-types-explorer) sample in our [OfficeDev/Office-](https://github.com/OfficeDev/Office-Add-in-samples)[Add-in-samples](https://github.com/OfficeDev/Office-Add-in-samples) repository.

## **Data types and custom functions**

Data types enhance the power of custom functions. Custom functions accept data types as both inputs to custom functions and outputs of custom functions, and custom functions use the same JSON schema for data types as the Excel JavaScript API. This data types JSON schema is maintained as custom functions calculate and evaluate. To

{145}------------------------------------------------

learn more about integrating data types with your custom functions, see Custom functions and data types.

{146}------------------------------------------------

# **Excel data types core concepts**

Article  05/12/2025

This article describes how to use the Excel JavaScript API to work with data types. It introduces core concepts that are fundamental to data type development.

### **The valuesAsJson property**

The valuesAsJson property (or the singular valueAsJson for [NamedItem](https://learn.microsoft.com/en-us/javascript/api/excel/excel.nameditem)) is integral to creating data types in Excel. This property is an expansion of values properties, such as [Range.values](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-values-member). Both the values and valuesAsJson properties are used to access the value in a cell, but the values property only returns one of the four basic types: string, number, boolean, or error (as a string). In contrast, valuesAsJson returns expanded information about the four basic types, and this property can return data types such as formatted number values, entities, and web images.

The following objects offer the valuesAsJson property.

- [NamedItem](https://learn.microsoft.com/en-us/javascript/api/excel/excel.nameditem) (as valueAsJson )
- [NamedItemArrayValues](https://learn.microsoft.com/en-us/javascript/api/excel/excel.nameditemarrayvalues)
- [Range](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range)
- [RangeView](https://learn.microsoft.com/en-us/javascript/api/excel/excel.rangeview)
- [TableColumn](https://learn.microsoft.com/en-us/javascript/api/excel/excel.tablecolumn)
- [TableRow](https://learn.microsoft.com/en-us/javascript/api/excel/excel.tablerow)

#### 7 **Note**

Some cell values change based on a user's locale. The valuesAsJsonLocal property offers localization support and is available on all the same objects as valuesAsJson .

## **Cell values**

The valuesAsJson property returns a [CellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellvalue) type alias, which is a [union](https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#union-types) of the following data types.

- [ArrayCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.arraycellvalue)
- [BooleanCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.booleancellvalue)
- [DoubleCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.doublecellvalue)
- [EmptyCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.emptycellvalue)
- [EntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.entitycellvalue)
- [ErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.errorcellvalue)

{147}------------------------------------------------

- [ExternalCodeServiceObjectCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.externalcodeserviceobjectcellvalue)
- [FunctionCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.functioncellvalue)
- [LinkedEntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.linkedentitycellvalue)
- [LocalImageCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.localimagecellvalue)
- [ReferenceCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.referencecellvalue)
- [StringCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.stringcellvalue)
- [ValueTypeNotAvailableCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.valuetypenotavailablecellvalue)
- [WebImageCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.webimagecellvalue)

The CellValue type alias also returns the [CellValueExtraProperties](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellvalueextraproperties) object, which is an [intersection](https://www.typescriptlang.org/docs/handbook/2/objects.html#intersection-types) with the rest of the *CellValue types. It's not a data type itself. The properties of the CellValueExtraProperties object are used with all data types to specify details related to overwriting cell values.

### **JSON schema**

Each cell value type returned by valuesAsJson uses a JSON metadata schema designed for that type. Along with additional properties unique to each data type, these JSON metadata schemas all have the type , basicType , and basicValue properties in common.

The type defines the [CellValueType](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellvaluetype) of the data. The basicType is always read-only and is used as a fallback when the data type isn't supported or is formatted incorrectly. The basicValue matches the value that would be returned by the values property. The basicValue is used as a fallback when calculations encounter incompatible scenarios, such as an older version of Excel that doesn't support the data types feature. The basicValue is read-only for ArrayCellValue , EntityCellValue , LinkedEntityCellValue , and WebImageCellValue data types.

In addition to the three fields that all data types share, the JSON metadata schema for each *CellValue has properties available according to that type. For example, the [WebImageCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.webimagecellvalue) type includes the altText and attribution properties, while the [EntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.entitycellvalue) type offers the properties and text fields.

The following sections show JSON code samples for the formatted number value, entity value, and web image data types.

## **Formatted number values**

The [DoubleCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.doublecellvalue) object enables Excel add-ins to define a numberFormat property for a value. Once assigned, this number format travels through calculations with the value and can be returned by functions.

{148}------------------------------------------------

The following JSON code sample shows the complete schema of a formatted number value. The myDate formatted number value in the code sample displays as **1/16/1990** in the Excel UI. If the minimum compatibility requirements for the data types feature aren't met, calculations use the basicValue in place of the formatted number.

```
TypeScript
// This is an example of the complete JSON of a formatted number value.
// In this case, the number is formatted as a date.
const myDate: Excel.DoubleCellValue = {
 type: Excel.CellValueType.double,
 basicValue: 32889.0,
 basicType: Excel.RangeValueType.double, // A read-only property. Used as a
fallback in incompatible scenarios.
 numberFormat: "m/d/yyyy"
};
```
The number formatting is considered the default format. If the user, or other code, applies formatting to a cell containing a formatted number, the applied format overrides the number's format.

Begin experimenting with formatted number values by opening Script Lab and checking out the [Data types: Formatted numbers](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-formatted-number.yaml) snippet in our **Samples** library.

### **Basic cell values**

Add properties to basic cell values in Excel to associate additional information with the values. Similar to entity values, you can add properties to the **string**, **double**, and **Boolean** basic types. Each property is a key/value pair. The following example shows the number 104.67 (a double) that represents a bill with added fields named **Drinks**, **Food**, **Tax**, and **Tip**.

| 104.67 [] |                     |
|------------|---------------------|
|            | Action              |
|            | Show Data Type Card |
|            | Field               |
|            | Drinks              |
|            | Food                |
|            | Tax                 |
|            | Tip                 |
|            |                     |

For more information, see Add properties to basic cell values.

{149}------------------------------------------------

## **Entity values**

An entity value is a container for data types, similar to an object in object-oriented programming. Entities also support arrays as properties of an entity value. The [EntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.entitycellvalue) object allows add-ins to define properties such as type , text , and properties . The properties property enables the entity value to define and contain additional data types.

The basicType and basicValue properties define how calculations read this entity data type if the minimum compatibility requirements to use data types aren't met. In that scenario, this entity data type displays as a **#VALUE!** error in the Excel UI.

The following JSON code sample shows the complete schema of an entity value that contains text, an image, a date, and an additional text value.

```
TypeScript
// This is an example of the complete JSON for an entity value.
// The entity contains text and properties which contain an image, a date, and
another text value.
const myEntity: Excel.EntityCellValue = {
 type: Excel.CellValueType.entity,
 text: "A llama",
 properties: {
 image: myImage,
 "start date": myDate,
 "quote": {
 type: Excel.CellValueType.string,
 basicValue: "I love llamas."
 }
 }, 
 basicType: Excel.RangeValueType.error, // A read-only property. Used as a
fallback in incompatible scenarios.
 basicValue: "#VALUE!" // A read-only property. Used as a fallback in
incompatible scenarios.
};
```
To explore entity data types, start by going to Script Lab in Excel and opening the [Data types:](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-entity-values.yaml) [Create entity cards from data in a table](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-entity-values.yaml) snippet in our **Samples** library. The [Data types: Entity](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-references.yaml) [values with references](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-references.yaml) and [Data types: Entity value attribution properties](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-entity-attribution.yaml) snippets offer a deeper look at entity features.

### **Linked entity cell values**

Linked entity cell values, or [LinkedEntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.linkedentitycellvalue) objects, are integrated data types from external data sources and can display the data as an entity card. They enable you to scale your data types to represent large data sets without downloading all the data into the workbook.

{150}------------------------------------------------

The[Stocks and Geography data domains](https://support.microsoft.com/office/excel-data-types-stocks-and-geography-61a33056-9935-484f-8ac8-f1a89e210877) available via the Excel UI provide linked entity cell values.

Linked entity cell values are linked to an external data source. They provide the following advantages over regular entity values:

- Linked entity cell values can nest, and nested linked entity cell values aren't retrieved until referenced, either by the user or by the worksheet. This helps reduce file size and improve workbook performance.
- Excel uses a cache to allow different cells to reference the same linked entity cell value seamlessly. This also improves workbook performance.

For more information, see Create linked entity cell values.

## **Web image values**

The [WebImageCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.webimagecellvalue) object creates the ability to store an image as part of an entity or as an independent value in a range. This object offers many properties, including address , altText , and relatedImagesAddress .

The basicType and basicValue properties define how calculations read the web image data type if the minimum compatibility requirements to use the data types feature aren't met. In that scenario, this web image data type displays as a **#VALUE!** error in the Excel UI.

The following JSON code sample shows the complete schema of a web image.

```
TypeScript
// This is an example of the complete JSON for a web image.
const myImage: Excel.WebImageCellValue = {
 type: Excel.CellValueType.webImage,
 address: "https://bit.ly/2YGOwtw", 
 basicType: Excel.RangeValueType.error, // A read-only property. Used as a
fallback in incompatible scenarios.
 basicValue: "#VALUE!" // A read-only property. Used as a fallback in
incompatible scenarios.
};
```
Try out web image data types by opening Script Lab and selecting the [Data types: Web](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-web-image.yaml) [images](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-web-image.yaml) snippet in our **Samples** library.

## **Improved error support**

{151}------------------------------------------------

The data types APIs expose existing Excel UI errors as objects. Now that these errors are accessible as objects, add-ins can define or retrieve properties such as type , errorType , and errorSubType .

The following is a list of all the error objects with expanded support through data types.

- [BlockedErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.blockederrorcellvalue)
- [BusyErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.busyerrorcellvalue)
- [CalcErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.calcerrorcellvalue)
- [ConnectErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.connecterrorcellvalue)
- [Div0ErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.div0errorcellvalue)
- [FieldErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.fielderrorcellvalue)
- [GettingDataErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.gettingdataerrorcellvalue)
- [NotAvailableErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.notavailableerrorcellvalue)
- [NameErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.nameerrorcellvalue)
- [NullErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.nullerrorcellvalue)
- [NumErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.numerrorcellvalue)
- [RefErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.referrorcellvalue)
- [SpillErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.spillerrorcellvalue)
- [ValueErrorCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.valueerrorcellvalue)

Each of the error objects can access an enum through the errorSubType property, and this enum contains additional data about the error. For example, the BlockedErrorCellValue error object can access the [BlockedErrorCellValueSubType](https://learn.microsoft.com/en-us/javascript/api/excel/excel.blockederrorcellvaluesubtype) enum. The BlockedErrorCellValueSubType enum offers additional data about what caused the error.

Learn more about the data types error objects by checking out the [Data types: Set error](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-error-values.yaml) [values](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-error-values.yaml) snippet in our Script Lab **Samples** library.

## **Next steps**

Learn how entity data types extend the potential of Excel add-ins beyond a 2-dimensional grid with the Use cards with entity value data types article.

Use the [Create and explore data types in Excel](https://github.com/OfficeDev/Office-Add-in-samples/tree/main/Samples/excel-data-types-explorer) sample in our [OfficeDev/Office-Add-in](https://github.com/OfficeDev/Office-Add-in-samples)[samples](https://github.com/OfficeDev/Office-Add-in-samples) repository to experiment more deeply with data types by building and sideloading an add-in that creates and edits data types in a workbook.

## **See also**

- Overview of data types in Excel add-ins

{152}------------------------------------------------

- Create linked entity cell values
- Add properties to basic cell values
- Use cards with entity value data types
- [Create and explore data types in Excel](https://github.com/OfficeDev/Office-Add-in-samples/tree/main/Samples/excel-data-types-explorer)
- Custom functions and data types
- Excel JavaScript API reference

{153}------------------------------------------------

# **Add properties to basic cell values**

Article  05/12/2025

Add properties to basic cell values in Excel to associate additional information with the values. Similar to entity values, you can add properties to the **string**, **double**, and **Boolean** basic types. Each property is a key/value pair. The following example shows the number 14.67 (a double) that represents a bill with added fields named **Drinks**, **Food**, **Tax**, and **Tip**.

| 104.67 [ ] |                     |
|-------------|---------------------|
|             | Action              |
|             | Show Data Type Card |
|             | Field               |
|             | Drinks              |
|             | Food                |
|             | Tax                 |
|             | Tip                 |

If the user chooses to show the data type card, they'll see the values for the fields.

| 104.67 |                            |  |
|--------|----------------------------|--|
|        | 104.67                     |  |
|        | Drinks                     |  |
|        | Soda                       |  |
|        |                            |  |
|        | Food<br>Sandwich and fries |  |
|        |                            |  |
|        | Tax                        |  |
|        | 5.5                        |  |
|        | Tip                        |  |
|        | 21                         |  |
|        |                            |  |
|        |                            |  |
|        |                            |  |
|        |                            |  |

Cell value properties can also be used in formulas.

{154}------------------------------------------------

## **Create a cell value with properties**

To create a cell value and add properties to it, use Range.valuesAsJson to assign properties. The following code sample shows how to create a new number in cell **A1**. It adds the **Food**, **Drinks**, and additional properties describing a bill in a restaurant. It assigns a JSON description of the properties to valuesAsJson .

```
TypeScript
async function createNumberProperties() {
 await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 const range = sheet.getRange("A1");
 range.valuesAsJson = [
 [
 {
 type: Excel.CellValueType.double,
 basicType: Excel.RangeValueType.double,
 basicValue: 14.67,
 properties: {
 Food: {
 type: Excel.CellValueType.string,
 basicType: Excel.RangeValueType.string,
 basicValue: "Sandwich and fries"
 },
 Drinks: {
 type: Excel.CellValueType.string,
 basicType: Excel.RangeValueType.string,
 basicValue: "Soda"
 },
 Tax: {
 type: Excel.CellValueType.double,
 basicType: Excel.RangeValueType.double,
 basicValue: 5.5
 },
 Tip: {
 type: Excel.CellValueType.double,
 basicType: Excel.RangeValueType.double,
 basicValue: 21
 }
 }
 }
 ]
 ];
 await context.sync();
 });
}
```
7 **Note**

{155}------------------------------------------------

Some cell values change based on a user's locale. The valuesAsJsonLocal property offers localization support and is available on all the same objects as valuesAsJson .

### **Add properties to an existing value**

To add properties to an existing value, first get the value from the cell using valuesAsJson , then add a properties JSON object to it. The following example shows how to get the number value from cell **A1** and assign a property named **Precision** to it. Note that you should check the type of the value to ensure it's a **string**, **double**, or **Boolean** basic type.

TypeScript

```
async function addPropertyToNumber() {
 await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let range = sheet.getRange("A1");
 range.load("valuesAsJson");
 await context.sync();
 let cellValue = range.valuesAsJson[0][0] as any;
 // Only apply this property to a double.
 if (cellValue.basicType === "Double") {
 cellValue.properties = {
 Precision: {
 type: Excel.CellValueType.double,
 basicValue: 4
 }
 };
 range.valuesAsJson = [[cellValue]];
 await context.sync();
 }
 });
}
```
### **Differences from entity values**

Adding properties to **string**, **Boolean**, and **double** basic types is similar to adding properties to entity values. However there are differences.

- Basic types have a non-error fallback so that calculations can operate on them. For example, consider the formula **=SUM(A1:A3)** where **A1** is **1**, **A2** is **2**, and **A3** is **3**. **A1** is a double with properties, while **A2** and **A3** don't have properties. The sum returns the correct result of **6**. The formula wouldn't work if **A1** was an entity value.

{156}------------------------------------------------

- When the value of a basic type is used in a calculation, the properties are excluded in the result. In the previous example of **=SUM(A1:A3)** where A1 is a double with properties, the result of **6** does not have any properties.
- If no icon is specified for a basic type, the cell doesn't show any icon. But if an entity value doesn't specify an icon, it shows a default icon in the cell value.

### **Formatted number values**

You can apply number formatting to values of type CellValueType.double . Use the numberFormat property in the JSON schema to specify a number format. The following code sample shows the complete schema of a number value formatted as currency. The formatted number value in the code sample displays as **$24.00** in the Excel UI.

```
TypeScript
// This is an example of the complete JSON of a formatted number value with a
property.
// In this case, the number is formatted as currency.
async function createCurrencyValue() {
 await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 const range = sheet.getRange("A1");
 range.valuesAsJson = [
 [
 {
 type: Excel.CellValueType.double,
 basicType: Excel.RangeValueType.double,
 basicValue: 24,
 numberFormat: "$0.00",
 properties: {
 Name: {
 type: Excel.CellValueType.string,
                   basicValue: "dollar"
 }
 }
 }
 ]
 ];
 await context.sync();
 });
}
```
The number formatting is considered the default format. If the user, or other code, applies formatting to a cell containing a formatted number, the applied format overrides the number's format.

{157}------------------------------------------------

# **Card layout**

Cell values with properties have a default data type card that the user can view. You can provide a custom card layout to use instead of the default card layout to improve the user experience when viewing properties. To do this, add the **layouts** property to the JSON description.

For more information, see Use cards with cell value data types.

## **Nested data types**

You can nest data types in a cell value, such as additional entity values, as well as **strings**, **doubles**, and **Booleans**. The following code sample shows how to create a cell value that represents the charge status on a computer battery. It contains a nested entity value that describes the computer properties for power consumption and charging status. The computer entity value also contains a nested string value that describes the computer's power plan.

TypeScript

```
async function createNumberWithNestedEntity() {
 await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 const range = sheet.getRange("A1");
 range.valuesAsJson = [
 [
 {
 type: Excel.CellValueType.double,
 basicType: Excel.RangeValueType.double,
 layouts: {
 compact: {
 icon: "Battery10"
 }
 },
 basicValue: 0.7,
 numberFormat: "00%",
 properties: {
 Computer: {
 type: Excel.CellValueType.entity,
                text: "Laptop",
                properties: {
 "Power Consumption": {
 type: Excel.CellValueType.double,
                    basicType: Excel.RangeValueType.double,
                    basicValue: 0.25,
                    numberFormat: "00%",
                    layouts: {
 compact: {
 icon: "Power"
 }
```

{158}------------------------------------------------

```
 },
               properties: {
 plan: {
 type: Excel.CellValueType.string,
                   basicType:
Excel.RangeValueType.string,
                   basicValue: "Balanced"
 }
 }
 },
             Charging: {
 type: Excel.CellValueType.boolean,
               basicType: Excel.RangeValueType.boolean,
               basicValue: true
 }
 }
 }
 }
 }
 ]
 ];
 await context.sync();
 });
}
```
The following image shows the number value and the data type card for the nested laptop entity.

|  | 70% <   ><br>70%          |  |
|--|---------------------------|--|
|  | Laptop                    |  |
|  | Charging                  |  |
|  | TRUE<br>Power Consumption |  |
|  |  25%                    |  |
|  |                           |  |
|  |                           |  |
|  |                           |  |

# **Compatibility**

On previous versions of Excel that don't support the data types feature, users see a warning of **Unavailable Data Type**. The value still displays in the cell and functions as expected with formulas and other Excel features. If the value is a formatted number, calculations use the basicValue in place of the formatted number.

{159}------------------------------------------------

On Excel versions older than Office 2016, the value is shown in the cell with no error and is indistinguishable from a basic value.

## **See also**

- Excel JavaScript API data types core concepts

{160}------------------------------------------------

# **Use cards with cell value data types**

Article  05/12/2025

You can specify card modal windows in the Excel UI for various cell value data types. Cards can display additional information beyond what's already visible in a cell, such as related images, product category information, and data attributions.

#### 7 **Note**

This article expands on information described in the **Excel data types core concepts** article. We recommend reading that article before learning about cards for cell values.

Cards are supported for the following cell value types.

- [EntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.entitycellvalue)
- [LinkedEntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.linkedentitycellvalue)
- **string**, **double**, and **Boolean** basic types

The following screenshot shows an example of an open entity value card, in this case for the **Chef Anton's Gumbo Mix** product from a list of grocery store products.

{161}------------------------------------------------

|    | A                                 | B                  | C                              |
|----|-----------------------------------|--------------------|--------------------------------|
| 1  | Product                           | ProductID          |  ProductName                  |
| 2  | 0 Chai                            |                    | 1 Chai                         |
| 3  | 0 Chang                           |                    | 2 Chang                        |
| 4  | 0 Aniseed Syrup                   |                    | 3 Aniseed Syrup                |
| 5  | Chef Anton's Cajun Seasoning      |                    | 4 Chef Anton's Cajun Seasoning |
|   | 0 Chef Anton's Gumbo Mix          |                    |                                |
| 7  |  Grandma's Boysenberry Spread   |                    |                                |
| 8  | 0 Uncle Bob's Organic Dried Pears |                    |                                |
| 9  |  Northwoods Cranberry Sauce     |                    |                                |
| 10 |  Mishi Kobe Niku                 |                    |                                |
| 11 |  Ikura                          |                    |                                |
| 12 | 0 Queso Cabrales                  |                    | Chef Anton's Gumbo Mix         |
| 13 | 0 Queso Manchego La Pastora       |                    |                                |
| 14 |  Konbu                          | Product ID         |                                |
| 15 |  Tofu                           | 5                  |                                |
| 16 | Genen Shouyu                      |                    |                                |
| 17 | 0 Pavlova                         | Category           |                                |
| 18 | Alice Mutton                      | Condiments<br>   |                                |
| 19 | Carnarvon Tigers                  |                    |                                |
| 20 | Teatime Chocolate Biscuits        | Quantity and price |                                |
| 21 | 0 Sir Rodney's Marmalade          |                    |                                |
| 22 |                                   |                    |                                |
| 23 |                                   | Quantity Per Unit  |                                |
| 24 |                                   | 36 boxes           |                                |
| 25 |                                   | Unit Price         |                                |
| 26 |                                   |                    |                                |
| 27 |                                   |                    |                                |

### **Card properties**

Use [properties](https://learn.microsoft.com/en-us/javascript/api/excel/excel.entitycellvalue#excel-excel-entitycellvalue-properties-member) to specify all custom information about your data types. The properties key supports nested data types. Each nested property, or data type, must have a type and basicValue setting.

#### ) **Important**

The nested properties data types are used in combination with the **Card layout** values described in the subsequent article section. After defining a nested data type in properties , it must be assigned in the layouts property to display on the card.

{162}------------------------------------------------

The following code snippet shows the JSON for an entity value with multiple data types nested within properties .

#### 7 **Note**

To experiment with this code snippet in a complete sample, open **Script Lab** in Excel and select **[Data types: Create entity cards from data in a table](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-entity-values.yaml)** in our **Samples** library.

TypeScript

```
const entity: Excel.EntityCellValue = {
 type: Excel.CellValueType.entity,
 text: productName,
 properties: {
 "Product ID": {
 type: Excel.CellValueType.string,
 basicValue: productID.toString() || ""
 },
 "Product Name": {
 type: Excel.CellValueType.string,
 basicValue: productName || ""
 },
 "Image": {
 type: Excel.CellValueType.webImage,
 address: product.productImage || ""
 },
 "Quantity Per Unit": {
 type: Excel.CellValueType.string,
 basicValue: product.quantityPerUnit || ""
 },
 "Unit Price": {
 type: Excel.CellValueType.double,
 basicValue: product.unitPrice,
 numberFormat: "$* #,##0.00"
 },
 Discontinued: {
 type: Excel.CellValueType.boolean,
 basicValue: product.discontinued || false
 }
 },
 layouts: {
 // Enter layout settings here.
 }
};
```
The following screenshot shows an entity value card that uses the preceding code snippet. The screenshot shows the **Product ID**, **Product Name**, **Image**, **Quantity Per Unit**, and **Unit Price** information from the preceding code snippet.

{163}------------------------------------------------

|    | A                                 | B                   |                                |
|----|-----------------------------------|---------------------|--------------------------------|
| 1  | Product                           | ProductID           | ProductName                    |
| 2  | 0 Chai                            |                     | 1 Chai                         |
| 3  |  Chang                         |                     | 2 Chang                        |
| 4  | Aniseed Syrup                     |                     | 3 Aniseed Syrup                |
| 5  | Chef Anton's Cajun Seasoning      |                     | 4 Chef Anton's Cajun Seasoning |
|   | Chef Anton's Gumbo Mix            |                     |                                |
| 7  |  Grandma's Boysenberry Spread   |                     |                                |
| 8  | 0 Uncle Bob's Organic Dried Pears |                     |                                |
| 9  |  Northwoods Cranberry Sauce     |                     |                                |
| 10 |  Mishi Kobe Niku                 |                     |                                |
| 11 | 0 Ikura                           |                     |                                |
| 12 | 00 Queso Cabrales                 |                     | Chef Anton's Gumbo Mix         |
| 13 | 0 Queso Manchego La Pastora       |                     |                                |
| 14 |  Konbu                          | Product ID          |                                |
| 15 |  Tofu                           | 5                   |                                |
| 16 | 0 Genen Shouyu                    |                     |                                |
| 17 | 0 Pavlova                         | Category            |                                |
| 18 | Alice Mutton                      | Condiments<br> |                                |
| 19 | Carnarvon Tigers                  |                     |                                |
| 20 | 0 Teatime Chocolate Biscuits      | Quantity and price  |                                |
| 21 | 0 Sir Rodney's Marmalade          |                     |                                |
| 22 |                                   |                     |                                |
| 23 |                                   | Quantity Per Unit   |                                |
| 24 |                                   | 36 boxes            |                                |
| 25 |                                   | Unit Price          |                                |
| 26 |                                   |                     |                                |
| 27 |                                   |                     |                                |

## **Card layout**

Cell values have a default data type card that the user can view. Specify a custom card layout to improve the user experience when viewing properties. The [layouts](https://learn.microsoft.com/en-us/javascript/api/excel/excel.entitycellvalue#excel-excel-entitycellvalue-layouts-member) property defines the structure and appearance of the card. Use layouts to specify attributes such as an icon, card title, image for a card, and the number of sections to display.

#### ) **Important**

The nested layouts values are used in combination with the **Card properties** data types described in the preceding article section. A nested data type must be defined in

{164}------------------------------------------------

The layouts property contains two direct subproperties, compact and card . The card property specifies the appearance of a card when the card is open. The compact property is optional and defines the icon for a value. The icon is shown in the cell value if it's provided. It can also be shown in the card if it's referenced as a subproperty.

See the [EntityCompactLayoutIcons](https://learn.microsoft.com/en-us/javascript/api/excel/excel.entitycompactlayouticons) enum for a full list of available icons. The next code snippet shows how to display the shoppingBag icon.

Within the card property, use the [CardLayoutStandardProperties](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cardlayoutstandardproperties) object to define the components of the card like title , subTitle , and sections .

The entity value JSON in the next code snippet shows a card layout with nested title and mainImage objects, as well as three sections within the card. Note that the title property "Product Name" has a corresponding data type in the preceding Card properties article section. The mainImage property also has a corresponding "Image" data type in the preceding section. The sections property takes a nested array and uses the [CardLayoutSectionStandardProperties](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cardlayoutsectionstandardproperties) object to define the appearance of each section.

Within each card section you can specify elements like layout , title , and properties . The layout key uses the [CardLayoutListSection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cardlayoutlistsection) object and accepts the value "List" . The properties key accepts an array of strings. Note that the properties values, such as "Product ID" , have corresponding data types in the preceding Card properties article section. Sections can also be collapsible and can be defined with boolean values as collapsed or not collapsed when the entity card is opened in the Excel UI.

#### 7 **Note**

To experiment with this code snippet in a complete sample, open **Script Lab** in Excel and select **[Data types: Create entity cards from data in a table](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-entity-values.yaml)** in our **Samples** library.

#### TypeScript

```
const entity: Excel.EntityCellValue = {
 type: Excel.CellValueType.entity,
 text: productName,
 properties: {
 // Enter property settings here.
 },
 layouts: {
 compact: {
 icon: Excel.EntityCompactLayoutIcons.shoppingBag
```

{165}------------------------------------------------

```
 },
 card: {
 title: { 
 property: "Product Name"
 },
 mainImage: { 
 property: "Image"
 },
 sections: [
 {
 layout: "List",
 properties: ["Product ID"]
 },
 {
 layout: "List",
 title: "Quantity and price",
 collapsible: true,
 collapsed: false, // This section will not be collapsed when
the card is opened.
 properties: ["Quantity Per Unit", "Unit Price"]
 },
 {
 layout: "List",
 title: "Additional information",
 collapsible: true,
 collapsed: true, // This section will be collapsed when the
card is opened.
 properties: ["Discontinued"]
 }
 ]
 }
 }
};
```
The following screenshot shows an entity value card that uses the preceding code snippets. In the screenshot, the shoppingBag icon displays alongside the product names in the spreadsheet. In the entity card, the mainImage object displays at the top, followed by the title object which uses the **Product Name** and is set to **Chef Anton's Gumbo Mix**. The screenshot also shows sections . The **Quantity and price** section is collapsible and contains **Quantity Per Unit** and **Unit Price**. The **Additional information** field is collapsible and is collapsed when the card is opened.

{166}------------------------------------------------

|    | A                                 | B                  |                                |
|----|-----------------------------------|--------------------|--------------------------------|
| 1  | Product                           |                    | ProductID ProductName          |
| 2  |  Chai                           |                    | 1 Chai                         |
| 3  | 0 Chang                           |                    | 2 Chang                        |
| 4  | 0 Aniseed Syrup                   |                    | 3 Aniseed Syrup                |
| 5  | Chef Anton's Cajun Seasoning      |                    | 4 Chef Anton's Cajun Seasoning |
|   | Chef Anton's Gumbo Mix            |                    | Image                          |
| 7  |  Grandma's Boysenberry Spread   |                    |                                |
| 8  | 0 Uncle Bob's Organic Dried Pears |                    | Chef Anton's Gumbo Mix         |
| 9  |  Northwoods Cranberry Sauce     |                    |                                |
| 10 |  Mishi Kobe Niku                | Product ID         | Title                          |
| 11 |  Ikura                          | 5                  |                                |
| 12 | Queso Cabrales                    | Category           | Sections                       |
| 13 | 0 Queso Manchego La Pastora       | <br>Condiments |                                |
| 14 |  Konbu                           |                    |                                |
| 15 |  Tofu                           |                    |                                |
| 16 |  Genen Shouyu                   | Quantity and price |                                |
| 17 |  Pavlova                        |                    |                                |
| 18 | Alice Mutton                      | Quantity Per Unit  |                                |
| 19 | Carnarvon Tigers                  | 36 boxes           |                                |
| 20 | 0 Teatime Chocolate Biscuits      |                    |                                |
| 21 | 0 Sir Rodney's Marmalade          | Unit Price  USD   |                                |
| 22 |                                   | $21.35             |                                |
| 23 |                                   |                    |                                |
| 24 |                                   |                    |                                |
| 25 |                                   |                    | Additional information         |
| 26 |                                   |                    |                                |
| 27 |                                   |                    |                                |
|    |                                   |                    |                                |

#### 7 **Note**

In the preceding screenshot, the branch icon displays alongside **Condiments** in the **Category** section. See the **[Data types: Create entity cards from data in a table](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-entity-values.yaml)** sample to learn how to set nested icons like the **Category** section icon.

There is a known issue with nested icons in Excel on Mac. In that environment, nested icons will always display as the generic icon, regardless of which icon is selected with the EntityCompactLayoutIcons enum.

### **Property metadata**

{167}------------------------------------------------

Entity properties have an optional propertyMetadata field that uses the

[CellValuePropertyMetadata](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellvaluepropertymetadata) object and offers the properties attribution , excludeFrom , and sublabel . The following code snippet shows how to add a sublabel to the "Unit Price" property from the preceding code snippet. In this case, the sublabel identifies the currency type.

#### 7 **Note**

The propertyMetadata field is only available on data types that are nested within entity properties.

TypeScript

```
// This code snippet is an excerpt from the `properties` field of the 
// preceding `EntityCellValue` snippet. "Unit Price" is a property of 
// an entity value.
 "Unit Price": {
 type: Excel.CellValueType.double,
 basicValue: product.unitPrice,
 numberFormat: "$* #,##0.00",
 propertyMetadata: {
 sublabel: "USD"
 }
 },
```
## **Attribution**

Add attribution for information that comes from third parties to indicate the source and any license information. Use [Excel.CellValueAttributionAttributes](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellvalueattributionattributes) to add attribution to a cell value. The following code example shows how to add attribution for usage of information about the planet Mars from Wikipedia.

```
TypeScript
async function createPlanet() {
 await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 const range = sheet.getRange("A1");
 const attributionObject: Excel.CellValueAttributionAttributes = {
 licenseAddress: 
"https://en.wikipedia.org/wiki/Wikipedia:Wikipedia_is_free_content",
 licenseText: "Free usage information",
 sourceAddress: "https://en.wikipedia.org/wiki/Mars",
 sourceText: "Wikipedia"
 };
```

{168}------------------------------------------------

```
 range.valuesAsJson = [
 [
 {
 type: Excel.CellValueType.double,
 basicType: Excel.RangeValueType.double,
 basicValue: 6779, // kilometers (radius)
 properties: {
 Name: {
 type: Excel.CellValueType.string,
                basicType: Excel.RangeValueType.string,
                basicValue: "Mars",
                propertyMetadata: {
 sublabel: "Planetary Body",
                  attribution: [attributionObject]
 }
 }
 }
 }
 ]
 ];
 await context.sync();
 });
}
```
The following image shows how the attribution is displayed in the data type card for the user.

| 6779 | 6779                               |  |
|------|------------------------------------|--|
|      | Name  Planetary Body<br>Mars      |  |
|      | Wikipedia  Free usage information |  |
|      |                                    |  |
|      |                                    |  |
|      |                                    |  |

## **Provider information**

You can add information about your add-in, or service, that is the source for the information in the data type card. Use [Excel.CellValueProviderAttributes](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellvalueproviderattributes) to add your provider information. The following code sample shows how to add provider information for Contoso generic search as the source of search data for the cell value.

```
TypeScript
async function createSearchEntry() {
 await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getActiveWorksheet();
```

{169}------------------------------------------------

```
 const range = sheet.getRange("A1");
 range.valuesAsJson = [
 [
 {
 type: Excel.CellValueType.string,
 basicType: Excel.RangeValueType.string,
 basicValue: "cell function - Microsoft support",
 properties: {
 "Search Keywords": {
 type: Excel.CellValueType.string,
                  basicType: Excel.RangeValueType.string,
                  basicValue: "Cell Values"
 }
 },
 provider: {
 description: "Contoso generic search",
               // Image credit: Ignacio javier igjav, Public domain, via
Wikimedia Commons
 logoSourceAddress: 
"https://upload.wikimedia.org/wikipedia/commons/f/f9/Lupa.png",
 logoTargetAddress: "https://contoso.com"
 }
 }
 ]
 ];
 await context.sync();
 });
}
```
The following image shows how the provider information appears as the logo in the data type card for the user.

{170}------------------------------------------------

### **Next steps**

Try out the [Create and explore data types in Excel](https://github.com/OfficeDev/Office-Add-in-samples/tree/main/Samples/excel-data-types-explorer) sample in our [OfficeDev/Office-Add-in](https://github.com/OfficeDev/Office-Add-in-samples)[samples](https://github.com/OfficeDev/Office-Add-in-samples) repository. This sample guides you through building and then sideloading an add-in that creates and edits data types in a workbook.

## **See also**

- Overview of data types in Excel add-ins
- Excel data types core concepts
- [Create and explore data types in Excel](https://github.com/OfficeDev/Office-Add-in-samples/tree/main/Samples/excel-data-types-explorer)
- Excel JavaScript API reference

{171}------------------------------------------------

# **Create linked entity cell values**

Article  05/12/2025

Linked entity cell values integrate data types from external data sources and can display the data as an entity card, like regular entity values. They enable you to scale your data types to represent large data sets without downloading all the data into the workbook. The [Stocks and](https://support.microsoft.com/office/excel-data-types-stocks-and-geography-61a33056-9935-484f-8ac8-f1a89e210877) [Geography data domains](https://support.microsoft.com/office/excel-data-types-stocks-and-geography-61a33056-9935-484f-8ac8-f1a89e210877) available via the Excel UI provide linked entity cell values. This article explains how to create your own data provider in an Excel add-in to provide custom values for end users.

Linked entity cell values are linked to an external data source. They provide the following advantages over regular entity values.

- Linked entity cell values can nest, and nested linked entity cell values are not retrieved until referenced; either by the user, or by the worksheet. This helps reduce file size and improve workbook performance.
- Excel uses a cache to allow different cells to reference the same linked entity cell value seamlessly. This also improves workbook performance.

This article expands on information described in the following articles. We recommend reading the following articles before learning how to build your own linked entity cell values.

- [Excel data types: Stocks and geography](https://support.microsoft.com/office/61a33056-9935-484f-8ac8-f1a89e210877)
- Overview of data types in Excel add-ins
- Excel JavaScript API data types entity value card

# **Key concepts**

Linked entity cell values provide the user with data linked from an external data source. The user can view them as an entity value card.

{172}------------------------------------------------

| Seattle |                                          |  |
|---------|------------------------------------------|--|
|         |                                          |  |
|         | Seattle<br>Learn more on Bing            |  |
|         | Admin Division 2 (County/district/other) |  |
|         | OD King County, Washington               |  |
|         | Admin Division 1 (State/province/other)  |  |
|         | Washington                               |  |
|         | Country/region                           |  |
|         | United States                            |  |

Like regular entity values, linked entity cell values can be referenced in formulas.

## **Definitions**

The following definitions are fundamental to understanding how to implement your own linked entity cell values.

- **Linked entity data domain** A linked entity data domain describes the overall category that an entity belongs to. Some examples are employees, organizations, or cars.
- **Linked entity cell value** An instance created from a data domain. An example is an employee value for someone named Joe. It can be displayed as an entity value card.
- **Data provider** The data provider is recognized by Excel as the source of data for one or more registered linked entity data domains.
- **Linked entity load service function** Every linked entity data domain defines a load service function to act as the source of data for that domain. The linked entity load

{173}------------------------------------------------

service function handles requests from Excel to get linked entity cell values for the workbook. You implement it as a TypeScript or JavaScript custom function.

## **How your add-in provides linked entity cell values**

This diagram shows the steps that occur when your add-in is loaded and then inserts a new linked entity cell value into a cell. The following description explains what happens at each step of the process.

| Workbook                                   | Excel                                   |                                     |
|--------------------------------------------|-----------------------------------------|-------------------------------------|
|                                            |                                         | Your add-in                         |
| 2<br>Registered data domains<br>- Products | Register data domains                   | { //Initialization code }           |
| ProductID ProductName<br>Product<br>Chai   | Insert linked entity cell<br>3<br>value | Function or custom function         |
| Chai<br>Product ID                         | 4<br>Request product data               |                                     |
| P1<br>Severage<br>Quantity and price       | 5<br>Provide product data               | Linked entity load service function |
|                                            |                                         |                                     |

- 1. Excel loads your add-in, and your add-in registers all of the linked entity data domains that it supports. Each registration includes the ID of a linked entity load service function. This ID is called later by Excel to request property values for the linked entity cell value from the linked entity data domain. In this example, one data domain named **Products** is registered.
- 2. Excel tracks each registered linked entity data domain in a linked entity data domain collection. This enables Excel to call your linked entity load service function when data is needed for a linked entity cell value.
- 3. Your add-in inserts a new linked entity cell value into the worksheet. In this example a new linked entity cell value is created for the product **Chai**. This would typically occur from the user choosing a button on your add-in that results in creating one or more linked entity cell values. When you create new linked entity cell values, they only contain an initial text string that is displayed in the cell. Excel calls your linked entity load service function to get the remaining property values. Your add-in can also create linked entity cell values from custom functions.
- 4. Excel calls the linked entity load service function that you registered in step 1. This occurs every time you create a new linked entity cell value, or if a data refresh occurs. Excel calls your linked entity load service function to get all of the property values.

{174}------------------------------------------------

- 5. The linked entity load service function returns an up-to-date linked entity cell value ([Excel.LinkedEntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.linkedentitycellvalue)) for the linked entity ID ([Excel.LinkedEntityId](https://learn.microsoft.com/en-us/javascript/api/excel/excel.linkedentityid)) requested by Excel. Typically, your linked entity load service function queries an external data source to get the values and create the linked entity cell value. In this example the values for **product ID**, **category**, **quantity**, and **price** are returned.
#### 7 **Note**

If Excel needs multiple linked entity cell values, the linked entity IDs are passed as a batch to your linked entity load service function. The linked entity load service then returns a batch result of all values.

The following sections provide additional details about the terms defined earlier in this article.

### **Data provider**

Your add-in is the data provider and is recognized by Excel as the source of data for one or more registered data domains. Your add-in exposes one or more data provider functions that return data for linked entity cell values. The [data provider](https://learn.microsoft.com/en-us/javascript/api/excel/excel.linkedentitydatadomaincreateoptions) is identified by a text string such as **Contoso** or the name of your add-in. The name must be unique within your add-in.

### **Linked entity data domains**

The data provider (your add-in) registers one or more data domains. A data domain describes an entity to Excel. For example, a data provider can provide the **products** and **categories** data domains. The domains must be registered with Excel so that it can work with those domains to retrieve and display linked entity cell values and perform calculations.

A data domain describes to Excel the following attributes:

- The name of the data provider it is associated with.
- A domain ID to uniquely identify it, such as **products**.
- A display name for the user, such as **Products**.
- A linked entity load service function to call when Excel needs a linked entity cell value.
- A specified refresh mode and interval describing how often it refreshes.

An example of a linked entity data domain is the **Geography** data domain in Excel that provides linked entity cell values for cities.

### **Linked entity cell value**

{175}------------------------------------------------

A linked entity cell value is an instance created from a data domain. An example is a value for Seattle, from the [Geography data domain](https://support.microsoft.com/office/excel-data-types-stocks-and-geography-61a33056-9935-484f-8ac8-f1a89e210877) . It displays an entity value card like regular entity cell values.

Since linked entity cell values are linked to the data domain, they can be refreshed. Also, nested linked entity cell values are not retrieved unless the user requests them (such as viewing the entity card). And nested entity cell values aren't saved with the worksheet unless they are referenced from the worksheet (such as a formula). This reduces file size and improves performance.

### **Linked entity load service function**

Each data domain requires a function that Excel can call when it needs linked entity cell values. Your add-in provides the service as a JavaScript or TypeScript function tagged with **@linkedEntityLoadService**. It's recommended to create just one load service function for best performance. Excel sends all requests for linked entity cell values as a batch to the load service function.

## **Create a data provider with data domains**

The following sections of this article show how to write TypeScript code to implement an Excel add-in that is a data provider for **Contoso**. It provides two data domains named **Products** and **Categories**.

### **Register the data domains**

{176}------------------------------------------------

Let's look at the code to register new domains named **Products** and **Categories**. The data provider name is **Contoso**. When the add-in loads, it first registers the data domains with Excel.

Use the [Excel.LinkedEntityDataDomainCreateOptions](https://learn.microsoft.com/en-us/javascript/api/excel/excel.linkedentitydatadomaincreateoptions) type to describe the options you want, including which function to use as the linked entity load service. Then add the domain to the [Workbook.linkedEntityDataDomains](https://learn.microsoft.com/en-us/javascript/api/excel/excel.workbook#excel-excel-workbook-linkedentitydatadomains-member) collection. It's recommended to register domains when you Initialize your Office Add-in. The following code shows how to register the **Products**, **Categories**, and **Suppliers** data domains.

```
TypeScript
Office.onReady(async () => {
 await Excel.run(async (context) => {
 const productsDomain: Excel.LinkedEntityDataDomainCreateOptions = {
 dataProvider: "Contoso",
 id: "products",
 name: "Products",
 // ID of the custom function that is called on demand by Excel to
resolve or refresh linked entity cell values of this data domain.
 loadFunctionId: "CONTOSOLOADSERVICE",
 // periodicRefreshInterval is only required when supportedRefreshModes
contains "Periodic".
 periodicRefreshInterval: 300,
 // Manual refresh mode is always supported, even if unspecified.
 supportedRefreshModes: [
 Excel.LinkedEntityDataDomainRefreshMode.periodic,
 Excel.LinkedEntityDataDomainRefreshMode.onLoad
 ]
 };
 const categoriesDomain: Excel.LinkedEntityDataDomainCreateOptions = {
 dataProvider: "Contoso",
 id: "categories",
 name: "Categories",
 loadFunctionId: "CONTOSOLOADSERVICE",
 periodicRefreshInterval: 300,
 supportedRefreshModes: [
 Excel.LinkedEntityDataDomainRefreshMode.periodic,
 Excel.LinkedEntityDataDomainRefreshMode.onLoad
 ]
 };
 const suppliersDomain: Excel.LinkedEntityDataDomainCreateOptions = {
 dataProvider: "Contoso",
 id: "suppliers",
 name: "Suppliers",
 loadFunctionId: "CONTOSOLOADSERVICE"
 };
 // Register the data domains by adding them to the collection.
 context.workbook.linkedEntityDataDomains.add(productsDomain);
 context.workbook.linkedEntityDataDomains.add(categoriesDomain);
 context.workbook.linkedEntityDataDomains.add(suppliersDomain);
```

{177}------------------------------------------------

```
 await context.sync();
 });
});
```
## **Insert a linked entity cell value**

There are two ways to insert a linked entity cell value into a cell on a worksheet.

- Create a command button on the ribbon or a button in your task pane. When the user selects the button, your code inserts a linked entity cell value.
- Create a custom function that returns a linked entity cell value.

The following code example shows how to insert a new linked entity cell value into the selected cell. This code can be called from a command button on the ribbon, or a button in the task pane. Notes about the following code:

- You must specify a serviceId of 268436224 for any linked entity cell values you return. This informs Excel that the linked entity cell value is associated with an Excel add-in.
- You must specify a culture . Excel will pass it to your linked entity load service function so that you can maintain the original culture when the workbook is opened in a different culture.
- The text property is displayed to the user in the cell while the linked entity data value is updated. This prevents the user seeing a blank cell while the update is completed.

```
TypeScript
```

```
async function insertProduct() {
 await Excel.run(async (context) => {
 const productLinkedEntity: Excel.LinkedEntityCellValue = {
 type: Excel.CellValueType.linkedEntity,
 id: {
 entityId: "P1", // Don't use exclamation marks in this value.
 domainId: "products", // Don't use exclamation marks in this
value.
 serviceId: 268436224,
 culture: "en-US",
 },
 text: "Chai",
 };
 context.workbook.getActiveCell().valuesAsJson = [[productLinkedEntity]];
 await context.sync();
 });
}
```

{178}------------------------------------------------

#### 7 **Note**

Don't use exclamation marks in the entityID or domainId values.

The following code sample shows how to insert a linked entity cell value by using a custom function. A user could get a linked entity cell value by entering =CONTOSO.GETPRODUCTBYID("productid") into any cell. The notes for the previous code sample also apply to this one.

|  | TypeScript |  |
|--|------------|--|

```
/**
* Custom function that shows how to insert a `LinkedEntityCellValue`.
* @customfunction
* @param {string} productID Unique ID of the product.
* @return {any} `LinkedEntityCellValue` for the requested product, if found.
*/
function getProductById(productID: string): any {
 const product = getProduct(productID);
 if (product === null) {
 throw new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable, 
"Invalid productID");
 }
 const productLinkedEntity: Excel.LinkedEntityCellValue = {
 type: Excel.CellValueType.linkedEntity,
 id: {
 entityId: product.productID,
 domainId: "products",
 serviceId: 268436224,
 culture: "en-US",
 },
 text: product.productName
 };
 return productLinkedEntity;
}
```
### **Implement the linked entity load service function**

The add-in must provide a linked entity load service function to handle requests from Excel when property values are needed for any linked entity cell values. The function is identified with the @linkedEntityLoadService JSDoc tag.

The following code example shows how to create a function that handles data requests from Excel for the **Products** and **Categories** data domains. Notes on the following code:

{179}------------------------------------------------

- It uses helper functions to create the linked entity cell values. That code is shown later.
- If an error occurs it throws a CustomFunctions.ErrorCode.notAvailable error. This displays #CONNECT! in the cell that the user sees.

```
TypeScript
```

```
// Linked entity data domain constants
const productsDomainId = "products";
const categoriesDomainId = "categories";
const suppliersDomainId = "suppliers";
// Linked entity cell value constants
const addinDomainServiceId = 268436224;
const defaultCulture = "en-US";
/**
* Custom function which acts as the "service" or the data provider for a
`LinkedEntityDataDomain`, that is
* called on demand by Excel to resolve/refresh `LinkedEntityCellValue`s of that
`LinkedEntityDataDomain`.
* @customfunction
* @linkedEntityLoadService
* @param {any} request Request to resolve/refresh `LinkedEntityCellValue`
objects.
* @return {any} Resolved/Refreshed `LinkedEntityCellValue` objects that were
requested in the passed-in request.
*/
function contosoLoadService(request: any): any {
 const notAvailableError = new
CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable);
 console.log(`Fetching linked entities from request: ${request} ...`);
 try {
 // Parse the request that was passed-in by Excel.
 const parsedRequest: Excel.LinkedEntityLoadServiceRequest = 
JSON.parse(request);
 // Initialize result to populate and return to Excel.
 const result: Excel.LinkedEntityLoadServiceResult = { entities: [] };
 // Identify the domainId of the request and call the corresponding
function to create
 // linked entity cell values for that linked entity data domain.
 for (const { entityId } of parsedRequest.entities) {
 var linkedEntityResult = null;
 switch (parsedRequest.domainId) {
 case productsDomainId: {
 linkedEntityResult = makeProductLinkedEntity(entityId);
 break;
 }
 case categoriesDomainId: {
 linkedEntityResult = makeCategoryLinkedEntity(entityId);
 break;
 }
```

{180}------------------------------------------------

```
 case suppliersDomainId: {
 linkedEntityResult = makeSupplierLinkedEntity(entityId);
 break;
 }
 default:
 throw notAvailableError;
 }
 if (!linkedEntityResult) {
 // Throw an error to signify to Excel that resolution/refresh of
the requested linkedEntityId failed.
 throw notAvailableError;
 }
 result.entities.push(linkedEntityResult);
 }
 return result;
 } catch (error) {
 console.error(error);
 throw notAvailableError;
 }
}
```
The following code sample shows the helper function to create a product linked entity cell value. This function is called by the previous code contosoLoadService to create a linked entity for a specific product ID. Notes on the following code:

- It uses the same settings as the previous insertProduct example for the type , id , and text properties.
- It includes additional properties specific to the **Products** data domain, such as Product Name and Unit Price .
- It creates a deferred nested linked entity for the category of the product. The properties for the category are not requested until they are needed.

```
/** Helper function to create a linked entity from product properties. */
function makeProductLinkedEntity(productID: string): any {
 // Search the product data in the data source for a matching product ID.
 const product = getProduct(productID);
 if (product === null) {
 // Return null if no matching product is found.
 return null;
 }
 const productLinkedEntity: Excel.LinkedEntityCellValue = {
 type: "LinkedEntity",
 text: product.productName,
 id: {
```
TypeScript

{181}------------------------------------------------

```
 entityId: product.productID,
 domainId: productsDomainId,
 serviceId: addinDomainServiceId,
 culture: defaultCulture
 },
 properties: {
 "Product ID": {
 type: "String",
 basicValue: product.productID
 },
 "Product Name": {
 type: "String",
 basicValue: product.productName
 },
 "Quantity Per Unit": {
 type: "String",
 basicValue: product.quantityPerUnit
 },
 // Add Unit Price as a formatted number.
 "Unit Price": {
 type: "FormattedNumber",
 basicValue: product.unitPrice,
 numberFormat: "$* #,##0.00"
 },
 Discontinued: {
 type: "Boolean",
 basicValue: product.discontinued
 }
 },
 layouts: {
 compact: {
 icon: "ShoppingBag"
 },
 card: {
 title: { property: "Product Name" },
 sections: [
 {
 layout: "List",
              properties: ["Product ID"]
 },
 {
 layout: "List",
              title: "Quantity and price",
              collapsible: true,
              collapsed: false,
              properties: ["Quantity Per Unit", "Unit Price"]
 },
 {
 layout: "List",
              title: "Additional information",
              collapsed: true,
              properties: ["Discontinued"]
 }
 ]
 }
```

{182}------------------------------------------------

```
 }
 };
 // Add image property to the linked entity and then add it to the card layout.
 if (product.productImage) {
 productLinkedEntity.properties["Image"] = {
 type: "WebImage",
 address: product.productImage
 };
 productLinkedEntity.layouts.card.mainImage = { property: "Image" };
 }
 // Add a deferred nested linked entity for the product category.
 const category = getCategory(product.categoryID.toString());
 if (category) {
 productLinkedEntity.properties["Category"] = {
 type: "LinkedEntity",
 text: category.categoryName,
 id: {
 entityId: category.categoryID.toString(),
 domainId: categoriesDomainId,
 serviceId: addinDomainServiceId,
 culture: defaultCulture
 }
 };
 // Add nested product category to the card layout.
 productLinkedEntity.layouts.card.sections[0].properties.push("Category");
 }
 // Add a deferred nested linked entity for the supplier.
 const supplier = getSupplier(product.supplierID.toString());
 if (supplier) {
 productLinkedEntity.properties["Supplier"] = {
 type: "LinkedEntity",
 text: supplier.companyName,
 id: {
 entityId: supplier.supplierID.toString(),
 domainId: suppliersDomainId,
 serviceId: addinDomainServiceId,
 culture: defaultCulture
 }
 };
 // Add nested product supplier to the card layout.
 productLinkedEntity.layouts.card.sections[2].properties.push("Supplier");
 }
 return productLinkedEntity;
```
The following code sample shows the helper function to create a category linked entity cell value. This function is called by the previous code contosoLoadService to create a linked entity

}

{183}------------------------------------------------

for a specific category ID.

TypeScript

```
/** Helper function to create a linked entity from category properties. */
function makeCategoryLinkedEntity(categoryID: string): any {
 // Search the sample JSON category data for a matching category ID.
 const category = getCategory(categoryID);
 if (category === null) {
 // Return null if no matching category is found.
 return null;
 }
 const categoryLinkedEntity: Excel.LinkedEntityCellValue = {
 type: "LinkedEntity",
 text: category.categoryName,
 id: {
 entityId: category.categoryID,
 domainId: categoriesDomainId,
 serviceId: addinDomainServiceId,
 culture: defaultCulture
 },
 properties: {
 "Category ID": {
 type: "String",
 basicValue: category.categoryID,
 propertyMetadata: {
 // Exclude the category ID property from the card view and
auto-complete.
 excludeFrom: {
 cardView: true,
                 autoComplete: true
 }
 }
 },
 "Category Name": {
 type: "String",
 basicValue: category.categoryName
 },
 Description: {
 type: "String",
 basicValue: category.description
 }
 },
 layouts: {
 compact: {
 icon: "Branch"
 }
 }
 };
 return categoryLinkedEntity;
}
```

{184}------------------------------------------------

The following code sample shows the helper function to create a supplier linked entity cell value. This function is called by the previous code contosoLoadService to create a linked entity for a specific supplier ID.

TypeScript

```
/** Helper function to create linked entity from supplier properties. */
function makeSupplierLinkedEntity(supplierID: string): any {
 // Search the sample JSON category data for a matching supplier ID.
 const supplier = getSupplier(supplierID);
 if (supplier === null) {
 // Return null if no matching supplier is found.
 return null;
 }
 const supplierLinkedEntity: Excel.LinkedEntityCellValue = {
 type: "LinkedEntity",
 text: supplier.companyName,
 id: {
 entityId: supplier.supplierID,
 domainId: suppliersDomainId,
 serviceId: addinDomainServiceId,
 culture: defaultCulture
 },
 properties: {
 "Supplier ID": {
 type: "String",
 basicValue: supplier.supplierID
 },
 "Company Name": {
 type: "String",
 basicValue: supplier.companyName
 },
 "Contact Name": {
 type: "String",
 basicValue: supplier.contactName
 },
 "Contact Title": {
 type: "String",
 basicValue: supplier.contactTitle
 }
 },
 cardLayout: {
 title: { property: "Company Name" },
 sections: [
 {
 layout: "List",
 properties: ["Supplier ID", "Company Name", "Contact Name", 
"Contact Title"]
 }
 ]
 }
 };
```

{185}------------------------------------------------

```
 return supplierLinkedEntity;
```
}

The following code sample contains sample data you can use with the previous code samples.

```
TypeScript
/// Sample product data.
const products = [
 {
 productID: "P1",
 productName: "Chai",
 supplierID: "S1",
 categoryID: "C1",
 quantityPerUnit: "10 boxes x 20 bags",
 unitPrice: 18,
 discontinued: false,
 productImage: 
"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Masala_Chai.JPG/320px-
Masala_Chai.JPG"
 }
];
/// Sample product category data.
const categories = [
 {
 categoryID: "C1",
 categoryName: "Beverages",
 description: "Soft drinks, coffees, teas, beers, and ales"
 }];
/// Sample product supplier data.
const suppliers = [
 {
 supplierID: "S1",
 companyName: "Exotic Liquids",
 contactName: "Ema Vargova",
 contactTitle: "Purchasing Manager"
 }];
```
## **Data refresh options**

When you register a data domain, the user can refresh it manually at any time, such as by choosing **Refresh All** from the **Data** tab. There are three refresh modes you can specify for your data domain.

- manual The data is refreshed only when the user chooses to refresh. This is the default mode. Manual refresh can always be performed by the user, even when the refresh mode

{186}------------------------------------------------

is set to onLoad or periodic .

- onLoad The data is refreshed when the data domain is registered (typically when the add-in is loaded). Afterwards, data is only refreshed manually by the user. If you want to refresh data when the workbook is opened, configure your add-in to load on document open. For more information, see Run code in your Office Add-in when the document opens.
- periodic The data is refreshed when the data domain is registered (typically when the add-in is loaded). Afterwards, the data is continuously updated after a specified interval of time. For example you could specify that the data domain refreshes every 300 seconds (which is the minimum value). The number of seconds is always rounded up to the nearest number of minutes since the refresh interval is only performed in minutes.

The following code example shows how to configure a data domain to refresh on load, and then continue to refresh every 5 minutes.

```
TypeScript
const productsDomain: Excel.LinkedEntityDataDomainCreateOptions = {
 dataProvider: domainDataProvider,
 id: "products",
 name: "Products",
 // ID of the custom function that is called on demand by Excel to resolve or
refresh linked entity cell values of this data domain.
 loadFunctionId: loadFunctionId,
 // periodicRefreshInterval is only required when supportedRefreshModes
contains "Periodic".
 periodicRefreshInterval: 300, // equivalent to 5 minutes.
 // Manual refresh mode is always supported, even if unspecified.
 supportedRefreshModes: [
 Excel.LinkedEntityDataDomainRefreshMode.periodic,
 Excel.LinkedEntityDataDomainRefreshMode.onLoad
 ]
};
```
You can also programmatically request a refresh on a linked entity data domain by using either of the following methods.

- LinkedEntityDataDomain.refresh() Refreshes all LinkedEntityCellValue objects of the linked entity data domain.
- LinkedEntityDataDomainCollection.refreshAll() Refreshes all LinkedEntityCellValue objects of all linked entity data domains in the collection.

The refresh methods request a refresh which occurs asynchronously. To determine the results of the refresh, listen for the onRefreshCompleted event. The following code sample shows an example of listening for the onRefreshCompleted event.

{187}------------------------------------------------

```
TypeScript
```

```
await Excel.run(async (context) => {
 const dataDomains = context.workbook.linkedEntityDataDomains;
 dataDomains.onRefreshCompleted.add(onLinkedEntityDomainRefreshed);
 await context.sync();
});
async function onLinkedEntityDomainRefreshed(eventArgs:
Excel.LinkedEntityDataDomainRefreshCompletedEventArgs): Promise<any> {
 console.log("Linked entity domain refreshed: " + eventArgs.id);
 console.log("Refresh status: " + eventArgs.refreshed);
 console.log("Refresh error: " + eventArgs.errors);
 return null;
}
```
## **Error handling with the linked entity load service**

When Excel calls your add-in to get data for a linked entity cell value, it's possible an error can occur. If Excel is unable to connect to your add-in at all, such as when the add-in isn't loaded, Excel displays the #CONNECT! error to the user.

If your linked entity load service function encounters an error, it should throw the notAvailableError error. This causes Excel to show #CONNECT! to the user.

The following code shows how to handle an error in a linked entity load service function.

```
TypeScript
async function contosoLoadService(request: any): Promise<any> {
 const notAvailableError = new
CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable);
 try {
 // Create and return a new linked entity cell value.
 let linkedEntityResult = ...
 ...
 if (!linkedEntityResult) {
 // Throw an error to signify to Excel that resolution or refresh of
the requested linkedEntityId failed.
 throw notAvailableError;
 }
 ...
 } catch (error) {
 console.error(error);
 throw notAvailableError;
 }
}
```

{188}------------------------------------------------

# **Debugging the linked entity load service**

Most add-in functionality for linked entity data types can be debugged using the guidance in Overview of debugging Office Add-ins. However, the linked entity load service function can be implemented in a shared runtime or a JavaScript-only runtime (also know as a custom functions runtime.) If you choose to implement the function in a JavaScript-only runtime, use the Custom functions debugging in a non-shared runtime guidance.

The linked entity load service function uses the custom functions architecture, regardless of which runtime you use. However, there are significant differences from regular custom functions.

Linked entity load service functions have the following differences from custom functions:

- They don't appear to end users for usage in formulas.
- They don't support the JSDoc tags @streaming or @volatile . The user will see a **#CALC!** error if these tags are used.

Linked entity load service functions have the following similarities with custom functions:

- They use Custom functions naming and localization.
- They use the same error handling approach.

## **Behavior in Excel 2019 and earlier**

If someone opens a worksheet with linked entity cell values on an older version of Excel that doesn't support linked entity cell values, Excel shows the cell values as errors. This is the designed behavior. This is also why you set the basicType to Error and the basicValue to #VALUE! every time you insert or update a linked entity cell value. This is the error that Excel uses as a fallback on older versions.

# **Best practices**

- Don't use exclamation marks in the entityID or domainId values.
- Register linked entity data domains in the initialization code Office.OnReady so that the user has immediate functionality such as the ability to refresh the linked entity cell values.
- After publishing your add-in, don't change the linked entity data domain IDs. Consistent IDs across the same logical objects helps with performance.
- Always provide the text property when creating a new linked entity cell value. This value is displayed while Excel calls your data provider function to get the remaining property values. Otherwise the user sees a blank cell until the data is retrieved.

{189}------------------------------------------------

## **See also**

- Overview of data types in Excel add-ins

{190}------------------------------------------------

# **Add reference methods to cell values**

09/05/2025

Add reference methods to cell values to give users access to dynamic calculations based on the cell value. The [EntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.entitycellvalue) and [LinkedEntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.linkedentitycellvalue) types support reference methods. For example, add a method to a product entity value that converts its weight to different units.

The following image shows an example of adding a ConvertWeight method to a product entity value representing pancake mix.

| 81<br> |                 |  | : X  Jxv |  | =A1.ConvertWeight("ounces") |  |  |  |
|---------|-----------------|--|-----------|--|-----------------------------|--|--|--|
|         |               |  |           |  |                             |  |  |  |
|         | 1 & Pancake mix |  | 35        |  |                             |  |  |  |
|         |                 |  |           |  |                             |  |  |  |

The [DoubleCellValue,](https://learn.microsoft.com/en-us/javascript/api/excel/excel.doublecellvalue) [BooleanCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.booleancellvalue), and [StringCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.stringcellvalue) types also support reference methods. The following image shows an example of adding a ConvertToRomanNumeral method to a double value type.

| 81 |  |      |  :   fx  =A1.ConvertToRomanNumeral() |  |  |  |  |
|----|--|------|------------------------------------------|--|--|--|--|
|    |  |      |                                          |  |  |  |  |
|    |  | 6 VI |                                          |  |  |  |  |

Reference methods don't appear on the data type card.

| & Pancake mix | Pancake mix                 |  |
|---------------|-----------------------------|--|
|               | Product ID<br>1             |  |
|               | Product Name<br>Pancake mix |  |
|               | Unit Price<br>$5.45         |  |
|               |                             |  |
|               |                             |  |

## **Add a reference method to an entity value**

To add a reference method to an entity value, define it in JSON by using the

Excel.JavaScriptCustomFunctionReferenceCellValue type. The following code sample shows

{191}------------------------------------------------

how to define a simple method that returns the value 27.

TypeScript

TypeScript

```
const referenceCustomFunctionGet27:
Excel.JavaScriptCustomFunctionReferenceCellValue = { 
 type: Excel.CellValueType.function,
 functionType: Excel.FunctionCellValueType.javaScriptReference,
 namespace: "CONTOSO", 
 id: "GET27" 
}
```
The properties are described in the following table.

####  **Expand table**

| Property     | Description                                                                                                                                                                                                                  |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| type         | Specifies the type of reference. This property only supports function and must be set to<br>Excel.CellValueType.function .                                                                                                   |
| functionType | Specifies the type of function. This property only supports JavaScript reference functions,<br>and must be set to Excel.FunctionCellValueType.javaScriptReference                                                            |
| namespace    | The namespace that contains the custom function. This value must match the namespace<br>specified by the customFunctions.namespace element in the unified manifest, or the<br>Namespace element in the add-in only manifest. |
| id           | The name of the custom function to map to this reference method. The name is the<br>uppercase version of the custom function name.                                                                                           |

When you create the entity value, add the reference method to the properties list. The following code sample shows how to create a simple entity value named Math and add a reference method to it. Get27 is the method name that appears to users (for example: A1.Get27() ).

```
function makeMathEntity(value: number){
 const entity: Excel.EntityCellValue = {
 type: Excel.CellValueType.entity,
 text: "Math value",
 properties: {
 "value": {
 type: Excel.CellValueType.double,
 basicValue: value,
 numberFormat: "#"
 },
 Get27: referenceCustomFunctionGet27
```

{192}------------------------------------------------

```
 }
 };
 return entity;
}
```
The following code sample shows how to create an instance of the Math entity and add it to the selected cell.

```
TypeScript
// Add entity to selected cell.
async function addEntityToCell(){
 const entity: Excel.EntityCellValue = makeMathEntity(10);
 await Excel.run( async (context) => {
 const cell = context.workbook.getActiveCell();
 cell.valuesAsJson = [[entity]];
 await context.sync();
 });
}
```
Finally, implement the reference method with a custom function. The following code sample shows how to implement the custom function.

TypeScript /** * Returns the value 27. * @customfunction * @excludeFromAutoComplete * @returns {number} 27 */ function get27() { return 27; }

In the previous code sample, the @excludeFromAutoComplete tag ensures the custom function doesn't appear in the Excel UI when a user enters it in a search box. However, a user can still call the custom function separately from an entity value if they enter it directly into a cell.

When the code runs, it creates a Math entity value as shown in the following image. The method appears in formula AutoComplete when the user references the entity value from a formula.

{193}------------------------------------------------

|   | A                  | B             | C |
|---|--------------------|---------------|---|
| 1 | > Math value = A1. |               |   |
| 2 |                    | 1 10          |   |
| 3 |                    | (fx) AddValue |   |
| 4 |                    | (fx) Get27    |   |
| 5 |                    | value         |   |
|   |                    |               |   |

## **Add arguments**

If your reference method needs arguments, add them to the custom function. The following code example shows how to add an argument named x to a method named addValue . The method adds one to the x value by calling a custom function named addValue .

```
TypeScript
/**
 * Adds a value to 1.
 * @customfunction
 * @excludeFromAutoComplete
 * @param {number} x The value to add to 1.
 * @return {number[][]} Sum of x and 1.
 */
function addValue(x): number[][] { 
 return [[x+1]];
}
```
## **Reference the entity value as a calling object**

A common scenario is that your methods need to reference properties on the entity value itself to perform calculations. For example, it's more useful if the addValue method adds the argument value to the entity value itself. Specify that the entity value is passed as the first argument by applying the @capturesCallingObject tag to the custom function as shown in the following code example.

```
TypeScript
/**
 * Adds x to the calling object.
 * @customfunction
 * @excludeFromAutoComplete
 * @capturesCallingObject
 * @param {any} math The math object (calling object).
 * @param {number} x The value to add.
 * @return {number[][]} Sum.
 */
function addValue(math, x): number[][] {
```

{194}------------------------------------------------

```
 const result: number = math.properties["value"].basicValue + x;
 return [[result]];
}
```
You can use any argument name that conforms to the Excel syntax rules in [Names in](https://support.microsoft.com/office/names-in-formulas-fc2935f9-115d-4bef-a370-3aa8bb4c91f1) [formulas](https://support.microsoft.com/office/names-in-formulas-fc2935f9-115d-4bef-a370-3aa8bb4c91f1) . Because this is a math entity, the calling object argument is named math . The argument name can be used in the calculation. In the previous code sample, it retrieves the math.[value] property to perform the calculation.

The following code sample shows the implementation of the Contoso.addValue function.

```
TypeScript
/**
 * Adds x to the calling object.
 * @customfunction
 * @excludeFromAutoComplete
 * @param {any} math The math object (calling object).
 * @param {number} x The value to add.
 * @return {number[][]} Sum.
 */
function addValue(math, x): number[][] { 
 const result: number = math.properties["value"].basicValue + x;
 return [[result]];
}
```
Note the following about the previous code sample.

- The @excludeFromAutoComplete tag ensures that the custom function doesn't appear in the Excel UI when a user enters it in a search box. However, a user can still call the custom function separately from an entity value if they enter it directly into a cell.
- The calling object is always passed as the first argument and must be of type any . In this case, it's named math and is used to get the value property from the math object.
- It returns a double array of numbers.
- When the user interacts with the reference method in Excel, they don't see the calling object as an argument.

# **Example: Calculate product sales tax**

The following code shows how to implement a custom function that calculates the sales tax for the unit price of a product.

TypeScript

{195}------------------------------------------------

```
/**
 * Calculates the price when a sales tax rate is applied.
 * @customfunction
 * @excludeFromAutoComplete
 * @capturesCallingObject
 * @param {any} product The product entity value (calling object).
 * @param {number} taxRate The tax rate (0.11 = 11%).
 * @return {number[][]} Product unit price with tax rate applied.
 */
function applySalesTax(product, taxRate): number[][] {
 const unitPrice: number = product.properties["Unit Price"].basicValue;
 const result: number = unitPrice * taxRate + unitPrice;
 return [[result]];
}
```
The following code sample shows how to specify the reference method and includes the id of the applySalesTax custom function.

```
TypeScript
const referenceCustomFunctionCalculateSalesTax:
Excel.JavaScriptCustomFunctionReferenceCellValue = { 
 type: Excel.CellValueType.function,
 functionType: Excel.FunctionCellValueType.javaScriptReference,
 namespace: "CONTOSO", 
 id: "APPLYSALESTAX" 
}
```
The following code shows how to add the reference method to the product entity value.

```
TypeScript
function makeProductEntity(productID: number, productName: string, price: number) 
{
 const entity: Excel.EntityCellValue = {
 type: Excel.CellValueType.entity,
 text: productName,
 properties: {
 "Product ID": {
 type: Excel.CellValueType.string,
 basicValue: productID.toString() || ""
 },
 "Product Name": {
 type: Excel.CellValueType.string,
 basicValue: productName || ""
 },
 "Unit Price": {
 type: Excel.CellValueType.formattedNumber,
 basicValue: price,
 numberFormat: "$* #,##0.00"
```

{196}------------------------------------------------

```
 },
 applySalesTax: referenceCustomFunctionCalculateSalesTax
 },
 };
 return entity;
}
```
## **Exclude custom functions from the Excel UI**

Use the @excludeFromAutoComplete tag in the JSDoc tag of custom functions used by reference methods to indicate that the function be excluded from formula AutoComplete and Formula Builder. This helps prevent users from accidentally using a custom function separately from its entity value.

#### 7 **Note**

If the function is manually entered correctly in the grid, the function still runs.

#### ) **Important**

A function can't have both @excludeFromAutoComplete and @linkedEntityLoadService tags.

The @excludeFromAutoComplete tag is processed during build to generate a **functions.json** file by the **Custom-Functions-Metadata** package. This package is automatically added to the build process if you create your add-in with the Yeoman generator for Office Add-ins and choose a custom functions template. If you aren't using the **Custom-Functions-Metadata** package, you'll need to add the excludeFromAutoComplete property manually to the **functions.json** file.

The following code sample shows how to manually define the APPLYSALESTAX custom function with JSON in the **functions.json** file. The excludeFromAutoComplete property is set to true .

```
JSON
{
 "description": "Calculates the price when a sales tax rate is applied.",
 "id": "APPLYSALESTAX",
 "name": "APPLYSALESTAX",
 "options": {
 "excludeFromAutoComplete": true,
 "capturesCallingObject": true
 },
 "parameters": [
 {
```

{197}------------------------------------------------

```
 "description": "The product entity value (calling object).",
 "name": "product",
 "type": "any"
 },
 {
 "description": "The tax rate (0.11 = 11%).",
 "name": "taxRate",
 "type": "number"
 }
 ],
 "result": {
 "dimensionality": "matrix",
 "type": "number"
 }
},
```
For more information, see Manually create JSON metadata for custom functions.

### **Add a function to a basic value type**

To add functions to the basic value types of Boolean , double , and string , use the same process as you would for entity values. The following code sample shows how to create a double basic value with a custom function called addValue . The function adds the value x to the basic value.

```
TypeScript
/**
 * Adds the value x to the number value.
 * @customfunction
 * @capturesCallingObject
 * @param {any} numberValue The number value (calling object).
 * @param {number} x The value to add.
 * @return {number[][]} Sum of the number value and x.
 */
export function addValue(numberValue: any, x: number): number[][] {
 return [[x+numberValue.basicValue]];
}
```
The following code sample shows how to define the addValue custom function from the preceding sample in JSON and then reference it with a method called createSimpleNumber .

TypeScript

```
const referenceCustomFunctionAddValue:
Excel.JavaScriptCustomFunctionReferenceCellValue = { 
 type: Excel.CellValueType.function,
```

{198}------------------------------------------------

```
 functionType: Excel.FunctionCellValueType.javaScriptReference,
 namespace: "CONTOSO", 
 id: "ADDVALUE" 
} 
async function createSimpleNumber() {
 await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 const range = sheet.getRange("A1");
 range.valuesAsJson = [
 [
 {
 type: Excel.CellValueType.double,
 basicType: Excel.RangeValueType.double,
 basicValue: 6.0,
 properties: {
 addValue: referenceCustomFunctionAddValue
 }
 }
 ]
 ];
 await context.sync();
 });
}
```
## **Optional arguments**

The following code sample shows how to create a reference method that accepts optional arguments. The reference method is named generateRandomRange and it generates a range of random values.

```
TypeScript
const referenceCustomFunctionOptional:
Excel.JavaScriptCustomFunctionReferenceCellValue = { 
 type: Excel.CellValueType.function,
 functionType: Excel.FunctionCellValueType.javaScriptReference,
 namespace: "CONTOSO", 
 id: "GENERATERANDOMRANGE" 
}
function makeProductEntity(productID: number, productName: string, price: number) 
{
 const entity: Excel.EntityCellValue = {
 type: Excel.CellValueType.entity,
 text: productName,
 properties: {
 "Product ID": {...},
 "Product Name": {...},
 "Unit Price": {...},
 generateRandomRange: referenceCustomFunctionOptional
```

{199}------------------------------------------------

```
 },
 };
 return entity;
}
```
The following code sample shows the implementation of the reference method as a custom function named generateRandomRange . It returns a dynamic array of random values matching the number of rows and columns specified. The min and max arguments are optional, and if not specified will default to 1 and 10 .

| TypeScript                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| /**<br>* Generates a dynamic array of random numbers.<br>* @customfunction<br>* @excludeFromAutoComplete<br>* @param {number} rows Number of rows to generate.<br>* @param {number} columns Number of columns to generate.<br>* @param {number} [min] Lowest number that can be generated. Default is 1.<br>* @param {number} [max] Highest number that can be generated. Default is 10.<br>* @returns {number[][]} A dynamic array of random numbers.<br>*/<br>function generateRandomRange(rows, columns, min, max) {<br>// Set defaults for any missing optional arguments.<br>if (min === undefined) min = 1;<br>if (max === undefined) max = 10; |
| let numbers = new Array(rows);<br>for (let r = 0; r < rows; r++) {<br>numbers[r] = new Array(columns);<br>for (let c = 0; c < columns; c++) {<br>numbers[r][c] = Math.round(Math.random() * (max - min) ) + min;<br>}<br>}<br>return numbers;                                                                                                                                                                                                                                                                                                                                                                                                         |
| }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

When the user enters the custom function in Excel, AutoComplete shows the properties of the function and indicates optional arguments by surrounding them in brackets ( [] ). The following image shows an example of entering optional parameters by using the generateRandomRange reference method.

|   |  | B                                                |  | D | E |  |
|---|-----|--------------------------------------------------|--|---|---|--|
|   |     |                                                  |  |   |   |  |
|   |     | 2   { } unicycle = A2.generateRandomRange(       |  |   |   |  |
| 3 |     | generateRandomRange(rows, columns, [min], [max]) |  |   |   |  |
|   |     |                                                  |  |   |   |  |

{200}------------------------------------------------

## **Multiple parameters**

Reference methods support multiple parameters, similar to how the Excel SUM function supports multiple parameters. The following code sample shows how to create a reference function that concatenates zero or more product names passed in a products array. The function is shown to the user as concatProductNames([products], ...) .

```
TypeScript
/** 
 * @customfunction 
 * @excludeFromAutoComplete 
 * @description Concatenate the names of given products, joined by " | " 
 * @param {any[]} products - The products to concatenate.
 * @returns A string of concatenated product names. 
 */
function concatProductNames(products: any[]): string { 
 return products.map((product) => product.properties["Product
Name"].basicValue).join(" | "); 
}
```
The following code sample shows how to create an entity with the concatProductNames reference method.

```
TypeScript
const referenceCustomFunctionMultiple:
Excel.JavaScriptCustomFunctionReferenceCellValue = { 
 type: Excel.CellValueType.function,
 functionType: Excel.FunctionCellValueType.javaScriptReference,
 namespace: "CONTOSO", 
 id: "CONCATPRODUCTNAMES" 
} 
function makeProductEntity(productID: number, productName: string, price: number) 
{
 const entity: Excel.EntityCellValue = {
 type: Excel.CellValueType.entity,
 text: productName,
 properties: {
 "Product ID": {...},
 "Product Name": {...},
 "Unit Price": {...},
 concatProductNames: referenceCustomFunctionMultiple,
 },
 };
 return entity;
}
```

{201}------------------------------------------------

The following image shows an example of entering multiple parameters by using the concatProductNames reference method.

|  |                | 1   { } bicycle  = a1.concatProductNames(a1,a2  |  |  |  |
|--|----------------|-------------------------------------------------|--|--|--|
|  | 2   { unicycle | [ concatProductNames([products], [products],  ) |  |  |  |
|  |                |                                                 |  |  |  |

#### **Multiple parameters with ranges**

To support passing ranges to your reference method such as **B1:B3**, use a multidimensional array. The following code sample shows how to create a reference function that sums zero or more parameters which can include ranges.

```
TypeScript
/** 
 * @customfunction 
 * @excludeFromAutoComplete 
 * @description Calculate the sum of arbitrary parameters. 
 * @param {number[][][]} operands - The operands to sum. 
 * @returns The sum of all operands. 
 */
function sumAll(operands: number[][][]): number { 
 let total: number = 0; 
 operands.forEach(range => { 
 range.forEach(row => { 
 row.forEach(num => { 
 total += num; 
 }); 
 }); 
 }); 
 return total; 
}
```
The following code sample shows how to create an entity with the sumAll reference method.

```
TypeScript
const referenceCustomFunctionRange:
Excel.JavaScriptCustomFunctionReferenceCellValue = { 
 type: Excel.CellValueType.function,
 functionType: Excel.FunctionCellValueType.javaScriptReference,
 namespace: "CONTOSO", 
 id: "SUMALL" 
} 
function makeProductEntity(productID: number, productName: string, price: number)
```

{202}------------------------------------------------

```
{
 const entity: Excel.EntityCellValue = {
 type: Excel.CellValueType.entity,
 text: productName,
 properties: {
 "Product ID": {...},
 "Product Name": {...},
 "Unit Price": {...},
 sumAll: referenceCustomFunctionRange
 },
 };
 return entity;
}
```
The following image shows an example of entering multiple parameters, including a range parameter, by using the sumAll reference method.

|     |                  | B                                 | C | D |  |
|-----|--------------------|-----------------------------------|---|---|--|
| 1   |  bicycle  $       | 89.50                             |   |   |  |
| 2   | & unicycle $       | 77.10                             |   |   |  |
| 3   | =A2.sumAll(B1:B2,5 |                                   |   |   |  |
|  |                    | sumAll([operands], [operands],  ) |   |   |  |

## **Support details**

Reference methods are supported in all custom function types, such as volatile and streaming functions. All custom function return typesmatrix, scalar, and errorare supported.

#### ) **Important**

A linked entity can't have a custom function that combines both a reference method and a data provider. When you develop linked entities, keep these types of custom functions separate.

## **See also**

- Create custom functions in Excel
- Autogenerate JSON metadata for custom functions
- Manually create JSON metadata for custom functions

{203}------------------------------------------------

# **Add data validation to Excel ranges**

Article  03/22/2022

The Excel JavaScript Library provides APIs to enable your add-in to add automatic data validation to tables, columns, rows, and other ranges in a workbook. To understand the concepts and the terminology of data validation, please see the following articles about how users add data validation through the Excel UI.

- [Apply data validation to cells](https://support.microsoft.com/office/29fecbcc-d1b9-42c1-9d76-eff3ce5f7249)
- [More on data validation](https://support.microsoft.com/office/f38dee73-9900-4ca6-9301-8a5f6e1f0c4c)
- [Description and examples of data validation in Excel](https://support.microsoft.com/help/211485)

## **Programmatic control of data validation**

The Range.dataValidation property, which takes a [DataValidation](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datavalidation) object, is the entry point for programmatic control of data validation in Excel. There are five properties to the DataValidation object:

- rule Defines what constitutes valid data for the range. See [DataValidationRule.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datavalidationrule)
- errorAlert Specifies whether an error pops up if the user enters invalid data, and defines the alert text, title, and style; for example, information , warning , and stop . See [DataValidationErrorAlert.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datavalidationerroralert)
- prompt Specifies whether a prompt appears when the user hovers over the range and defines the prompt message. See [DataValidationPrompt](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datavalidationprompt).
- ignoreBlanks Specifies whether the data validation rule applies to blank cells in the range. Defaults to true .
- type A read-only identification of the validation type, such as WholeNumber, Date, TextLength, etc. It is set indirectly when you set the rule property.

#### 7 **Note**

Data validation added programmatically behaves just like manually added data validation. In particular, note that data validation is triggered only if the user directly enters a value into a cell or copies and pastes a cell from elsewhere in the workbook and chooses the **Values** paste option. If the user copies a cell and does a plain paste into a range with data validation, validation is not triggered.

# **Creating validation rules**

{204}------------------------------------------------

To add data validation to a range, your code must set the rule property of the DataValidation object in Range.dataValidation . This takes a [DataValidationRule](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datavalidationrule) object which has seven optional properties. *No more than one of these properties may be present in any DataValidationRule object.* The property that you include determines the type of validation.

#### **Basic and DateTime validation rule types**

The first three DataValidationRule properties (i.e., validation rule types) take a [BasicDataValidation](https://learn.microsoft.com/en-us/javascript/api/excel/excel.basicdatavalidation) object as their value.

- wholeNumber Requires a whole number in addition to any other validation specified by the BasicDataValidation object.
- decimal Requires a decimal number in addition to any other validation specified by the BasicDataValidation object.
- textLength Applies the validation details in the BasicDataValidation object to the *length* of the cell's value.

Here is an example of creating a validation rule. Note the following about this code.

- The operator is the binary operator greaterThan . Whenever you use a binary operator, the value that the user tries to enter in the cell is the left-hand operand and the value specified in formula1 is the right-hand operand. So this rule says that only whole numbers that are greater than 0 are valid.
- The formula1 is a hard-coded number. If you don't know at coding time what the value should be, you can also use an Excel formula (as a string) for the value. For example, "=A3" and "=SUM(A4,B5)" could also be values of formula1 .

```
JavaScript
```

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let range = sheet.getRange("B2:C5");
 range.dataValidation.rule = {
 wholeNumber: {
 formula1: 0,
 operator: Excel.DataValidationOperator.greaterThan
 }
 };
 await context.sync();
});
```

{205}------------------------------------------------

See [BasicDataValidation](https://learn.microsoft.com/en-us/javascript/api/excel/excel.basicdatavalidation) for a list of the other binary operators.

There are also two ternary operators: between and notBetween . To use these, you must specify the optional formula2 property. The formula1 and formula2 values are the bounding operands. The value that the user tries to enter in the cell is the third (evaluated) operand. The following is an example of using the "Between" operator.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let range = sheet.getRange("B2:C5");
 range.dataValidation.rule = {
 decimal: {
 formula1: 0,
 formula2: 100,
 operator: Excel.DataValidationOperator.between
 }
 };
 await context.sync();
});
```
The next two rule properties take a [DateTimeDataValidation](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datetimedatavalidation) object as their value.

- date
- time

The DateTimeDataValidation object is structured similarly to the BasicDataValidation : it has the properties formula1 , formula2 , and operator , and is used in the same way. The difference is that you cannot use a number in the formula properties, but you can enter a [ISO 8606 datetime](https://www.iso.org/iso-8601-date-and-time-format.html) string (or an Excel formula). The following is an example that defines valid values as dates in the first week of April, 2022.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let range = sheet.getRange("B2:C5");
 range.dataValidation.rule = {
 date: {
 formula1: "2022-04-01",
 formula2: "2022-04-08",
 operator: Excel.DataValidationOperator.between
 }
 };
```

{206}------------------------------------------------

```
 await context.sync();
});
```
### **List validation rule type**

Use the list property in the DataValidationRule object to specify that the only valid values are those from a finite list. The following is an example. Note the following about this code.

- It assumes that there is a worksheet named "Names" and that the values in the range "A1:A3" are names.
- The source property specifies the list of valid values. The string argument refers to a range containing the names. You can also assign a comma-delimited list; for example: "Sue, Ricky, Liz".
- The inCellDropDown property specifies whether a drop-down control will appear in the cell when the user selects it. If set to true , then the drop-down appears with the list of values from the source .

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let range = sheet.getRange("B2:C5"); 
 let nameSourceRange =
context.workbook.worksheets.getItem("Names").getRange("A1:A3");
 range.dataValidation.rule = {
 list: {
 inCellDropDown: true,
 source: "=Names!$A$1:$A$3"
 }
 };
 await context.sync();
})
```
### **Custom validation rule type**

Use the custom property in the DataValidationRule object to specify a custom validation formula. The following is an example. Note the following about this code.

- It assumes there is a two-column table with columns **Athlete Name** and **Comments** in the A and B columns of the worksheet.

{207}------------------------------------------------

- To reduce verbosity in the **Comments** column, it makes data that includes the athlete's name invalid.
- SEARCH(A2,B2) returns the starting position, in string in B2, of the string in A2. If A2 is not contained in B2, it does not return a number. ISNUMBER() returns a boolean. So the formula property says that valid data for the **Comment** column is data that does not include the string in the **Athlete Name** column.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let commentsRange =
sheet.tables.getItem("AthletesTable").columns.getItem("Comments").getDataBod
yRange();
 commentsRange.dataValidation.rule = {
 custom: {
 formula: "=NOT(ISNUMBER(SEARCH(A2,B2)))"
 }
 };
 await context.sync();
});
```
### **Create validation error alerts**

You can a create custom error alert that appears when a user tries to enter invalid data in a cell. The following is a simple example. Note the following about this code.

- The style property determines whether the user gets an informational alert, a warning, or a "stop" alert. Only stop actually prevents the user from adding invalid data. The pop-ups for warning and information have options that allow the user enter the invalid data anyway.
- The showAlert property defaults to true . This means that Excel will pop-up a generic alert (of type stop ) unless you create a custom alert which either sets showAlert to false or sets a custom message, title, and style. This code sets a custom message and title.

JavaScript

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let range = sheet.getRange("B2:C5");
 range.dataValidation.errorAlert = {
```

{208}------------------------------------------------

```
 message: "Sorry, only positive whole numbers are allowed",
 showAlert: true, // The default is 'true'.
 style: Excel.DataValidationAlertStyle.stop,
 title: "Negative or Decimal Number Entered"
 };
 // Set range.dataValidation.rule and optionally .prompt here.
 await context.sync();
});
```
For more information, see [DataValidationErrorAlert](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datavalidationerroralert).

## **Create validation prompts**

You can create an instructional prompt that appears when a user hovers over, or selects, a cell to which data validation has been applied. The following is an example.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let range = sheet.getRange("B2:C5");
 range.dataValidation.prompt = {
 message: "Please enter a positive whole number.",
 showPrompt: true, // The default is 'false'.
 title: "Positive Whole Numbers Only."
 };
 // Set range.dataValidation.rule and optionally .errorAlert here.
 await context.sync();
});
```
For more information, see [DataValidationPrompt](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datavalidationprompt).

### **Remove data validation from a range**

To remove data validation from a range, call the [Range.dataValidation.clear()](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datavalidation#excel-excel-datavalidation-clear-member(1)) method.

```
JavaScript
myrange.dataValidation.clear()
```

{209}------------------------------------------------

It isn't necessary that the range you clear is exactly the same range as a range on which you added data validation. If it isn't, only the overlapping cells, if any, of the two ranges are cleared.

#### 7 **Note**

Clearing data validation from a range will also clear any data validation that a user has added manually to the range.

### **See also**

- Excel JavaScript object model in Office Add-ins
- [DataValidation Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datavalidation)
- [Range Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range)

{210}------------------------------------------------

# **Work with Events using the Excel JavaScript API**

Article  05/19/2023

This article describes important concepts related to working with events in Excel and provides code samples that show how to register event handlers, handle events, and remove event handlers using the Excel JavaScript API.

## **Events in Excel**

Each time certain types of changes occur in an Excel workbook, an event notification fires. By using the Excel JavaScript API, you can register event handlers that allow your add-in to automatically run a designated function when a specific event occurs. The following events are currently supported.

| Event                    | Description                                                                                                        | Supported objects                                                                 |
|--------------------------|--------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
| onActivated              | Occurs when an object is<br>activated.                                                                             | Chart, ChartCollection, Shape,<br>Worksheet,<br>WorksheetCollection               |
| onActivated              | Occurs when a workbook is<br>activated.                                                                            | Workbook                                                                          |
| onAdded                  | Occurs when an object is added<br>to the collection.                                                               | ChartCollection,<br>CommentCollection,<br>TableCollection,<br>WorksheetCollection |
| onAutoSaveSettingChanged | Occurs when the autoSave setting<br>is changed on the workbook.                                                    | Workbook                                                                          |
| onCalculated             | Occurs when a worksheet has<br>finished calculation (or all the<br>worksheets of the collection have<br>finished). | Worksheet,<br>WorksheetCollection                                                 |
| onChanged                | Occurs when the data of<br>individual cells or comments has<br>changed.                                            | CommentCollection, Table,<br>TableCollection, Worksheet,<br>WorksheetCollection   |

{211}------------------------------------------------

| Event               | Description                                                                                                              | Supported objects                                                                 |
|---------------------|--------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
| onColumnSorted      | Occurs when one or more<br>columns have been sorted. This<br>happens as the result of a left-to<br>right sort operation. | Worksheet,<br>WorksheetCollection                                                 |
| onDataChanged       | Occurs when data or formatting<br>within the binding is changed.                                                         | Binding                                                                           |
| onDeactivated       | Occurs when an object is<br>deactivated.                                                                                 | Chart, ChartCollection, Shape,<br>Worksheet,<br>WorksheetCollection               |
| onDeleted           | Occurs when an object is deleted<br>from the collection.                                                                 | ChartCollection,<br>CommentCollection,<br>TableCollection,<br>WorksheetCollection |
| onFormatChanged     | Occurs when the format is<br>changed on a worksheet.                                                                     | Worksheet,<br>WorksheetCollection                                                 |
| onFormulaChanged    | Occurs when a formula is<br>changed.                                                                                     | Worksheet,<br>WorksheetCollection                                                 |
| onMoved             | Occurs when a worksheet is<br>moved within a workbook.                                                                   | WorksheetCollection                                                               |
| onNameChanged       | Occurs when the worksheet name<br>is changed.                                                                            | Worksheet,<br>WorksheetCollection                                                 |
| onProtectionChanged | Occurs when the worksheet<br>protection state is changed.                                                                | Worksheet,<br>WorksheetCollection                                                 |
| onRowHiddenChanged  | Occurs when the row-hidden<br>state changes on a specific<br>worksheet.                                                  | Worksheet,<br>WorksheetCollection                                                 |
| onRowSorted         | Occurs when one or more rows<br>have been sorted. This happens<br>as the result of a top-to-bottom<br>sort operation.    | Worksheet,<br>WorksheetCollection                                                 |
| onSelectionChanged  | Occurs when the active cell or<br>selected range is changed.                                                             | Binding, Table, Workbook,<br>Worksheet,<br>WorksheetCollection                    |
| onSettingsChanged   | Occurs when the Settings in the<br>document are changed.                                                                 | SettingCollection                                                                 |
| onSingleClicked     | Occurs when left-clicked/tapped                                                                                          | Worksheet,                                                                        |

{212}------------------------------------------------

| Event               | Description                                         | Supported objects                 |
|---------------------|-----------------------------------------------------|-----------------------------------|
|                     | action occurs in the worksheet.                     | WorksheetCollection               |
| onVisibilityChanged | Occurs when the worksheet<br>visibility is changed. | Worksheet,<br>WorksheetCollection |

### **Events in preview**

#### 7 **Note**

The following events are currently available only in public preview. To use this feature, you must use the preview version of the Office JavaScript API library from the **[Office.js content delivery network (CDN)](https://appsforoffice.microsoft.com/lib/beta/hosted/office.js)** . The **[type definition file](https://appsforoffice.microsoft.com/lib/beta/hosted/office.d.ts)** for TypeScript compilation and IntelliSense is found at the CDN and **[DefinitelyTyped](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts)** . You can install these types with npm install --save-dev @types/office-js-preview . For more information on our upcoming APIs, please visit **[Excel JavaScript API](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/excel-preview-apis) [requirement sets](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/excel-preview-apis)**.

 **Expand table**

| Event      | Description                                      | Supported objects                                         |
|------------|--------------------------------------------------|-----------------------------------------------------------|
| onFiltered | Occurs when a filter is applied to<br>an object. | Table, TableCollection, Worksheet,<br>WorksheetCollection |

### **Event triggers**

Events within an Excel workbook can be triggered by:

- User interaction via the Excel user interface (UI) that changes the workbook
- Office Add-in (JavaScript) code that changes the workbook
- VBA add-in (macro) code that changes the workbook

Any change that complies with default behavior of Excel will trigger the corresponding events in a workbook.

### **Lifecycle of an event handler**

An event handler is created when an add-in registers the event handler. It is destroyed when the add-in unregisters the event handler or when the add-in is refreshed,

{213}------------------------------------------------

reloaded, or closed. Event handlers do not persist as part of the Excel file, or across sessions with Excel on the web.

#### U **Caution**

When an object to which events are registered is deleted (e.g., a table with an onChanged event registered), the event handler no longer triggers but remains in memory until the add-in or Excel session refreshes or closes.

#### **Events and coauthoring**

With coauthoring, multiple people can work together and edit the same Excel workbook simultaneously. For events that can be triggered by a coauthor, such as onChanged , the corresponding **Event** object will contain a **source** property that indicates whether the event was triggered locally by the current user ( event.source == Local ) or was triggered by the remote coauthor ( event.source == Remote ).

### **Register an event handler**

The following code sample registers an event handler for the onChanged event in the worksheet named **Sample**. The code specifies that when data changes in that worksheet, the handleChange function should run.

```
JavaScript
await Excel.run(async (context) => {
 const worksheet = context.workbook.worksheets.getItem("Sample");
 worksheet.onChanged.add(handleChange);
 await context.sync();
 console.log("Event handler successfully registered for onChanged event
in the worksheet.");
}).catch(errorHandlerFunction);
```
## **Handle an event**

As shown in the previous example, when you register an event handler, you indicate the function that should run when the specified event occurs. You can design that function to perform whatever actions your scenario requires. The following code sample shows an event handler function that simply writes information about the event to the console.

{214}------------------------------------------------

```
JavaScript
async function handleChange(event) {
 await Excel.run(async (context) => {
 await context.sync(); 
 console.log("Change type of event: " + event.changeType);
 console.log("Address of event: " + event.address);
 console.log("Source of event: " + event.source); 
 }).catch(errorHandlerFunction);
}
```
### **Remove an event handler**

The following code sample registers an event handler for the onSelectionChanged event in the worksheet named **Sample** and defines the handleSelectionChange function that will run when the event occurs. It also defines the remove() function that can subsequently be called to remove that event handler. Note that the RequestContext used to create the event handler is needed to remove it.

```
JavaScript
let eventResult;
async function run() {
 await Excel.run(async (context) => {
 const worksheet = context.workbook.worksheets.getItem("Sample");
 eventResult = worksheet.onSelectionChanged.add(handleSelectionChange);
 await context.sync();
 console.log("Event handler successfully registered for
onSelectionChanged event in the worksheet.");
 });
}
async function handleSelectionChange(event) {
 await Excel.run(async (context) => {
 await context.sync();
 console.log("Address of current selection: " + event.address);
 });
}
async function remove() {
 // The `RequestContext` used to create the event handler is needed to
remove it.
 // In this example, `eventContext` is being used to keep track of that
context.
 await Excel.run(eventResult.context, async (context) => {
 eventResult.remove();
 await context.sync();
```

{215}------------------------------------------------

```
 eventResult = null;
 console.log("Event handler successfully removed.");
 });
}
```
### **Enable and disable events**

The performance of an add-in may be improved by disabling events. For example, your app might never need to receive events, or it could ignore events while performing batch-edits of multiple entities.

Events are enabled and disabled at the [runtime](https://learn.microsoft.com/en-us/javascript/api/excel/excel.runtime) level. The enableEvents property determines if events are fired and their handlers are activated.

The following code sample shows how to toggle events on and off.

```
JavaScript
await Excel.run(async (context) => {
 context.runtime.load("enableEvents");
 await context.sync();
 let eventBoolean = !context.runtime.enableEvents;
 context.runtime.enableEvents = eventBoolean;
 if (eventBoolean) {
 console.log("Events are currently on.");
 } else {
 console.log("Events are currently off.");
 }

 await context.sync();
});
```
## **See also**

- Excel JavaScript object model in Office Add-ins
#### 6 **Collaborate with us on GitHub**

The source for this content can be found on GitHub, where you can also create and review

#### **Office Add-ins feedback**

Office Add-ins is an open source project. Select a link to provide feedback:

{216}------------------------------------------------

issues and pull requests. For more information, see [our](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md) [contributor guide](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md).

- [Open a documentation issue](https://github.com/OfficeDev/office-js-docs-pr/issues/new?template=3-customer-feedback.yml&pageUrl=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Foffice%2Fdev%2Fadd-ins%2Fexcel%2Fexcel-add-ins-events&pageQueryParams=&contentSourceUrl=https%3A%2F%2Fgithub.com%2FOfficeDev%2Foffice-js-docs-pr%2Fblob%2Fmain%2Fdocs%2Fexcel%2Fexcel-add-ins-events.md&documentVersionIndependentId=dfe8c9fb-4107-e19b-972a-c5a58eeb2646&feedback=%0A%0A%5BEnter+feedback+here%5D%0A&author=%40o365devx&metadata=*+ID%3A+52542c44-015a-746d-5d6f-c43f6e4e6774+%0A*+Service%3A+**excel**%0A*+Sub-service%3A+**add-ins**)
- [Provide product feedback](https://aka.ms/office-addins-dev-questions)

{217}------------------------------------------------

# **Work with notes using the Excel JavaScript API**

06/27/2025

This article describes how to add, change, and remove notes in a workbook with the Excel JavaScript API. You can learn more about notes from the [Insert comments and notes in Excel](https://support.microsoft.com/office/bdcc9f5d-38e2-45b4-9a92-0b2b5c7bf6f8) article. For information about the differences between notes and comments, see [The difference](https://support.microsoft.com/office/the-difference-between-threaded-comments-and-notes-75a51eec-4092-42ab-abf8-7669077b7be3) [between threaded comments and notes](https://support.microsoft.com/office/the-difference-between-threaded-comments-and-notes-75a51eec-4092-42ab-abf8-7669077b7be3) .

Notes are tied to an individual cell. Anyone viewing the workbook with sufficient permissions can view a note. Notes in a workbook are tracked by the Workbook.notes property. This includes notes created by users and also notes created by your add-in. The Workbook.notes property is a [NoteCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.notecollection) object that contains a collection of [Note](https://learn.microsoft.com/en-us/javascript/api/excel/excel.note) objects. Notes are also accessible at the [Worksheet](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet) level.

#### **Tip**

To learn about adding and editing comments with the Excel JavaScript API, see **Work with comments using the Excel JavaScript API**.

## **Add a note**

Use the NoteCollection.add method to add notes to a workbook. This method takes two parameters:

- cellAddress : The cell where the comment is added. This can either be a string or [Range](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range) object. The range must be a single cell.
- content : The comment's content, as a string.

The following code sample shows how to add a note to the selected cell in a worksheet.

```
JavaScript
await Excel.run(async (context) => {
 // This function adds a note to the selected cell.
 const selectedRange = context.workbook.getSelectedRange();
 // Note that an InvalidArgument error is thrown if multiple cells are
selected.
 context.workbook.notes.add(selectedRange, "The first note.");
```

{218}------------------------------------------------

```
 await context.sync();
});
```
## **Change note visibility**

By default, the content of a note is hidden unless a user hovers over the cell with the note or sets the workbook to display notes. To display a note, use the [Note.visible](https://learn.microsoft.com/en-us/javascript/api/excel/excel.note#excel-excel-note-visible-member) property. The following code sample shows how to change the visibility of a note.

```
JavaScript
await Excel.run(async (context) => {
 // This function sets the note on cell A1 to visible.
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 const firstNote = sheet.notes.getItem("A1");
 firstNote.load();
 await context.sync();
 firstNote.visible = true;
});
```
## **Edit the content of a note**

To edit the content of a note, use the [Note.content](https://learn.microsoft.com/en-us/javascript/api/excel/excel.note#excel-excel-note-content-member) property. The following sample shows how to change the content of the first note in the NoteCollection .

```
JavaScript
await Excel.run(async (context) => {
 // This function changes the content in the first note.
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 const note = sheet.notes.getItemAt(0);
 note.content = "Changing the content of the first note.";
 await context.sync();
});
```
#### 7 **Note**

Use the Note.authorName property to get the author of a note. The author name is a readonly property.

{219}------------------------------------------------

### **Change the size of a note**

To make notes larger or smaller, use the [Note.height](https://learn.microsoft.com/en-us/javascript/api/excel/excel.note#excel-excel-note-height-member) and [Note.width](https://learn.microsoft.com/en-us/javascript/api/excel/excel.note#excel-excel-note-width-member) properties.

The following sample shows how to set the size of the first note in the NoteCollection .

```
JavaScript
await Excel.run(async (context) => {
 // This function changes the height and width of the first note.
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 const note = sheet.notes.getItemAt(0);
 note.width = 400;
 note.height = 200; 
 await context.sync();
});
```
### **Delete a note**

To delete a note, use the [Note.delete](https://learn.microsoft.com/en-us/javascript/api/excel/excel.note#excel-excel-note-delete-member(1)) method. The following sample shows how to delete the note attached to cell **A2**.

```
JavaScript
await Excel.run(async (context) => {
 // This function deletes the note from cell A2.
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 const note = sheet.notes.getItem("A2");
 note.delete();
 await context.sync();
});
```
## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with workbooks using the Excel JavaScript API
- Work with comments using the Excel JavaScript API
- [Insert comments and notes in Excel](https://support.microsoft.com/office/bdcc9f5d-38e2-45b4-9a92-0b2b5c7bf6f8)

{220}------------------------------------------------

# **Performance optimization using the Excel JavaScript API**

09/03/2025

There are multiple ways that you can perform common tasks with the Excel JavaScript API. You'll find significant performance differences between various approaches. This article provides guidance and code samples to show you how to perform common tasks efficiently using Excel JavaScript API.

#### ) **Important**

JavaScript

Many performance issues can be addressed through recommended usage of load and sync calls. See the "Performance improvements with the application-specific APIs" section of **Resource limits and performance optimization for Office Add-ins** for advice on working with the application-specific APIs in an efficient way.

### **Suspend Excel processes temporarily**

Excel has a number of background tasks reacting to input from both users and your add-in. Some of these Excel processes can be controlled to yield a performance benefit. This is especially helpful when your add-in deals with large data sets.

### **Suspend calculation temporarily**

If you are trying to perform an operation on a large number of cells (for example, setting the value of a huge range object) and you don't mind suspending the calculation in Excel temporarily while your operation finishes, we recommend that you suspend calculation until the next context.sync() is called.

See the [Application Object](https://learn.microsoft.com/en-us/javascript/api/excel/excel.application) reference documentation for information about how to use the suspendApiCalculationUntilNextSync() API to suspend and reactivate calculations in a very convenient way. The following code demonstrates how to suspend calculation temporarily.

```
await Excel.run(async (context) => {
 let app = context.workbook.application;
 let sheet = context.workbook.worksheets.getItem("sheet1");
 let rangeToSet: Excel.Range;
 let rangeToGet: Excel.Range;
```

{221}------------------------------------------------

```
 app.load("calculationMode");
 await context.sync();
 // Calculation mode should be "Automatic" by default
 console.log(app.calculationMode);
 rangeToSet = sheet.getRange("A1:C1");
 rangeToSet.values = [[1, 2, "=SUM(A1:B1)"]];
 rangeToGet = sheet.getRange("A1:C1");
 rangeToGet.load("values");
 await context.sync();
 // Range value should be [1, 2, 3] now
 console.log(rangeToGet.values);
 // Suspending recalculation
 app.suspendApiCalculationUntilNextSync();
 rangeToSet = sheet.getRange("A1:B1");
 rangeToSet.values = [[10, 20]];
 rangeToGet = sheet.getRange("A1:C1");
 rangeToGet.load("values");
 app.load("calculationMode");
 await context.sync();
 // Range value should be [10, 20, 3] when we load the property, because
calculation is suspended at that point
 console.log(rangeToGet.values);
 // Calculation mode should still be "Automatic" even with suspend
recalculation
 console.log(app.calculationMode);
 rangeToGet.load("values");
 await context.sync();
 // Range value should be [10, 20, 30] when we load the property, because
calculation is resumed after last sync
 console.log(rangeToGet.values);
});
```
Please note that only formula calculations are suspended. Any altered references are still rebuilt. For example, renaming a worksheet still updates any references in formulas to that worksheet.

### **Suspend screen updating**

Excel displays changes your add-in makes approximately as they happen in the code. For large, iterative data sets, you may not need to see this progress on the screen in real-time. Application.suspendScreenUpdatingUntilNextSync() pauses visual updates to Excel until the add-in calls context.sync() , or until Excel.run ends (implicitly calling context.sync ). Be aware, Excel will not show any signs of activity until the next sync. Your add-in should either give users guidance to prepare them for this delay or provide a status bar to demonstrate activity.

{222}------------------------------------------------

#### 7 **Note**

Don't call suspendScreenUpdatingUntilNextSync repeatedly (such as in a loop). Repeated calls will cause the Excel window to flicker.

#### **Enable and disable events**

Performance of an add-in may be improved by disabling events. A code sample showing how to enable and disable events is in the Work with Events article.

### **Importing data into tables**

When trying to import a huge amount of data directly into a [Table](https://learn.microsoft.com/en-us/javascript/api/excel/excel.table) object directly (for example, by using TableRowCollection.add() ), you might experience slow performance. If you are trying to add a new table, you should fill in the data first by setting range.values , and then call worksheet.tables.add() to create a table over the range. If you are trying to write data into an existing table, write the data into a range object via table.getDataBodyRange() , and the table will expand automatically.

Here is an example of this approach:

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sheet1");
 // Write the data into the range first.
 let range = sheet.getRange("A1:B3");
 range.values = [["Key", "Value"], ["A", 1], ["B", 2]];
 // Create the table over the range
 let table = sheet.tables.add('A1:B3', true);
 table.name = "Example";
 await context.sync();
 // Insert a new row to the table
 table.getDataBodyRange().getRowsBelow(1).values = [["C", 3]];
 // Change a existing row value
 table.getDataBodyRange().getRow(1).values = [["D", 4]];
 await context.sync();
});
```

{223}------------------------------------------------

## **Payload size limit best practices**

The Excel JavaScript API has size limitations for API calls. **Excel on the web** has a payload size limit for requests and responses of **5MB**, and an API returns a RichAPI.Error error if this limit is exceeded. On all platforms, a range is limited to five million cells for get operations. Large ranges typically exceed both of these limitations.

The payload size of a request is a combination of the following three components.

- The number of API calls
- The number of objects, such as Range objects
- The length of the value to set or get

If an API returns the RequestPayloadSizeLimitExceeded error, use the best practice strategies documented in this article to optimize your script and avoid the error.

### **Strategy 1: Move unchanged values out of loops**

Limit the number of processes that occur within loops to improve performance. In the following code sample, context.workbook.worksheets.getActiveWorksheet() can be moved out of the for loop, because it doesn't change within that loop.

```
JavaScript
```

```
// DO NOT USE THIS CODE SAMPLE. This sample shows a poor performance strategy. 
async function run() {
 await Excel.run(async (context) => {
 let ranges = [];

 // This sample retrieves the worksheet every time the loop runs, which is bad
for performance.
 for (let i = 0; i < 7500; i++) {
 let rangeByIndex =
context.workbook.worksheets.getActiveWorksheet().getRangeByIndexes(i, 1, 1, 1);
 } 
 await context.sync();
 });
}
```
The following code sample shows logic similar to the preceding code sample, but with an improved performance strategy. The value context.workbook.worksheets.getActiveWorksheet() 

{224}------------------------------------------------

is retrieved before the for loop, because this value doesn't need to be retrieved each time the for loop runs. Only values that change within the context of a loop should be retrieved within that loop.

```
JavaScript
// This code sample shows a good performance strategy.
async function run() {
 await Excel.run(async (context) => {
 let ranges = [];
 // Retrieve the worksheet outside the loop.
 let worksheet = context.workbook.worksheets.getActiveWorksheet(); 
 // Only process the necessary values inside the loop.
 for (let i = 0; i < 7500; i++) {
 let rangeByIndex = worksheet.getRangeByIndexes(i, 1, 1, 1);
 } 
 await context.sync();
 });
}
```
#### **Strategy 2: Create fewer range objects**

Create fewer range objects to improve performance and minimize payload size. Two approaches for creating fewer range objects are described in the following article sections and code samples.

#### **Split each range array into multiple arrays**

One way to create fewer range objects is to split each range array into multiple arrays, and then process each new array with a loop and a new context.sync() call.

#### ) **Important**

Only use this strategy if you've first determined that you're exceeding the payload request size limit. Using multiple loops can reduce the size of each payload request to avoid exceeding the 5MB limit, but using multiple loops and multiple context.sync() calls also negatively impacts performance.

The following code sample attempts to process a large array of ranges in a single loop and then a single context.sync() call. Processing too many range values in one context.sync() call causes the payload request size to exceed the 5MB limit.

{225}------------------------------------------------

```
JavaScript
```

```
// This code sample does not show a recommended strategy.
// Calling 10,000 rows would likely exceed the 5MB payload size limit in a real-
world situation.
async function run() {
 await Excel.run(async (context) => {
 let worksheet = context.workbook.worksheets.getActiveWorksheet();

 // This sample attempts to process too many ranges at once. 
 for (let row = 1; row < 10000; row++) {
 let range = sheet.getRangeByIndexes(row, 1, 1, 1);
 range.values = [["1"]];
 }
 await context.sync(); 
 });
}
```
The following code sample shows logic similar to the preceding code sample, but with a strategy that avoids exceeding the 5MB payload request size limit. In the following code sample, the ranges are processed in two separate loops, and each loop is followed by a context.sync() call.

```
JavaScript
// This code sample shows a strategy for reducing payload request size.
// However, using multiple loops and `context.sync()` calls negatively impacts
performance.
// Only use this strategy if you've determined that you're exceeding the payload
request limit.
async function run() {
 await Excel.run(async (context) => {
 let worksheet = context.workbook.worksheets.getActiveWorksheet();
 // Split the ranges into two loops, rows 1-5000 and then 5001-10000.
 for (let row = 1; row < 5000; row++) {
 let range = worksheet.getRangeByIndexes(row, 1, 1, 1);
 range.values = [["1"]];
 }
 // Sync after each loop. 
 await context.sync(); 

 for (let row = 5001; row < 10000; row++) {
 let range = worksheet.getRangeByIndexes(row, 1, 1, 1);
 range.values = [["1"]];
 }
 await context.sync(); 
 });
}
```

{226}------------------------------------------------

#### **Set range values in an array**

Another way to create fewer range objects is to create an array, use a loop to set all the data in that array, and then pass the array values to a range. This benefits both performance and payload size. Instead of calling range.values for each range in a loop, range.values is a called once outside the loop.

The following code sample shows how to create an array, set the values of that array in a for loop, and then pass the array values to a range outside the loop.

```
JavaScript
// This code sample shows a good performance strategy.
async function run() {
 await Excel.run(async (context) => {
 const worksheet = context.workbook.worksheets.getActiveWorksheet(); 
 // Create an array.
 const array = new Array(10000);
 // Set the values of the array inside the loop.
 for (let i = 0; i < 10000; i++) {
 array[i] = [1];
 }
 // Pass the array values to a range outside the loop. 
 let range = worksheet.getRange("A1:A10000");
 range.values = array;
 await context.sync();
 });
}
```
## **See also**

- Excel JavaScript object model in Office Add-ins
- Error handling with the application-specific JavaScript APIs
- Resource limits and performance optimization for Office Add-ins
- [Worksheet Functions Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.functions)

{227}------------------------------------------------

# **Work with PivotTables using the Excel JavaScript API**

Article  03/22/2022

PivotTables streamline larger data sets. They allow the quick manipulation of grouped data. The Excel JavaScript API lets your add-in create PivotTables and interact with their components. This article describes how PivotTables are represented by the Office JavaScript API and provides code samples for key scenarios.

If you are unfamiliar with the functionality of PivotTables, consider exploring them as an end user. See [Create a PivotTable to analyze worksheet data](https://support.microsoft.com/office/ccd3c4a6-272f-4c97-afbb-d3f27407fcde#ID0EBBD=PivotTables) for a good primer on these tools.

#### ) **Important**

PivotTables created with OLAP are not currently supported. There is also no support for Power Pivot.

## **Object model**

{228}------------------------------------------------

The [PivotTable](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivottable) is the central object for PivotTables in the Office JavaScript API.

- Workbook.pivotTables and Worksheet.pivotTables are [PivotTableCollections](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivottablecollection) that contain the [PivotTables](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivottable) in the workbook and worksheet, respectively.
- A [PivotTable](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivottable) contains a [PivotHierarchyCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivothierarchycollection) that has multiple [PivotHierarchies](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivothierarchy).
- These [PivotHierarchies](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivothierarchy) can be added to specific hierarchy collections to define how the PivotTable pivots data (as explained in the following section).
- A [PivotHierarchy](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivothierarchy) contains a [PivotFieldCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfieldcollection) that has exactly one [PivotField](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfield). If the design expands to include OLAP PivotTables, this may change.
- A [PivotField](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfield) can have one or more [PivotFilters](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfilters) applied, as long as the field's [PivotHierarchy](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivothierarchy) is assigned to a hierarchy category.

{229}------------------------------------------------

- A [PivotField](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfield) contains a [PivotItemCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotitemcollection) that has multiple [PivotItems](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotitem).
- A [PivotTable](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivottable) contains a [PivotLayout](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotlayout) that defines where the [PivotFields](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfield) and [PivotItems](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotitem) are displayed in the worksheet. The layout also controls some display settings for the PivotTable.

Let's look at how these relationships apply to some example data. The following data describes fruit sales from various farms. It will be the example throughout this article.

|    | A                      | B     | C                               | D   | E                                                        |  |
|----|------------------------|-------|---------------------------------|-----|----------------------------------------------------------|--|
| 1  | Farm                   | Type  |                                 |     | Classification Crates Sold at Farm Crates Sold Wholesale |  |
| 2  | A Farms Lime           |       | Organic                         | 300 | 2000                                                     |  |
| 3  | A Farms   Lemon        |       | Organic                         | 250 | 1800                                                     |  |
| 4  | A Farms Orange Organic |       |                                 | 200 | 2200                                                     |  |
| 5  | B Farms   Lime         |       | Conventional                    | 80  | 1000                                                     |  |
| 6  | B Farms   Lemon        |       | Conventional                    | 75  | 1230                                                     |  |
| 7  |                        |       | B Farms   Orange   Conventional | 25  | 800                                                      |  |
| 8  | B Farms Orange Organic |       |                                 | 20  | 500                                                      |  |
| 9  | B Farms   Lemon        |       | Organic                         | 10  | 770                                                      |  |
| 10 | B Farms   Kiwi         |       | Conventional                    | 30  | 300                                                      |  |
| 11 | B Farms  Lime          |       | Organic                         | 50  | 400                                                      |  |
| 12 | C Farms   Apple        |       | Organic                         | 275 | 220                                                      |  |
| 13 | C Farms   Kiwi         |       | Organic                         | 200 | 120                                                      |  |
| 14 | D Farms   Apple        |       | Conventional                    | 100 | 3000                                                     |  |
| 15 | D Farms   Apple        |       | Organic                         | 80  | 2800                                                     |  |
| 16 | E Farms                | Lime  | Conventional                    | 160 | 2700                                                     |  |
| 17 | E Farms                |       | Orange Conventional             | 180 | 2000                                                     |  |
| 18 | E Farms                | Apple | Conventional                    | 245 | 2200                                                     |  |
| 19 | E Farms                | Kiwi  | Conventional                    | 200 | 1500                                                     |  |
| 20 | F Farms                | Kiwi  | Organic                         | 100 | 150                                                      |  |
| 21 | F Farms   Lemon        |       | Conventional                    | 150 | 270                                                      |  |

This fruit farm sales data will be used to make a PivotTable. Each column, such as **Types**, is a PivotHierarchy . The **Types** hierarchy contains the **Types** field. The **Types** field contains the items **Apple**, **Kiwi**, **Lemon**, **Lime**, and **Orange**.

### **Hierarchies**

PivotTables are organized based on four hierarchy categories: [row](https://learn.microsoft.com/en-us/javascript/api/excel/excel.rowcolumnpivothierarchy), [column](https://learn.microsoft.com/en-us/javascript/api/excel/excel.rowcolumnpivothierarchy), [data](https://learn.microsoft.com/en-us/javascript/api/excel/excel.datapivothierarchy), and [filter](https://learn.microsoft.com/en-us/javascript/api/excel/excel.filterpivothierarchy).

The farm data shown earlier has five hierarchies: **Farms**, **Type**, **Classification**, **Crates Sold at Farm**, and **Crates Sold Wholesale**. Each hierarchy can only exist in one of the four categories. If **Type** is added to column hierarchies, it cannot also be in the row, data, or filter hierarchies. If **Type** is subsequently added to row hierarchies, it is removed from the column hierarchies. This behavior is the same whether hierarchy assignment is done through the Excel UI or the Excel JavaScript APIs.

{230}------------------------------------------------

Row and column hierarchies define how data will be grouped. For example, a row hierarchy of **Farms** will group together all the data sets from the same farm. The choice between row and column hierarchy defines the orientation of the PivotTable.

Data hierarchies are the values to be aggregated based on the row and column hierarchies. A PivotTable with a row hierarchy of **Farms** and a data hierarchy of **Crates Sold Wholesale** shows the sum total (by default) of all the different fruits for each farm.

Filter hierarchies include or exclude data from the pivot based on values within that filtered type. A filter hierarchy of **Classification** with the type **Organic** selected only shows data for organic fruit.

Here is the farm data again, alongside a PivotTable. The PivotTable is using **Farm** and **Type** as the row hierarchies, **Crates Sold at Farm** and **Crates Sold Wholesale** as the data hierarchies (with the default aggregation function of sum), and **Classification** as a filter hierarchy (with **Organic** selected).

This PivotTable could be generated through the JavaScript API or through the Excel UI. Both options allow for further manipulation through add-ins.

## **Create a PivotTable**

{231}------------------------------------------------

PivotTables need a name, source, and destination. The source can be a range address or table name (passed as a Range , string , or Table type). The destination is a range address (given as either a Range or string ). The following samples show various PivotTable creation techniques.

#### **Create a PivotTable with range addresses**

```
JavaScript
await Excel.run(async (context) => {
 // Create a PivotTable named "Farm Sales" on the current worksheet at
cell
 // A22 with data from the range A1:E21.
 context.workbook.worksheets.getActiveWorksheet().pivotTables.add(
 "Farm Sales", "A1:E21", "A22");
 await context.sync();
});
```
### **Create a PivotTable with Range objects**

```
JavaScript
await Excel.run(async (context) => {
 // Create a PivotTable named "Farm Sales" on a worksheet called
"PivotWorksheet" at cell A2
 // the data comes from the worksheet "DataWorksheet" across the range
A1:E21.
 let rangeToAnalyze =
context.workbook.worksheets.getItem("DataWorksheet").getRange("A1:E21");
 let rangeToPlacePivot =
context.workbook.worksheets.getItem("PivotWorksheet").getRange("A2");
 context.workbook.worksheets.getItem("PivotWorksheet").pivotTables.add(
 "Farm Sales", rangeToAnalyze, rangeToPlacePivot);
 await context.sync();
});
```
### **Create a PivotTable at the workbook level**

```
JavaScript
```

```
await Excel.run(async (context) => {
 // Create a PivotTable named "Farm Sales" on a worksheet called
"PivotWorksheet" at cell A2
 // the data is from the worksheet "DataWorksheet" across the range
```

{232}------------------------------------------------

```
A1:E21.
 context.workbook.pivotTables.add(
 "Farm Sales", "DataWorksheet!A1:E21", "PivotWorksheet!A2");
 await context.sync();
});
```
## **Use an existing PivotTable**

Manually created PivotTables are also accessible through the PivotTable collection of the workbook or of individual worksheets. The following code gets a PivotTable named **My Pivot** from the workbook.

```
JavaScript
await Excel.run(async (context) => {
 let pivotTable = context.workbook.pivotTables.getItem("My Pivot");
 await context.sync();
});
```
## **Add rows and columns to a PivotTable**

Rows and columns pivot the data around those fields' values.

Adding the **Farm** column pivots all the sales around each farm. Adding the **Type** and **Classification** rows further breaks down the data based on what fruit was sold and whether it was organic or not.

{233}------------------------------------------------

|    | A               | B                  | C | D | E | F | G | H                                                   |
|----|-----------------|--------------------|---|---|---|---|---|-----------------------------------------------------|
| 1  |                 |                    |   |   |   |   |   |                                                     |
| 2  |                 | Column Labels<br> |   |   |   |   |   |                                                     |
| 3  | Row Labels<br>) | A Farms            |   |   |   |   |   | B Farms C Farms D Farms E Farms F Farms Grand Total |
| 4  | Apple           |                    |   |   |   |   |   |                                                     |
| 5  | Conventional    |                    |   |   |   |   |   |                                                     |
|   | Organic         |                    |   |   |   |   |   |                                                     |
| 7  | Kiwi           |                    |   |   |   |   |   |                                                     |
| 8  | Conventional    |                    |   |   |   |   |   |                                                     |
| 9  | Organic         |                    |   |   |   |   |   |                                                     |
| 10 | Lemon          |                    |   |   |   |   |   |                                                     |
| 11 | Conventional    |                    |   |   |   |   |   |                                                     |
| 12 | Organic         |                    |   |   |   |   |   |                                                     |
| 13 | 0 Lime          |                    |   |   |   |   |   |                                                     |
| 14 | Conventional    |                    |   |   |   |   |   |                                                     |
| 15 | Organic         |                    |   |   |   |   |   |                                                     |
| 16 | O Orange        |                    |   |   |   |   |   |                                                     |
| 17 | Conventional    |                    |   |   |   |   |   |                                                     |
| 18 | Organic         |                    |   |   |   |   |   |                                                     |
| 19 | Grand Total     |                    |   |   |   |   |   |                                                     |

JavaScript

```
await Excel.run(async (context) => {
 let pivotTable =
context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem("Farm
```
Sales");

pivotTable.rowHierarchies.add(pivotTable.hierarchies.getItem("Type"));

```
pivotTable.rowHierarchies.add(pivotTable.hierarchies.getItem("Classification
"));
```
pivotTable.columnHierarchies.add(pivotTable.hierarchies.getItem("Farm"));

```
 await context.sync();
});
```
You can also have a PivotTable with only rows or columns.

```
JavaScript
await Excel.run(async (context) => {
 let pivotTable =
context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem("Farm
Sales");
 pivotTable.rowHierarchies.add(pivotTable.hierarchies.getItem("Farm"));
 pivotTable.rowHierarchies.add(pivotTable.hierarchies.getItem("Type"));
```
pivotTable.rowHierarchies.add(pivotTable.hierarchies.getItem("Classification

{234}------------------------------------------------

```
"));
 await context.sync();
});
```
## **Add data hierarchies to the PivotTable**

Data hierarchies fill the PivotTable with information to combine based on the rows and columns. Adding the data hierarchies of **Crates Sold at Farm** and **Crates Sold Wholesale** gives sums of those figures for each row and column.

In the example, both **Farm** and **Type** are rows, with the crate sales as the data.

|    | A              | B                          | C                            |  |  |
|----|----------------|----------------------------|------------------------------|--|--|
| 1  |                |                            |                              |  |  |
| 2  | Row Labels    | Sum of Crates Sold at Farm | Sum of Crates Sold Wholesale |  |  |
| 3  | OA Farms       | 750                        | 6000                         |  |  |
| 4  | Lemon          | 250                        | 1800                         |  |  |
| 5  | Lime           | 300                        | 2000                         |  |  |
|   | Orange         | 200                        | 2200                         |  |  |
| 7  | EB Farms       | 290                        | 5000                         |  |  |
| 8  | Kiwi           | 30                         | 300                          |  |  |
| 9  | Lemon          | 85                         | 2000                         |  |  |
| 10 | Lime           | 130                        | 1400                         |  |  |
| 11 | Orange         | 45                         | 1300                         |  |  |
| 12 | EC Farms       | 475                        | 340                          |  |  |
| 13 | Apple          | 275                        | 220                          |  |  |
| 14 | Kiwi           | 200                        | 120                          |  |  |
| 15 | ED Farms       | 180                        | 5800                         |  |  |
| 16 | Apple          | 180                        | 5800                         |  |  |
| 17 | OE Farms       | 785                        | 8400                         |  |  |
| 18 | Apple          | 245                        | 2200                         |  |  |
| 19 | Kiwi           | 200                        | 1500                         |  |  |
| 20 | Lime           | 160                        | 2700                         |  |  |
| 21 | Orange         | 180                        | 2000                         |  |  |
| 22 | OF Farms       | 250                        | 420                          |  |  |
| 23 | Kiwi           | 100                        | 150                          |  |  |
| 24 | Lemon          | 150                        | 270                          |  |  |
|    | 25 Grand Total | 2730                       | 25960                        |  |  |

```
JavaScript
```

```
await Excel.run(async (context) => {
 let pivotTable =
context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem("Farm
Sales");
```
 // "Farm" and "Type" are the hierarchies on which the aggregation is based.

{235}------------------------------------------------

```
 pivotTable.rowHierarchies.add(pivotTable.hierarchies.getItem("Farm"));
 pivotTable.rowHierarchies.add(pivotTable.hierarchies.getItem("Type"));
 // "Crates Sold at Farm" and "Crates Sold Wholesale" are the hierarchies
 // that will have their data aggregated (summed in this case).
 pivotTable.dataHierarchies.add(pivotTable.hierarchies.getItem("Crates
Sold at Farm"));
 pivotTable.dataHierarchies.add(pivotTable.hierarchies.getItem("Crates
Sold Wholesale"));
 await context.sync();
});
```
## **PivotTable layouts and getting pivoted data**

A [PivotLayout](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotlayout) defines the placement of hierarchies and their data. You access the layout to determine the ranges where data is stored.

The following diagram shows which layout function calls correspond to which ranges of the PivotTable.

|     |                        | B                | C                                                         | getFilterAxisRange |                     |
|-----|------------------------|------------------|-----------------------------------------------------------|--------------------|---------------------|
|     | Classification Organic | J                |                                                           |                    |                     |
|     |                        |                  |                                                           |                    |                     |
| 3   | Row Labels            |                  | Sum of Crates Sold at Farm   Sum of Crates Sold Wholesale |                    | getColumnLabelRange |
|  | @A Farms               | 750              | 6000                                                      |                    |                     |
| 5   | Lemon                  | 250              | 1800                                                      |                    |                     |
|    | Lime                   | 300              | 2000                                                      |                    |                     |
| 7   | Orange                 | 200              | 2200                                                      |                    |                     |
| 8   | B Farms               | 80               | 1670                                                      |                    |                     |
| 9   | Lemon                  | 10               | 770                                                       |                    |                     |
| 10  | Lime                   | 50               | 400                                                       |                    |                     |
| 11  | Orange                 | 20               | 500                                                       |                    | getDataBodyRange    |
| 12  | C Farms               | 475              | 340                                                       |                    |                     |
| 13  | Apple                  | 275              | 220                                                       |                    |                     |
| 14  | Kiwi                   | 200              | 120                                                       |                    |                     |
| 15  | D Farms               | 80               | 2800                                                      |                    |                     |
| 16  | Apple                  | 80               | 2800                                                      |                    |                     |
| 17  | F Farms               | 100              | 150                                                       |                    |                     |
| 18  | Kiwi                   | 100              | 150                                                       |                    |                     |
| 19  | Grand Total            | 1485             | 10960                                                     |                    |                     |
|     |                        |                  |                                                           |                    |                     |
|     |                        |                  |                                                           |                    |                     |
|     |                        |                  |                                                           |                    |                     |
|     |                        |                  |                                                           |                    |                     |
|     |                        | getRowLabelRange |                                                           | getRange           |                     |
|     |                        |                  |                                                           |                    |                     |
|     |                        |                  |                                                           |                    |                     |

### **Get data from the PivotTable**

The layout defines how the PivotTable is displayed in the worksheet. This means the PivotLayout object controls the ranges used for PivotTable elements. Use the ranges provided by the layout to get data collected and aggregated by the PivotTable. In

{236}------------------------------------------------

particular, use PivotLayout.getDataBodyRange to access the data produced by the PivotTable.

The following code demonstrates how to get the last row of the PivotTable data by going through the layout (the **Grand Total** of both the **Sum of Crates Sold at Farm** and **Sum of Crates Sold Wholesale** columns in the earlier example). Those values are then summed together for a final total, which is displayed in cell **E30** (outside of the PivotTable).

```
JavaScript
await Excel.run(async (context) => {
 let pivotTable =
context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem("Farm
Sales");
 // Get the totals for each data hierarchy from the layout.
 let range = pivotTable.layout.getDataBodyRange();
 let grandTotalRange = range.getLastRow();
 grandTotalRange.load("address");
 await context.sync();
 // Sum the totals from the PivotTable data hierarchies and place them in
a new range, outside of the PivotTable.
 let masterTotalRange =
context.workbook.worksheets.getActiveWorksheet().getRange("E30");
 masterTotalRange.formulas = [["=SUM(" + grandTotalRange.address + ")"]];
 await context.sync();
});
```
### **Layout types**

PivotTables have three layout styles: Compact, Outline, and Tabular. We've seen the compact style in the previous examples.

The following examples use the outline and tabular styles, respectively. The code sample shows how to cycle between the different layouts.

### **Outline layout**

{237}------------------------------------------------

| 1  | A           | B           | C    | D                                                       |
|----|-------------|-------------|------|---------------------------------------------------------|
| 1  |             |             |      |                                                         |
| 2  | Farm        | Type <br> |      | Sum of Crates Sold at Farm Sum of Crates Sold Wholesale |
| 3  | OA Farms    |             | 750  | 6000                                                    |
| 4  |             | Lemon       | 250  | 1800                                                    |
| 5  |             | Lime        | 300  | 2000                                                    |
| 6  |             | Orange      | 200  | 2200                                                    |
| 7  | OB Farms    |             | 290  | 5000                                                    |
| 8  |             | Kiwi        | 30   | 300                                                     |
| 9  |             | Lemon       | 85   | 2000                                                    |
| 10 |             | Lime        | 130  | 1400                                                    |
| 11 |             | Orange      | 45   | 1300                                                    |
| 12 | EC Farms    |             | 475  | 340                                                     |
| 13 |             | Apple       | 275  | 220                                                     |
| 14 |             | Kiwi        | 200  | 120                                                     |
| 15 | ED Farms    |             | 180  | 5800                                                    |
| 16 |             | Apple       | 180  | 5800                                                    |
| 17 | OE Farms    |             | 785  | 8400                                                    |
| 18 |             | Apple       | 245  | 2200                                                    |
| 19 |             | Kiwi        | 200  | 1500                                                    |
| 20 |             | Lime        | 160  | 2700                                                    |
| 21 |             | Orange      | 180  | 2000                                                    |
| 22 | FFFarms     |             | 250  | 420                                                     |
| 23 |             | Kiwi        | 100  | 150                                                     |
| 24 |             | Lemon       | 150  | 270                                                     |
| 25 | Grand Total |             | 2730 | 25960                                                   |

#### **Tabular layout**

{238}------------------------------------------------

| 1  | A              | B      | C    | D                                                         |  |
|----|----------------|--------|------|-----------------------------------------------------------|--|
| 1  |                |        |      |                                                           |  |
| 2  | Farm<br>      | Type  |      | Sum of Crates Sold at Farm   Sum of Crates Sold Wholesale |  |
| 3  | OA Farms       | Lemon  | 250  | 1800                                                      |  |
| 4  |                | Lime   | 300  | 2000                                                      |  |
| 5  |                | Orange | 200  | 2200                                                      |  |
|   | A Farms Total  |        | 750  | 6000                                                      |  |
| 7  | @B Farms       | Kiwi   | 30   | 300                                                       |  |
| 8  |                | Lemon  | 85   | 2000                                                      |  |
| 9  |                | Lime   | 130  | 1400                                                      |  |
| 10 | Orange         |        | 45   | 1300                                                      |  |
| 11 | B Farms Total  |        | 290  | 5000                                                      |  |
| 12 | EC Farms       | Apple  | 275  | 220                                                       |  |
| 13 |                | Kiwi   | 200  | 120                                                       |  |
| 14 | C Farms Total  |        | 475  | 340                                                       |  |
| 15 | ED Farms       | Apple  | 180  | 5800                                                      |  |
| 16 | D Farms Total  |        | 180  | 5800                                                      |  |
| 17 | OE Farms       | Apple  | 245  | 2200                                                      |  |
| 18 |                | Kiwi   | 200  | 1500                                                      |  |
| 19 |                | Lime   | 160  | 2700                                                      |  |
| 20 |                | Orange | 180  | 2000                                                      |  |
| 21 | E Farms Total  |        | 785  | 8400                                                      |  |
| 22 | OF Farms       | Kiwi   | 100  | 150                                                       |  |
| 23 |                | Lemon  | 150  | 270                                                       |  |
| 24 | F Farms Total  |        | 250  | 420                                                       |  |
|    | 25 Grand Total |        | 2730 | 25960                                                     |  |

#### **PivotLayout type switch code sample**

```
JavaScript
await Excel.run(async (context) => {
 // Change the PivotLayout.type to a new type.
 let pivotTable =
context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem("Farm
Sales");
 pivotTable.layout.load("layoutType");
 await context.sync();
 // Cycle between the three layout types.
 if (pivotTable.layout.layoutType === "Compact") {
 pivotTable.layout.layoutType = "Outline";
 } else if (pivotTable.layout.layoutType === "Outline") {
 pivotTable.layout.layoutType = "Tabular";
 } else {
 pivotTable.layout.layoutType = "Compact";
 }
 await context.sync();
});
```

{239}------------------------------------------------

### **Other PivotLayout functions**

By default, PivotTables adjust row and column sizes as needed. This is done when the PivotTable is refreshed. PivotLayout.autoFormat specifies that behavior. Any row or column size changes made by your add-in persist when autoFormat is false . Additionally, the default settings of a PivotTable keep any custom formatting in the PivotTable (such as fills and font changes). Set PivotLayout.preserveFormatting to false to apply the default format when refreshed.

A PivotLayout also controls header and total row settings, how empty data cells are displayed, and [alt text](https://support.microsoft.com/topic/44989b2a-903c-4d9a-b742-6a75b451c669) options. The [PivotLayout](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotlayout) reference provides a complete list of these features.

The following code sample makes empty data cells display the string "--" , formats the body range to a consistent horizontal alignment, and ensures that the formatting changes remain even after the PivotTable is refreshed.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let pivotTable = context.workbook.pivotTables.getItem("Farm Sales");
 let pivotLayout = pivotTable.layout;
 // Set a default value for an empty cell in the PivotTable. This doesn't
include cells left blank by the layout.
 pivotLayout.emptyCellText = "--";
 // Set the text alignment to match the rest of the PivotTable.
 pivotLayout.getDataBodyRange().format.horizontalAlignment =
Excel.HorizontalAlignment.right;
 // Ensure empty cells are filled with a default value.
 pivotLayout.fillEmptyCells = true;
 // Ensure that the format settings persist, even after the PivotTable is
refreshed and recalculated.
 pivotLayout.preserveFormatting = true;
 await context.sync();
});
```
### **Delete a PivotTable**

PivotTables are deleted by using their name.

JavaScript

{240}------------------------------------------------

```
await Excel.run(async (context) => {
 context.workbook.worksheets.getItem("Pivot").pivotTables.getItem("Farm
Sales").delete();
 await context.sync();
});
```
## **Filter a PivotTable**

The primary method for filtering PivotTable data is with PivotFilters. Slicers offer an alternate, less flexible filtering method.

[PivotFilters](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfilters) filter data based on a PivotTable's four hierarchy categories (filters, columns, rows, and values). There are four types of PivotFilters, allowing calendar date-based filtering, string parsing, number comparison, and filtering based on a custom input.

[Slicers](https://learn.microsoft.com/en-us/javascript/api/excel/excel.slicer) can be applied to both PivotTables and regular Excel tables. When applied to a PivotTable, slicers function like a PivotManualFilter and allow filtering based on a custom input. Unlike PivotFilters, slicers have an [Excel UI component](https://support.microsoft.com/office/249f966b-a9d5-4b0f-b31a-12651785d29d) . With the Slicer class, you create this UI component, manage filtering, and control its visual appearance.

#### **Filter with PivotFilters**

[PivotFilters](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfilters) allow you to filter PivotTable data based on the four hierarchy categories (filters, columns, rows, and values). In the PivotTable object model, PivotFilters are applied to a [PivotField](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfield), and each PivotField can have one or more assigned PivotFilters . To apply PivotFilters to a PivotField, the field's corresponding [PivotHierarchy](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivothierarchy) must be assigned to a hierarchy category.

| Filter type  | Filter purpose                 | Excel JavaScript API reference |  |
|--------------|--------------------------------|--------------------------------|--|
| DateFilter   | Calendar date-based filtering. | PivotDateFilter                |  |
| LabelFilter  | Text comparison filtering.     | PivotLabelFilter               |  |
| ManualFilter | Custom input filtering.        | PivotManualFilter              |  |
| ValueFilter  | Number comparison filtering.   | PivotValueFilter               |  |

#### **Types of PivotFilters**

#### **Create a PivotFilter**

{241}------------------------------------------------

To filter PivotTable data with a Pivot*Filter (such as a PivotDateFilter ), apply the filter to a [PivotField](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfield). The following four code samples show how to use each of the four types of PivotFilters.

#### **PivotDateFilter**

The first code sample applies a [PivotDateFilter](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotdatefilter) to the **Date Updated** PivotField, hiding any data prior to **2020-08-01**.

#### ) **Important**

A Pivot*Filter can't be applied to a PivotField unless that field's PivotHierarchy is assigned to a hierarchy category. In the following code sample, the dateHierarchy must be added to the PivotTable's rowHierarchies category before it can be used for filtering.

#### JavaScript

```
await Excel.run(async (context) => {
 // Get the PivotTable and the date hierarchy.
 let pivotTable =
context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem("Farm
Sales");
 let dateHierarchy = pivotTable.rowHierarchies.getItemOrNullObject("Date
Updated");
 await context.sync();
 // PivotFilters can only be applied to PivotHierarchies that are being
used for pivoting.
 // If it's not already there, add "Date Updated" to the hierarchies.
 if (dateHierarchy.isNullObject) {
 dateHierarchy =
pivotTable.rowHierarchies.add(pivotTable.hierarchies.getItem("Date
Updated"));
 }
 // Apply a date filter to filter out anything logged before August.
 let filterField = dateHierarchy.fields.getItem("Date Updated");
 let dateFilter = {
 condition: Excel.DateFilterCondition.afterOrEqualTo,
 comparator: {
 date: "2020-08-01",
 specificity: Excel.FilterDatetimeSpecificity.month
 }
 };
 filterField.applyFilter({ dateFilter: dateFilter });
```

{242}------------------------------------------------

```
 await context.sync();
});
```
#### 7 **Note**

The following three code snippets only display filter-specific excerpts, instead of full Excel.run calls.

#### **PivotLabelFilter**

The second code snippet demonstrates how to apply a [PivotLabelFilter](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotlabelfilter) to the **Type** PivotField, using the LabelFilterCondition.beginsWith property to exclude labels that start with the letter **L**.

```
JavaScript
 // Get the "Type" field.
 let filterField =
pivotTable.hierarchies.getItem("Type").fields.getItem("Type");
 // Filter out any types that start with "L" ("Lemons" and "Limes" in
this case).
 let filter: Excel.PivotLabelFilter = {
 condition: Excel.LabelFilterCondition.beginsWith,
 substring: "L",
 exclusive: true
 };
 // Apply the label filter to the field.
 filterField.applyFilter({ labelFilter: filter });
```
#### **PivotManualFilter**

The third code snippet applies a manual filter with [PivotManualFilter](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotmanualfilter) to the the **Classification** field, filtering out data that doesn't include the classification **Organic**.

```
JavaScript
 // Apply a manual filter to include only a specific PivotItem (the
string "Organic").
 let filterField = classHierarchy.fields.getItem("Classification");
 let manualFilter = { selectedItems: ["Organic"] };
 filterField.applyFilter({ manualFilter: manualFilter });
```

{243}------------------------------------------------

#### **PivotValueFilter**

To compare numbers, use a value filter with [PivotValueFilter,](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotvaluefilter) as shown in the final code snippet. The PivotValueFilter compares the data in the **Farm** PivotField to the data in the **Crates Sold Wholesale** PivotField, including only farms whose sum of crates sold exceeds the value **500**.

```
JavaScript
 // Get the "Farm" field.
 let filterField =
pivotTable.hierarchies.getItem("Farm").fields.getItem("Farm");

 // Filter to only include rows with more than 500 wholesale crates sold.
 let filter: Excel.PivotValueFilter = {
 condition: Excel.ValueFilterCondition.greaterThan,
 comparator: 500,
 value: "Sum of Crates Sold Wholesale"
 };

 // Apply the value filter to the field.
 filterField.applyFilter({ valueFilter: filter });
```
#### **Remove PivotFilters**

To remove all PivotFilters, apply the clearAllFilters method to each PivotField, as shown in the following code sample.

```
JavaScript
await Excel.run(async (context) => {
 // Get the PivotTable.
 let pivotTable =
context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem("Farm
Sales");
 pivotTable.hierarchies.load("name");
 await context.sync();
 // Clear the filters on each PivotField.
 pivotTable.hierarchies.items.forEach(function (hierarchy) {
 hierarchy.fields.getItem(hierarchy.name).clearAllFilters();
 });
 await context.sync();
});
```
### **Filter with slicers**

{244}------------------------------------------------

[Slicers](https://learn.microsoft.com/en-us/javascript/api/excel/excel.slicer) allow data to be filtered from an Excel PivotTable or table. A slicer uses values from a specified column or PivotField to filter corresponding rows. These values are stored as [SlicerItem](https://learn.microsoft.com/en-us/javascript/api/excel/excel.sliceritem) objects in the Slicer . Your add-in can adjust these filters, as can users ([through the Excel UI](https://support.microsoft.com/office/249f966b-a9d5-4b0f-b31a-12651785d29d) ). The slicer sits on top of the worksheet in the drawing layer, as shown in the following screenshot.

|     | A            | B    | C                                                         | D | E           | F | G | H |
|-----|--------------|------|-----------------------------------------------------------|---|-------------|---|---|---|
|     |              |      |                                                           |   |             |   |   |   |
| 2   | Row Labels  |      | Sum of Crates Sold at Farm   Sum of Crates Sold Wholesale |   | Fruit Types |   |  |   |
|    | A Farms      | 750  | 6000                                                      |   |             |   |   |   |
|  | B Farms      | 260  | 4700                                                      |   | Apple       |   |   |   |
|    | E Farms      | 340  | 4700                                                      |   | Kiwi        |   |   |   |
| 6   | F Farms      | 150  | 270                                                       |   | Lemon       |   |   |   |
| 7   | Grand Total  | 1500 | 15670                                                     |   |             |   |   |   |
| 8   |              |      |                                                           |   | Lime        |   |   |   |
| 9   |              |      |                                                           |   | Orange      |   |   |   |
| 10  |              |      |                                                           |   |             |   |   |   |
| 11  |              |      |                                                           |   |             |   |   |   |

#### 7 **Note**

The techniques described in this section focus on how to use slicers connected to PivotTables. The same techniques also apply to using slicers connected to tables.

#### **Create a slicer**

You can create a slicer in a workbook or worksheet by using the Workbook.slicers.add method or Worksheet.slicers.add method. Doing so adds a slicer to the [SlicerCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.slicercollection) of the specified Workbook or Worksheet object. The SlicerCollection.add method has three parameters:

- slicerSource : The data source on which the new slicer is based. It can be a PivotTable , Table , or string representing the name or ID of a PivotTable or Table .
- sourceField : The field in the data source by which to filter. It can be a PivotField , TableColumn , or string representing the name or ID of a PivotField or TableColumn .
- slicerDestination : The worksheet where the new slicer will be created. It can be a Worksheet object or the name or ID of a Worksheet . This parameter is unnecessary when the SlicerCollection is accessed through Worksheet.slicers . In this case, the collection's worksheet is used as the destination.

The following code sample adds a new slicer to the **Pivot** worksheet. The slicer's source is the **Farm Sales** PivotTable and filters using the **Type** data. The slicer is also named

{245}------------------------------------------------

**Fruit Slicer** for future reference.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Pivot");
 let slicer = sheet.slicers.add(
 "Farm Sales" /* The slicer data source. For PivotTables, this can be
the PivotTable object reference or name. */,
 "Type" /* The field in the data to filter by. For PivotTables, this
can be a PivotField object reference or ID. */
 );
 slicer.name = "Fruit Slicer";
 await context.sync();
});
```
#### **Filter items with a slicer**

The slicer filters the PivotTable with items from the sourceField . The Slicer.selectItems method sets the items that remain in the slicer. These items are passed to the method as a string[] , representing the keys of the items. Any rows containing those items remain in the PivotTable's aggregation. Subsequent calls to selectItems set the list to the keys specified in those calls.

7 **Note**

If Slicer.selectItems is passed an item that's not in the data source, an InvalidArgument error is thrown. The contents can be verified through the Slicer.slicerItems property, which is a **[SlicerItemCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.sliceritemcollection)**.

The following code sample shows three items being selected for the slicer: **Lemon**, **Lime**, and **Orange**.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let slicer = context.workbook.slicers.getItem("Fruit Slicer");
 // Anything other than the following three values will be filtered out
of the PivotTable for display and aggregation.
 slicer.selectItems(["Lemon", "Lime", "Orange"]);
 await context.sync();
});
```

{246}------------------------------------------------

To remove all filters from the slicer, use the Slicer.clearFilters method, as shown in the following sample.

```
JavaScript
await Excel.run(async (context) => {
 let slicer = context.workbook.slicers.getItem("Fruit Slicer");
 slicer.clearFilters();
 await context.sync();
});
```
#### **Style and format a slicer**

You add-in can adjust a slicer's display settings through Slicer properties. The following code sample sets the style to **SlicerStyleLight6**, sets the text at the top of the slicer to **Fruit Types**, places the slicer at the position **(395, 15)** on the drawing layer, and sets the slicer's size to **135x150** pixels.

```
JavaScript
await Excel.run(async (context) => {
 let slicer = context.workbook.slicers.getItem("Fruit Slicer");
 slicer.caption = "Fruit Types";
 slicer.left = 395;
 slicer.top = 15;
 slicer.height = 135;
 slicer.width = 150;
 slicer.style = "SlicerStyleLight6";
 await context.sync();
});
```
#### **Delete a slicer**

To delete a slicer, call the Slicer.delete method. The following code sample deletes the first slicer from the current worksheet.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 sheet.slicers.getItemAt(0).delete();
 await context.sync();
});
```

{247}------------------------------------------------

## **Change aggregation function**

Data hierarchies have their values aggregated. For datasets of numbers, this is a sum by default. The summarizeBy property defines this behavior based on an [AggregationFunction](https://learn.microsoft.com/en-us/javascript/api/excel/excel.aggregationfunction) type.

The currently supported aggregation function types are Sum , Count , Average , Max , Min , Product , CountNumbers , StandardDeviation , StandardDeviationP , Variance , VarianceP , and Automatic (the default).

The following code samples changes the aggregation to be averages of the data.

```
JavaScript
await Excel.run(async (context) => {
 let pivotTable =
context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem("Farm
Sales");
 pivotTable.dataHierarchies.load("no-properties-needed");
 await context.sync();
 // Change the aggregation from the default sum to an average of all the
values in the hierarchy.
 pivotTable.dataHierarchies.items[0].summarizeBy =
Excel.AggregationFunction.average;
 pivotTable.dataHierarchies.items[1].summarizeBy =
Excel.AggregationFunction.average;
 await context.sync();
});
```
## **Change calculations with a ShowAsRule**

PivotTables, by default, aggregate the data of their row and column hierarchies independently. A [ShowAsRule](https://learn.microsoft.com/en-us/javascript/api/excel/excel.showasrule) changes the data hierarchy to output values based on other items in the PivotTable.

The ShowAsRule object has three properties:

- calculation : The type of relative calculation to apply to the data hierarchy (the default is none ).
- baseField : The [PivotField](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotfield) in the hierarchy containing the base data before the calculation is applied. Since Excel PivotTables have a one-to-one mapping of hierarchy to field, you'll use the same name to access both the hierarchy and the field.

{248}------------------------------------------------

- baseItem : The individual [PivotItem](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pivotitem) compared against the values of the base fields based on the calculation type. Not all calculations require this field.
The following example sets the calculation on the **Sum of Crates Sold at Farm** data hierarchy to be a percentage of the column total. We still want the granularity to extend to the fruit type level, so we'll use the **Type** row hierarchy and its underlying field. The example also has **Farm** as the first row hierarchy, so the farm total entries display the percentage each farm is responsible for producing as well.

|    | A           | B                                           |
|----|-------------|---------------------------------------------|
| 1  |             |                                             |
| 2  |             | Row Labels  Percentage of Total Farm Sales |
| 3  | OA Farms    | 27.47%                                      |
| 4  | Lemon       | 9.16%                                       |
| 5  | Lime        | 10.99%                                      |
|   | Orange      | 7.33%                                       |
| 7  | @B Farms    | 10.62%                                      |
| 8  | Kiwi        | 1.10%                                       |
| 9  | Lemon       | 3.11%                                       |
| 10 | Lime        | 4.76%                                       |
| 11 | Orange      | 1.65%                                       |
| 12 | EC Farms    | 17.40%                                      |
| 13 | Apple       | 10.07%                                      |
| 14 | Kiwi        | 7.33%                                       |
| 15 | ED Farms    | 6.59%                                       |
| 16 | Apple       | 6.59%                                       |
| 17 | OE Farms    | 28.75%                                      |
| 18 | Apple       | 8.97%                                       |
| 19 | Kiwi        | 7.33%                                       |
| 20 | Lime        | 5.86%                                       |
| 21 | Orange      | 6.59%                                       |
| 22 | EF Farms    | 9.16%                                       |
| 23 | Kiwi        | 3.66%                                       |
| 24 | Lemon       | 5.49%                                       |
| 25 | Grand Total | 100.00%                                     |

```
JavaScript
```

```
await Excel.run(async (context) => {
 let pivotTable =
context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem("Farm
Sales");
 let farmDataHierarchy = pivotTable.dataHierarchies.getItem("Sum of
Crates Sold at Farm");
 farmDataHierarchy.load("showAs");
 await context.sync();
```
 // Show the crates of each fruit type sold at the farm as a percentage of the column's total.

{249}------------------------------------------------

```
 let farmShowAs = farmDataHierarchy.showAs;
 farmShowAs.calculation = Excel.ShowAsCalculation.percentOfColumnTotal;
 farmShowAs.baseField =
pivotTable.rowHierarchies.getItem("Type").fields.getItem("Type");
 farmDataHierarchy.showAs = farmShowAs;
 farmDataHierarchy.name = "Percentage of Total Farm Sales";
});
```
The previous example set the calculation to the column, relative to the field of an individual row hierarchy. When the calculation relates to an individual item, use the baseItem property.

The following example shows the differenceFrom calculation. It displays the difference of the farm crate sales data hierarchy entries relative to those of **A Farms**. The baseField is **Farm**, so we see the differences between the other farms, as well as breakdowns for each type of like fruit (**Type** is also a row hierarchy in this example).

|    | A           | B                                    |  |  |
|----|-------------|--------------------------------------|--|--|
| 1  |             |                                      |  |  |
| 2  |             | Row Labels  Difference from A Farms |  |  |
| 3  | OA Farms    |                                      |  |  |
| 4  | Lemon       |                                      |  |  |
| 5  | Lime        |                                      |  |  |
|   | Orange      |                                      |  |  |
| 7  | @B Farms    | -460                                 |  |  |
| 8  | Kiwi        | #N/A                                 |  |  |
| 9  | Lemon       | -165                                 |  |  |
| 10 | Lime        | -170                                 |  |  |
| 11 | Orange      | -155                                 |  |  |
| 12 | C Farms    | -275                                 |  |  |
| 13 | Apple       | #N/A                                 |  |  |
| 14 | Kiwi        | #N/A                                 |  |  |
| 15 | @D Farms    | -570                                 |  |  |
| 16 | Apple       | #N/A                                 |  |  |
| 17 | OE Farms    |                                   |  |  |
| 18 | Apple       | #N/A                                 |  |  |
| 19 | Kiwi        | #N/A                                 |  |  |
| 20 | Lime        | -140                                 |  |  |
| 21 | Orange      | -20                                  |  |  |
| 22 | OF Farms    | -200                                 |  |  |
| 23 | Kiwi        | #N/A                                 |  |  |
| 24 | Lemon       | -100                                 |  |  |
| 25 | Grand Total |                                      |  |  |

#### JavaScript

await Excel.run(async (context) => { let pivotTable = context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem("Farm

{250}------------------------------------------------

```
Sales");
 let farmDataHierarchy = pivotTable.dataHierarchies.getItem("Sum of
Crates Sold at Farm");
 farmDataHierarchy.load("showAs");
 await context.sync();

 // Show the difference between crate sales of the "A Farms" and the
other farms.
 // This difference is both aggregated and shown for individual fruit
types (where applicable).
 let farmShowAs = farmDataHierarchy.showAs;
 farmShowAs.calculation = Excel.ShowAsCalculation.differenceFrom;
 farmShowAs.baseField =
pivotTable.rowHierarchies.getItem("Farm").fields.getItem("Farm");
 farmShowAs.baseItem =
pivotTable.rowHierarchies.getItem("Farm").fields.getItem("Farm").items.getIt
em("A Farms");
 farmDataHierarchy.showAs = farmShowAs;
 farmDataHierarchy.name = "Difference from A Farms";
});
```
### **Change hierarchy names**

Hierarchy fields are editable. The following code demonstrates how to change the displayed names of two data hierarchies.

```
JavaScript
await Excel.run(async (context) => {
 let dataHierarchies = context.workbook.worksheets.getActiveWorksheet()
 .pivotTables.getItem("Farm Sales").dataHierarchies;
 dataHierarchies.load("no-properties-needed");
 await context.sync();
 // Changing the displayed names of these entries.
 dataHierarchies.items[0].name = "Farm Sales";
 dataHierarchies.items[1].name = "Wholesale";
});
```
## **See also**

- Excel JavaScript object model in Office Add-ins
- [Excel JavaScript API Reference](https://learn.microsoft.com/en-us/javascript/api/excel)

{251}------------------------------------------------

# **Get a range using the Excel JavaScript API**

Article  05/02/2023

This article provides examples that show different ways to get a range within a worksheet using the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

#### 7 **Note**

JavaScript

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, the Excel JavaScript API defines all Excel cells as Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API. A single Range object can also contain multiple contiguous cells. See **Work with cells using the Excel JavaScript API** to learn more.

### **Get range by address**

The following code sample gets the range with address **B2:C5** from the worksheet named **Sample**, loads its address property, and writes a message to the console.

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");

 let range = sheet.getRange("B2:C5");
 range.load("address");
 await context.sync();

 console.log(`The address of the range B2:C5 is "${range.address}"`);
});
```
## **Get range by name**

The following code sample gets the range named MyRange from the worksheet named **Sample**, loads its address property, and writes a message to the console.

JavaScript

{252}------------------------------------------------

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("MyRange");
 range.load("address");
 await context.sync();
 console.log(`The address of the range "MyRange" is "${range.address}"`);
});
```
### **Get used range**

The following code sample gets the used range from the worksheet named **Sample**, loads its address property, and writes a message to the console. The used range is the smallest range that encompasses any cells in the worksheet that have a value or formatting assigned to them. If the entire worksheet is blank, the getUsedRange() method returns a range that consists of only the top-left cell.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getUsedRange();
 range.load("address");
 await context.sync();

 console.log(`The address of the used range in the worksheet is
"${range.address}"`);
});
```
## **Get entire range**

The following code sample gets the entire worksheet range from the worksheet named **Sample**, loads its address property, and writes a message to the console.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange();
 range.load("address");
 await context.sync();
```

{253}------------------------------------------------

```
 console.log(`The address of the entire worksheet range is
"${range.address}"`);
});
```
## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Insert a range using the Excel JavaScript API

{254}------------------------------------------------

# **Insert a range of cells using the Excel JavaScript API**

Article  05/02/2023

This article provides a code sample that inserts a range of cells with the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see the [Excel.Range class.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range)

#### 7 **Note**

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, the Excel JavaScript API defines all Excel cells as Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API. A single Range object can also contain multiple contiguous cells. See **Work with cells using the Excel JavaScript API** to learn more.

## **Insert a range of cells**

The following code sample inserts a range of cells in location **B4:E4** and shifts other cells down to provide space for the new cells.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("B4:E4");
 range.insert(Excel.InsertShiftDirection.down);
 await context.sync();
});
```
### **Data before range is inserted**

|   | A | B         | C | D    | E                          |  |
|---|---|-----------|---|------|----------------------------|--|
|   |   |           |   |      |                            |  |
| 2 |   | Product   |   |      | Qty Unit Price Total Price |  |
| 3 |   | Almonds   | 2 | 7.5  | 15                         |  |
| 4 |   | Coffee    | 1 | 34.5 | 34.5                       |  |
| 5 |   | Chocolate | 5 | 9.56 | 47.8                       |  |

{255}------------------------------------------------

### **Data after range is inserted**

|   | A         | B       | C<br>D |      | E                            |  |
|---|-----------|---------|--------|------|------------------------------|--|
| 1 |           |         |        |      |                              |  |
| 2 |           | Product |        |      | Qty  Unit Price  Total Price |  |
| 3 |           | Almonds | 2      | 7.5  | 15                           |  |
| 4 |           |         |        |      |                              |  |
| 5 |           | Coffee  | 1      | 34.5 | 34.5                         |  |
| 6 | Chocolate |         | 5      | 9.56 | 47.8                         |  |
|   |           |         |        |      |                              |  |

## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Clear or delete a ranges using the Excel JavaScript API

{256}------------------------------------------------

# **Clear or delete ranges using the Excel JavaScript API**

Article  05/02/2023

This article provides code samples that clear and delete ranges with the Excel JavaScript API. For the complete list of properties and methods supported by the Range object, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

#### 7 **Note**

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, the Excel JavaScript API defines all Excel cells as Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API. A single Range object can also contain multiple contiguous cells. See **Work with cells using the Excel JavaScript API** to learn more.

## **Clear a range of cells**

The following code sample clears all contents and formatting of cells in the range **E2:E5**.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("E2:E5");
 range.clear();
 await context.sync();
});
```
### **Data before range is cleared**

|   | A | B                                     | C | D    | E    |  |
|---|---|---------------------------------------|---|------|------|--|
|   |   |                                       |   |      |      |  |
| 2 |   | Qty Unit Price Total Price<br>Product |   |      |      |  |
| 3 |   | Almonds                               | 2 | 7.5  | 15   |  |
| 4 |   | Coffee                                | 1 | 34.5 | 34.5 |  |
| 5 |   | Chocolate                             | 5 | 9.56 | 47.8 |  |

{257}------------------------------------------------

#### **Data after range is cleared**

|     | A | B         | C | D               | E |  |
|-----|---|-----------|---|-----------------|---|--|
| 1   |   |           |   |                 |   |  |
| 2   |   | Product   |   | Qty  Unit Price |   |  |
| 3   |   | Almonds   | 2 | 7.5             |   |  |
|  |   | Coffee    | 1 | 34.5            |   |  |
|    |   | Chocolate | 5 | 9.56            |   |  |
|     |   |           |   |                 |   |  |

## **Delete a range of cells**

The following code sample deletes the cells in the range **B4:E4** and shifts other cells up to fill the space that was vacated by the deleted cells.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("B4:E4");
 range.delete(Excel.DeleteShiftDirection.up);
 await context.sync();
});
```
### **Data before range is deleted**

|   | A | B         | C | D    | E                          |  |
|---|---|-----------|---|------|----------------------------|--|
| 1 |   |           |   |      |                            |  |
|  |   | Product   |   |      | Qty Unit Price Total Price |  |
| 3 |   | Almonds   | 2 | 7.5  | 15                         |  |
| 4 |   | Coffee    | 1 | 34.5 | 34.5                       |  |
| 5 |   | Chocolate | 5 | 9.56 | 47.8                       |  |
|   |   |           |   |      |                            |  |

### **Data after range is deleted**

|   | A | B         | C | D    | E                          |
|---|---|-----------|---|------|----------------------------|
| 1 |   |           |   |      |                            |
| 2 |   | Product   |   |      | Qty Unit Price Total Price |
| 3 |   | Almonds   | 2 | 7.5  | 15                         |
| 4 |   | Chocolate | 5 | 9.56 | 47.8                       |
| 5 |   |           |   |      |                            |

{258}------------------------------------------------

## **See also**

- Work with cells using the Excel JavaScript API
- Set and get ranges using the Excel JavaScript API
- Excel JavaScript object model in Office Add-ins

{259}------------------------------------------------

# **Set and get the selected range using the Excel JavaScript API**

Article  05/02/2023

This article provides code samples that set and get the selected range with the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

#### 7 **Note**

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, the Excel JavaScript API defines all Excel cells as Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API. A single Range object can also contain multiple contiguous cells. See **Work with cells using the Excel JavaScript API** to learn more.

### **Set the selected range**

The following code sample selects the range **B2:E6** in the active worksheet.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let range = sheet.getRange("B2:E6");
 range.select();
 await context.sync();
});
```
### **Selected range B2:E6**

{260}------------------------------------------------

|   | A | B | C/ | D | E | F |
|---|---|---|----|---|---|---|
| 1 |   |   |    |   |   |   |
|  |   |   |    |   |   |   |
|   |   |   |    |   |   |   |
| 4 |   |   |    |   |   |   |
| 5 |   |   |    |   |   |   |
|  |   |   |    |   |   |   |
| 7 |   |   |    |   |   |   |
| 8 |   |   |    |   |   |   |
|   |   |   |    |   |   |   |

### **Get the selected range**

The following code sample gets the selected range, loads its address property, and writes a message to the console.

```
JavaScript
await Excel.run(async (context) => {
 let range = context.workbook.getSelectedRange();
 range.load("address");
 await context.sync();

 console.log(`The address of the selected range is "${range.address}"`);
});
```
## **Select the edge of a used range**

The [Range.getRangeEdge](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getrangeedge-member(1)) and [Range.getExtendedRange](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getextendedrange-member(1)) methods let your add-in replicate the behavior of the keyboard selection shortcuts, selecting the edge of the used range based on the currently selected range. To learn more about used ranges, see Get used range.

In the following screenshot, the used range is the table with values in each cell, **C5:F12**. The empty cells outside this table are outside the used range.

{261}------------------------------------------------

|    | A | B | C | D                                      | E              | E        | G |
|----|---|---|---|----------------------------------------|----------------|----------|---|
|   |   |   |   |                                        |                |          |   |
| 2  |   |   |   |                                        |                |          |   |
| 3  |   |   |   |                                        |                |          |   |
| 4  |   |   |   |                                        |                |          |   |
| 5  |   |   |   | Date Merchant                          | Category<br>D  | Amount  |   |
| 6  |   |   |   | 1/1/17  The Phone Company              | Communications | $120     |   |
| 7  |   |   |   | 1/2/17 Northwind Electric Cars         | Transportation | $142     |   |
| 8  |   |   |   | 1/5/17 Best For You Organics Company   | Groceries      | $27      |   |
|   |   |   |   | 1/10/17 Coho Vineyard                  | Restaurant     |   |   |
| 10 |   |   |   | 1/11/17 Bellows College                | Education      | $350     |   |
| 11 |   |   |   | 1/15/17 Trey Research                  | Other          | $135     |   |
| 12 |   |   |   | 1/15/17  Best For You Organics Company | Groceries      | $97      |   |
| 13 |   |   |   |                                        |                |          |   |
| 14 |   |   |   |                                        |                |          |   |
| 15 |   |   |   |                                        |                |          |   |
| 16 |   |   |   |                                        |                |          |   |

### **Select the cell at the edge of the current used range**

The following code sample shows how use the Range.getRangeEdge method to select the cell at the furthest edge of the current used range, in the direction up. This action matches the result of using the Ctrl + Up arrow key keyboard shortcut while a range is selected.

```
JavaScript
await Excel.run(async (context) => {
 // Get the selected range.
 let range = context.workbook.getSelectedRange();
 // Specify the direction with the `KeyboardDirection` enum.
 let direction = Excel.KeyboardDirection.up;
 // Get the active cell in the workbook.
 let activeCell = context.workbook.getActiveCell();
 // Get the top-most cell of the current used range.
 // This method acts like the Ctrl+Up arrow key keyboard shortcut while a
range is selected.
 let rangeEdge = range.getRangeEdge(
 direction,
 activeCell
 );
 rangeEdge.select();
 await context.sync();
});
```

{262}------------------------------------------------

The following screenshot shows a used range and a selected range within the used range. The used range is a table with data at **C5:F12**. Inside this table, the range **D8:E9** is selected. This selection is the *before* state, prior to running the Range.getRangeEdge method.

|    | A | B | C      | D                                      | E              | E        | G |
|----|---|---|--------|----------------------------------------|----------------|----------|---|
| 1  |   |   |        |                                        |                |          |   |
| 2  |   |   |        |                                        |                |          |   |
| 3  |   |   |        |                                        |                |          |   |
| 4  |   |   |        |                                        |                |          |   |
| 5  |   |   | Date  | Merchant                               | Category       | Amount  |   |
|   |   |   |        | 1/1/17  The Phone Company              | Communications | $120     |   |
| 7  |   |   |        | 1/2/17 Northwind Electric Cars         | Transportation | $142     |   |
| 8  |   |   |        | 1/5/17 Best For You Organics Company   | Groceries      | $27      |   |
| g  |   |   |        | 1/10/17 Coho Vineyard                  | Restaurant     | $33      |   |
| 10 |   |   |        | 1/11/17 Bellows College                | Education      | $350     |   |
| 11 |   |   |        | 1/15/17 Trey Research                  | Other          | $135     |   |
| 12 |   |   |        | 1/15/17  Best For You Organics Company | Groceries      | $97      |   |
| 13 |   |   |        |                                        |                |          |   |
| 14 |   |   |        |                                        |                |          |   |

#### **After selecting the cell at the edge of the used range**

The following screenshot shows the same table as the preceding screenshot, with data in the range **C5:F12**. Inside this table, the range **D5** is selected. This selection is *after* state, after running the Range.getRangeEdge method to select the cell at the edge of the used range in the up direction.

|    | A | B | C | D                                      | E              | E        | G |
|----|---|---|---|----------------------------------------|----------------|----------|---|
| 1  |   |   |   |                                        |                |          |   |
| 2  |   |   |   |                                        |                |          |   |
| 3  |   |   |   |                                        |                |          |   |
| 4  |   |   |   |                                        |                |          |   |
| 5  |   |   |   | Date Merchant                          | Category<br>D  | Amount  |   |
|   |   |   |   | 1/17 The Phone Company                 | Communications | $120     |   |
| 7  |   |   |   | 1/2/17 Northwind Electric Cars         | Transportation | $142     |   |
| 8  |   |   |   | 1/5/17 Best For You Organics Company   | Groceries      | $27      |   |
|  |   |   |   | 1/10/17 Coho Vineyard                  | Restaurant     |   |   |
| 10 |   |   |   | 1/11/17 Bellows College                | Education      | $350     |   |
| 11 |   |   |   | 1/15/17 Trey Research                  | Other          | $135     |   |
| 12 |   |   |   | 1/15/17  Best For You Organics Company | Groceries      | $97      |   |
| 13 |   |   |   |                                        |                |          |   |
| 14 |   |   |   |                                        |                |          |   |

### **Select all cells from current range to furthest edge of used range**

The following code sample shows how use the Range.getExtendedRange method to to select all the cells from the currently selected range to the furthest edge of the used

{263}------------------------------------------------

range, in the direction down. This action matches the result of using the Ctrl + Shift + Down arrow key keyboard shortcut while a range is selected.

```
JavaScript
await Excel.run(async (context) => {
 // Get the selected range.
 let range = context.workbook.getSelectedRange();
 // Specify the direction with the `KeyboardDirection` enum.
 let direction = Excel.KeyboardDirection.down;
 // Get the active cell in the workbook.
 let activeCell = context.workbook.getActiveCell();
 // Get all the cells from the currently selected range to the bottom-
most edge of the used range.
 // This method acts like the Ctrl+Shift+Down arrow key keyboard shortcut
while a range is selected.
 let extendedRange = range.getExtendedRange(
 direction,
 activeCell
 );
 extendedRange.select();
 await context.sync();
});
```
#### **Before selecting all the cells from the current range to the edge of the used range**

The following screenshot shows a used range and a selected range within the used range. The used range is a table with data at **C5:F12**. Inside this table, the range **D8:E9** is selected. This selection is the *before* state, prior to running the Range.getExtendedRange method.

|    | A | B | C | D                                      | E              | F        | G |
|----|---|---|---|----------------------------------------|----------------|----------|---|
| 1  |   |   |   |                                        |                |          |   |
| 2  |   |   |   |                                        |                |          |   |
| 3  |   |   |   |                                        |                |          |   |
| 4  |   |   |   |                                        |                |          |   |
| 5  |   |   |   | Date Merchant                          | Category<br>>  | Amount  |   |
| 6  |   |   |   | 1/17  The Phone Company                | Communications | $120     |   |
| 7  |   |   |   | 1/2/17 Northwind Electric Cars         | Transportation | $142     |   |
| 8  |   |   |   | 1/5/17 Best For You Organics Company   | Groceries      | $27      |   |
|   |   |   |   | 1/10/17 Coho Vineyard                  | Restaurant     |    |   |
| 10 |   |   |   | 1/11/17 Bellows College                | Education      | $350     |   |
| 11 |   |   |   | 1/15/17 Trey Research                  | Other          | $135     |   |
| 12 |   |   |   | 1/15/17  Best For You Organics Company | Groceries      | $97      |   |
| 13 |   |   |   |                                        |                |          |   |
| 14 |   |   |   |                                        |                |          |   |

{264}------------------------------------------------

#### **After selecting all the cells from the current range to the edge of the used range**

The following screenshot shows the same table as the preceding screenshot, with data in the range **C5:F12**. Inside this table, the range **D8:E12** is selected. This selection is *after* state, after running the Range.getExtendedRange method to select all the cells from the current range to the edge of the used range in the down direction.

|    | A | B | C | D                                     | E              | F        | G |
|----|---|---|---|---------------------------------------|----------------|----------|---|
| 1  |   |   |   |                                       |                |          |   |
| 2  |   |   |   |                                       |                |          |   |
| 3  |   |   |   |                                       |                |          |   |
| 4  |   |   |   |                                       |                |          |   |
| 5  |   |   |   | Date Merchant                         | Category<br>D  | Amount  |   |
|   |   |   |   | 1/17  The Phone Company               | Communications | $120     |   |
| 7  |   |   |   | 1/2/17 Northwind Electric Cars        | Transportation | $142     |   |
| 8  |   |   |   | 1/5/17 Best For You Organics Company  | Groceries      | $27      |   |
|   |   |   |   | 1/10/17 Coho Vineyard                 | Restaurant     | $33      |   |
| 10 |   |   |   | 1/11/17 Bellows College               | Education      | $350     |   |
| 11 |   |   |   | 1/15/17 Trey Research                 | Other          | 2135     |   |
| 12 |   |   |   | 1/15/17 Best For You Organics Company | Groceries      | $97      |   |
| 13 |   |   |   |                                       |                |          |   |
| 14 |   |   |   |                                       |                |          |   |

### **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Set and get range values, text, or formulas using the Excel JavaScript API
- Set range format using the Excel JavaScript API

{265}------------------------------------------------

# **Set and get range values, text, or formulas using the Excel JavaScript API**

Article  05/02/2023

This article provides code samples that set and get range values, text, or formulas with the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

#### 7 **Note**

JavaScript

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, the Excel JavaScript API defines all Excel cells as Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API. A single Range object can also contain multiple contiguous cells. See **Work with cells using the Excel JavaScript API** to learn more.

### **Set values or formulas**

The following code samples set values and formulas for a single cell or a range of cells.

#### **Set value for a single cell**

The following code sample sets the value of cell **C3** to "5" and then sets the width of the columns to best fit the data.

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("C3");
 range.values = [[ 5 ]];
 range.format.autofitColumns();
 await context.sync();
});
```
#### **Data before cell value is updated**

{266}------------------------------------------------

|   | A | B         | C | D              | E |
|---|---|-----------|---|----------------|---|
| 1 |   |           |   |                |   |
| 2 |   | Product   |   | Qty Unit Price |   |
| 3 |   | Almonds   | 2 | 7.5            |   |
| 4 |   | Coffee    | 1 | 34.5           |   |
| 5 |   | Chocolate | 5 | 9.56           |   |
|  |   |           |   |                |   |
| 7 |   |           |   |                |   |

#### **Data after cell value is updated**

|   | A | B         | C | D               | E |
|---|---|-----------|---|-----------------|---|
| 1 |   |           |   |                 |   |
| 2 |   | Product   |   | Qty  Unit Price |   |
| 3 |   | Almonds   | 5 | 7.5             |   |
| 4 |   | Coffee    | 1 | 34.5            |   |
| 5 |   | Chocolate | 5 | 9.56            |   |
|  |   |           |   |                 |   |
|   |   |           |   |                 |   |

### **Set values for a range of cells**

The following code sample sets values for the cells in the range **B5:D5** and then sets the width of the columns to best fit the data.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let data = [
 ["Potato Chips", 10, 1.80],
 ];
 let range = sheet.getRange("B5:D5");
 range.values = data;
 range.format.autofitColumns();
 await context.sync();
});
```
#### **Data before cell values are updated**

{267}------------------------------------------------

|   | A | B         | C | D               | E |
|---|---|-----------|---|-----------------|---|
| 1 |   |           |   |                 |   |
| 2 |   | Product   |   | Qty  Unit Price |   |
| 3 |   | Almonds   | 2 | 7.5             |   |
| 4 |   | Coffee    | 1 | 34.5            |   |
| 5 |   | Chocolate | 5 | 9.56            |   |
|  |   |           |   |                 |   |
| 1 |   |           |   |                 |   |

#### **Data after cell values are updated**

|   | A | B            | C  | D               | E |
|---|---|--------------|----|-----------------|---|
| 1 |   |              |    |                 |   |
| 2 |   | Product      |    | Qty  Unit Price |   |
| 3 |   | Almonds      | 2  | 7.5             |   |
| 4 |   | Coffee       | 1  | 34.5            |   |
| 5 |   | Potato Chips | 10 | 1.8             |   |
|  |   |              |    |                 |   |
| 7 |   |              |    |                 |   |

#### **Set formula for a single cell**

The following code sample sets a formula for cell **E3** and then sets the width of the columns to best fit the data.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("E3");
 range.formulas = [[ "=C3 * D3" ]];
 range.format.autofitColumns();
 await context.sync();
});
```
#### **Data before cell formula is set**

|   | A | B         | C | D    | E                          |
|---|---|-----------|---|------|----------------------------|
| 1 |   |           |   |      |                            |
| 2 |   | Product   |   |      | Qty Unit Price Total Price |
| 3 |   | Almonds   | 2 | 7.5  |                            |
| 4 |   | Coffee    | 1 | 34.5 |                            |
| 5 |   | Chocolate | 5 | 9.56 |                            |
|  |   |           |   |      |                            |
|   |   |           |   |      |                            |

{268}------------------------------------------------

#### **Data after cell formula is set**

|   | A | B         | C | D    | E                          |
|---|---|-----------|---|------|----------------------------|
| 1 |   |           |   |      |                            |
| 2 |   | Product   |   |      | Qty Unit Price Total Price |
| 3 |   | Almonds   | 2 | 7.5  | 15                         |
| 4 |   | Coffee    | 1 | 34.5 |                            |
| 5 |   | Chocolate | 5 | 9.56 |                            |
| 6 |   |           |   |      |                            |
| 7 |   |           |   |      |                            |

### **Set formulas for a range of cells**

The following code sample sets formulas for cells in the range **E2:E6** and then sets the width of the columns to best fit the data.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let data = [
 ["=C3 * D3"],
 ["=C4 * D4"],
 ["=C5 * D5"],
 ["=SUM(E3:E5)"]
 ];
 let range = sheet.getRange("E3:E6");
 range.formulas = data;
 range.format.autofitColumns();
 await context.sync();
});
```
#### **Data before cell formulas are set**

|   | A | B         | C | D    | E                          |
|---|---|-----------|---|------|----------------------------|
| 1 |   |           |   |      |                            |
| 2 |   | Product   |   |      | Qty Unit Price Total Price |
| 3 |   | Almonds   | 2 | 7.5  |                            |
| 4 |   | Coffee    | 1 | 34.5 |                            |
| 5 |   | Chocolate | 5 | 9.56 |                            |
|  |   |           |   |      |                            |
| 7 |   |           |   |      |                            |

#### **Data after cell formulas are set**

{269}------------------------------------------------

|   | A | B         | C | D    | E                          |  |
|---|---|-----------|---|------|----------------------------|--|
| 1 |   |           |   |      |                            |  |
| 2 |   | Product   |   |      | Qty Unit Price Total Price |  |
| 3 |   | Almonds   | 2 | 7.5  | 15                         |  |
| 4 |   | Coffee    | 1 | 34.5 | 34.5                       |  |
| 5 |   | Chocolate | 5 | 9.56 | 47.8                       |  |
|  |   |           |   |      | 97.3                       |  |
| 7 |   |           |   |      |                            |  |

### **Get values, text, or formulas**

These code samples get values, text, and formulas from a range of cells.

### **Get values from a range of cells**

The following code sample gets the range **B2:E6**, loads its values property, and writes the values to the console. The values property of a range specifies the raw values that the cells contain. Even if some cells in a range contain formulas, the values property of the range specifies the raw values for those cells, not any of the formulas.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("B2:E6");
 range.load("values");
 await context.sync();
 console.log(JSON.stringify(range.values, null, 4));
});
```

|   | A | B         | C | D    | E                            |
|---|---|-----------|---|------|------------------------------|
| 1 |   |           |   |      |                              |
| 2 |   | Product   |   |      | Qty  Unit Price  Total Price |
| 3 |   | Almonds   | 2 | 7.5  | 15                           |
| 4 |   | Coffee    | 1 | 34.5 | 34.5                         |
| 5 |   | Chocolate | 5 | 9.56 | 47.8                         |
|  |   |           |   |      | 97.3                         |
| 7 |   |           |   |      |                              |

#### **Data in range (values in column E are a result of formulas)**

**range.values (as logged to the console by the code sample above)**

{270}------------------------------------------------

```
JSON
[
 [
 "Product",
 "Qty",
 "Unit Price",
 "Total Price"
 ],
 [
 "Almonds",
 2,
 7.5,
 15
 ],
 [
 "Coffee",
 1,
 34.5,
 34.5
 ],
 [
 "Chocolate",
 5,
 9.56,
 47.8
 ],
 [
 "",
 "",
 "",
 97.3
 ]
]
```
### **Get text from a range of cells**

The following code sample gets the range **B2:E6**, loads its text property, and writes it to the console. The text property of a range specifies the display values for cells in the range. Even if some cells in a range contain formulas, the text property of the range specifies the display values for those cells, not any of the formulas.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("B2:E6");
 range.load("text");
 await context.sync();
```

{271}------------------------------------------------

```
 console.log(JSON.stringify(range.text, null, 4));
});
```
#### **Data in range (values in column E are a result of formulas)**

|   | A | B         | C | D    | E                            |  |
|---|---|-----------|---|------|------------------------------|--|
| 1 |   |           |   |      |                              |  |
| 2 |   | Product   |   |      | Qty  Unit Price  Total Price |  |
| 3 |   | Almonds   | 2 | 7.5  | 15                           |  |
| 4 |   | Coffee    | 1 | 34.5 | 34.5                         |  |
|  |   | Chocolate | 5 | 9.56 | 47.8                         |  |
|  |   |           |   |      | 97.3                         |  |
| 7 |   |           |   |      |                              |  |

#### **range.text (as logged to the console by the code sample above)**

| JSON    |                                                        |
|---------|--------------------------------------------------------|
| [<br>[  | "Product",<br>"Qty",<br>"Unit Price",<br>"Total Price" |
| ],<br>[ | "Almonds",<br>"2",<br>"7.5",<br>"15"                   |
| ],<br>[ | "Coffee",<br>"1",<br>"34.5",<br>"34.5"                 |
| ],<br>[ | "Chocolate",<br>"5",<br>"9.56",<br>"47.8"              |
| ],<br>[ | "",<br>"",<br>"",<br>"97.3"                            |

{272}------------------------------------------------

### **Get formulas from a range of cells**

The following code sample gets the range **B2:E6**, loads its formulas property, and writes it to the console. The formulas property of a range specifies the formulas for cells in the range that contain formulas and the raw values for cells in the range that do not contain formulas.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("B2:E6");
 range.load("formulas");
 await context.sync();
 console.log(JSON.stringify(range.formulas, null, 4));
});
```
#### **Data in range (values in column E are a result of formulas)**

|   | A | B         | C | D    | E                            |  |
|---|---|-----------|---|------|------------------------------|--|
| 1 |   |           |   |      |                              |  |
| 2 |   | Product   |   |      | Qty  Unit Price  Total Price |  |
| 3 |   | Almonds   | 2 | 7.5  | 15                           |  |
| 4 |   | Coffee    | 1 | 34.5 | 34.5                         |  |
|  |   | Chocolate | 5 | 9.56 | 47.8                         |  |
|  |   |           |   |      | 97.3                         |  |
| 7 |   |           |   |      |                              |  |

**range.formulas (as logged to the console by the code sample above)**

| JSON   |                                       |
|--------|---------------------------------------|
| [<br>[ | "Product",<br>"Qty",<br>"Unit Price", |
|        | "Total Price"                         |
| ],     |                                       |

{273}------------------------------------------------

```
 [
 "Almonds",
 2,
 7.5,
 "=C3 * D3"
 ],
 [
 "Coffee",
 1,
 34.5,
 "=C4 * D4"
 ],
 [
 "Chocolate",
 5,
 9.56,
 "=C5 * D5"
 ],
 [
 "",
 "",
 "",
 "=SUM(E3:E5)"
 ]
]
```
## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Set and get ranges using the Excel JavaScript API
- Set range format using the Excel JavaScript API

{274}------------------------------------------------

# **Set range format using the Excel JavaScript API**

Article  05/02/2023

This article provides code samples that set font color, fill color, and number format for cells in a range with the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

#### 7 **Note**

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, the Excel JavaScript API defines all Excel cells as Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API. A single Range object can also contain multiple contiguous cells. See **Work with cells using the Excel JavaScript API** to learn more.

### **Set font color and fill color**

The following code sample sets the font color and fill color for cells in range **B2:E2**.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("B2:E2");
 range.format.fill.color = "#4472C4";
 range.format.font.color = "white";
 await context.sync();
});
```
#### **Data in range before font color and fill color are set**

| 15                             |
|--------------------------------|
| 34.5                           |
| 47.8                           |
|                                |
| Qty   Unit Price   Total Price |

{275}------------------------------------------------

#### **Data in range after font color and fill color are set**

| A | B         | C      | D | E      | E                                                 |
|---|-----------|--------|---|--------|---------------------------------------------------|
|   |           |        |   |        |                                                   |
|   | Product   |        |   |        |                                                   |
|   | Almonds   |        |   | 15     |                                                   |
|   |           | 1      |   | 34.5   |                                                   |
|   | Chocolate |        |   | 47.8   |                                                   |
|   |           |        |   |        |                                                   |
|   |           | Coffee |   | 2<br>5 | Qty Unit Price Total Price<br>7.5<br>34.5<br>9.56 |

## **Set number format**

The following code sample sets the number format for the cells in range **D3:E5**.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let formats = [
 ["0.00", "0.00"],
 ["0.00", "0.00"],
 ["0.00", "0.00"]
 ];
 let range = sheet.getRange("D3:E5");
 range.numberFormat = formats;
 await context.sync();
});
```
### **Data in range before number format is set**

|     | A | B         | C | D    | E                            | E |
|-----|---|-----------|---|------|------------------------------|---|
| 1   |   |           |   |      |                              |   |
| 2   |   | Product   |   |      | Qty  Unit Price  Total Price |   |
| 3   |   | Almonds   | 2 | 7.5  | 15                           |   |
|  |   | Coffee    | 1 | 34.5 | 34.5                         |   |
|    |   | Chocolate | 5 | 9.56 | 47.8                         |   |
| 6   |   |           |   |      |                              |   |

**Data in range after number format is set**

{276}------------------------------------------------

|     | A | B         | C | D     | E                          | E |
|-----|---|-----------|---|-------|----------------------------|---|
| 1   |   |           |   |       |                            |   |
|    |   | Product   |   |       | Qty Unit Price Total Price |   |
| 3   |   | Almonds   | 2 | 7.50  | 15.00                      |   |
|  |   | Coffee    | 1 | 34.50 | 34.50                      |   |
| 5   |   | Chocolate | 5 | 9.56  | 47.80                      |   |
| 6   |   |           |   |       |                            |   |

### **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Set and get ranges using the Excel JavaScript API
- Set and get range values, text, or formulas using the Excel JavaScript API

{277}------------------------------------------------

# **Add checkboxes using the Excel JavaScript API**

Article  04/23/2025

This article provides code samples that add, edit, and remove checkboxes from a range with the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

To use checkboxes, make sure that your range contains Boolean values, like **TRUE** or **FALSE**. Only Boolean values can be replaced with checkboxes using the Excel JavaScript API.

The following screenshot shows an example of checkboxes in a table. The table lists a variety of items, and the checkboxes indicate whether or not the items are types of fruit.

|    |            | B        |
|----|------------|----------|
| 1  | Fruit      | Analysis |
| 2  | Apple      |          |
| 3  | Kale       |          |
| 4  | Orange     |          |
| 5  | Pear       |          |
| 6  | Mango      |          |
| 7  | Dog        |          |
| 8  | Strawberry |          |
| 9  | Chair      |          |
| 10 | Tomato     | UNKNOWN  |
| 11 |            |          |
|    |            |          |

#### 7 **Note**

To experiment with the code snippets in this article in a complete sample, open **Script Lab** in Excel and select **[Checkboxes](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/42-range/range-cell-control.yaml)** in our **Samples** library.

### **Add checkboxes**

To add checkboxes to a range, use the [Range.control](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-control-member) property to access the [CellControl](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellcontrol) type, and set the CellControlType enum value to checkbox . Only Boolean values, like **TRUE** or **FALSE**, 

{278}------------------------------------------------

display as checkboxes in your range. The following code sample shows how to add checkboxes to the **Analysis** column of a table named **FruitTable**.

```
JavaScript
await Excel.run(async (context) => {
 // This code sample shows how to add checkboxes to a table.
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 // Get the "Analysis" column in the table, without the header.
 const range =
sheet.tables.getItem("FruitTable").columns.getItem("Analysis").getDataBodyRange();
 // Change the Boolean values in the range to checkboxes.
 range.control = {
 type: Excel.CellControlType.checkbox
 };
 await context.sync();
});
```
## **Change the value of a checkbox**

To select or clear a checkbox with the Excel JavaScript API, change the Boolean value in that cell. Use Range.values to change the value of a cell. The following code sample shows how to set the value of a cell to **TRUE**. Note that if the cell doesn't already display a checkbox, then the code sample simply changes the Boolean value of the cell.

```
JavaScript
await Excel.run(async (context) => {
 // This code sample shows how to change the value of cell B3.
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 const range = sheet.getRange("B3");
 range.values = [["TRUE"]];
 await context.sync();
});
```
### **Remove checkboxes**

To remove checkboxes from a range and return the values to simple Booleans, use the [Range.control](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-control-member) property to access the [CellControl](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellcontrol) type, and set the CellControlType enum value to empty . The following code sample shows how to remove checkboxes from the **Analysis** column of a table named **FruitTable**.

{279}------------------------------------------------

```
JavaScript
```

```
await Excel.run(async (context) => {
 // This code sample shows how to remove checkboxes from a table.
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 // Get the "Analysis" column in the table, without the header.
 const range =
sheet.tables.getItem("FruitTable").columns.getItem("Analysis").getDataBodyRange();
 // Change the checkboxes to Boolean values.
 range.control = {
 type: Excel.CellControlType.empty
 };
 await context.sync();
});
```
#### 7 **Note**

To remove all content from a range, use the **[Range.clearOrResetContents](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-clearorresetcontents-member(1))** method.

## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Insert a range using the Excel JavaScript API

{280}------------------------------------------------

# **Apply conditional formatting to Excel ranges**

Article  05/22/2023

The Excel JavaScript Library provides APIs to apply conditional formatting to data ranges in your worksheets. This functionality makes large sets of data easy to visually parse. The formatting also dynamically updates based on changes within the range.

#### 7 **Note**

This article covers conditional formatting in the context of Excel JavaScript add-ins. The following articles provide detailed information about the full conditional formatting capabilities within Excel.

- **[Add, change, or clear conditional formats](https://support.microsoft.com/office/fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f)**
- **[Use formulas with conditional formatting](https://support.microsoft.com/office/fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f)**

## **Programmatic control of conditional formatting**

The Range.conditionalFormats property is a collection of [ConditionalFormat](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformat) objects that apply to the range. The ConditionalFormat object contains several properties that define the format to be applied based on the [ConditionalFormatType](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformattype).

- cellValue
- colorScale
- custom
- dataBar
- iconSet
- preset
- textComparison
- topBottom

#### 7 **Note**

Each of these formatting properties has a corresponding *OrNullObject variant. Learn more about that pattern in the ***OrNullObject methods** section.

{281}------------------------------------------------

Only one format type can be set for the ConditionalFormat object. This is determined by the type property, which is a [ConditionalFormatType](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformattype) enum value. type is set when adding a conditional format to a range.

## **Create conditional formatting rules**

Conditional formats are added to a range by using conditionalFormats.add . Once added, the properties specific to the conditional format can be set. The following examples show the creation of different formatting types.

### **Cell [value](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellvalueconditionalformat)**

Cell value conditional formatting applies a user-defined format based on the results of one or two formulas in the [ConditionalCellValueRule](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalcellvaluerule). The operator property is a [ConditionalCellValueOperator](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalcellvalueoperator) defining how the resulting expressions relate to the formatting.

The following example shows red font coloring applied to any value in the range less than zero.

|           | Company  2013 > 2014 |         | > 2015 |  2016         |
|-----------|-----------------------|---------|--------|-----------------|
| Contoso   | $256.00               | -$55.31 |        | $68.90 -$82.13  |
| Fabrikam  | $454.00               | $75.29  |        | -$88.88 $781.87 |
| Northwind | -$858.21              | $35.33  |        | $49.01 $112.68  |

```
JavaScript
```

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const range = sheet.getRange("B21:E23");
 const conditionalFormat = range.conditionalFormats.add(
 Excel.ConditionalFormatType.cellValue
 );

 // Set the font of negative numbers to red.
 conditionalFormat.cellValue.format.font.color = "red";
 conditionalFormat.cellValue.rule = { formula1: "=0", operator:
"LessThan" };

 await context.sync();
});
```
### **[Color](https://learn.microsoft.com/en-us/javascript/api/excel/excel.colorscaleconditionalformat) scale**

{282}------------------------------------------------

Color scale conditional formatting applies a color gradient across the data range. The criteria property on the ColorScaleConditionalFormat defines three [ConditionalColorScaleCriterion:](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalcolorscalecriterion) minimum , maximum , and, optionally, midpoint . Each of the criterion scale points have three properties:

- color The HTML color code for the endpoint.
- formula A number or formula representing the endpoint. This will be null if type is lowestValue or highestValue .
- type How the formula should be evaluated. highestValue and lowestValue refer to values in the range being formatted.

The following example shows a range being colored blue to yellow to red. Note that minimum and maximum are the lowest and highest values respectively and use null formulas. midpoint is using the percentage type with a formula of "=50" so the yellowest cell is the mean value.

| Category Jan Jan Feb |  |          |  Mar | Apr  |          |    |  |  |                            |  |                         |       |
|----------------------|--|----------|-------|------|----------|----|--|--|----------------------------|--|-------------------------|-------|
| Avg High             |  | 40<br>38 |      |      | 45 51    | 56 |  |  | 67 67 72 77 7              |  | 59                      | 41    |
| Avg Low              |  | 34<br>33 | 38    | 41   |          |    |  |  | 45 45 48 51 51 55 55 55 54 |  | 45 41 38                |       |
| Record High          |  | 61<br>69 | 79    | 83 8 |          |    |  |  | 95 97 100 101 94 887       |  |                         | 72 66 |
| Record Low           |  |          |       |      | 24 24 28 |    |  |  |                            |  | 32 36 36 39 35 21 21 12 |       |

```
JavaScript
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const range = sheet.getRange("B2:M5");
 const conditionalFormat = range.conditionalFormats.add(
 Excel.ConditionalFormatType.colorScale
 );

 // Color the backgrounds of the cells from blue to yellow to red based
on value.
 const criteria = {
 minimum: {
 formula: null,
 type: Excel.ConditionalFormatColorCriterionType.lowestValue,
 color: "blue"
 },
 midpoint: {
 formula: "50",
 type: Excel.ConditionalFormatColorCriterionType.percent,
 color: "yellow"
 },
 maximum: {
 formula: null,
 type: Excel.ConditionalFormatColorCriterionType.highestValue,
 color: "red"
 }
 };
```

{283}------------------------------------------------

```
 conditionalFormat.colorScale.criteria = criteria;

 await context.sync();
});
```
#### **[Custom](https://learn.microsoft.com/en-us/javascript/api/excel/excel.customconditionalformat)**

Custom conditional formatting applies a user-defined format to the cells based on a formula of arbitrary complexity. The [ConditionalFormatRule](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformatrule) object lets you define the formula in different notations:

- formula Standard notation.
- formulaLocal Localized based on the user's language.
- formulaR1C1 R1C1-style notation.

The following example colors the fonts green of cells with higher values than the cell to their left.

| Sales Team Qtr1 Qtr1 Qtr2 |      |      |  Qtr3 |  Qtr4 |
|---------------------------|------|------|--------|--------|
| Asian Team 1              | 500  | 700  | 654    | 234    |
| Asian Team 2              | 400  | 323  | 276    | 345    |
| Asian Team 3              | 1200 | 876  | 845    | 456    |
| Euro Team 1               | 600  | 500  | 854    | 567    |
| Euro Team 2               | 5001 | 2232 | 4763   | 678    |
| Euro Team 3               | 130  | 776  | 104    | 789    |

```
JavaScript
```

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const range = sheet.getRange("B8:E13");
 const conditionalFormat = range.conditionalFormats.add(
 Excel.ConditionalFormatType.custom
 );

 // If a cell has a higher value than the one to its left, set that
cell's font to green.
 conditionalFormat.custom.rule.formula =
'=IF(B8>INDIRECT("RC[-1]",0),TRUE)';
 conditionalFormat.custom.format.font.color = "green";

 await context.sync();
});
```
#### **[Data](https://learn.microsoft.com/en-us/javascript/api/excel/excel.databarconditionalformat) bar**

{284}------------------------------------------------

Data bar conditional formatting adds data bars to the cells. By default, the minimum and maximum values in the Range form the bounds and proportional sizes of the data bars. The DataBarConditionalFormat object has several properties to control the bar's appearance.

| Sales Team Z Qtr1 |      |  Qtr2 |  Qtr3 |  Qtr4 |
|-------------------|------|--------|--------|--------|
| Asian Team 1      | 500  | 700    | 654    | 234    |
| Asian Team 2      | 400  | 323    | 276    | 345    |
| Asian Team 3      | 1200 | 876    | 845    | 456    |
| Euro Team 1       | 600  | 500    | 854    | 567    |
| Euro Team 2       | 5001 | 2232   | 4763   | 678    |
| Euro Team 3       | 130  | 776    | 104    | 789    |

The following example formats the range with data bars filling left-to-right.

```
JavaScript
```

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const range = sheet.getRange("B8:E13");
 const conditionalFormat = range.conditionalFormats.add(
 Excel.ConditionalFormatType.dataBar
 );

 // Give left-to-right, default-appearance data bars to all the cells.
 conditionalFormat.dataBar.barDirection =
Excel.ConditionalDataBarDirection.leftToRight;
 await context.sync();
});
```
#### **[Icon](https://learn.microsoft.com/en-us/javascript/api/excel/excel.iconsetconditionalformat) set**

Icon set conditional formatting uses Excel [Icons](https://learn.microsoft.com/en-us/javascript/api/excel/excel.icon) to highlight cells. The criteria property is an array of [ConditionalIconCriterion](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionaliconcriterion), which define the symbol to be inserted and the condition under which it is inserted. This array is automatically prepopulated with criterion elements with default properties. Individual properties cannot be overwritten. Instead, the whole criteria object must be replaced.

The following example shows a three-triangle icon set applied across the range.

| Sales Team & Qtr1     |  |       |           | Qtr4 Y     |  |
|-----------------------|--|-------|-----------|------------|--|
| Asian Team 1  500   |  |       | 700      | 654  234  |  |
| Asian Team 2         |  | 400  | 323      | 276  345  |  |
| Asian Team 3  1200  |  |       | 876 =     | 845  456  |  |
| Euro Team 1  600    |  |       | 500      | 854  567  |  |
| Euro Team 2  5001   |  |       | 2232     | 4763 7 678 |  |
| Euro Team 3  130 =   |  |       | 776  201 | 104 = 789  |  |

{285}------------------------------------------------

```
JavaScript
```

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const range = sheet.getRange("B8:E13");
 const conditionalFormat = range.conditionalFormats.add(
 Excel.ConditionalFormatType.iconSet
 );

 const iconSetCF = conditionalFormat.iconSet;
 iconSetCF.style = Excel.IconSet.threeTriangles;

 /*
 With a "three*" icon set style, such as "threeTriangles", the third
 element in the criteria array (criteria[2]) defines the "top" icon;
 e.g., a green triangle. The second (criteria[1]) defines the
"middle"
 icon, The first (criteria[0]) defines the "low" icon, but it can
often 
 be left empty as this method does below, because every cell that
 does not match the other two criteria always gets the low icon.
 */
 iconSetCF.criteria = [
 {},
 {
 type: Excel.ConditionalFormatIconRuleType.number,
 operator:
Excel.ConditionalIconCriterionOperator.greaterThanOrEqual,
 formula: "=700"
 },
 {
 type: Excel.ConditionalFormatIconRuleType.number,
 operator:
Excel.ConditionalIconCriterionOperator.greaterThanOrEqual,
 formula: "=1000"
 }
 ];
 await context.sync();
});
```
### **Preset [criteria](https://learn.microsoft.com/en-us/javascript/api/excel/excel.presetcriteriaconditionalformat)**

Preset conditional formatting applies a user-defined format to the range based on a selected standard rule. These rules are defined by the [ConditionalFormatPresetCriterion](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformatpresetcriterion) in the [ConditionalPresetCriteriaRule.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalpresetcriteriarule)

The following example colors the font white wherever a cell's value is at least one standard deviation above the range's average.

{286}------------------------------------------------

| Category Jan Jan |    |  Feb |  Mar | Apr |    |    |       |            |        |    |          |    |
|------------------|----|-------|-------|-----|----|----|-------|------------|--------|----|----------|----|
| Avg High         | 40 | 38    | 44    | 45  | 51 |    |       | 56         | 19 -   |    | 59 45    | 41 |
| Avg Low          | 34 | 33    | 38    | 41  | 45 |    | 48 51 | 55         | 54     | 45 | 41       | 38 |
| Record High      | 61 |     | 197   | 83  | 95 |    |       | 97 100 101 | - 94 / | 87 | 72       | 66 |
| Record Low       | 0  | 2     |     | 24  | 28 | 32 |       | 36 36 39 3 |        |    | 35 21 12 | 4  |

JavaScript

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const range = sheet.getRange("B2:M5");
 const conditionalFormat = range.conditionalFormats.add(
 Excel.ConditionalFormatType.presetCriteria
 );

 // Color every cell's font white that is one standard deviation above
average relative to the range.
 conditionalFormat.preset.format.font.color = "white";
 conditionalFormat.preset.rule = {
 criterion:
Excel.ConditionalFormatPresetCriterion.oneStdDevAboveAverage
 };

 await context.sync();
});
```
#### **Text [comparison](https://learn.microsoft.com/en-us/javascript/api/excel/excel.textconditionalformat)**

Text comparison conditional formatting uses string comparisons as the condition. The rule property is a [ConditionalTextComparisonRule](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionaltextcomparisonrule) defining a string to compare with the cell and an operator to specify the type of comparison.

The following example formats the font color red when a cell's text contains "Delayed".

| Project   | Alpha Z Beta |                  |  Ship                        |
|-----------|--------------|------------------|-------------------------------|
| Project 1 |              | Complete Ongoing | On Schedule                   |
| Project 2 |              |                  | Complete Complete On Schedule |
| Project 3 | Ongoing      |                  | Not Started  Delayed          |

```
JavaScript
```

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const range = sheet.getRange("B16:D18");
 const conditionalFormat = range.conditionalFormats.add(
 Excel.ConditionalFormatType.containsText
 );

 // Color the font of every cell containing "Delayed".
 conditionalFormat.textComparison.format.font.color = "red";
```

{287}------------------------------------------------

```
 conditionalFormat.textComparison.rule = {
 operator: Excel.ConditionalTextOperator.contains,
 text: "Delayed"
 };

 await context.sync();
});
```
### **[Top/bottom](https://learn.microsoft.com/en-us/javascript/api/excel/excel.topbottomconditionalformat)**

Top/bottom conditional formatting applies a format to the highest or lowest values in a range. The rule property, which is of type [ConditionalTopBottomRule](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionaltopbottomrule), sets whether the condition is based on the highest or lowest, as well as whether the evaluation is ranked or percentage-based.

The following example applies a green highlight to the highest value cell in the range.

|           | Company 2013 - 2014 |         | > 2015 |  2016         |
|-----------|---------------------|---------|--------|-----------------|
| Contoso   | $256.00             | -$55.31 |        | $68.90 -$82.13  |
| Fabrikam  | $454.00             | $75.29  |        | -$88.88 $781.87 |
| Northwind | -$858.21            | $35.33  |        | $49.01 $112.68  |

```
JavaScript
```

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const range = sheet.getRange("B21:E23");
 const conditionalFormat = range.conditionalFormats.add(
 Excel.ConditionalFormatType.topBottom
 );

 // For the highest valued cell in the range, make the background green.
 conditionalFormat.topBottom.format.fill.color = "green"
 conditionalFormat.topBottom.rule = { rank: 1, type: "TopItems"}

 await context.sync();
});
```
## **Change conditional formatting rules**

The ConditionalFormat object offers multiple methods to change conditional formatting rules after they've been set.

- [changeRuleToCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformat#excel-excel-conditionalformat-changeruletocellvalue-member(1))
- [changeRuleToColorScale](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformat#excel-excel-conditionalformat-changeruletocolorscale-member(1))
- [changeRuleToContainsText](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformat#excel-excel-conditionalformat-changeruletocontainstext-member(1))

{288}------------------------------------------------

- [changeRuleToCustom](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformat#excel-excel-conditionalformat-changeruletocustom-member(1))
- [changeRuleToDataBar](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformat#excel-excel-conditionalformat-changeruletodatabar-member(1))
- [changeRuleToIconSet](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformat#excel-excel-conditionalformat-changeruletoiconset-member(1))
- [changeRuleToPresetCriteria](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformat#excel-excel-conditionalformat-changeruletopresetcriteria-member(1))
- [changeRuleToTopBottom](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformat#excel-excel-conditionalformat-changeruletotopbottom-member(1))

The following example shows how to use the changeRuleToPresetCriteria method from the preceding list to change an existing conditional format rule to the preset criteria rule type.

#### 7 **Note**

The specified range must have an existing conditional format rule to use the change methods. If the specified range has no conditional format rule, the change methods don't apply a new rule.

#### JavaScript

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const range = sheet.getRange("B2:M5");

 // Retrieve the first existing `ConditionalFormat` rule on this range. 
 // Note: The specified range must have an existing conditional format
rule.
 const conditionalFormat =
range.conditionalFormats.getItemOrNullObject("0");

 // Change the conditional format rule to preset criteria.
 conditionalFormat.changeRuleToPresetCriteria({
 criterion:
Excel.ConditionalFormatPresetCriterion.oneStdDevAboveAverage, 
 });
 conditionalFormat.preset.format.font.color = "red";

 await context.sync();
});
```
### **Multiple formats and priority**

You can apply multiple conditional formats to a range. If the formats have conflicting elements, such as differing font colors, only one format applies that particular element. Precedence is defined by the ConditionalFormat.priority property. Priority is a number 

{289}------------------------------------------------

(equal to the index in the ConditionalFormatCollection ) and can be set when creating the format. The lower the priority value, the higher the priority of the format is.

The following example shows a conflicting font color choice between the two formats. Negative numbers will get a bold font, but NOT a red font, because priority goes to the format that gives them a blue font.

| Category    |  |  |  |  |  |  |  |  |  |  |                                                                |  |
|-------------|--|--|--|--|--|--|--|--|--|--|----------------------------------------------------------------|--|
| Avg High    |  |  |  |  |  |  |  |  |  |  | 40 38 38 44 45 45 51 51 56 67 72 72 59 79 59 45 41             |  |
| Avg Low     |  |  |  |  |  |  |  |  |  |  | 34                                                             |  |
| Record High |  |  |  |  |  |  |  |  |  |  | 94 94 87 72 66                                                 |  |
| Record Low  |  |  |  |  |  |  |  |  |  |  | 2 -1 -1 2 - 9 - 24 - 28 - 32 - 36 - 39 - 35 - 21 - 12 - 12 - 4 |  |

```
JavaScript
```

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const temperatureDataRange =
sheet.tables.getItem("TemperatureTable").getDataBodyRange();

 // Set low numbers to bold, dark red font and assign priority 1.
 const presetFormat = temperatureDataRange.conditionalFormats
 .add(Excel.ConditionalFormatType.presetCriteria);
 presetFormat.preset.format.font.color = "red";
 presetFormat.preset.format.font.bold = true;
 presetFormat.preset.rule = { criterion:
Excel.ConditionalFormatPresetCriterion.oneStdDevBelowAverage };
 presetFormat.priority = 1;

 // Set negative numbers to blue font with green background and set
priority 0.
 const cellValueFormat = temperatureDataRange.conditionalFormats
 .add(Excel.ConditionalFormatType.cellValue);
 cellValueFormat.cellValue.format.font.color = "blue";
 cellValueFormat.cellValue.format.fill.color = "lightgreen";
 cellValueFormat.cellValue.rule = { formula1: "=0", operator: "LessThan"
};
 cellValueFormat.priority = 0;

 await context.sync();
});
```
#### **Mutually exclusive conditional formats**

The stopIfTrue property of ConditionalFormat prevents lower priority conditional formats from being applied to the range. When a range matching the conditional

{290}------------------------------------------------

format with stopIfTrue === true is applied, no subsequent conditional formats are applied, even if their formatting details are not contradictory.

The following example shows two conditional formats being added to a range. Negative numbers will have a blue font with a light green background, regardless of whether the other format condition is true.

| Category    |  |    |                                                   |  |  |  |  |  |  |  |             |  |
|-------------|--|----|---------------------------------------------------|--|--|--|--|--|--|--|-------------|--|
| Avg High    |  | 40 | 38 44 44 45 45 51 51 56 67 72 72 59 79 59 45 41   |  |  |  |  |  |  |  |             |  |
| Avg Low     |  |    | 34                                                |  |  |  |  |  |  |  |             |  |
| Record High |  |    | 61 61 69 79 883 83 995 997 100 101                |  |  |  |  |  |  |  | 94 87 72 66 |  |
| Record Low  |  |    | 2 -1 2 2 9 9 24 228 32 32 36 39 33 35 21 21 12 44 |  |  |  |  |  |  |  |             |  |

JavaScript

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const temperatureDataRange =
sheet.tables.getItem("TemperatureTable").getDataBodyRange();

 // Set low numbers to bold, dark red font and assign priority 1.
 const presetFormat = temperatureDataRange.conditionalFormats
 .add(Excel.ConditionalFormatType.presetCriteria);
 presetFormat.preset.format.font.color = "red";
 presetFormat.preset.format.font.bold = true;
 presetFormat.preset.rule = { criterion:
Excel.ConditionalFormatPresetCriterion.oneStdDevBelowAverage };
 presetFormat.priority = 1;

 // Set negative numbers to blue font with green background and 
 // set priority 0, but set stopIfTrue to true, so none of the 
 // formatting of the conditional format with the higher priority
 // value will apply, not even the bolding of the font.
 const cellValueFormat = temperatureDataRange.conditionalFormats
 .add(Excel.ConditionalFormatType.cellValue);
 cellValueFormat.cellValue.format.font.color = "blue";
 cellValueFormat.cellValue.format.fill.color = "lightgreen";
 cellValueFormat.cellValue.rule = { formula1: "=0", operator: "LessThan"
};
 cellValueFormat.priority = 0;
 cellValueFormat.stopIfTrue = true;

 await context.sync();
});
```
### **Clear conditional formatting rules**

To remove format properties from a specific conditional format rule, use the [clearFormat](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalrangeformat#excel-excel-conditionalrangeformat-clearformat-member(1)) method of the ConditionalRangeFormat object. The clearFormat method creates a

{291}------------------------------------------------

formatting rule without format settings.

To remove all the conditional formatting rules from a specific range, or an entire worksheet, use the [clearAll](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformatcollection#excel-excel-conditionalformatcollection-clearall-member(1)) method of the ConditionalFormatCollection object.

The following sample shows how to remove all conditional formatting from a worksheet with the clearAll method.

```
JavaScript
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getItem("Sample");
 const range = sheet.getRange();
 range.conditionalFormats.clearAll();
 await context.sync();
});
```
## **See also**

- Excel JavaScript object model in Office Add-ins
- [ConditionalFormat Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.conditionalformat)
- [Add, change, or clear conditional formats](https://support.microsoft.com/office/fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f)
- [Use formulas with conditional formatting](https://support.microsoft.com/office/fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f)

{292}------------------------------------------------

# **Read or write to an unbounded range using the Excel JavaScript API**

Article  05/02/2023

This article describes how to read and write to an unbounded range with the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

An unbounded range address is a range address that specifies either entire columns or entire rows. For example:

- Range addresses comprised of entire columns.
	- C:C
	- A:F
- Range addresses comprised of entire rows.
	- 2:2
	- 1:4

### **Read an unbounded range**

When the API makes a request to retrieve an unbounded range (for example, getRange('C:C') ), the response will contain null values for cell-level properties such as values , text , numberFormat , and formula . Other properties of the range, such as address and cellCount , will contain valid values for the unbounded range.

### **Write to an unbounded range**

You cannot set cell-level properties such as values , numberFormat , and formula on an unbounded range because the input request is too large. For example, the following code example is not valid because it attempts to specify values for an unbounded range. The API returns an error if you attempt to set cell-level properties for an unbounded range.

#### JavaScript

```
// Note: This code sample attempts to specify `values` for an unbounded
range, which is not a valid request. The sample will return an error. 
let range =
context.workbook.worksheets.getActiveWorksheet().getRange('A:B');
range.values = 'Due Date';
```

{293}------------------------------------------------

## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Read or write to a large range using the Excel JavaScript API
- Work with multiple ranges simultaneously in Excel add-ins

{294}------------------------------------------------

# **Read or write to a large range using the Excel JavaScript API**

Article  03/09/2023

This article describes how to handle reading and writing to large ranges with the Excel JavaScript API.

## **Run separate read or write operations for large ranges**

If a range contains a large number of cells, values, number formats, or formulas, it may not be possible to run API operations on that range. The API will always make a best attempt to run the requested operation on a range (i.e., to retrieve or write the specified data), but attempting to perform read or write operations for a large range may result in an API error due to excessive resource utilization. To avoid such errors, we recommend that you run separate read or write operations for smaller subsets of a large range, instead of attempting to run a single read or write operation on a large range.

For details on the system limitations, see the "Excel add-ins" section of Resource limits and performance optimization for Office Add-ins.

### **Conditional formatting of ranges**

Ranges can have formats applied to individual cells based on conditions. For more information about this, see Apply conditional formatting to Excel ranges.

# **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Read or write to an unbounded range using the Excel JavaScript API
- Work with multiple ranges simultaneously in Excel add-ins

{295}------------------------------------------------

# **Find a string within a range using the Excel JavaScript API**

Article  05/02/2023

This article provides a code sample that finds a string within a range using the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

#### 7 **Note**

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, the Excel JavaScript API defines all Excel cells as Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API. A single Range object can also contain multiple contiguous cells. See **Work with cells using the Excel JavaScript API** to learn more.

### **Match a string within a range**

The Range object has a find method to search for a specified string within the range. It returns the range of the first cell with matching text.

The following code sample finds the first cell with a value equal to the string **Food** and logs its address to the console. Note that find throws an ItemNotFound error if the specified string doesn't exist in the range. If you expect that the specified string may not exist in the range, use the findOrNullObject method instead, so your code gracefully handles that scenario.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let table = sheet.tables.getItem("ExpensesTable");
 let searchRange = table.getRange();
 let foundRange = searchRange.find("Food", {
 completeMatch: true, // Match the whole cell value.
 matchCase: false, // Don't match case.
 searchDirection: Excel.SearchDirection.forward // Start search at
the beginning of the range.
 });
 foundRange.load("address");
 await context.sync();
```

{296}------------------------------------------------

```
 console.log(foundRange.address);
});
```
When the find method is called on a range representing a single cell, the entire worksheet is searched. The search begins at that cell and goes in the direction specified by SearchCriteria.searchDirection , wrapping around the ends of the worksheet if needed.

## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Find special cells within a range using the Excel JavaScript API

{297}------------------------------------------------

# **Work with dates using the Excel JavaScript API and the Moment-MSDate plug-in**

Article  05/02/2023

This article provides code samples that show how to work with dates using the Excel JavaScript API and the [Moment-MSDate plug-in](https://www.npmjs.com/package/moment-msdate) . For the complete list of properties and methods that the Range object supports, see the [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

#### 7 **Note**

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, the Excel JavaScript API defines all Excel cells as Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API. A single Range object can also contain multiple contiguous cells. See **Work with cells using the Excel JavaScript API** to learn more.

## **Use the Moment-MSDate plug-in to work with dates**

The [Moment JavaScript library](https://momentjs.com/) provides a convenient way to use dates and timestamps. The [Moment-MSDate plug-in](https://www.npmjs.com/package/moment-msdate) converts the format of moments into one preferable for Excel. This is the same format the [NOW function](https://support.microsoft.com/office/3337fd29-145a-4347-b2e6-20c904739c46) returns.

The following code shows how to set the range at **B4** to a moment's timestamp.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let now = Date.now();
 let nowMoment = moment(now);
 let nowMS = nowMoment.toOADate();
 let dateRange = sheet.getRange("B4");
 dateRange.values = [[nowMS]];
 dateRange.numberFormat = [["[$-409]m/d/yy h:mm AM/PM;@"]];
```

{298}------------------------------------------------

```
 await context.sync();
});
```
The following code sample demonstrates a similar technique to get the date back out of the cell and convert it to a Moment or other format.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let dateRange = sheet.getRange("B4");
 dateRange.load("values");
 await context.sync();
 let nowMS = dateRange.values[0][0];
 // Log the date as a moment.
 let nowMoment = moment.fromOADate(nowMS);
 console.log(`get (moment): ${JSON.stringify(nowMoment)}`);
 // Log the date as a UNIX-style timestamp.
 let now = nowMoment.unix();
 console.log(`get (timestamp): ${now}`);
});
```
Your add-in has to format the ranges to display the dates in a more human-readable form. For example, "[$-409]m/d/yy h:mm AM/PM;@" displays "12/3/18 3:57 PM". For more information about date and time number formats, see "Guidelines for date and time formats" in the [Review guidelines for customizing a number format](https://support.microsoft.com/office/c0a1d1fa-d3f4-4018-96b7-9c9354dd99f5) article.

## **See also**

- Work with cells using the Excel JavaScript API
- Excel JavaScript object model in Office Add-ins
- Work with multiple ranges simultaneously in Excel add-ins

{299}------------------------------------------------

# **Find special cells within a range using the Excel JavaScript API**

Article  05/02/2023

This article provides code samples that find special cells within a range using the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

## **Find ranges with special cells**

The [Range.getSpecialCells](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getspecialcells-member(1)) and [Range.getSpecialCellsOrNullObject](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getspecialcellsornullobject-member(1)) methods find ranges based on the characteristics of their cells and the types of values of their cells. Both of these methods return RangeAreas objects. Here are the signatures of the methods from the TypeScript data types file:

TypeScript

```
getSpecialCells(cellType: Excel.SpecialCellType, cellValueType?:
Excel.SpecialCellValueType): Excel.RangeAreas;
```
TypeScript

JavaScript

```
getSpecialCellsOrNullObject(cellType: Excel.SpecialCellType, cellValueType?:
Excel.SpecialCellValueType): Excel.RangeAreas;
```
The following code sample uses the getSpecialCells method to find all the cells with formulas. About this code, note:

- It limits the part of the sheet that needs to be searched by first calling Worksheet.getUsedRange and calling getSpecialCells for only that range.
- The getSpecialCells method returns a RangeAreas object, so all of the cells with formulas will be colored pink even if they are not all contiguous.

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let usedRange = sheet.getUsedRange();
 let formulaRanges =
usedRange.getSpecialCells(Excel.SpecialCellType.formulas);
 formulaRanges.format.fill.color = "pink";
```

{300}------------------------------------------------

```
 await context.sync();
});
```
If no cells with the targeted characteristic exist in the range, getSpecialCells throws an **ItemNotFound** error. This diverts the flow of control to a catch block, if there is one. If there isn't a catch block, the error halts the method.

If you expect that cells with the targeted characteristic should always exist, you'll likely want your code to throw an error if those cells aren't there. If it's a valid scenario that there aren't any matching cells, your code should check for this possibility and handle it gracefully without throwing an error. You can achieve this behavior with the getSpecialCellsOrNullObject method and its returned isNullObject property. The following code sample uses this pattern. About this code, note:

- The getSpecialCellsOrNullObject method always returns a proxy object, so it's never null in the ordinary JavaScript sense. But if no matching cells are found, the isNullObject property of the object is set to true .
- It calls context.sync *before* it tests the isNullObject property. This is a requirement with all *OrNullObject methods and properties, because you always have to load and sync a property in order to read it. However, it's not necessary to *explicitly* load the isNullObject property. It's automatically loaded by the context.sync even if load is not called on the object. For more information, see *OrNullObject methods and properties.
- You can test this code by first selecting a range that has no formula cells and running it. Then select a range that has at least one cell with a formula and run it again.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let range = context.workbook.getSelectedRange();
 let formulaRanges =
range.getSpecialCellsOrNullObject(Excel.SpecialCellType.formulas);
 await context.sync();

 if (formulaRanges.isNullObject) {
 console.log("No cells have formulas");
 }
 else {
 formulaRanges.format.fill.color = "pink";
 }

 await context.sync();
});
```

{301}------------------------------------------------

For simplicity, all other code samples in this article use the getSpecialCells method instead of getSpecialCellsOrNullObject .

### **Narrow the target cells with cell value types**

The Range.getSpecialCells() and Range.getSpecialCellsOrNullObject() methods accept an optional second parameter used to further narrow down the targeted cells. This second parameter is an Excel.SpecialCellValueType you use to specify that you only want cells that contain certain types of values.

#### 7 **Note**

The Excel.SpecialCellValueType parameter can only be used if the Excel.SpecialCellType is Excel.SpecialCellType.formulas or Excel.SpecialCellType.constants .

#### **Test for a single cell value type**

The Excel.SpecialCellValueType enum has these four basic types (in addition to the other combined values described later in this section):

- Excel.SpecialCellValueType.errors
- Excel.SpecialCellValueType.logical (which means boolean)
- Excel.SpecialCellValueType.numbers
- Excel.SpecialCellValueType.text

The following code sample finds special cells that are numerical constants and colors those cells pink. About this code, note:

- It only highlights cells that have a literal number value. It won't highlight cells that have a formula (even if the result is a number) or a boolean, text, or error state cells.
- To test the code, be sure the worksheet has some cells with literal number values, some with other kinds of literal values, and some with formulas.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let usedRange = sheet.getUsedRange();
 let constantNumberRanges = usedRange.getSpecialCells(
```

{302}------------------------------------------------

```
 Excel.SpecialCellType.constants,
 Excel.SpecialCellValueType.numbers);
 constantNumberRanges.format.fill.color = "pink";
 await context.sync();
});
```
### **Test for multiple cell value types**

Sometimes you need to operate on more than one cell value type, such as all textvalued and all boolean-valued ( Excel.SpecialCellValueType.logical ) cells. The Excel.SpecialCellValueType enum has values with combined types. For example, Excel.SpecialCellValueType.logicalText targets all boolean and all text-valued cells. Excel.SpecialCellValueType.all is the default value, which does not limit the cell value types returned. The following code sample colors all cells with formulas that produce number or boolean value.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let usedRange = sheet.getUsedRange();
 let formulaLogicalNumberRanges = usedRange.getSpecialCells(
 Excel.SpecialCellType.formulas,
 Excel.SpecialCellValueType.logicalNumbers);
 formulaLogicalNumberRanges.format.fill.color = "pink";
 await context.sync();
});
```
## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Find a string using the Excel JavaScript API
- Work with multiple ranges simultaneously in Excel add-ins

{303}------------------------------------------------

# **Cut, copy, and paste ranges using the Excel JavaScript API**

Article  05/30/2024

This article provides code samples that cut, copy, and paste ranges using the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

#### 7 **Note**

The Excel JavaScript API doesn't have a "Cell" object or class. Instead, the Excel JavaScript API defines all Excel cells as Range objects. An individual cell in the Excel UI translates to a Range object with one cell in the Excel JavaScript API. A single Range object can also contain multiple contiguous cells. See **Work with cells using the Excel JavaScript API** to learn more.

#### **Tip**

To experiment with the cut, copy, and paste APIs from this article in a complete sample, open **Script Lab** in Excel and select **[Copy and paste ranges](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/20-data-types/data-types-entity-values.yaml)** in our **Samples** library.

## **Copy and paste**

The [Range.copyFrom](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-copyfrom-member(1)) method replicates the **Copy** and **Paste** actions of the Excel UI. The destination is the Range object that copyFrom is called on. The source to be copied is passed as a range or a string address representing a range.

The following code sample copies the data from **A1:E1** into the range starting at **G1** (which ends up pasting into **G1:K1**).

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 // Copy everything from "A1:E1" into "G1" and the cells afterwards
("G1:K1").
 sheet.getRange("G1").copyFrom("A1:E1");
```

{304}------------------------------------------------

Range.copyFrom has three optional parameters.

### TypeScript copyFrom(sourceRange: Range | RangeAreas | string, copyType?: Excel.RangeCopyType, skipBlanks?: boolean, transpose?: boolean): void;

copyType specifies what data gets copied from the source to the destination.

- Excel.RangeCopyType.formulas transfers the formulas in the source cells and preserves the relative positioning of those formulas' ranges. Any non-formula entries are copied as-is.
- Excel.RangeCopyType.values copies the data values and, in the case of formulas, the result of the formula.
- Excel.RangeCopyType.formats copies the formatting of the range, including font, color, and other format settings, but no values.
- Excel.RangeCopyType.all (the default option) copies both data and formatting, preserving cells' formulas if found.

skipBlanks sets whether blank cells are copied into the destination. When true, copyFrom skips blank cells in the source range. Skipped cells will not overwrite the existing data of their corresponding cells in the destination range. The default is false.

transpose determines whether or not the data is transposed, meaning its rows and columns are switched, into the source location. A transposed range is flipped along the main diagonal, so rows **1**, **2**, and **3** will become columns **A**, **B**, and **C**.

The following code sample and images demonstrate this behavior in a simple scenario.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 // Copy a range, omitting the blank cells so existing data is not
overwritten in those cells.
 sheet.getRange("D1").copyFrom("A1:C1",
 Excel.RangeCopyType.all,
 true, // skipBlanks
 false); // transpose
 // Copy a range, including the blank cells which will overwrite existing
data in the target cells.
 sheet.getRange("D2").copyFrom("A2:C2",
 Excel.RangeCopyType.all,
```

{305}------------------------------------------------

```
 false, // skipBlanks
 false); // transpose
 await context.sync();
});
```
#### **Data before range is copied and pasted**

|   | A | B | C   | D | E |   | G |
|---|---|---|-----|---|---|---|---|
| 4 | 3 |   | 5 x |   | V | Z |   |
| 2 | 3 |   | 5 x |   | V | Z |   |
| 3 |   |   |     |   |   |   |   |

### **Data after range is copied and pasted**

|   |  |  | C | D   | E | E | G |
|---|-----|---|---|-----|---|---|---|
| 1 | 3   |   | 5 | 3 y |   | 5 |   |
| 2 | 3   |   | 5 | 3   |   | 5 |   |
| 3 |     |   |   |     |   |   |   |

## **Cut and paste (move) cells**

The [Range.moveTo](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-moveto-member(1)) method moves cells to a new location in the workbook. This cell movement behavior works the same as when cells are moved by [dragging the range](https://support.microsoft.com/office/803d65eb-6a3e-4534-8c6f-ff12d1c4139e) [border](https://support.microsoft.com/office/803d65eb-6a3e-4534-8c6f-ff12d1c4139e) or when taking the **Cut** and **Paste** actions. Both the formatting and values of the range are moved to the location specified as the destinationRange parameter.

The following code sample moves a range with the Range.moveTo method. Note that if the destination range is smaller than the source, it will be expanded to encompass the source content.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 sheet.getRange("F1").values = [["Moved Range"]];
 // Move the cells "A1:E1" to "G1" (which fills the range "G1:K1").
 sheet.getRange("A1:E1").moveTo("G1");
 await context.sync();
});
```
### **See also**

{306}------------------------------------------------

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Remove duplicates using the Excel JavaScript API
- Work with multiple ranges simultaneously in Excel add-ins

#### 6 **Collaborate with us on GitHub**

The source for this content can be found on GitHub, where you can also create and review issues and pull requests. For more information, see [our](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md) [contributor guide](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md).

#### **Office Add-ins feedback**

Office Add-ins is an open source project. Select a link to provide feedback:

- [Open a documentation issue](https://github.com/OfficeDev/office-js-docs-pr/issues/new?template=3-customer-feedback.yml&pageUrl=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Foffice%2Fdev%2Fadd-ins%2Fexcel%2Fexcel-add-ins-ranges-cut-copy-paste&pageQueryParams=&contentSourceUrl=https%3A%2F%2Fgithub.com%2FOfficeDev%2Foffice-js-docs-pr%2Fblob%2Fmain%2Fdocs%2Fexcel%2Fexcel-add-ins-ranges-cut-copy-paste.md&documentVersionIndependentId=d2733e3d-031d-3676-e3a8-dfaeab4ad6f0&feedback=%0A%0A%5BEnter+feedback+here%5D%0A&author=%40o365devx&metadata=*+ID%3A+9f0ce951-f238-7d76-6c9a-73c0528a52ac+%0A*+Service%3A+**excel**%0A*+Sub-service%3A+**add-ins**)
- [Provide product feedback](https://aka.ms/office-addins-dev-questions)

{307}------------------------------------------------

# **Remove duplicates using the Excel JavaScript API**

Article  05/02/2023

This article provides a code sample that removes duplicate entries in a range using the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

### **Remove rows with duplicate entries**

The [Range.removeDuplicates](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-removeduplicates-member(1)) method removes rows with duplicate entries in the specified columns. The method goes through each row in the range from the lowestvalued index to the highest-valued index in the range (from top to bottom). A row is deleted if a value in its specified column or columns appeared earlier in the range. Rows in the range below the deleted row are shifted up. removeDuplicates does not affect the position of cells outside of the range.

removeDuplicates takes in a number[] representing the column indices which are checked for duplicates. This array is zero-based and relative to the range, not the worksheet. The method also takes in a boolean parameter that specifies whether the first row is a header. When true , the top row is ignored when considering duplicates. The removeDuplicates method returns a RemoveDuplicatesResult object that specifies the number of rows removed and the number of unique rows remaining.

When using a range's removeDuplicates method, keep the following in mind.

- removeDuplicates considers cell values, not function results. If two different functions evaluate to the same result, the cell values are not considered duplicates.
- Empty cells are not ignored by removeDuplicates . The value of an empty cell is treated like any other value. This means empty rows contained within in the range will be included in the RemoveDuplicatesResult .

The following code sample shows the removal of entries with duplicate values in the first column.

JavaScript

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let range = sheet.getRange("B2:D11");
```

{308}------------------------------------------------

```
 let deleteResult = range.removeDuplicates([0],true);
 deleteResult.load();
 await context.sync();
 console.log(deleteResult.removed + " entries with duplicate names
removed.");
 console.log(deleteResult.uniqueRemaining + " entries with unique names
remain in the range.");
});
```
#### **Data before duplicate entries are removed**

| Product Name  Distributor |                               | Order Amount |
|---------------------------|-------------------------------|--------------|
| Onions                    | Contoso Produce               | 3            |
| Potatoes                  | Contoso Produce               |            |
| Red Wine                  | Coho Vineyard                 | 7            |
| Onions                    | Best For You Organics Company | 80           |
| Arugula                   | Best For You Organics Company | 7            |
| Potatoes                  | Contoso Produce               | 12           |
| Red Wine                  | Coho Vineyard                 | 3            |
| Onions                    | Contoso Produce               |            |
| Arugula                   | Best For You Organics Company |              |

#### **Data after duplicate entries are removed**

| Product Name  Distributor |                               | Order Amount |
|---------------------------|-------------------------------|--------------|
| Onions                    | Contoso Produce               | 3            |
| Potatoes                  | Contoso Produce               |            |
| Red Wine                  | Coho Vineyard                 | 7            |
| Arugula                   | Best For You Organics Company | 7            |

## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Cut, copy, and paste ranges using the Excel JavaScript API
- Work with multiple ranges simultaneously in Excel add-ins

{309}------------------------------------------------

# **Group ranges for an outline using the Excel JavaScript API**

Article  05/02/2023

This article provides a code sample that shows how to group ranges for an outline using the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

## **Group rows or columns of a range for an outline**

Rows or columns of a range can be grouped together to create an [outline](https://support.microsoft.com/office/08ce98c4-0063-4d42-8ac7-8278c49e9aff) . These groups can be collapsed and expanded to hide and show the corresponding cells. This makes quick analysis of top-line data easier. Use [Range.group](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-group-member(1)) to make these outline groups.

An outline can have a hierarchy, where smaller groups are nested under larger groups. This allows the outline to be viewed at different levels. Changing the visible outline level can be done programmatically through the [Worksheet.showOutlineLevels](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet#excel-excel-worksheet-showoutlinelevels-member(1)) method. Note that Excel only supports eight levels of outline groups.

The following code sample creates an outline with two levels of groups for both the rows and columns. The subsequent image shows the groupings of that outline. In the code sample, the ranges being grouped do not include the row or column of the outline control (the "Totals" for this example). A group defines what will be collapsed, not the row or column with the control.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 // Group the larger, main level. Note that the outline controls
 // will be on row 10, meaning 4-9 will collapse and expand.
 sheet.getRange("4:9").group(Excel.GroupOption.byRows);
 // Group the smaller, sublevels. Note that the outline controls
 // will be on rows 6 and 9, meaning 4-5 and 7-8 will collapse and
expand.
 sheet.getRange("4:5").group(Excel.GroupOption.byRows);
 sheet.getRange("7:8").group(Excel.GroupOption.byRows);
 // Group the larger, main level. Note that the outline controls
```

{310}------------------------------------------------

```
 // will be on column R, meaning C-Q will collapse and expand.
 sheet.getRange("C:Q").group(Excel.GroupOption.byColumns);
 // Group the smaller, sublevels. Note that the outline controls
 // will be on columns G, L, and R, meaning C-F, H-K, and M-P will
collapse and expand.
 sheet.getRange("C:F").group(Excel.GroupOption.byColumns);
 sheet.getRange("H:K").group(Excel.GroupOption.byColumns);
 sheet.getRange("M:P").group(Excel.GroupOption.byColumns);
 await context.sync();
});
```

|   |   |    |             |                |       |       |                   |             | l             |       |             |       |             | I              |       |             |             |             | l     | l                        |   |
|---|---|----|-------------|----------------|-------|-------|-------------------|-------------|---------------|-------|-------------|-------|-------------|----------------|-------|-------------|-------------|-------------|-------|--------------------------|---|
|   |   |   |             |                |       |       |                   |             |               |       |             |       |             |                |       |             |             |             |       |                          |   |
| 2 | 3 |    | A           | B              | C     | D     | E                 | E           | G             | H     |             |       | K           |                | M     | N           | O           | P           | Q     | R                        |  |
|   |   |    | Fruit Sales |                |       |       |                   |             |               |       |             |       |             |                |       |             |             |             |       |                          |   |
|   |   | 2  |             |                |       |       |                   |             | 2017          |       |             |       |             | 2018           |       |             |             |             | 2019  |                          |   |
|   |   |   | Category    | Type           | Q1    | Q2    | Q3                | Q4          | Year Total Q1 |       | Q2          | Q3    | Q4          | Year Total  Q1 |       | Q2          | Q3          | Q4          |       | Year Total   Grand Total |   |
|   |   |    | Stone Fruit | Peaches        | 500   | 2000  | 5000              | 1500        | 9000          | 600   | 2200        | 5400  | 1300        | 9500           | 300   | 1500        | 4300        | 1200        | 7300  | 17600                    |   |
|   |   | 5  |             | Plums          | 700   | 900   | 1300              | 800         | 3700          | 800   | 1000        | 2000  | 700         | 4500           | 300   | 600         | 1100        | 700         | 2700  | 7100                     |   |
|   |   |   |             | Category Total | 1200  | 2900  | 6300              | 2300        | 12700         | 1400  | 3200        | 7400  | 2000        | 14000          | 600   | 2100        | 5400        | 1900        | 10000 | 24700                    |   |
|   |   |    | Citrus      | Lemons         | 8000  | 3000  | 4500              | 7500        | 23000         | 8900  | 4000        | 3500  | 4500        | 20900          | 6000  | 2500        | 4500        | 9500        | 22500 | 50000                    |   |
|   |   | 8  |             | Limes          | 12000 | 7000  | 8000              | 13000       | 40000         | 16000 | 10000       | 8500  | 12000       | 46500          | 11000 | 5600        | 6500        | 11000       | 34100 | 86100                    |   |
|   |   | 9  |             | Category Total |       |       | 20000 10000 12500 | 20500       | 63000         |       | 24900 14000 |       | 12000 16500 | 67400          | 17000 | 8100        | 11000 20500 |             | 56600 | 136100                   |   |
|   |   | 10 |             | Grand Total    | 21200 | 12900 |                   | 18800 22800 | 75700         | 26300 | 17200       | 19400 | 18500       | 81400          |       | 17600 10200 |             | 16400 22400 | 66600 | 160800                   |   |
|   |   | 11 |             |                |       |       |                   |             |               |       |             |       |             |                |       |             |             |             |       |                          |   |

## **Remove grouping from rows or columns of a range**

To ungroup a row or column group, use the [Range.ungroup](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-ungroup-member(1)) method. This removes the outermost level from the outline. If multiple groups of the same row or column type are at the same level within the specified range, all of those groups are ungrouped.

### **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Work with multiple ranges simultaneously in Excel add-ins

{311}------------------------------------------------

# **Handle dynamic arrays and spilling using the Excel JavaScript API**

Article  05/02/2023

This article provides a code sample that handles dynamic arrays and range spilling using the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Excel.Range class](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range).

## **Dynamic arrays**

Some Excel formulas return [Dynamic arrays](https://support.microsoft.com/office/205c6b06-03ba-4151-89a1-87a7eb36e531) . These fill the values of multiple cells outside of the formula's original cell. This value overflow is referred to as a "spill". Your add-in can find the range used for a spill with the [Range.getSpillingToRange](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getspillingtorange-member(1)) method. There is also a *OrNullObject version, Range.getSpillingToRangeOrNullObject .

The following sample shows a basic formula that copies the contents of a range into a cell, which spills into neighboring cells. The add-in then logs the range that contains the spill.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 // Set G4 to a formula that returns a dynamic array.
 let targetCell = sheet.getRange("G4");
 targetCell.formulas = [["=A4:D4"]];
 // Get the address of the cells that the dynamic array spilled into.
 let spillRange = targetCell.getSpillingToRange();
 spillRange.load("address");
 // Sync and log the spilled-to range.
 await context.sync();
 // This will log the range as "G4:J4".
 console.log(`Copying the table headers spilled into
${spillRange.address}.`);
});
```
## **Range spilling**

{312}------------------------------------------------

Find the cell responsible for spilling into a given cell by using the [Range.getSpillParent](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getspillparent-member(1)) method. Note that getSpillParent only works when the range object is a single cell. Calling getSpillParent on a range with multiple cells will result in an error being thrown (or a null range being returned for Range.getSpillParentOrNullObject ).

## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Work with multiple ranges simultaneously in Excel add-ins

{313}------------------------------------------------

# **Get formula precedents and dependents using the Excel JavaScript API**

Article  06/04/2024

Excel formulas often contain references to other cells in the same worksheet or workbook. These cross-cell references are known as "precedents" and "dependents". A precedent is a cell that provides data to a formula. A dependent is a cell that contains a formula which refers to other cells. To learn more about features in the Excel UI related to precedents and dependents, such as **Trace Precedents** and **Trace Dependents**, see [Display the relationships between formulas and cells](https://support.microsoft.com/office/a59bef2b-3701-46bf-8ff1-d3518771d507) .

A precedent cell may have its own precedent cells. Every precedent cell in this chain of precedents is still a precedent of the original cell. The same relationship exists for dependents. Any cell affected by another cell is a dependent of that cell. A "direct precedent" is the first preceding group of cells in this sequence, similar to the concept of parents in a parent-child relationship. A "direct dependent" is the first dependent group of cells in a sequence, similar to children in a parent-child relationship.

This article provides code samples that retrieve the precedents and dependents of formulas using the Excel JavaScript API. For the complete list of properties and methods that the Range object supports, see [Range Object (JavaScript API for Excel).](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range)

## **Get the precedents of a formula**

Locate a formula's precedent cells with [Range.getPrecedents](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getprecedents-member(1)). Range.getPrecedents returns a WorkbookRangeAreas object. This object contains the addresses of all the precedents in the workbook. It has a separate RangeAreas object for each worksheet containing at least one formula precedent. To learn more about the RangeAreas object, see Work with multiple ranges simultaneously in Excel add-ins.

To locate only the direct precedent cells of a formula, use [Range.getDirectPrecedents](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getdirectprecedents-member(1)). Range.getDirectPrecedents works like Range.getPrecedents and returns a WorkbookRangeAreas object containing the addresses of direct precedents.

The following screenshot shows the result of selecting the **Trace Precedents** button in the Excel UI. This button draws an arrow from precedent cells to the selected cell. The selected cell, **E3**, contains the formula "=C3 * D3", so both **C3** and **D3** are precedent cells. Unlike the Excel UI button, the getPrecedents and getDirectPrecedents methods don't draw arrows.

{314}------------------------------------------------

| E3 |  |   fx =C3 * D3 |   |                    |                                 |
|----|--|-----------------|---|--------------------|---------------------------------|
|    |  | A B             |   | C D -              |                                |
|    |  |                 |   |                    |                                 |
| 2  |  | Product         |   |                    | Qty Unit Price Total Price 2019 |
| 3  |  |                 |   | Almonds 2  7.5  | 15                              |
| 4  |  | Coffee          | 1 | 34.5               | 34.5                            |
|    |  | Chocolate       | 5 |  56              | 47.8                            |

#### ) **Important**

The getPrecedents and getDirectPrecedents methods don't retrieve precedent cells across workbooks.

The following code sample shows how to work with the Range.getPrecedents and Range.getDirectPrecedents methods. The sample gets the precedents for the active range and then changes the background color of those precedent cells. The background color of the direct precedent cells is set to yellow and the background color of the other precedent cells is set to orange.

```
JavaScript
// This code sample shows how to find and highlight the precedents 
// and direct precedents of the currently selected cell.
await Excel.run(async (context) => {
 let range = context.workbook.getActiveCell();
 // Precedents are all cells that provide data to the selected formula.
 let precedents = range.getPrecedents();
 // Direct precedents are the parent cells, or the first preceding group of
cells that provide data to the selected formula. 
 let directPrecedents = range.getDirectPrecedents();
 range.load("address");
 precedents.areas.load("address");
 directPrecedents.areas.load("address");

 await context.sync();
 console.log(`All precedent cells of ${range.address}:`);

 // Use the precedents API to loop through all precedents of the active
cell.
 for (let i = 0; i < precedents.areas.items.length; i++) {
 // Highlight and print out the address of all precedent cells.
```

{315}------------------------------------------------

```
 precedents.areas.items[i].format.fill.color = "Orange";
 console.log(` ${precedents.areas.items[i].address}`);
 }
 console.log(`Direct precedent cells of ${range.address}:`);
 // Use the direct precedents API to loop through direct precedents of the
active cell.
 for (let i = 0; i < directPrecedents.areas.items.length; i++) {
 // Highlight and print out the address of each direct precedent cell.
 directPrecedents.areas.items[i].format.fill.color = "Yellow";
 console.log(` ${directPrecedents.areas.items[i].address}`);
 }
});
```
#### 7 **Note**

The Range.getPrecedents and Range.getDirectPrecedents methods return an ItemNotFound error if no precedent cells are found.

### **Get the dependents of a formula**

Locate a formula's dependent cells with [Range.getDependents.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getdependents-member(1)) Like Range.getPrecedents , Range.getDependents also returns a WorkbookRangeAreas object. This object contains the addresses of all the dependents in the workbook. It has a separate RangeAreas object for each worksheet containing at least one formula dependent. For more information on working with the RangeAreas object, see Work with multiple ranges simultaneously in Excel add-ins.

To locate only the direct dependent cells of a formula, use [Range.getDirectDependents.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getdirectdependents-member(1)) Range.getDirectDependents works like Range.getDependents and returns a WorkbookRangeAreas object containing the addresses of direct dependents.

The following screenshot shows the result of selecting the **Trace Dependents** button in the Excel UI. This button draws an arrow from the selected cell to dependent cells. The selected cell, **D3**, has cell **E3** as a dependent. **E3** contains the formula "=C3 * D3". Unlike the Excel UI button, the getDependents and getDirectDependents methods don't draw arrows.

{316}------------------------------------------------

|   | A | B         | C | D    | E                                   |
|---|---|-----------|---|------|-------------------------------------|
|   |   |           |   |      |                                     |
| 2 |   | Product   |   |      | Qty   Unit Price   Total Price 2019 |
| 3 |   | Almonds   |  | 7-5  |                                  |
| 4 |   | Coffee    | 1 | 34.5 | 34.5                                |
|   |   | Chocolate | 5 | 9.56 | 47.8                                |

#### ) **Important**

The getDependents and getDirectDependents methods don't retrieve dependent cells across workbooks.

The following code sample shows how to work with the Range.getDependents and Range.getDirectDependents methods. The sample gets the dependents for the active range and then changes the background color of those dependent cells. The background color of the direct dependent cells is set to yellow and the background color of the other dependent cells is set to orange.

```
JavaScript
// This code sample shows how to find and highlight the dependents 
// and direct dependents of the currently selected cell.
await Excel.run(async (context) => {
 let range = context.workbook.getActiveCell();
 // Dependents are all cells that contain formulas that refer to other
cells.
 let dependents = range.getDependents(); 
 // Direct dependents are the child cells, or the first succeeding group
of cells in a sequence of cells that refer to other cells.
 let directDependents = range.getDirectDependents();
 range.load("address");
 dependents.areas.load("address"); 
 directDependents.areas.load("address");

 await context.sync();
 console.log(`All dependent cells of ${range.address}:`);

 // Use the dependents API to loop through all dependents of the active
cell.
 for (let i = 0; i < dependents.areas.items.length; i++) {
 // Highlight and print out the addresses of all dependent cells.
 dependents.areas.items[i].format.fill.color = "Orange";
 console.log(` ${dependents.areas.items[i].address}`);
```

{317}------------------------------------------------

```
 }
 console.log(`Direct dependent cells of ${range.address}:`);
 // Use the direct dependents API to loop through direct dependents of
the active cell.
 for (let i = 0; i < directDependents.areas.items.length; i++) {
 // Highlight and print the address of each dependent cell.
 directDependents.areas.items[i].format.fill.color = "Yellow";
 console.log(` ${directDependents.areas.items[i].address}`);
 }
});
```
#### 7 **Note**

The Range.getDependents and Range.getDirectDependents methods return an ItemNotFound error if no dependent cells are found.

### **See also**

- Excel JavaScript object model in Office Add-ins
- Work with cells using the Excel JavaScript API
- Work with multiple ranges simultaneously in Excel add-ins

#### 6 **Collaborate with us on GitHub**

The source for this content can be found on GitHub, where you can also create and review issues and pull requests. For more information, see [our](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md) [contributor guide](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md).

#### **Office Add-ins feedback**

Office Add-ins is an open source project. Select a link to provide feedback:

- [Open a documentation issue](https://github.com/OfficeDev/office-js-docs-pr/issues/new?template=3-customer-feedback.yml&pageUrl=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Foffice%2Fdev%2Fadd-ins%2Fexcel%2Fexcel-add-ins-ranges-precedents-dependents&pageQueryParams=&contentSourceUrl=https%3A%2F%2Fgithub.com%2FOfficeDev%2Foffice-js-docs-pr%2Fblob%2Fmain%2Fdocs%2Fexcel%2Fexcel-add-ins-ranges-precedents-dependents.md&documentVersionIndependentId=26277ce8-3cf6-633c-c394-8b8e61af0d58&feedback=%0A%0A%5BEnter+feedback+here%5D%0A&author=%40o365devx&metadata=*+ID%3A+6262f451-62f7-5813-7da2-20bc010d259b+%0A*+Service%3A+**excel**%0A*+Sub-service%3A+**add-ins**)
- [Provide product feedback](https://aka.ms/office-addins-dev-questions)

{318}------------------------------------------------

# **Delay execution while cell is being edited**

Article  07/21/2022

Excel.run has an overload that takes in a [Excel.RunOptions](https://learn.microsoft.com/en-us/javascript/api/excel/excel.runoptions) object. This contains a set of properties that affect platform behavior when the function runs. The following property is currently supported.

- delayForCellEdit : Determines whether Excel delays the batch request until the user exits cell edit mode. When true , the batch request is delayed and runs when the user exits cell edit mode. When false , the batch request automatically fails if the user is in cell edit mode (causing an error to reach the user). The default behavior with no delayForCellEdit property specified is equivalent to when it is false .
JavaScript

await Excel.run({ delayForCellEdit: true }, async (context) => { ... });

{319}------------------------------------------------

# **Work with multiple ranges simultaneously in Excel add-ins**

Article  03/22/2022

The Excel JavaScript library enables your add-in to perform operations, and set properties, on multiple ranges simultaneously. The ranges do not have to be contiguous. In addition to making your code simpler, this way of setting a property runs much faster than setting the same property individually for each of the ranges.

### **RangeAreas**

A set of (possibly discontiguous) ranges is represented by a [RangeAreas](https://learn.microsoft.com/en-us/javascript/api/excel/excel.rangeareas) object. It has properties and methods similar to the Range type (many with the same, or similar, names), but adjustments have been made to:

- The data types for properties and the behavior of the setters and getters.
- The data types of method parameters and the method behaviors.
- The data types of method return values.

Some examples:

- RangeAreas has an address property that returns a comma-delimited string of range addresses, instead of just one address as with the Range.address property.
- RangeAreas has a dataValidation property that returns a DataValidation object that represents the data validation of all the ranges in the RangeAreas , if it is consistent. The property is null if identical DataValidation objects are not applied to all the all the ranges in the RangeAreas . This is a general, but not universal, principle with the RangeAreas object: *If a property does not have consistent values on all the all the ranges in the RangeAreas , then it is null .* See Read properties of RangeAreas for more information and some exceptions.
- RangeAreas.cellCount gets the total number of cells in all the ranges in the RangeAreas .
- RangeAreas.calculate recalculates the cells of all the ranges in the RangeAreas .
- RangeAreas.getEntireColumn and RangeAreas.getEntireRow return another RangeAreas object that represents all of the columns (or rows) in all the ranges in the RangeAreas . For example, if the RangeAreas represents "A1:C4" and "F14:L15", then RangeAreas.getEntireColumn returns a RangeAreas object that represents "A:C" and "F:L".

{320}------------------------------------------------

- RangeAreas.copyFrom can take either a Range or a RangeAreas parameter representing the source ranges of the copy operation.
### **Complete list of Range members that are also available on RangeAreas**

#### **Properties**

Be familiar with Read properties of RangeAreas before you write code that reads any properties listed. There are subtleties to what gets returned.

- address
- addressLocal
- cellCount
- conditionalFormats
- context
- dataValidation
- format
- isEntireColumn
- isEntireRow
- style
- worksheet

#### **Methods**

- calculate()
- clear()
- convertDataTypeToText()
- convertToLinkedDataType()
- copyFrom()
- getEntireColumn()
- getEntireRow()
- getIntersection()
- getIntersectionOrNullObject()
- getOffsetRange() (named getOffsetRangeAreas on the RangeAreas object)
- getSpecialCells()
- getSpecialCellsOrNullObject()
- getTables()

{321}------------------------------------------------

- getUsedRange() (named getUsedRangeAreas on the RangeAreas object)
- getUsedRangeOrNullObject() (named getUsedRangeAreasOrNullObject on the RangeAreas object)
- load()
- set()
- setDirty()
- toJSON()
- track()
- untrack()

#### **RangeArea-specific properties and methods**

The RangeAreas type has some properties and methods that are not on the Range object. The following is a selection of them.

- areas : A RangeCollection object that contains all of the ranges represented by the RangeAreas object. The RangeCollection object is also new and is similar to other Excel collection objects. It has an items property which is an array of Range objects representing the ranges.
- areaCount : The total number of ranges in the RangeAreas .
- getOffsetRangeAreas : Works just like [Range.getOffsetRange](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getoffsetrange-member(1)), except that a RangeAreas is returned and it contains ranges that are each offset from one of the ranges in the original RangeAreas .

## **Create RangeAreas**

You can create RangeAreas object in two basic ways:

- Call Worksheet.getRanges() and pass it a string with comma-delimited range addresses. If any range you want to include has been made into a [NamedItem](https://learn.microsoft.com/en-us/javascript/api/excel/excel.nameditem), you can include the name, instead of the address, in the string.
- Call Workbook.getSelectedRanges() . This method returns a RangeAreas representing all the ranges that are selected on the currently active worksheet.

Once you have a RangeAreas object, you can create others using the methods on the object that return RangeAreas such as getOffsetRangeAreas and getIntersection .

{322}------------------------------------------------

You cannot directly add additional ranges to a RangeAreas object. For example, the collection in RangeAreas.areas does not have an add method.

#### 2 **Warning**

Do not attempt to directly add or delete members of the the RangeAreas.areas.items array. This will lead to undesirable behavior in your code. For example, it is possible to push an additional Range object onto the array, but doing so will cause errors because RangeAreas properties and methods behave as if the new item isn't there. For example, the areaCount property does not include ranges pushed in this way, and the RangeAreas.getItemAt(index) throws an error if index is larger than areasCount-1 . Similarly, deleting a Range object in the RangeAreas.areas.items array by getting a reference to it and calling its Range.delete method causes bugs: although the Range object *is* deleted, the properties and methods of the parent RangeAreas object behave, or try to, as if it is still in existence. For example, if your code calls RangeAreas.calculate , Office will try to calculate the range, but will error because the range object is gone.

### **Set properties on multiple ranges**

Setting a property on a RangeAreas object sets the corresponding property on all the ranges in the RangeAreas.areas collection.

The following is an example of setting a property on multiple ranges. The function highlights the ranges **F3:F5** and **H3:H5**.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let rangeAreas = sheet.getRanges("F3:F5, H3:H5");
 rangeAreas.format.fill.color = "pink";
 await context.sync();
});
```
This example applies to scenarios in which you can hard code the range addresses that you pass to getRanges or easily calculate them at runtime. Some of the scenarios in which this would be true include:

{323}------------------------------------------------

- The code runs in the context of a known template.
- The code runs in the context of imported data where the schema of the data is known.

## **Get special cells from multiple ranges**

The getSpecialCells and getSpecialCellsOrNullObject methods on the RangeAreas object work analogously to methods of the same name on the Range object. These methods return the cells with the specified characteristic from all of the ranges in the RangeAreas.areas collection. For more details on special cells, see Find special cells within a range.

When calling the getSpecialCells or getSpecialCellsOrNullObject method on a RangeAreas object:

- If you pass Excel.SpecialCellType.sameConditionalFormat as the first parameter, the method returns all cells with the same conditional formatting as the upperleftmost cell in the first range in the RangeAreas.areas collection.
- If you pass Excel.SpecialCellType.sameDataValidation as the first parameter, the method returns all cells with the same data validation rule as the upper-leftmost cell in the first range in the RangeAreas.areas collection.

## **Read properties of RangeAreas**

Reading property values of RangeAreas requires care, because a given property may have different values for different ranges within the RangeAreas . The general rule is that if a consistent value *can* be returned it will be returned. For example, in the following code, the RGB code for pink ( #FFC0CB ) and true will be logged to the console because both the ranges in the RangeAreas object have a pink fill and both are entire columns.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 // The ranges are the F column and the H column.
 let rangeAreas = sheet.getRanges("F:F, H:H"); 
 rangeAreas.format.fill.color = "pink";
 rangeAreas.load("format/fill/color, isEntireColumn");
 await context.sync();
 console.log(rangeAreas.format.fill.color); // #FFC0CB
```

{324}------------------------------------------------

```
 console.log(rangeAreas.isEntireColumn); // true
});
```
Things get more complicated when consistency isn't possible. The behavior of RangeAreas properties follows these three principles:

- A boolean property of a RangeAreas object returns false unless the property is true for all the member ranges.
- Non-boolean properties, with the exception of the address property, return null unless the corresponding property on all the member ranges has the same value.
- The address property returns a comma-delimited string of the addresses of the member ranges.

For example, the following code creates a RangeAreas in which only one range is an entire column and only one is filled with pink. The console will show null for the fill color, false for the isEntireRow property, and "Sheet1!F3:F5, Sheet1!H:H" (assuming the sheet name is "Sheet1") for the address property.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let rangeAreas = sheet.getRanges("F3:F5, H:H");
 let pinkColumnRange = sheet.getRange("H:H");
 pinkColumnRange.format.fill.color = "pink";
 rangeAreas.load("format/fill/color, isEntireColumn, address");
 await context.sync();
 console.log(rangeAreas.format.fill.color); // null
 console.log(rangeAreas.isEntireColumn); // false
 console.log(rangeAreas.address); // "Sheet1!F3:F5, Sheet1!H:H"
});
```
## **See also**

- Fundamental programming concepts with the Excel JavaScript API
- Read or write to a large range using the Excel JavaScript API

{325}------------------------------------------------

The source for this content can be found on GitHub, where you can also create and review issues and pull requests. For more information, see [our](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md) [contributor guide](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md).

Office Add-ins is an open source project. Select a link to provide feedback:

- [Open a documentation issue](https://github.com/OfficeDev/office-js-docs-pr/issues/new?template=3-customer-feedback.yml&pageUrl=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Foffice%2Fdev%2Fadd-ins%2Fexcel%2Fexcel-add-ins-multiple-ranges&pageQueryParams=&contentSourceUrl=https%3A%2F%2Fgithub.com%2FOfficeDev%2Foffice-js-docs-pr%2Fblob%2Fmain%2Fdocs%2Fexcel%2Fexcel-add-ins-multiple-ranges.md&documentVersionIndependentId=dade8e53-60c4-0da1-c8a4-a52bb61fd968&feedback=%0A%0A%5BEnter+feedback+here%5D%0A&author=%40o365devx&metadata=*+ID%3A+ec11ff3f-a9d7-1042-9dd9-b865c14a4980+%0A*+Service%3A+**excel**%0A*+Sub-service%3A+**add-ins**)
- [Provide product feedback](https://aka.ms/office-addins-dev-questions)

{326}------------------------------------------------

# **Work with shapes using the Excel JavaScript API**

Article  04/14/2025

Excel defines shapes as any object that sits on the drawing layer of Excel. That means anything outside of a cell is a shape. This article describes how to use geometric shapes, lines, and images in conjunction with the [Shape](https://learn.microsoft.com/en-us/javascript/api/excel/excel.shape) and [ShapeCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.shapecollection) APIs. [Charts](https://learn.microsoft.com/en-us/javascript/api/excel/excel.chart) are covered in their own article, Work with charts using the Excel JavaScript API.

|   | A                           | B    |  |
|---|-----------------------------|------|--|
| 1 | Average October Temperature | Year |  |
| 2 | 55 degrees                  | 2019 |  |
| 3 | 65 degrees                  | 2018 |  |
|   | 59 degrees                  | 2017 |  |
|   | 57 degrees                  | 2016 |  |

The following image shows shapes which form a thermometer.

### **Create shapes**

Shapes are created through and stored in a worksheet's shape collection ( Worksheet.shapes ). ShapeCollection has several .add* methods for this purpose. All shapes have names and IDs generated for them when they are added to the collection. These are the name and id properties, respectively. name can be set by your add-in for easy retrieval with the ShapeCollection.getItem(name) method.

The following types of shapes are added using the associated method.

| Shape                         | Add Method        | Signature                                                                                                              |
|-------------------------------|-------------------|------------------------------------------------------------------------------------------------------------------------|
| Geometric<br>Shape            | addGeometricShape | addGeometricShape(geometricShapeType:<br>Excel.GeometricShapeType): Excel.Shape                                        |
| Image (either<br>JPEG or PNG) | addImage          | addImage(base64ImageString: string): Excel.Shape                                                                       |
| Line                          | addLine           | addLine(startLeft: number, startTop: number, endLeft: number,<br>endTop: number, connectorType?: Excel.ConnectorType): |

{327}------------------------------------------------

| Shape    | Add Method | Signature                              |  |
|----------|------------|----------------------------------------|--|
|          |            | Excel.Shape                            |  |
| SVG      | addSvg     | addSvg(xml: string): Excel.Shape       |  |
| Text Box | addTextBox | addTextBox(text?: string): Excel.Shape |  |

#### **Geometric shapes**

A geometric shape is created with ShapeCollection.addGeometricShape . That method takes a [GeometricShapeType](https://learn.microsoft.com/en-us/javascript/api/excel/excel.geometricshapetype) enum as an argument.

The following code sample creates a 150x150-pixel rectangle named **"Square"** that is positioned 100 pixels from the top and left sides of the worksheet.

```
JavaScript
// This sample creates a rectangle positioned 100 pixels from the top and left
sides
// of the worksheet and is 150x150 pixels.
await Excel.run(async (context) => {
 let shapes = context.workbook.worksheets.getItem("MyWorksheet").shapes;
 let rectangle = shapes.addGeometricShape(Excel.GeometricShapeType.rectangle);
 rectangle.left = 100;
 rectangle.top = 100;
 rectangle.height = 150;
 rectangle.width = 150;
 rectangle.name = "Square";
 await context.sync();
});
```
### **Images**

JPEG, PNG, and SVG images can be inserted into a worksheet as shapes. The ShapeCollection.addImage method takes a base64-encoded string as an argument. This is either a JPEG or PNG image in string form. ShapeCollection.addSvg also takes in a string, though this argument is XML that defines the graphic.

The following code sample shows an image file being loaded by a [FileReader](https://developer.mozilla.org/docs/Web/API/FileReader) as a string. The string has the metadata "base64," removed before the shape is created.

JavaScript

{328}------------------------------------------------

```
// This sample creates an image as a Shape object in the worksheet.
let myFile = document.getElementById("selectedFile");
let reader = new FileReader();
reader.onload = (event) => {
 Excel.run(function (context) {
 let startIndex = reader.result.toString().indexOf("base64,");
 let myBase64 = reader.result.toString().substr(startIndex + 7);
 let sheet = context.workbook.worksheets.getItem("MyWorksheet");
 let image = sheet.shapes.addImage(myBase64);
 image.name = "Image";
 return context.sync();
 }).catch(errorHandlerFunction);
};
// Read in the image file as a data URL.
reader.readAsDataURL(myFile.files[0]);
```
#### **Lines**

JavaScript

A line is created with ShapeCollection.addLine . That method needs the left and top margins of the line's start and end points. It also takes a [ConnectorType](https://learn.microsoft.com/en-us/javascript/api/excel/excel.connectortype) enum to specify how the line contorts between endpoints. The following code sample creates a straight line on the worksheet.

```
// This sample creates a straight line from [200,50] to [300,150] on the
worksheet.
await Excel.run(async (context) => {
 let shapes = context.workbook.worksheets.getItem("MyWorksheet").shapes;
 let line = shapes.addLine(200, 50, 300, 150, Excel.ConnectorType.straight);
 line.name = "StraightLine";
 await context.sync();
});
```
Lines can be connected to other Shape objects. The connectBeginShape and connectEndShape methods attach the beginning and ending of a line to shapes at the specified connection points. The locations of these points vary by shape, but the Shape.connectionSiteCount can be used to ensure your add-in does not connect to a point that's out-of-bounds. A line is disconnected from any attached shapes using the disconnectBeginShape and disconnectEndShape methods.

The following code sample connects the **"MyLine"** line to two shapes named **"LeftShape"** and **"RightShape"**.

{329}------------------------------------------------

JavaScript

```
// This sample connects a line between two shapes at connection points '0' and
'3'.
await Excel.run(async (context) => {
 let shapes = context.workbook.worksheets.getItem("MyWorksheet").shapes;
 let line = shapes.getItem("MyLine").line;
 line.connectBeginShape(shapes.getItem("LeftShape"), 0);
 line.connectEndShape(shapes.getItem("RightShape"), 3);
 await context.sync();
});
```
## **Move and resize shapes**

Shapes sit on top of the worksheet. Their placement is defined by the left and top property. These act as margins from worksheet's respective edges, with [0, 0] being the upper-left corner. These can either be set directly or adjusted from their current position with the incrementLeft and incrementTop methods. How much a shape is rotated from the default position is also established in this manner, with the rotation property being the absolute amount and the incrementRotation method adjusting the existing rotation.

A shape's depth relative to other shapes is defined by the zorderPosition property. This is set using the setZOrder method, which takes a [ShapeZOrder.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.shapezorder) setZOrder adjusts the ordering of the current shape relative to the other shapes.

Your add-in has a couple options for changing the height and width of shapes. Setting either the height or width property changes the specified dimension without changing the other dimension. The scaleHeight and scaleWidth adjust the shape's respective dimensions relative to either the current or original size (based on the value of the provided [ShapeScaleType)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.shapescaletype). An optional [ShapeScaleFrom](https://learn.microsoft.com/en-us/javascript/api/excel/excel.shapescalefrom) parameter specifies from where the shape scales (top-left corner, middle, or bottom-right corner). If the lockAspectRatio property is true , the scale methods maintain the shape's current aspect ratio by also adjusting the other dimension.

#### 7 **Note**

Direct changes to the height and width properties only affect that property, regardless of the lockAspectRatio property's value.

The following code sample shows a shape being scaled to 1.25 times its original size and rotated 30 degrees.

JavaScript

{330}------------------------------------------------

```
// In this sample, the shape "Octagon" is rotated 30 degrees clockwise
// and scaled 25% larger, with the upper-left corner remaining in place.
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("MyWorksheet");
 let shape = sheet.shapes.getItem("Octagon");
 shape.incrementRotation(30);
 shape.lockAspectRatio = true;
 shape.scaleWidth(
 1.25,
 Excel.ShapeScaleType.currentSize,
 Excel.ShapeScaleFrom.scaleFromTopLeft);
 await context.sync();
});
```
### **Get the active shape**

Get the active shape by using either of the following methods.

- [Workbook.getActiveShape](https://learn.microsoft.com/en-us/javascript/api/excel/excel.workbook)
- [Workbook.getActiveShapeOrNullObject](https://learn.microsoft.com/en-us/javascript/api/excel/excel.workbook)

The following code sample shows how to get the active shape in a workbook and increase its height by 10%.

```
JavaScript
 await Excel.run(async (context) => {
 const shape = context.workbook.getActiveShapeOrNullObject();
 if (shape !== null) {
 shape.load("height");
 await context.sync();
 shape.height = shape.height + shape.height * 0.1;
 await context.sync();
 }
 });
```
## **Text in shapes**

Geometric Shapes can contain text. Shapes have a textFrame property of type [TextFrame](https://learn.microsoft.com/en-us/javascript/api/excel/excel.textframe). The TextFrame object manages the text display options (such as margins and text overflow). TextFrame.textRange is a [TextRange](https://learn.microsoft.com/en-us/javascript/api/excel/excel.textrange) object with the text content and font settings.

{331}------------------------------------------------

The following code sample creates a geometric shape named "Wave" with the text "Shape Text". It also adjusts the shape and text colors, as well as sets the text's horizontal alignment to the center.

```
JavaScript
// This sample creates a light-blue wave shape and adds the purple text "Shape
text" to the center.
await Excel.run(async (context) => {
 let shapes = context.workbook.worksheets.getItem("MyWorksheet").shapes;
 let wave = shapes.addGeometricShape(Excel.GeometricShapeType.wave);
 wave.left = 100;
 wave.top = 400;
 wave.height = 50;
 wave.width = 150;
 wave.name = "Wave";
 wave.fill.setSolidColor("lightblue");
 wave.textFrame.textRange.text = "Shape text";
 wave.textFrame.textRange.font.color = "purple";
 wave.textFrame.horizontalAlignment =
Excel.ShapeTextHorizontalAlignment.center;
 await context.sync();
});
```
The addTextBox method of ShapeCollection creates a GeometricShape of type Rectangle with a white background and black text. This is the same as what is created by Excel's **Text Box** button on the **Insert** tab. addTextBox takes a string argument to set the text of the TextRange .

The following code sample shows the creation of a text box with the text "Hello!".

```
JavaScript
// This sample creates a text box with the text "Hello!" and sizes it
appropriately.
await Excel.run(async (context) => {
 let shapes = context.workbook.worksheets.getItem("MyWorksheet").shapes;
 let textbox = shapes.addTextBox("Hello!");
 textbox.left = 100;
 textbox.top = 100;
 textbox.height = 20;
 textbox.width = 45;
 textbox.name = "Textbox";
 await context.sync();
});
```

{332}------------------------------------------------

## **Shape groups**

Shapes can be grouped together. This allows a user to treat them as a single entity for positioning, sizing, and other related tasks. A [ShapeGroup](https://learn.microsoft.com/en-us/javascript/api/excel/excel.shapegroup) is a type of Shape , so your add-in treats the group as a single shape.

The following code sample shows three shapes being grouped together. The subsequent code sample shows that shape group being moved to the right 50 pixels.

```
JavaScript
// This sample takes three previously-created shapes ("Square", "Pentagon", and
"Octagon")
// and groups them into a single ShapeGroup.
await Excel.run(async (context) => {
 let shapes = context.workbook.worksheets.getItem("MyWorksheet").shapes;
 let square = shapes.getItem("Square");
 let pentagon = shapes.getItem("Pentagon");
 let octagon = shapes.getItem("Octagon");
 let shapeGroup = shapes.addGroup([square, pentagon, octagon]);
 shapeGroup.name = "Group";
 console.log("Shapes grouped");
 await context.sync();
});
// This sample moves the previously created shape group to the right by 50 pixels.
await Excel.run(async (context) => {
 let shapes = context.workbook.worksheets.getItem("MyWorksheet").shapes;
 let shapeGroup = shapes.getItem("Group");
 shapeGroup.incrementLeft(50);
 await context.sync();
});
```
#### ) **Important**

Individual shapes within the group are referenced through the ShapeGroup.shapes property, which is of type **[GroupShapeCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.groupshapecollection)**. They are no longer accessible through the worksheet's shape collection after being grouped. As an example, if your worksheet had three shapes and they were all grouped together, the worksheet's shapes.getCount method would return a count of 1.

## **Export shapes as images**

{333}------------------------------------------------

Any Shape object can be converted to an image. [Shape.getAsImage](https://learn.microsoft.com/en-us/javascript/api/excel/excel.shape#excel-excel-shape-getasimage-member(1)) returns base64-encoded string. The image's format is specified as a [PictureFormat](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pictureformat) enum passed to getAsImage .

```
JavaScript
await Excel.run(async (context) => {
 let shapes = context.workbook.worksheets.getItem("MyWorksheet").shapes;
 let shape = shapes.getItem("Image");
 let stringResult = shape.getAsImage(Excel.PictureFormat.png);
 await context.sync();
 console.log(stringResult.value);
 // Instead of logging, your add-in may use the base64-encoded string to save
the image as a file or insert it in HTML.
});
```
### **Delete shapes**

Shapes are removed from the worksheet with the Shape object's delete method. No other metadata is needed.

The following code sample deletes all the shapes from **MyWorksheet**.

```
JavaScript
// This deletes all the shapes from "MyWorksheet".
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("MyWorksheet");
 let shapes = sheet.shapes;
 // We'll load all the shapes in the collection without loading their
properties.
 shapes.load("items/$none");
 await context.sync();
 shapes.items.forEach(function (shape) {
 shape.delete();
 });

 await context.sync();
});
```
### **See also**

- Fundamental programming concepts with the Excel JavaScript API

{334}------------------------------------------------

- Work with charts using the Excel JavaScript API

{335}------------------------------------------------

# **Work with tables using the Excel JavaScript API**

Article  05/20/2022

This article provides code samples that show how to perform common tasks with tables using the Excel JavaScript API. For the complete list of properties and methods that the Table and TableCollection objects support, see [Table Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.table) and [TableCollection Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.tablecollection).

### **Create a table**

The following code sample creates a table in the worksheet named **Sample**. The table has headers and contains four columns and seven rows of data. If the Excel application where the code is running supports [requirement set](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/excel-api-requirement-sets) **ExcelApi 1.2**, the width of the columns and height of the rows are set to best fit the current data in the table.

7 **Note**

To specify a name for a table, you must first create the table and then set its name property, as shown in the following example.

#### JavaScript

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.add("A1:D1", true /*hasHeaders*/);
 expensesTable.name = "ExpensesTable";
 expensesTable.getHeaderRowRange().values = [["Date", "Merchant",
"Category", "Amount"]];
 expensesTable.rows.add(null /*add rows to the end of the table*/, [
 ["1/1/2017", "The Phone Company", "Communications", "$120"],
 ["1/2/2017", "Northwind Electric Cars", "Transportation", "$142"],
 ["1/5/2017", "Best For You Organics Company", "Groceries", "$27"],
 ["1/10/2017", "Coho Vineyard", "Restaurant", "$33"],
 ["1/11/2017", "Bellows College", "Education", "$350"],
 ["1/15/2017", "Trey Research", "Other", "$135"],
 ["1/15/2017", "Best For You Organics Company", "Groceries", "$97"]
 ]);
 if (Office.context.requirements.isSetSupported("ExcelApi", "1.2")) {
 sheet.getUsedRange().format.autofitColumns();
 sheet.getUsedRange().format.autofitRows();
```

{336}------------------------------------------------

```
 }
 sheet.activate();
 await context.sync();
});
```
#### **New table**

|     | A    |                                                  | C              | D        |
|-----|------|---------------------------------------------------|----------------|----------|
| -   | Date |  Merchant                                        |  Category     | > Amount |
|    |      | 1/1/2017 The Phone Company                        | Communications | $120     |
|    |      | 1/2/2017 Northwind Electric Cars                  | Transportation | $142     |
|  |      | 1/5/2017 Best For You Organics Company Groceries  |                | S27      |
|    |      | 1/10/2017 Coho Vineyard                           | Restaurant     | $33      |
| 6   |      | 1/11/2017 Bellows College                         | Education      | $350     |
| 7   |      | 1/15/2017 Trey Research                           | Other          | $135     |
| og  |      | 1/15/2017 Best For You Organics Company Groceries |                | 597      |

### **Add rows to a table**

The following code sample adds seven new rows to the table named **ExpensesTable** within the worksheet named **Sample**. The index parameter of the [add](https://learn.microsoft.com/en-us/javascript/api/excel/excel.tablerowcollection#excel-excel-tablerowcollection-add-member(1)) method is set to null , which specifies that the rows be added after the existing rows in the table. The alwaysInsert parameter is set to true , which indicates that the new rows be inserted into the table, not below the table. The width of the columns and height of the rows are then set to best fit the current data in the table.

#### 7 **Note**

The index property of a **[TableRow](https://learn.microsoft.com/en-us/javascript/api/excel/excel.tablerow)** object indicates the index number of the row within the rows collection of the table. A TableRow object does not contain an id property that can be used as a unique key to identify the row.

#### JavaScript

```
// This code sample shows how to add rows to a table that already exists 
// on a worksheet named Sample.
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 expensesTable.rows.add(
 null, // index, Adds rows to the end of the table.
```

{337}------------------------------------------------

```
 [
 ["1/16/2017", "THE PHONE COMPANY", "Communications", "$120"],
 ["1/20/2017", "NORTHWIND ELECTRIC CARS", "Transportation",
"$142"],
 ["1/20/2017", "BEST FOR YOU ORGANICS COMPANY", "Groceries",
"$27"],
 ["1/21/2017", "COHO VINEYARD", "Restaurant", "$33"],
 ["1/25/2017", "BELLOWS COLLEGE", "Education", "$350"],
 ["1/28/2017", "TREY RESEARCH", "Other", "$135"],
 ["1/31/2017", "BEST FOR YOU ORGANICS COMPANY", "Groceries",
"$97"]
 ], 
 true, // alwaysInsert, Specifies that the new rows be inserted into
the table.
 );
 sheet.getUsedRange().format.autofitColumns();
 sheet.getUsedRange().format.autofitRows();
 await context.sync();
});
```
#### **Table with new rows**

|    | A    | B                                       | C              | D      |
|----|------|-----------------------------------------|----------------|--------|
| 1  | Date |  Merchant                              |  Category     | Amount |
| 2  |      | 1/1/2017 The Phone Company              | Communications | $120   |
|   |      | 1/2/2017 Northwind Electric Cars        | Transportation | $142   |
| 4  |      | 1/5/2017 Best For You Organics Company  | Groceries      | $27    |
| 5  |      | 1/10/2017 Coho Vineyard                 | Restaurant     | $33    |
| 6  |      | 1/11/2017 Bellows College               | Education      | $350   |
| 7  |      | 1/15/2017 Trey Research                 | Other          | $135   |
| 8  |      | 1/15/2017 Best For You Organics Company | Groceries      | $97    |
| 9  |      | 1/16/2017 THE PHONE COMPANY             | Communications | $120   |
| 10 |      | 1/20/2017 NORTHWIND ELECTRIC CARS       | Transportation | $142   |
| 11 |      | 1/20/2017 BEST FOR YOU ORGANICS COMPANY | Groceries      | $27    |
| 12 |      | 1/21/2017 COHO VINEYARD                 | Restaurant     | 533    |
| 13 |      | 1/25/2017 BELLOWS COLLEGE               | Education      | $350   |
| 14 |      | 1/28/2017 TREY RESEARCH                 | Other          | $135   |
| 15 |      | 1/31/2017 BEST FOR YOU ORGANICS COMPANY | Groceries      | $97    |

## **Add a column to a table**

These examples show how to add a column to a table. The first example populates the new column with static values; the second example populates the new column with formulas.

{338}------------------------------------------------

#### 7 **Note**

The **index** property of a **[TableColumn](https://learn.microsoft.com/en-us/javascript/api/excel/excel.tablecolumn)** object indicates the index number of the column within the columns collection of the table. The **id** property of a **TableColumn** object contains a unique key that identifies the column.

### **Add a column that contains static values**

The following code sample adds a new column to the table named **ExpensesTable** within the worksheet named **Sample**. The new column is added after all existing columns in the table and contains a header ("Day of the Week") as well as data to populate the cells in the column. The width of the columns and height of the rows are then set to best fit the current data in the table.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 expensesTable.columns.add(null /*add columns to the end of the table*/,
[
 ["Day of the Week"],
 ["Saturday"],
 ["Friday"],
 ["Monday"],
 ["Thursday"],
 ["Sunday"],
 ["Saturday"],
 ["Monday"]
 ]);
 sheet.getUsedRange().format.autofitColumns();
 sheet.getUsedRange().format.autofitRows();
 await context.sync();
});
```
**Table with new column**

{339}------------------------------------------------

|    | A |  | B                                                  |  | C              | D | E                        |
|----|---|--|----------------------------------------------------|--|----------------|---|--------------------------|
| 1  |   |  | Date > Merchant                                    |  |  Category     |   | Amount > Day of the Week |
|   |   |  | 1/1/2017 The Phone Company                         |  | Communications |   | $120 Saturday            |
| 3  |   |  | 1/2/2017 Northwind Electric Cars                   |  | Transportation |   | $142 Friday              |
| 4  |   |  | 1/5/2017 Best For You Organics Company   Groceries |  |                |   | $27 Monday               |
| 5  |   |  | 1/10/2017 Coho Vineyard                            |  | Restaurant     |   | $33   Thursday           |
| e  |   |  | 1/11/2017 Bellows College                          |  | Education      |   | $350 Sunday              |
| 7  |   |  | 1/15/2017 Trey Research                            |  | Other          |   | $135  Saturday           |
| 00 |   |  | 1/15/2017 Best For You Organics Company Groceries  |  |                |   | $97 Monday               |
|    |   |  |                                                    |  |                |   |                          |

#### **Add a column that contains formulas**

The following code sample adds a new column to the table named **ExpensesTable** within the worksheet named **Sample**. The new column is added to the end of the table, contains a header ("Type of the Day"), and uses a formula to populate each data cell in the column. The width of the columns and height of the rows are then set to best fit the current data in the table.

JavaScript

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 expensesTable.columns.add(null /*add columns to the end of the table*/,
[
 ["Type of the Day"],
 ['=IF(OR((TEXT([DATE], "dddd") = "Saturday"), (TEXT([DATE], "dddd")
= "Sunday")), "Weekend", "Weekday")'],
 ['=IF(OR((TEXT([DATE], "dddd") = "Saturday"), (TEXT([DATE], "dddd")
= "Sunday")), "Weekend", "Weekday")'],
 ['=IF(OR((TEXT([DATE], "dddd") = "Saturday"), (TEXT([DATE], "dddd")
= "Sunday")), "Weekend", "Weekday")'],
 ['=IF(OR((TEXT([DATE], "dddd") = "Saturday"), (TEXT([DATE], "dddd")
= "Sunday")), "Weekend", "Weekday")'],
 ['=IF(OR((TEXT([DATE], "dddd") = "Saturday"), (TEXT([DATE], "dddd")
= "Sunday")), "Weekend", "Weekday")'],
 ['=IF(OR((TEXT([DATE], "dddd") = "Saturday"), (TEXT([DATE], "dddd")
= "Sunday")), "Weekend", "Weekday")'],
 ['=IF(OR((TEXT([DATE], "dddd") = "Saturday"), (TEXT([DATE], "dddd")
= "Sunday")), "Weekend", "Weekday")']
 ]);
 sheet.getUsedRange().format.autofitColumns();
 sheet.getUsedRange().format.autofitRows();
 await context.sync();
});
```

{340}------------------------------------------------

#### **Table with new calculated column**

|   | A    | B                                                     | C              | D | E                                            |         |
|---|------|-------------------------------------------------------|----------------|---|----------------------------------------------|---------|
|   | Date | > Merchant                                            |  Category     |   | Amount >> Day of the Week >> Type of the Day |         |
|  |      | 1/1/2017 The Phone Company                            | Communications |   | $120 Saturday                                | Weekend |
| 3 |      | 1/2/2017 Northwind Electric Cars                      | Transportation |   | $142   Friday                                | Weekday |
| 4 |      | 1/5/2017 Best For You Organics Company                | Groceries      |   | $27 Monday                                   | Weekday |
| 5 |      | 1/10/2017 Coho Vineyard                               | Restaurant     |   | $33  Thursday                                | Weekday |
| e |      | 1/11/2017 Bellows College                             | Education      |   | $350 Sunday                                  | Weekday |
| 7 |      | 1/15/2017 Trey Research                               | Other          |   | $135 Saturday                                | Weekend |
|   |      | 8   1/15/2017 Best For You Organics Company Groceries |                |   | $97 Monday                                   | Weekend |

## **Resize a table**

Your add-in can resize a table without adding data to the table or changing cell values. To resize a table, use the [Table.resize](https://learn.microsoft.com/en-us/javascript/api/excel/excel.table#excel-excel-table-resize-member(1)) method. The following code sample shows how to resize a table. This code sample uses the **ExpensesTable** from the Create a table section earlier in this article and sets the new range of the table to **A1:D20**.

JavaScript

```
await Excel.run(async (context) => {
 // Retrieve the worksheet and a table on that worksheet.
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 // Resize the table.
 expensesTable.resize("A1:D20");
 await context.sync();
});
```
#### ) **Important**

The new range of the table must overlap with the original range, and the headers (or the top of the table) must be in the same row.

### **Table after resize**

{341}------------------------------------------------

|    | A      | B                                     | C              | D      |
|----|--------|---------------------------------------|----------------|--------|
| 1  | Date  | Merchant                              | Category       | Amount |
| 2  |        | 1/17 The Phone Company                | Communications | $120   |
| 3  |        | 1/2/17 Northwind Electric Cars        | Transportation | $142   |
| 4  |        | 1/5/17 Best For You Organics Company  | Groceries      | $27    |
| 5  |        | 1/10/17 Coho Vineyard                 | Restaurant     | $33    |
| 6  |        | 1/11/17 Bellows College               | Education      | $350   |
| 7  |        | 1/15/17 Trey Research                 | Other          | $135   |
| 8  |        | 1/15/17 Best For You Organics Company | Groceries      | $97    |
| 9  |        |                                       |                |        |
| 10 |        |                                       |                |        |
| 11 |        |                                       |                |        |
| 12 |        |                                       |                |        |
| 13 |        |                                       |                |        |
| 14 |        |                                       |                |        |
| 15 |        |                                       |                |        |
| 16 |        |                                       |                |        |
| 17 |        |                                       |                |        |
| 18 |        |                                       |                |        |
| 19 |        |                                       |                |        |
| 20 |        |                                       |                |        |

## **Update column name**

The following code sample updates the name of the first column in the table to **Purchase date**. The width of the columns and height of the rows are then set to best fit the current data in the table.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 expensesTable.columns.load("items");
 await context.sync();

 expensesTable.columns.items[0].name = "Purchase date";
 sheet.getUsedRange().format.autofitColumns();
 sheet.getUsedRange().format.autofitRows();
```

{342}------------------------------------------------

### **Table with new column name**

|     | A                          | B                                                 | C              | D        |
|-----|----------------------------|---------------------------------------------------|----------------|----------|
|     | i Purchase date   Merchant |                                                   |  Category     |  Amount |
| 2   |                            | 1/1/2017 The Phone Company                        | Communications | $120     |
|    |                            | 1/2/2017 Northwind Electric Cars                  | Transportation | $142     |
|  |                            | 1/5/2017 Best For You Organics Company Groceries  |                | S27      |
|    |                            | 1/10/2017 Coho Vineyard                           | Restaurant     | 533      |
| 6   |                            | 1/11/2017 Bellows College                         | Education      | $350     |
| 7   |                            | 1/15/2017 Trey Research                           | Other          | $135     |
|   |                            | 1/15/2017 Best For You Organics Company Groceries |                | 597      |
|     |                            |                                                   |                |          |

## **Get data from a table**

The following code sample reads data from a table named **ExpensesTable** in the worksheet named **Sample** and then outputs that data below the table in the same worksheet.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 // Get data from the header row.
 let headerRange = expensesTable.getHeaderRowRange().load("values");
 // Get data from the table.
 let bodyRange = expensesTable.getDataBodyRange().load("values");
 // Get data from a single column.
 let columnRange =
expensesTable.columns.getItem("Merchant").getDataBodyRange().load("values");
 // Get data from a single row.
 let rowRange = expensesTable.rows.getItemAt(1).load("values");
 // Sync to populate proxy objects with data from Excel.
 await context.sync();
 let headerValues = headerRange.values;
 let bodyValues = bodyRange.values;
 let merchantColumnValues = columnRange.values;
 let secondRowValues = rowRange.values;
```

{343}------------------------------------------------

```
 // Write data from table back to the sheet
 sheet.getRange("A11:A11").values = [["Results"]];
 sheet.getRange("A13:D13").values = headerValues;
 sheet.getRange("A14:D20").values = bodyValues;
 sheet.getRange("B23:B29").values = merchantColumnValues;
 sheet.getRange("A32:D32").values = secondRowValues;
 // Sync to update the sheet in Excel.
 await context.sync();
});
```
#### **Table and data output**

|    | A       | B                                       | C              | D        |
|----|---------|-----------------------------------------|----------------|----------|
| 1  | Date    |  Merchant                              | Category<br>  | Amount  |
| 2  |         | 1/1/2017 The Phone Company              | Communications | $120     |
| 3  |         | 1/2/2017 Northwind Electric Cars        | Transportation | $142     |
| 4  |         | 1/5/2017 Best For You Organics Company  | Groceries      | $27      |
| 5  |         | 1/10/2017 Coho Vineyard                 | Restaurant     | $33      |
|   |         | 1/11/2017 Bellows College               | Education      | $350     |
| 7  |         | 1/15/2017 Trey Research                 | Other          | $135     |
| 8  |         | 1/15/2017 Best For You Organics Company | Groceries      | $97      |
| 9  |         |                                         |                |          |
| 10 |         |                                         |                |          |
| 11 | Results |                                         |                |          |
| 12 |         |                                         |                |          |
| 13 | Date    | Merchant                                | Category       | Amount   |
| 14 |         | 42736 The Phone Company                 | Communications | 120      |
| 15 |         | 42737 Northwind Electric Cars           | Transportation | 142      |
| 16 |         | 42740 Best For You Organics Company     | Groceries      | 27       |
| 17 |         | 42745 Coho Vineyard                     | Restaurant     | 33       |
| 18 |         | 42746 Bellows College                   | Education      | 350      |
| 19 |         | 42750 Trey Research                     | Other          | 135      |
| 20 |         | 42750 Best For You Organics Company     | Groceries      | 97       |
| 21 |         |                                         |                |          |
| 22 |         |                                         |                |          |
| 23 |         | The Phone Company                       |                |          |
| 24 |         | Northwind Electric Cars                 |                |          |
| 25 |         | Best For You Organics Company           |                |          |
| 26 |         | Coho Vineyard                           |                |          |
| 27 |         | Bellows College                         |                |          |
| 28 |         | Trey Research                           |                |          |
| 29 |         | Best For You Organics Company           |                |          |
| 30 |         |                                         |                |          |
| 31 |         |                                         |                |          |
| 32 |         | 42737 Northwind Electric Cars           | Transportation | 142      |

### **Detect data changes**

{344}------------------------------------------------

Your add-in may need to react to users changing the data in a table. To detect these changes, you can register an event handler for the onChanged event of a table. Event handlers for the onChanged event receive a [TableChangedEventArgs](https://learn.microsoft.com/en-us/javascript/api/excel/excel.tablechangedeventargs) object when the event fires.

The TableChangedEventArgs object provides information about the changes and the source. Since onChanged fires when either the format or value of the data changes, it can be useful to have your add-in check if the values have actually changed. The details property encapsulates this information as a [ChangedEventDetail.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.changedeventdetail) The following code sample shows how to display the before and after values and types of a cell that has been changed.

```
JavaScript
```

```
// This function would be used as an event handler for the Table.onChanged
event.
async function onTableChanged(eventArgs) {
 await Excel.run(async (context) => {
 let details = eventArgs.details;
 let address = eventArgs.address;
 // Print the before and after types and values to the console.
 console.log(`Change at ${address}: was ${details.valueBefore}
(${details.valueTypeBefore}),`
 + ` now is ${details.valueAfter}(${details.valueTypeAfter})`);
 await context.sync();
 });
}
```
### **Sort data in a table**

The following code sample sorts table data in descending order according to the values in the fourth column of the table.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 // Queue a command to sort data by the fourth column of the table
(descending).
 let sortRange = expensesTable.getDataBodyRange();
 sortRange.sort.apply([
 {
 key: 3,
 ascending: false,
```

{345}------------------------------------------------

```
 },
 ]);
 // Sync to run the queued command in Excel.
 await context.sync();
});
```
### **Table data sorted by Amount (descending)**

|    | A    |                                                  | C              | D        |
|----|------|---------------------------------------------------|----------------|----------|
|    | Date |  Merchant                                        |  Category     |  Amount |
|   |      | 1/11/2017 Bellows College                         | Education      | $350     |
|   |      | 1/2/2017   Northwind Electric Cars                | Transportation | $142     |
|   |      | 1/15/2017 Trey Research                           | Other          | $135     |
|   |      | 1/1/2017 The Phone Company                        | Communications | $120     |
| 6  |      | 1/15/2017 Best For You Organics Company Groceries |                | $97      |
| 7  |      | 1/10/2017 Coho Vineyard                           | Restaurant     | $33      |
| og |      | 1/5/2017 Best For You Organics Company Groceries  |                | 577      |

When data is sorted in a worksheet, an event notification fires. To learn more about sortrelated events and how your add-in can register event handlers to respond to such events, see Handle sorting events.

## **Apply filters to a table**

The following code sample applies filters to the **Amount** column and the **Category** column within a table. As a result of the filters, only rows where **Category** is one of the specified values and **Amount** is below the average value for all rows is shown.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 // Queue a command to apply a filter on the Category column.
 let categoryFilter = expensesTable.columns.getItem("Category").filter;
 categoryFilter.apply({
 filterOn: Excel.FilterOn.values,
 values: ["Restaurant", "Groceries"]
 });
 // Queue a command to apply a filter on the Amount column.
 let amountFilter = expensesTable.columns.getItem("Amount").filter;
 amountFilter.apply({
 filterOn: Excel.FilterOn.dynamic,
 dynamicCriteria: Excel.DynamicFilterCriteria.belowAverage
 });
```

{346}------------------------------------------------

```
 // Sync to run the queued commands in Excel.
 await context.sync();
});
```
#### **Table data with filters applied for Category and Amount**

|    | A    |                                                  |            | D        |
|----|------|---------------------------------------------------|------------|----------|
|    | Date | > Merchant                                        |  Category | Amount T |
|    |      | 1/5/2017 Best For You Organics Company Groceries  |            | $27      |
|   |      | 1/10/2017 Coho Vineyard                           | Restaurant |    |
| 00 |      | 1/15/2017 Best For You Organics Company Groceries |            | S97      |

## **Clear table filters**

The following code sample clears any filters currently applied on the table.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 expensesTable.clearFilters();
 await context.sync();
});
```
### **Table data with no filters applied**

|     | A    |                                                  | C              | D        |  |
|-----|------|---------------------------------------------------|----------------|----------|--|
| 1   | Date |  Merchant                                        |  Category     | - Amount |  |
|    |      | 1/1/2017 The Phone Company                        | Communications | $120     |  |
|    |      | 1/2/2017 Northwind Electric Cars                  | Transportation | $142     |  |
|  |      | 1/5/2017 Best For You Organics Company Groceries  |                | S27      |  |
|    |      | 1/10/2017 Coho Vineyard                           | Restaurant     | $33      |  |
| e   |      | 1/11/2017 Bellows College                         | Education      | $350     |  |
| 7   |      | 1/15/2017 Trey Research                           | Other          | $135     |  |
| 00  |      | 1/15/2017 Best For You Organics Company Groceries |                | 597      |  |
|     |      |                                                   |                |          |  |

## **Get the visible range from a filtered table**

The following code sample gets a range that contains data only for cells that are currently visible within the specified table, and then writes the values of that range to 

{347}------------------------------------------------

the console. You can use the getVisibleView() method as shown below to get the visible contents of a table whenever column filters have been applied.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 let visibleRange = expensesTable.getDataBodyRange().getVisibleView();
 visibleRange.load("values");
 await context.sync();
 console.log(visibleRange.values);
});
```
## **AutoFilter**

An add-in can use the table's [AutoFilter](https://learn.microsoft.com/en-us/javascript/api/excel/excel.autofilter) object to filter data. An AutoFilter object is the entire filter structure of a table or range. All of the filter operations discussed earlier in this article are compatible with the auto-filter. The single access point does make it easier to access and manage multiple filters.

The following code sample shows the same data filtering as the earlier code sample, but done entirely through the auto-filter.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 expensesTable.autoFilter.apply(expensesTable.getRange(), 2, {
 filterOn: Excel.FilterOn.values,
 values: ["Restaurant", "Groceries"]
 });
 expensesTable.autoFilter.apply(expensesTable.getRange(), 3, {
 filterOn: Excel.FilterOn.dynamic,
 dynamicCriteria: Excel.DynamicFilterCriteria.belowAverage
 });
 await context.sync();
});
```
An AutoFilter can also be applied to a range at the worksheet level. See Work with worksheets using the Excel JavaScript API for more information.

{348}------------------------------------------------

### **Format a table**

The following code sample applies formatting to a table. It specifies different fill colors for the header row of the table, the body of the table, the second row of the table, and the first column of the table. For information about the properties you can use to specify format, see [RangeFormat Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.rangeformat).

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.getItem("ExpensesTable");
 expensesTable.getHeaderRowRange().format.fill.color = "#C70039";
 expensesTable.getDataBodyRange().format.fill.color = "#DAF7A6";
 expensesTable.rows.getItemAt(1).getRange().format.fill.color =
"#FFC300";
 expensesTable.columns.getItemAt(0).getDataBodyRange().format.fill.color
= "#FFA07A";
 await context.sync();
});
```
### **Table after formatting is applied**

|   | A    |                                                      | C              | D          |
|---|------|-------------------------------------------------------|----------------|------------|
| - | Date |  Merchant                                            |  Category     |  Amount  |
|  |      | 1/1/2017 The Phone Company                            | Communications | $120       |
| 3 |      | 1/2/2017 Northwind Electric Cars                      | Transportation | $142       |
| 4 |      | 1/5/2017 Best For You Organics Company   Groceries    |                | $27        |
|  |      | 1/10/2017 Coho Vineyard                               | Restaurant     | $33        |
|   |      | 6   1/11/2017 Bellows College                         | Education      | $350       |
| 7 |      | 1/15/2017 Trey Research                               | Other          | $135       |
|   |      | 8   1/15/2017 Best For You Organics Company Groceries |                | S97        |

## **Convert a range to a table**

The following code sample creates a range of data and then converts that range to a table. The width of the columns and height of the rows are then set to best fit the current data in the table.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
```

{349}------------------------------------------------

```
 // Define values for the range.
 let values = [["Product", "Qtr1", "Qtr2", "Qtr3", "Qtr4"],
 ["Frames", 5000, 7000, 6544, 4377],
 ["Saddles", 400, 323, 276, 651],
 ["Brake levers", 12000, 8766, 8456, 9812],
 ["Chains", 1550, 1088, 692, 853],
 ["Mirrors", 225, 600, 923, 544],
 ["Spokes", 6005, 7634, 4589, 8765]];
 // Create the range.
 let range = sheet.getRange("A1:E7");
 range.values = values;
 sheet.getUsedRange().format.autofitColumns();
 sheet.getUsedRange().format.autofitRows();
 sheet.activate();
 // Convert the range to a table.
 let expensesTable = sheet.tables.add('A1:E7', true);
 expensesTable.name = "ExpensesTable";
 await context.sync();
});
```
#### **Data in the range (before the range is converted to a table)**

|     | A                                   | B    | C         | D              | E                   |  |
|-----|-------------------------------------|------|-----------|----------------|---------------------|--|
| 1   | Product                             | Qtr1 |           | Qtr2 Qtr3 Qtr4 |                     |  |
| N   | Frames                              |      |           |                | 5000 7000 6544 4377 |  |
| 3   | Saddles                             | 400  | 323       |                | 276 651             |  |
|  | Brake levers   12000 8766 8456 9812 |      |           |                |                     |  |
| 5   | Chains                              |      | 1550 1088 | 692            | 853                 |  |
| 6   | Mirrors                             | 225  | 600       | 923            | 544                 |  |
| 7   | Spokes                              |      |           |                | 6005 7634 4589 8765 |  |
|     |                                     |      |           |                |                     |  |

#### **Data in the table (after the range is converted to a table)**

|    | A                                     | B     | C    | D    | E     |
|----|---------------------------------------|-------|------|------|-------|
| 1  | Product Qtr1 Qtr2 Qtr2 Qtr3 Qtr3 Qtr4 |       |      |      |       |
|   | Frames                                | 5000  | 7000 | 6544 | 4377  |
| 3  | Saddles                               | 400   | 323  | 276  | 651   |
|  | Brake levers                          | 12000 | 8766 | 8456 | 9812  |
|   | Chains                                | 1550  | 1088 | 692  | 853   |
| 6  | Mirrors                               | 225   | 600  | 923  | 544   |
| 7  | Spokes                                | 6005  | 7634 | 4589 | 8765J |
|    |                                       |       |      |      |       |

{350}------------------------------------------------

## **Import JSON data into a table**

The following code sample creates a table in the worksheet named **Sample** and then populates the table by using a JSON object that defines two rows of data. The width of the columns and height of the rows are then set to best fit the current data in the table.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let expensesTable = sheet.tables.add("A1:D1", true /*hasHeaders*/);
 expensesTable.name = "ExpensesTable";
 expensesTable.getHeaderRowRange().values = [["Date", "Merchant",
"Category", "Amount"]];
 let transactions = [
 {
 "DATE": "1/1/2017",
 "MERCHANT": "The Phone Company",
 "CATEGORY": "Communications",
 "AMOUNT": "$120"
 },
 {
 "DATE": "1/1/2017",
 "MERCHANT": "Southridge Video",
 "CATEGORY": "Entertainment",
 "AMOUNT": "$40"
 }
 ];
 let newData = transactions.map(item =>
 [item.DATE, item.MERCHANT, item.CATEGORY, item.AMOUNT]);
 expensesTable.rows.add(null, newData);
 sheet.getUsedRange().format.autofitColumns();
 sheet.getUsedRange().format.autofitRows();
 sheet.activate();
 await context.sync();
});
```
#### **New table**

{351}------------------------------------------------

|  |                                                     | H                             |               | D        |  |
|--|-------------------------------------------------------|-------------------------------|---------------|----------|--|
|  |                                                       | 1 Date > Merchant             |  Category    | Amount  |  |
|  | 2   1/1/2017 The Phone Company Communications<br>$120 |                               |               |          |  |
|  |                                                       | 3   1/1/2017 Southridge Video | Entertainment | $40      |  |
|  |                                                       |                               |               |          |  |

## **See also**

- Excel JavaScript object model in Office Add-ins

{352}------------------------------------------------

# **Undo support with the Excel JavaScript API**

09/09/2025

Excel add-ins support undo behavior. This preserves both actions performed by Excel JavaScript APIs and actions performed by the user in Excel. These actions are saved in the *undo stack* for an individual user, allowing the user to step back through their actions when desired.

# **Undo grouping**

The Excel JavaScript API also supports undo grouping. This allows you to group multiple API calls into a single undoable action for your add-in user. For example, if your add-in needs to make several different updates across multiple worksheets in response to a single user command, you can wrap all those updates in a single group. This is done with the mergeUndoGroup property provided to the Excel.run function.

If an API within the group doesn't offer undo support, the UndoNotSupported error is thrown to let you know that the operation can't be grouped. Your add-in should gracefully handle this error and present a reasonable message to the user.

The following code sample shows how to merge multiple actions with mergeUndoGroup set to true .

#### ) **Important**

Ensure that all grouped API calls support undo to avoid errors. See **Unsupported APIs** for more information.

#### JavaScript

```
await Excel.run({ mergeUndoGroup: true }, async (context) => { 
 const sheet = context.workbook.worksheets.getActiveWorksheet(); 
 let range = sheet.getRange("A1"); 
 range.values = [["123"]]; 

 await context.sync(); 

 range = sheet.getRange("B2"); 
 range.values = [["456"]];
 await context.sync(); 
});
```

{353}------------------------------------------------

## **Unsupported APIs**

Most Excel JavaScript APIs do support undo actions. However, see the following table for a list of APIs that do not support undo behavior.

#### **Tip**

If you call an unsupported API in your add-in, the user's undo stack is cleared starting from that API call, and a user cannot undo actions past that point.

| API                                            | Supported in<br>Excel on the<br>web | Supported in<br>Excel on<br>Windows and<br>Excel on Mac | Notes |
|------------------------------------------------|-------------------------------------|---------------------------------------------------------|-------|
| AllowEditRange.address                         | No                                  | No                                                      | None  |
| AllowEditRange.delete                          | No                                  | No                                                      | None  |
| AllowEditRange.pauseProtection                 | No                                  | No                                                      | None  |
| AllowEditRange.setPassword                     | No                                  | No                                                      | None  |
| AllowEditRange.title                           | No                                  | No                                                      | None  |
| AllowEditRangeCollection.add                   | No                                  | No                                                      | None  |
| AllowEditRangeCollection.pauseProtection       | No                                  | No                                                      | None  |
| Chart.categoryLabelLevel                       | No                                  | No                                                      | None  |
| Chart.seriesNameLevel                          | No                                  | No                                                      | None  |
| ChartPivotOptions.showAxisFieldButtons         | No                                  | Yes                                                     | None  |
| ChartPivotOptions.showLegendFieldButtons       | No                                  | Yes                                                     | None  |
| ChartPivotOptions.showReportFilterFieldButtons | No                                  | Yes                                                     | None  |
| ChartPivotOptions.showValueFieldButtons        | No                                  | Yes                                                     | None  |
| ChartTrendlineLabel.formula                    | No                                  | Yes                                                     | None  |
| DataConnectionCollection.refreshAll            | No                                  | No                                                      | None  |
| DocumentProperties.author                      | No                                  | Yes                                                     | None  |

{354}------------------------------------------------

| API                                  | Supported in<br>Excel on the<br>web | Supported in<br>Excel on<br>Windows and<br>Excel on Mac | Notes                                                                              |
|--------------------------------------|-------------------------------------|---------------------------------------------------------|------------------------------------------------------------------------------------|
| DocumentProperties.category          | No                                  | Yes                                                     | None                                                                               |
| DocumentProperties.comments          | No                                  | Yes                                                     | None                                                                               |
| DocumentProperties.company           | No                                  | Yes                                                     | None                                                                               |
| DocumentProperties.keywords          | No                                  | Yes                                                     | None                                                                               |
| DocumentProperties.manager           | No                                  | Yes                                                     | None                                                                               |
| DocumentProperties.revisionNumber    | No                                  | Yes                                                     | None                                                                               |
| DocumentProperties.subject           | No                                  | Yes                                                     | None                                                                               |
| DocumentProperties.title             | No                                  | Yes                                                     | None                                                                               |
| LinkedWorkbook.refresh               | No                                  | No                                                      | None                                                                               |
| LinkedWorkbookCollection.refreshAll  | No                                  | No                                                      | None                                                                               |
| NamedItem.comment                    | No                                  | Yes                                                     | None                                                                               |
| PivotTableStyle.delete               | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on<br>Windows and<br>Mac. |
| PivotTableStyle.duplicate            | No                                  | Yes                                                     | None                                                                               |
| PivotTableStyle.name                 | No                                  | Yes                                                     | None                                                                               |
| PivotTableStyleCollection.add        | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on<br>Windows and<br>Mac. |
| PivotTableStyleCollection.setDefault | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on<br>Windows and<br>Mac. |

{355}------------------------------------------------

| API                              | Supported in<br>Excel on the<br>web | Supported in<br>Excel on<br>Windows and<br>Excel on Mac | Notes                                                                               |
|----------------------------------|-------------------------------------|---------------------------------------------------------|-------------------------------------------------------------------------------------|
| Query.delete                     | No                                  | Yes                                                     | API supports<br>undo in Excel on<br>Windows and<br>Mac but doesn't<br>support redo. |
| Query.refresh                    | No                                  | Yes                                                     | API supports<br>undo Excel on<br>Windows and<br>Mac but doesn't<br>support redo.    |
| QueryCollection.refreshAll       | No                                  | Yes                                                     | API supports<br>undo Excel on<br>Windows and<br>Mac but doesn't<br>support redo.    |
| Slicer.name                      | No                                  | Yes                                                     | None                                                                                |
| Slicer.nameInFormula             | No                                  | Yes                                                     | None                                                                                |
| SlicerStyle.delete               | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on<br>Windows and<br>Mac.  |
| SlicerStyle.duplicate            | No                                  | Yes                                                     | None                                                                                |
| SlicerStyle.name                 | No                                  | Yes                                                     | None                                                                                |
| SlicerStyleCollection.add        | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on<br>Windows and<br>Mac.  |
| SlicerStyleCollection.setDefault | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on                         |

{356}------------------------------------------------

| API                       | Supported in<br>Excel on the<br>web | Supported in<br>Excel on<br>Windows and<br>Excel on Mac | Notes                                                       |
|---------------------------|-------------------------------------|---------------------------------------------------------|-------------------------------------------------------------|
|                           |                                     |                                                         | Windows and<br>Mac.                                         |
| Style.addIndent           | No                                  | Yes                                                     | None                                                        |
| Style.autoIndent          | No                                  | Yes                                                     | None                                                        |
| Style.formulaHidden       | No                                  | Yes                                                     | None                                                        |
| Style.horizontalAlignment | No                                  | Yes                                                     | None                                                        |
| Style.includeAlignment    | No                                  | Yes                                                     | None                                                        |
| Style.includeBorder       | No                                  | Yes                                                     | None                                                        |
| Style.includeFont         | No                                  | Yes                                                     | None                                                        |
| Style.includeNumber       | No                                  | Yes                                                     | None                                                        |
| Style.includePatterns     | No                                  | Yes                                                     | None                                                        |
| Style.includeProtection   | No                                  | Yes                                                     | None                                                        |
| Style.indentLevel         | No                                  | Yes                                                     | None                                                        |
| Style.locked              | No                                  | Yes                                                     | None                                                        |
| Style.numberFormat        | No                                  | Yes                                                     | None                                                        |
| Style.numberFormatLocal   | No                                  | Yes                                                     | None                                                        |
| Style.orientation         | No                                  | Yes                                                     | None                                                        |
| Style.readingOrder        | No                                  | Yes                                                     | None                                                        |
| Style.shrinkToFit         | No                                  | Yes                                                     | None                                                        |
| Style.textOrientation     | No                                  | Yes                                                     | None                                                        |
| Style.verticalAlignment   | No                                  | Yes                                                     | None                                                        |
| Style.wrapText            | No                                  | Yes                                                     | None                                                        |
| TableStyle.delete         | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on |

{357}------------------------------------------------

| API                                | Supported in<br>Excel on the<br>web | Supported in<br>Excel on<br>Windows and<br>Excel on Mac | Notes                                                                              |
|------------------------------------|-------------------------------------|---------------------------------------------------------|------------------------------------------------------------------------------------|
|                                    |                                     |                                                         | Windows and<br>Mac.                                                                |
| TableStyle.duplicate               | No                                  | Yes                                                     | None                                                                               |
| TableStyle.name                    | No                                  | Yes                                                     | None                                                                               |
| TableStyleCollection.add           | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on<br>Windows and<br>Mac. |
| TableStyleCollection.setDefault    | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on<br>Windows and<br>Mac. |
| TimelineStyle.delete               | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on<br>Windows and<br>Mac. |
| TimelineStyle.duplicate            | No                                  | Yes                                                     | None                                                                               |
| TimelineStyle.name                 | No                                  | Yes                                                     | None                                                                               |
| TimelineStyleCollection.add        | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on<br>Windows and<br>Mac. |
| TimelineStyleCollection.setDefault | No                                  | Yes                                                     | API does not<br>support co<br>authoring undo<br>in Excel on<br>Windows and<br>Mac. |

{358}------------------------------------------------

| API                                  | Supported in<br>Excel on the<br>web | Supported in<br>Excel on<br>Windows and<br>Excel on Mac | Notes |
|--------------------------------------|-------------------------------------|---------------------------------------------------------|-------|
| Workbook.close                       | No                                  | No                                                      | None  |
| Workbook.insertWorksheetsFromBase64  | No                                  | No                                                      | None  |
| Workbook.save                        | No                                  | No                                                      | None  |
| WorkbookProtection.protect           | No                                  | No                                                      | None  |
| WorkbookProtection.unprotect         | No                                  | No                                                      | None  |
| Worksheet.copy                       | No                                  | No                                                      | None  |
| Worksheet.delete                     | No                                  | No                                                      | None  |
| Worksheet.name                       | Yes                                 | No                                                      | None  |
| Worksheet.standardWidth              | No                                  | Yes                                                     | None  |
| Worksheet.position                   | Yes                                 | No                                                      | None  |
| Worksheet.visibility                 | Yes                                 | No                                                      | None  |
| WorksheetCollection.addFromBase64    | No                                  | No                                                      | None  |
| WorksheetProtection.pauseProtection  | No                                  | No                                                      | None  |
| WorksheetProtection.protect          | No                                  | No                                                      | None  |
| WorksheetProtection.resumeProtection | No                                  | No                                                      | None  |
| WorksheetProtection.setPassword      | No                                  | No                                                      | None  |
| WorksheetProtection.unprotect        | No                                  | No                                                      | None  |
| WorksheetProtection.updateOptions    | No                                  | No                                                      | None  |

## **See also**

- Excel JavaScript object model in Office Add-ins

{359}------------------------------------------------

# **Work with workbooks using the Excel JavaScript API**

Article  03/26/2024

This article provides code samples that show how to perform common tasks with workbooks using the Excel JavaScript API. For the complete list of properties and methods that the Workbook object supports, see [Workbook Object (JavaScript API for](https://learn.microsoft.com/en-us/javascript/api/excel/excel.workbook) [Excel).](https://learn.microsoft.com/en-us/javascript/api/excel/excel.workbook) This article also covers workbook-level actions performed through the [Application](https://learn.microsoft.com/en-us/javascript/api/excel/excel.application) object.

The Workbook object is the entry point for your add-in to interact with Excel. It maintains collections of worksheets, tables, PivotTables, and more, through which Excel data is accessed and changed. The [WorksheetCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetcollection) object gives your add-in access to all the workbook's data through individual worksheets. Specifically, it lets your add-in add worksheets, navigate among them, and assign handlers to worksheet events. The article Work with worksheets using the Excel JavaScript API describes how to access and edit worksheets.

### **Get the active cell or selected range**

The Workbook object contains two methods that get a range of cells the user or add-in has selected: getActiveCell() and getSelectedRange() . getActiveCell() gets the active cell from the workbook as a [Range object.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range) The following example shows a call to getActiveCell() , followed by the cell's address being printed to the console.

```
JavaScript
await Excel.run(async (context) => {
 let activeCell = context.workbook.getActiveCell();
 activeCell.load("address");
 await context.sync();
 console.log("The active cell is " + activeCell.address);
});
```
The getSelectedRange() method returns the currently selected single range. If multiple ranges are selected, an InvalidSelection error is thrown. The following example shows a call to getSelectedRange() that then sets the range's fill color to yellow.

JavaScript

{360}------------------------------------------------

```
await Excel.run(async (context) => {
 let range = context.workbook.getSelectedRange();
 range.format.fill.color = "yellow";
 await context.sync();
});
```
### **Create a workbook**

Your add-in can create a new workbook, separate from the Excel instance in which the add-in is currently running. The Excel object has the createWorkbook method for this purpose. When this method is called, the new workbook is immediately opened and displayed in a new instance of Excel. Your add-in remains open and running with the previous workbook.

JavaScript

Excel.createWorkbook();

The createWorkbook method can also create a copy of an existing workbook. The method accepts a base64-encoded string representation of an .xlsx file as an optional parameter. The resulting workbook will be a copy of that file, assuming the string argument is a valid .xlsx file.

You can get your add-in's current workbook as a base64-encoded string by using [file](https://learn.microsoft.com/en-us/javascript/api/office/office.document#office-office-document-getfileasync-member(1)) [slicing](https://learn.microsoft.com/en-us/javascript/api/office/office.document#office-office-document-getfileasync-member(1)). The [FileReader](https://developer.mozilla.org/docs/Web/API/FileReader) class can be used to convert a file into the required base64 encoded string, as demonstrated in the following example.

```
JavaScript
// Retrieve the external workbook file and set up a `FileReader` object. 
let myFile = document.getElementById("file");
let reader = new FileReader();
reader.onload = (function (event) {
 Excel.run(function (context) {
 // Remove the metadata before the base64-encoded string.
 let startIndex = reader.result.toString().indexOf("base64,");
 let externalWorkbook = reader.result.toString().substr(startIndex + 
7);
 Excel.createWorkbook(externalWorkbook);
 return context.sync();
 });
});
```

{361}------------------------------------------------

### **Insert a copy of an existing workbook into the current one**

The previous example shows a new workbook being created from an existing workbook. You can also copy some or all of an existing workbook into the one currently associated with your add-in. A [Workbook](https://learn.microsoft.com/en-us/javascript/api/excel/excel.workbook) has the insertWorksheetsFromBase64 method to insert copies of the target workbook's worksheets into itself. The other workbook's file is passed as a base64-encoded string, just like the Excel.createWorkbook call.

#### TypeScript

```
insertWorksheetsFromBase64(base64File: string, options?:
Excel.InsertWorksheetOptions): OfficeExtension.ClientResult<string[]>;
```
#### ) **Important**

The insertWorksheetsFromBase64 method is supported for Excel on the web, on Windows, and on Mac. It's not supported for iOS. Additionally, in Excel on the web, this method doesn't support source worksheets with PivotTable, Chart, Comment, or Slicer elements. If those objects are present, the insertWorksheetsFromBase64 method returns the UnsupportedFeature error in Excel on the web.

The following code sample shows how to insert worksheets from another workbook into the current workbook. This code sample first processes a workbook file with a [FileReader](https://developer.mozilla.org/docs/Web/API/FileReader) object and extracts a base64-encoded string, and then it inserts this base64-encoded string into the current workbook. The new worksheets are inserted after the worksheet named **Sheet1**. Note that [] is passed as the parameter for the [InsertWorksheetOptions.sheetNamesToInsert](https://learn.microsoft.com/en-us/javascript/api/excel/excel.insertworksheetoptions#excel-excel-insertworksheetoptions-sheetnamestoinsert-member) property. This means that all the worksheets from the target workbook are inserted into the current workbook.

#### JavaScript

```
// Retrieve the external workbook file and set up a `FileReader` object. 
let myFile = document.getElementById("file");
let reader = new FileReader();
reader.onload = (event) => {
 Excel.run((context) => {
 // Remove the metadata before the base64-encoded string.
```

{362}------------------------------------------------

```
 let startIndex = reader.result.toString().indexOf("base64,");
 let externalWorkbook = reader.result.toString().substr(startIndex + 
7);

 // Retrieve the current workbook.
 let workbook = context.workbook;

 // Set up the insert options. 
 let options = { 
 sheetNamesToInsert: [], // Insert all the worksheets from the
source workbook.
 positionType: Excel.WorksheetPositionType.after, // Insert after
the `relativeTo` sheet.
 relativeTo: "Sheet1" // The sheet relative to which the other
worksheets will be inserted. Used with `positionType`.
 }; 

 // Insert the new worksheets into the current workbook.
 workbook.insertWorksheetsFromBase64(externalWorkbook, options);
 return context.sync();
 });
};
// Read the file as a data URL so we can parse the base64-encoded string.
reader.readAsDataURL(myFile.files[0]);
```
### **Protect the workbook's structure**

Your add-in can control a user's ability to edit the workbook's structure. The Workbook object's protection property is a [WorkbookProtection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.workbookprotection) object with a protect() method. The following example shows a basic scenario toggling the protection of the workbook's structure.

```
JavaScript
```

```
await Excel.run(async (context) => {
 let workbook = context.workbook;
 workbook.load("protection/protected");
 await context.sync();
 if (!workbook.protection.protected) {
 workbook.protection.protect();
 }
});
```
The protect method accepts an optional string parameter. This string represents the password needed for a user to bypass protection and change the workbook's structure. 

{363}------------------------------------------------

Protection can also be set at the worksheet level to prevent unwanted data editing. For more information, see the **Data protection** section of the Work with worksheets using the Excel JavaScript API article.

#### 7 **Note**

For more information about workbook protection in Excel, see the **[Protect a](https://support.microsoft.com/office/7e365a4d-3e89-4616-84ca-1931257c1517) [workbook](https://support.microsoft.com/office/7e365a4d-3e89-4616-84ca-1931257c1517)** article.

### **Access document properties**

Workbook objects have access to the Office file metadata, which is known as the [document properties](https://support.microsoft.com/office/21d604c2-481e-4379-8e54-1dd4622c6b75) . The Workbook object's properties property is a [DocumentProperties](https://learn.microsoft.com/en-us/javascript/api/excel/excel.documentproperties) object that contains some of these metadata values. The following example shows how to set the author property.

```
JavaScript
await Excel.run(async (context) => {
 let docProperties = context.workbook.properties;
 docProperties.author = "Alex";
 await context.sync();
});
```
You can also define custom properties. The DocumentProperties object contains a custom property that represents a collection of key-value pairs for user-defined properties. For an example of setting custom properties, see the **Custom XML data in Excel and Word** section of the Persist add-in state and settings article.

### **Access document settings**

A workbook's settings are similar to the collection of custom properties. The difference is settings are unique to a single Excel file and add-in pairing, whereas properties are solely connected to the file. The following example shows how to create and access a setting.

JavaScript

```
await Excel.run(async (context) => {
 let settings = context.workbook.settings;
 settings.add("NeedsReview", true);
 let needsReview = settings.getItem("NeedsReview");
```

{364}------------------------------------------------

```
 needsReview.load("value");
 await context.sync();
 console.log("Workbook needs review : " + needsReview.value);
});
```
### **Access application culture settings**

A workbook has language and culture settings that affect how certain data is displayed. These settings can help localize data when your add-in's users are sharing workbooks across different languages and cultures. Your add-in can use string parsing to localize the format of numbers, dates, and times based on the system culture settings so that each user sees data in their own culture's format.

Application.cultureInfo defines the system culture settings as a [CultureInfo](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cultureinfo) object. This contains settings like the numerical decimal separator or the date format.

Some culture settings can be [changed through the Excel UI](https://support.microsoft.com/office/c093b545-71cb-4903-b205-aebb9837bd1e) . The system settings are preserved in the CultureInfo object. Any local changes are kept as [Application-](https://learn.microsoft.com/en-us/javascript/api/excel/excel.application)level properties, such as Application.decimalSeparator .

The following sample changes the decimal separator character of a numerical string from a ',' to the character used by the system settings.

```
JavaScript
// This will convert a number like "14,37" to "14.37"
// (assuming the system decimal separator is ".").
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let decimalSource = sheet.getRange("B2");
 decimalSource.load("values");

context.application.cultureInfo.numberFormat.load("numberDecimalSeparator");
 await context.sync();
 let systemDecimalSeparator =
 context.application.cultureInfo.numberFormat.numberDecimalSeparator;
 let oldDecimalString = decimalSource.values[0][0];
 // This assumes the input column is standardized to use "," as the
decimal separator.
 let newDecimalString = oldDecimalString.replace(",",
systemDecimalSeparator);
 let resultRange = sheet.getRange("C2");
 resultRange.values = [[newDecimalString]];
```

{365}------------------------------------------------

```
 resultRange.format.autofitColumns();
 await context.sync();
});
```
## **Control calculation behavior**

### **Set calculation mode**

By default, Excel recalculates formula results whenever a referenced cell is changed. Your add-in's performance may benefit from adjusting this calculation behavior. The Application object has a calculationMode property of type CalculationMode . It can be set to the following values.

- automatic : The default recalculation behavior where Excel calculates new formula results every time the relevant data is changed.
- automaticExceptTables : Same as automatic , except any changes made to values in tables are ignored.
- manual : Calculations only occur when the user or add-in requests them.

### **Set calculation type**

The [Application](https://learn.microsoft.com/en-us/javascript/api/excel/excel.application) object provides a method to force an immediate recalculation. Application.calculate(calculationType) starts a manual recalculation based on the specified calculationType . The following values can be specified.

- full : Recalculate all formulas in all open workbooks, regardless of whether they have changed since the last recalculation.
- fullRebuild : Check dependent formulas, and then recalculate all formulas in all open workbooks, regardless of whether they have changed since the last recalculation.
- recalculate : Recalculate formulas that have changed (or been programmatically marked for recalculation) since the last calculation, and formulas dependent on them, in all active workbooks.

#### 7 **Note**

For more information about recalculation, see the **[Change formula recalculation,](https://support.microsoft.com/office/73fc7dac-91cf-4d36-86e8-67124f6bcce4) [iteration, or precision](https://support.microsoft.com/office/73fc7dac-91cf-4d36-86e8-67124f6bcce4)** article.

{366}------------------------------------------------

### **Temporarily suspend calculations**

The Excel API also lets add-ins turn off calculations until RequestContext.sync() is called. This is done with suspendApiCalculationUntilNextSync() . Use this method when your add-in is editing large ranges without needing to access the data between edits.

JavaScript

context.application.suspendApiCalculationUntilNextSync();

## **Detect workbook activation**

Your add-in can detect when a workbook is activated. A workbook becomes *inactive* when the user switches focus to another workbook, to another application, or (in Excel on the web) to another tab of the web browser. A workbook is *activated* when the user returns focus to the workbook. The workbook activation can trigger callback functions in your add-in, such as refreshing workbook data.

To detect when a workbook is activated, register an event handler for the [onActivated](https://learn.microsoft.com/en-us/javascript/api/excel/excel.workbook#excel-excel-workbook-onactivated-member) event of a workbook. Event handlers for the onActivated event receive a [WorkbookActivatedEventArgs](https://learn.microsoft.com/en-us/javascript/api/excel/excel.workbookactivatedeventargs) object when the event fires.

#### ) **Important**

The onActivated event doesn't detect when a workbook is opened. This event only detects when a user switches focus back to an already open workbook.

The following code sample shows how to register the onActivated event handler and set up a callback function.

```
JavaScript
async function run() {
 await Excel.run(async (context) => {
 // Retrieve the workbook.
 let workbook = context.workbook;

 // Register the workbook activated event handler.
 workbook.onActivated.add(workbookActivated);
 await context.sync();
 });
}
async function workbookActivated(event) {
```

{367}------------------------------------------------

```
 await Excel.run(async (context) => {
 // Retrieve the workbook and load the name.
 let workbook = context.workbook;
 workbook.load("name"); 
 await context.sync();
 // Callback function for when the workbook is activated.
 console.log(`The workbook ${workbook.name} was activated.`);
 });
}
```
### **Save the workbook**

Workbook.save saves the workbook to persistent storage. The save method takes a single, optional saveBehavior parameter that can be one of the following values.

- Excel.SaveBehavior.save (default): The file is saved without prompting the user to specify file name and save location. If the file has not been saved previously, it's saved to the default location. If the file has been saved previously, it's saved to the same location.
- Excel.SaveBehavior.prompt : If file has not been saved previously, the user will be prompted to specify file name and save location. If the file has been saved previously, it will be saved to the same location and the user will not be prompted.

#### U **Caution**

If the user is prompted to save and cancels the operation, save throws an exception.

#### JavaScript

```
context.workbook.save(Excel.SaveBehavior.prompt);
```
## **Close the workbook**

Workbook.close closes the workbook, along with add-ins that are associated with the workbook (the Excel application remains open). The close method takes a single, optional closeBehavior parameter that can be one of the following values.

- Excel.CloseBehavior.save (default): The file is saved before closing. If the file has not been saved previously, the user will be prompted to specify file name and save

{368}------------------------------------------------

location.

- Excel.CloseBehavior.skipSave : The file is immediately closed, without saving. Any unsaved changes will be lost.
JavaScript

context.workbook.close(Excel.CloseBehavior.save);

## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with worksheets using the Excel JavaScript API

#### 6 **Collaborate with us on GitHub**

The source for this content can be found on GitHub, where you can also create and review issues and pull requests. For more information, see [our](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md) [contributor guide](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md).

#### **Office Add-ins feedback**

Office Add-ins is an open source project. Select a link to provide feedback:

[Open a documentation issue](https://github.com/OfficeDev/office-js-docs-pr/issues/new?template=3-customer-feedback.yml&pageUrl=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Foffice%2Fdev%2Fadd-ins%2Fexcel%2Fexcel-add-ins-workbooks&pageQueryParams=&contentSourceUrl=https%3A%2F%2Fgithub.com%2FOfficeDev%2Foffice-js-docs-pr%2Fblob%2Fmain%2Fdocs%2Fexcel%2Fexcel-add-ins-workbooks.md&documentVersionIndependentId=3f147de9-0138-9104-f462-c6f4097b1167&feedback=%0A%0A%5BEnter+feedback+here%5D%0A&author=%40o365devx&metadata=*+ID%3A+c6b16473-fffd-9ebf-ee91-2f0012a496ee+%0A*+Service%3A+**excel**%0A*+Sub-service%3A+**add-ins**)

[Provide product feedback](https://aka.ms/office-addins-dev-questions)

{369}------------------------------------------------

# **Work with worksheets using the Excel JavaScript API**

Article  04/23/2025

This article provides code samples that show how to perform common tasks with worksheets using the Excel JavaScript API. For the complete list of properties and methods that the Worksheet and WorksheetCollection objects support, see [Worksheet Object (JavaScript API for](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet) [Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet) and [WorksheetCollection Object (JavaScript API for Excel)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetcollection).

#### 7 **Note**

The information in this article applies only to regular worksheets; it does not apply to "chart" sheets or "macro" sheets.

## **Get worksheets**

The following code sample gets the collection of worksheets, loads the name property of each worksheet, and writes a message to the console.

```
JavaScript
await Excel.run(async (context) => {
 let sheets = context.workbook.worksheets;
 sheets.load("items/name");
 await context.sync();

 if (sheets.items.length > 1) {
 console.log(`There are ${sheets.items.length} worksheets in the
workbook:`);
 } else {
 console.log(`There is one worksheet in the workbook:`);
 }
 sheets.items.forEach(function (sheet) {
 console.log(sheet.name);
 });
});
```
#### 7 **Note**

The id property of a worksheet uniquely identifies the worksheet in a given workbook and its value will remain the same even when the worksheet is renamed or moved. When 

{370}------------------------------------------------

a worksheet is deleted from a workbook in Excel on Mac, the id of the deleted worksheet may be reassigned to a new worksheet that is subsequently created.

## **Get the active worksheet**

The following code sample gets the active worksheet, loads its name property, and writes a message to the console.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 sheet.load("name");
 await context.sync();
 console.log(`The active worksheet is "${sheet.name}"`);
});
```
### **Set the active worksheet**

The following code sample sets the active worksheet to the worksheet named **Sample**, loads its name property, and writes a message to the console. If there is no worksheet with that name, the activate() method throws an ItemNotFound error.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 sheet.activate();
 sheet.load("name");
 await context.sync();
 console.log(`The active worksheet is "${sheet.name}"`);
});
```
### **Reference worksheets by relative position**

These examples show how to reference a worksheet by its relative position.

### **Get the first worksheet**

{371}------------------------------------------------

The following code sample gets the first worksheet in the workbook, loads its name property, and writes a message to the console.

```
JavaScript
await Excel.run(async (context) => {
 let firstSheet = context.workbook.worksheets.getFirst();
 firstSheet.load("name");
 await context.sync();
 console.log(`The name of the first worksheet is "${firstSheet.name}"`);
});
```
### **Get the last worksheet**

The following code sample gets the last worksheet in the workbook, loads its name property, and writes a message to the console.

```
JavaScript
await Excel.run(async (context) => {
 let lastSheet = context.workbook.worksheets.getLast();
 lastSheet.load("name");
 await context.sync();
 console.log(`The name of the last worksheet is "${lastSheet.name}"`);
});
```
### **Get the next worksheet**

The following code sample gets the worksheet that follows the active worksheet in the workbook, loads its name property, and writes a message to the console. If there is no worksheet after the active worksheet, the getNext() method throws an ItemNotFound error.

```
JavaScript
await Excel.run(async (context) => {
 let currentSheet = context.workbook.worksheets.getActiveWorksheet();
 let nextSheet = currentSheet.getNext();
 nextSheet.load("name");
 await context.sync();
 console.log(`The name of the sheet that follows the active worksheet is
"${nextSheet.name}"`);
});
```

{372}------------------------------------------------

#### **Get the previous worksheet**

The following code sample gets the worksheet that precedes the active worksheet in the workbook, loads its name property, and writes a message to the console. If there is no worksheet before the active worksheet, the getPrevious() method throws an ItemNotFound error.

```
JavaScript
await Excel.run(async (context) => {
 let currentSheet = context.workbook.worksheets.getActiveWorksheet();
 let previousSheet = currentSheet.getPrevious();
 previousSheet.load("name");
 await context.sync();
 console.log(`The name of the sheet that precedes the active worksheet is
"${previousSheet.name}"`);
});
```
## **Add a worksheet**

The following code sample adds a new worksheet named **Sample** to the workbook, loads its name and position properties, and writes a message to the console. The new worksheet is added after all existing worksheets.

```
JavaScript
await Excel.run(async (context) => {
 let sheets = context.workbook.worksheets;
 let sheet = sheets.add("Sample");
 sheet.load("name, position");
 await context.sync();
 console.log(`Added worksheet named "${sheet.name}" in position 
${sheet.position}`);
});
```
### **Copy an existing worksheet**

Worksheet.copy adds a new worksheet that is a copy of an existing worksheet. The new worksheet's name will have a number appended to the end, in a manner consistent with copying a worksheet through the Excel UI (for example, **MySheet (2)**). Worksheet.copy can take two parameters, both of which are optional:

{373}------------------------------------------------

- positionType A [WorksheetPositionType](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetpositiontype) enum specifying where in the workbook the new worksheet is to be added.
- relativeTo If the positionType is Before or After , you need to specify a worksheet relative to which the new sheet is to be added (this parameter answers the question "Before or after what?").

The following code sample copies the current worksheet and inserts the new sheet directly after the current worksheet.

```
JavaScript
await Excel.run(async (context) => {
 let myWorkbook = context.workbook;
 let sampleSheet = myWorkbook.worksheets.getActiveWorksheet();
 let copiedSheet = sampleSheet.copy(Excel.WorksheetPositionType.after,
sampleSheet);
 await context.sync();
});
```
### **Delete a worksheet**

The following code sample deletes the final worksheet in the workbook (as long as it's not the only sheet in the workbook) and writes a message to the console.

```
JavaScript
await Excel.run(async (context) => {
 let sheets = context.workbook.worksheets;
 sheets.load("items/name");
 await context.sync();
 if (sheets.items.length === 1) {
 console.log("Unable to delete the only worksheet in the workbook");
 } else {
 let lastSheet = sheets.items[sheets.items.length - 1];
 console.log(`Deleting worksheet named "${lastSheet.name}"`);
 lastSheet.delete();
 await context.sync();
 }
});
```

{374}------------------------------------------------

A worksheet with a visibility of "**[Very Hidden](https://learn.microsoft.com/en-us/javascript/api/excel/excel.sheetvisibility)**" cannot be deleted with the delete method. If you wish to delete the worksheet anyway, you must first change the visibility.

### **Rename a worksheet**

The following code sample changes the name of the active worksheet to **New Name**.

```
JavaScript
await Excel.run(async (context) => {
 let currentSheet = context.workbook.worksheets.getActiveWorksheet();
 currentSheet.name = "New Name";
 await context.sync();
});
```
### **Move a worksheet**

The following code sample moves a worksheet from the last position in the workbook to the first position in the workbook.

```
JavaScript
await Excel.run(async (context) => {
 let sheets = context.workbook.worksheets;
 sheets.load("items");
 await context.sync();
 let lastSheet = sheets.items[sheets.items.length - 1];
 lastSheet.position = 0;
 await context.sync();
});
```
## **Set worksheet visibility**

These examples show how to set the visibility of a worksheet.

#### **Hide a worksheet**

The following code sample sets the visibility of worksheet named **Sample** to hidden, loads its name property, and writes a message to the console.

{375}------------------------------------------------

JavaScript

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 sheet.visibility = Excel.SheetVisibility.hidden;
 sheet.load("name");
 await context.sync();
 console.log(`Worksheet with name "${sheet.name}" is hidden`);
});
```
#### **Unhide a worksheet**

The following code sample sets the visibility of worksheet named **Sample** to visible, loads its name property, and writes a message to the console.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 sheet.visibility = Excel.SheetVisibility.visible;
 sheet.load("name");
 await context.sync();
 console.log(`Worksheet with name "${sheet.name}" is visible`);
});
```
## **Get a single cell within a worksheet**

The following code sample gets the cell that is located in row 2, column 5 of the worksheet named **Sample**, loads its address and values properties, and writes a message to the console. The values that are passed into the getCell(row: number, column:number) method are the zeroindexed row number and column number for the cell that is being retrieved.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let cell = sheet.getCell(1, 4);
 cell.load("address, values");
 await context.sync();
 console.log(`The value of the cell in row 2, column 5 is "${cell.values[0]
[0]}" and the address of that cell is "${cell.address}"`);
});
```

{376}------------------------------------------------

## **Detect data changes**

Your add-in may need to react to users changing the data in a worksheet. To detect these changes, you can register an event handler for the onChanged event of a worksheet. Event handlers for the onChanged event receive a [WorksheetChangedEventArgs](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetchangedeventargs) object when the event fires.

The WorksheetChangedEventArgs object provides information about the changes and the source. Since onChanged fires when either the format or value of the data changes, it can be useful to have your add-in check if the values have actually changed. The details property encapsulates this information as a [ChangedEventDetail](https://learn.microsoft.com/en-us/javascript/api/excel/excel.changedeventdetail). The following code sample shows how to display the before and after values and types of a cell that has been changed.

```
JavaScript
// This function would be used as an event handler for the Worksheet.onChanged
event.
function onWorksheetChanged(eventArgs) {
 Excel.run(function (context) {
 let details = eventArgs.details;
 let address = eventArgs.address;
 // Print the before and after types and values to the console.
 console.log(`Change at ${address}: was ${details.valueBefore}
(${details.valueTypeBefore}),`
 + ` now is ${details.valueAfter}(${details.valueTypeAfter})`);
 return context.sync();
 });
}
```
## **Detect formula changes**

Your add-in can track changes to formulas in a worksheet. This is useful when a worksheet is connected to an external database. When the formula changes in the worksheet, the event in this scenario triggers corresponding updates in the external database.

To detect changes to formulas, register an event handler for the [onFormulaChanged](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet#excel-excel-worksheet-onformulachanged-member) event of a worksheet. Event handlers for the onFormulaChanged event receive a [WorksheetFormulaChangedEventArgs](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetformulachangedeventargs) object when the event fires.

{377}------------------------------------------------

The onFormulaChanged event detects when a formula itself changes, not the data value resulting from the formula's calculation.

The following code sample shows how to register the onFormulaChanged event handler, use the WorksheetFormulaChangedEventArgs object to retrieve the [formulaDetails](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetformulachangedeventargs#excel-excel-worksheetformulachangedeventargs-formuladetails-member) array of the changed formula, and then print out details about the changed formula with the [FormulaChangedEventDetail](https://learn.microsoft.com/en-us/javascript/api/excel/excel.formulachangedeventdetail) properties.

#### 7 **Note**

JavaScript

This code sample only works when a single formula is changed.

```
async function run() {
 await Excel.run(async (context) => {
 // Retrieve the worksheet named "Sample".
 let sheet = context.workbook.worksheets.getItem("Sample");

 // Register the formula changed event handler for this worksheet.
 sheet.onFormulaChanged.add(formulaChangeHandler);

 await context.sync();
 });
}
async function formulaChangeHandler(event) {
 await Excel.run(async (context) => {
 // Retrieve details about the formula change event.
 // Note: This method assumes only a single formula is changed at a time. 
 let cellAddress = event.formulaDetails[0].cellAddress;
 let previousFormula = event.formulaDetails[0].previousFormula;
 let source = event.source;

 // Print out the change event details.
 console.log(
 `The formula in cell ${cellAddress} changed. 
 The previous formula was: ${previousFormula}. 
 The source of the change was: ${source}.`
 ); 
 });
}
```
### **Handle sorting events**

{378}------------------------------------------------

The onColumnSorted and onRowSorted events indicate when any worksheet data is sorted. These events are connected to individual Worksheet objects and to the workbook's WorkbookCollection . They fire whether the sorting is done programmatically or manually through the Excel user interface.

#### 7 **Note**

onColumnSorted fires when columns are sorted as the result of a left-to-right sort operation. onRowSorted fires when rows are sorted as the result of a top-to-bottom sort operation. Sorting a table using the drop-down menu on a column header results in an onRowSorted event. The event corresponds with what is moving, not what is being considered as the sorting criteria.

The onColumnSorted and onRowSorted events provide their callbacks with [WorksheetColumnSortedEventArgs](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetcolumnsortedeventargs) or [WorksheetRowSortedEventArgs,](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetrowsortedeventargs) respectively. These give more details about the event. In particular, both EventArgs have an address property that represents the rows or columns moved as a result of the sort operation. Any cell with sorted content is included, even if that cell's value was not part of the sorting criteria.

The following images show the ranges returned by the address property for sort events. First, here is the sample data before sorting:

|    | A              | B    | C   | D        | E                   |  |
|----|----------------|------|-----|----------|---------------------|--|
| 1  | Fruit Sales Q1 |      | Q2  | Q3       | Q4                  |  |
|   | Apples         |      |     |          | 5000 2000 1000 7500 |  |
|   | Pears          | 2000 | 900 |          | 550 1800            |  |
|  | Quinces        | 400  | 800 | 400      | 100                 |  |
|   | Plums          | 600  |     | 600 8000 | 900                 |  |
| 6  |                |      |     |          |                     |  |

If a top-to-bottom sort is performed on "**Q1**" (the values in "**B**"), the following highlighted rows are returned by WorksheetRowSortedEventArgs.address .

|   | A              | B    | C  | D       | E                   |  |
|---|----------------|------|----|---------|---------------------|--|
| 1 | Fruit Sales Q1 |      | Q2 | Q3      | Q4                  |  |
|  | Apples         |      |    |         | 5000 2000 1000 7500 |  |
|  | Pears          | 2000 |    |         | 900 550 1800        |  |
|  | Plums          | 600  |    |         | 600 8000 900        |  |
|  | Quinces        | 400  |    | 800 400 | 100                 |  |
| 6 |                |      |    |         |                     |  |

If a left-to-right sort is performed on "**Quinces**" (the values in "**4**") on the original data, the following highlighted columns are returned by WorksheetColumnsSortedEventArgs.address .

{379}------------------------------------------------

|     | A                 | B   | C        | D        | E                   |  |
|-----|-------------------|-----|----------|----------|---------------------|--|
| 1   | Fruit Sales Q2 Q1 |     |          | Q3       | Q4                  |  |
| 2   | Apples            |     |          |          | 2000 5000 1000 7500 |  |
| 3   | Pears             |     | 900 2000 |          | 550 1800            |  |
|  | Quinces           |     | 800 400  | 400      | 100                 |  |
| 5   | Plums             | 600 |          | 600 8000 | 900                 |  |
| 6   |                   |     |          |          |                     |  |

The following code sample shows how to register an event handler for the Worksheet.onRowSorted event. The handler's callback clears the fill color for the range, then fills the cells of the moved rows.

```
JavaScript
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 // This will fire whenever a row has been moved as the result of a sort
action.
 sheet.onRowSorted.add(async (event) => {
 await Excel.run(async (context) => {
 console.log("Row sorted: " + event.address);
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 // Clear formatting for section, then highlight the sorted area.
 sheet.getRange("A1:E5").format.fill.clear();
 if (event.address !== "") {
 sheet.getRanges(event.address).format.fill.color = "yellow";
 }
 await context.sync();
 });
 });
 await context.sync();
});
```
### **Find all cells with matching text**

The Worksheet object has a [findAll](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet#excel-excel-worksheet-findall-member(1)) method to search for a specified string within the worksheet. It returns a RangeAreas object, which is a collection of Range objects that can be edited all at once.

The following code sample finds all cells with values equal to the string **Complete** and colors them green. Note that findAll throws an ItemNotFound error if the specified string doesn't exist in the worksheet. If you're uncertain whether the specified string exists in the worksheet, use the findAllOrNullObject method to gracefully handle that scenario.

{380}------------------------------------------------

```
JavaScript
```

```
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getItem("Sample");
 let foundRanges = sheet.findAll("Complete", {
 completeMatch: true, /* Match the whole cell value, not any part of the
text. */
 matchCase: false /* Make the search case-insensitive. */
 });
 await context.sync();
 foundRanges.format.fill.color = "green";
});
```
#### 7 **Note**

This section describes how to find cells and ranges using the Worksheet object's methods. More range retrieval information can be found in object-specific articles.

- For examples that show how to get a range within a worksheet using the Range object, see **Get a range using the Excel JavaScript API**.
- For examples that show how to get ranges from a Table object, see **Work with tables using the Excel JavaScript API**.
- For examples that show how to search a large range for multiple sub-ranges based on cell characteristics, see **Work with multiple ranges simultaneously in Excel addins**.

# **Filter data**

An [AutoFilter](https://learn.microsoft.com/en-us/javascript/api/excel/excel.autofilter) applies data filters across a range within the worksheet. This is created with Worksheet.autoFilter.apply , which has the following parameters.

- range : The range to which the filter is applied, specified as either a Range object or a string.
- columnIndex : The zero-based column index against which the filter criteria is evaluated.
- criteria : A [FilterCriteria](https://learn.microsoft.com/en-us/javascript/api/excel/excel.filtercriteria) object determining which rows should be filtered based on the column's cell.

The first code sample shows how to add a filter to the worksheet's used range. This filter will hide entries that are not in the top 25%, based on the values in column **3**.

{381}------------------------------------------------

```
// This method adds a custom AutoFilter to the active worksheet
// and applies the filter to a column of the used range.
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 let farmData = sheet.getUsedRange();
 // This filter will only show the rows with the top 25% of values in column 3.
 sheet.autoFilter.apply(farmData, 3, { criterion1: "25", filterOn:
Excel.FilterOn.topPercent });
 await context.sync();
});
```
The next code sample shows how to refresh the auto-filter using the reapply method. This should be done when the data in the range changes.

| JavaScript                                                                                                           |
|----------------------------------------------------------------------------------------------------------------------|
| // This method refreshes the AutoFilter to ensure that changes are captured.<br>await Excel.run(async (context) => { |
| let sheet = context.workbook.worksheets.getActiveWorksheet();<br>sheet.autoFilter.reapply();                         |
| await context.sync();                                                                                                |
| });                                                                                                                  |

The following code sample shows how to use the clearColumnCriteria method to clear the auto-filter from only one column, while leaving the filter active on other columns.

```
JavaScript
// This method clears the AutoFilter setting from one column.
await Excel.run(async (context) => {
 // Retrieve the active worksheet.
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 // Clear the filter from only column 3.
 sheet.autoFilter.clearColumnCriteria(3);
 await context.sync();
});
```
The final auto-filter code sample shows how to remove the auto-filter from the worksheet with the remove method.

```
JavaScript
// This method removes all AutoFilters from the active worksheet.
await Excel.run(async (context) => {
 let sheet = context.workbook.worksheets.getActiveWorksheet();
 sheet.autoFilter.remove();
```

{382}------------------------------------------------

```
 await context.sync();
});
```
An AutoFilter can also be applied to individual tables. See Work with tables using the Excel JavaScript API for more information.

## **Data protection**

Your add-in can control a user's ability to edit data in a worksheet. The worksheet's protection property is a [WorksheetProtection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetprotection) object with a protect() method. The following example shows a basic scenario toggling the complete protection of the active worksheet.

```
JavaScript
await Excel.run(async (context) => {
 let activeSheet = context.workbook.worksheets.getActiveWorksheet();
 activeSheet.load("protection/protected");
 await context.sync();
 if (!activeSheet.protection.protected) {
 activeSheet.protection.protect();
 }
});
```
The protect method has two optional parameters:

- options : A [WorksheetProtectionOptions](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetprotectionoptions) object defining specific editing restrictions.
- password : A string representing the password needed for a user to bypass protection and edit the worksheet.

The article [Protect a worksheet](https://support.microsoft.com/office/3179efdb-1285-4d49-a9c3-f4ca36276de6) has more information about worksheet protection and how to change it through the Excel UI.

### **Detect changes to the worksheet protection state**

The protection state of a worksheet can be changed by an add-in or through the Excel UI. To detect changes to the protection state, register an event handler for the [onProtectionChanged](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet#excel-excel-worksheet-onprotectionchanged-member) event of a worksheet. Event handlers for the onProtectionChanged event receive a [WorksheetProtectionChangedEventArgs](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheetprotectionchangedeventargs) object when the event fires.

The following code sample shows how to register the onProtectionChanged event handler and use the WorksheetProtectionChangedEventArgs object to retrieve the isProtected , worksheetId , and source properties of the event.

{383}------------------------------------------------

```
JavaScript
```

```
// This function registers an event handler for the onProtectionChanged event of a
worksheet.
async function run() {
 await Excel.run(async (context) => {
 // Retrieve the worksheet named "Sample".
 let sheet = context.workbook.worksheets.getItem("Sample");

 // Register the onProtectionChanged event handler.
 sheet.onProtectionChanged.add(checkProtection);
 await context.sync();
 });
}
// This function is an event handler that returns the protection state of a
worksheet 
// and information about the changed worksheet.
async function checkProtection(event) {
 await Excel.run(async (context) => {
 // Retrieve the protection, worksheet ID, and source properties of the
event.
 let protectionStatus = event.isProtected;
 let worksheetId = event.worksheetId;
 let source = event.source;
 // Print the event properties to the console.
 console.log("Protectionstatuschanged. Protection status is now:" +
protectionStatus);
 console.log(" ID of changed worksheet: " + worksheetId);
 console.log(" Source of change event: " + source); 
 });
}
```
# **See also**

- Excel JavaScript object model in Office Add-ins

{384}------------------------------------------------

# **Adjust worksheet display settings**

Article  04/23/2025

Excel is often used for reporting scenarios where you want to share worksheet data with others. Your Office Add-in can reduce visual clutter and help focus attention by controlling the appearance of the worksheet. The Office JavaScript API supports changing several visual aspects of the worksheet.

## **Page layout and print settings**

Add-ins have access to page layout settings at a worksheet level. These control how the sheet is printed. A Worksheet object has three layout-related properties: horizontalPageBreaks , verticalPageBreaks , and pageLayout .

Worksheet.horizontalPageBreaks and Worksheet.verticalPageBreaks are [PageBreakCollection](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pagebreakcollection) objects. These are collections of [PageBreak](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pagebreak) objects, which specify ranges where manual page breaks are inserted. The following code sample adds a horizontal page break before row **21**.

```
JavaScript
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 sheet.horizontalPageBreaks.add("A21:E21"); // The page break precedes this
range.
 await context.sync();
});
```
Worksheet.pageLayout is a [PageLayout](https://learn.microsoft.com/en-us/javascript/api/excel/excel.pagelayout) object. This object contains layout and print settings that aren't dependent on any printer-specific implementation. These settings include margins, orientation, page numbering, title rows, and print area. The following code sample centers the page (both vertically and horizontally), sets a title row to be printed at the top of every page, and sets the printed area to a subsection of the worksheet.

```
JavaScript
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 // Center the page in both directions.
 sheet.pageLayout.centerHorizontally = true;
 sheet.pageLayout.centerVertically = true;
 // Set the first row as the title row for every page.
 sheet.pageLayout.setPrintTitleRows("$1:$1");
```

{385}------------------------------------------------

```
 // Limit the area to be printed to the range "A1:D100".
 sheet.pageLayout.setPrintArea("A1:D100");
 await context.sync();
});
```
## **Turn data type icons on or off (preview)**

#### 7 **Note**

To use this feature, you must use the preview version of the Office JavaScript API library from the **[Office.js content delivery network (CDN)](https://appsforoffice.microsoft.com/lib/beta/hosted/office.js)** . The **[type definition file](https://appsforoffice.microsoft.com/lib/beta/hosted/office.d.ts)** for TypeScript compilation and IntelliSense is found at the CDN and **[DefinitelyTyped](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts)** . You can install these types with npm install --save-dev @types/office-js-preview .

For more information on our upcoming APIs, please visit **[Excel JavaScript API](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/excel-preview-apis) [requirement sets](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/excel-preview-apis)**.

Data types can display an icon next to the value in the cell. When you have large tables with many data types, the icons may add visual clutter.

Use the [Worksheet.showDataTypeIcons](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet#excel-excel-worksheet-showdatatypeicons-member) property to toggle data type icons on or off. For more information about data types and their icons, see Overview of data types in Excel add-ins. The showDataTypeIcons property performs the same action as the user toggling data type icons by using the **View** > **Data Type Icons** checkbox. The visibility settings for data type icons are saved with the worksheet and are seen by anyone co-authoring at the time they are changed.

The following code sample shows how to turn off data type icons on a worksheet.

```
JavaScript
await Excel.run(async (context) => { 
 const sheet = context.workbook.worksheets.getActiveWorksheet(); 
 sheet.showDataTypeIcons = false; 
 await context.sync(); 
});
```

{386}------------------------------------------------

#### 7 **Note**

If a linked data type displays a **?** icon, this can't be toggled on or off. Excel needs the user to disambiguate the cell value to find the correct data type. For more information, see **[Excel data types: Stocks and geography](https://support.microsoft.com/office/61a33056-9935-484f-8ac8-f1a89e210877)** .

### **Show or hide the worksheet gridlines (preview)**

#### 7 **Note**

To use this feature, you must use the preview version of the Office JavaScript API library from the **[Office.js content delivery network (CDN)](https://appsforoffice.microsoft.com/lib/beta/hosted/office.js)** . The **[type definition file](https://appsforoffice.microsoft.com/lib/beta/hosted/office.d.ts)** for TypeScript compilation and IntelliSense is found at the CDN and **[DefinitelyTyped](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts)** . You can install these types with npm install --save-dev @types/office-js-preview .

For more information on our upcoming APIs, please visit **[Excel JavaScript API](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/excel-preview-apis) [requirement sets](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/excel-preview-apis)**.

Gridlines are the faint lines that appear between cells on a worksheet. These can be distracting if you use shapes, icons, or have specific line and border formats on data.

Turn the gridlines on or off with the [Worksheet.showGridlines](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet#excel-excel-worksheet-showgridlines-member) property. This is the same as using the **View** > **Gridlines** checkbox in the Excel UI. The visibility settings for gridlines are saved with the worksheet and are seen by anyone co-authoring at the time they are changed. 

{387}------------------------------------------------

The following example shows how to turn off gridlines on a worksheet.

```
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 sheet.showGridlines = false;
 await context.sync();
});
```
## **Toggle headings (preview)**

#### 7 **Note**

JavaScript

To use this feature, you must use the preview version of the Office JavaScript API library from the **[Office.js content delivery network (CDN)](https://appsforoffice.microsoft.com/lib/beta/hosted/office.js)** . The **[type definition file](https://appsforoffice.microsoft.com/lib/beta/hosted/office.d.ts)** for TypeScript compilation and IntelliSense is found at the CDN and **[DefinitelyTyped](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts)** . You can install these types with npm install --save-dev @types/office-js-preview .

For more information on our upcoming APIs, please visit **[Excel JavaScript API](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/excel-preview-apis) [requirement sets](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/excel-preview-apis)**.

Headings are the Excel row numbers that appear on the left side of the worksheet (1, 2, 3) and the column letters that appear at the top of the worksheet (A, B, C). The user may not want these in their report.

Turn the headings on or off with the [Worksheet.showHeadings](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet#excel-excel-worksheet-showheadings-member) property. This is the same as using the **View** > **Headings** checkbox in the Excel UI. The following example shows how to turn headings off on a worksheet.

```
JavaScript
await Excel.run(async (context) => {
 const sheet = context.workbook.worksheets.getActiveWorksheet();
 sheet.showHeadings = false;
```

{388}------------------------------------------------

```
 await context.sync();
});
```
## **See also**

- Excel JavaScript object model in Office Add-ins
- Work with worksheets using the Excel JavaScript API

{389}------------------------------------------------

# **Troubleshooting Excel add-ins**

Article  03/09/2023

This article discusses troubleshooting issues that are unique to Excel. Please use the feedback tool at the bottom of the page to suggest other issues that can be added to the article.

## **API limitations when the active workbook switches**

Add-ins for Excel are intended to operate on a single workbook at a time. Errors can arise when a workbook that is separate from the one running the add-in gains focus. This only happens when particular methods are in the process of being called when the focus changes.

The following APIs are affected by this workbook switch.

| Excel JavaScript API               | Error thrown     |
|------------------------------------|------------------|
| Chart.activate                     | GeneralException |
| Range.select                       | GeneralException |
| Table.clearFilters                 | GeneralException |
| Workbook.getActiveCell             | InvalidSelection |
| Workbook.getSelectedRange          | InvalidSelection |
| Workbook.getSelectedRanges         | InvalidSelection |
| Worksheet.activate                 | GeneralException |
| Worksheet.delete                   | InvalidSelection |
| Worksheet.gridlines                | GeneralException |
| Worksheet.showHeadings             | GeneralException |
| WorksheetCollection.add            | GeneralException |
| WorksheetFreezePanes.freezeAt      | GeneralException |
| WorksheetFreezePanes.freezeColumns | GeneralException |
| WorksheetFreezePanes.freezeRows    | GeneralException |

{390}------------------------------------------------

| Excel JavaScript API | Error thrown |
|----------------------|--------------|
|----------------------|--------------|

WorksheetFreezePanes.getLocationOrNullObject GeneralException

WorksheetFreezePanes.unfreeze GeneralException

7 **Note**

This only applies to multiple Excel workbooks open on Windows or Mac.

# **Coauthoring**

See Coauthoring in Excel add-ins for patterns to use with events in a coauthoring environment. The article also discusses potential merge conflicts when using certain APIs, such as [TableRowCollection.add.](https://learn.microsoft.com/en-us/javascript/api/excel/excel.tablerowcollection#excel-excel-tablerowcollection-add-member(1))

## **Known Issues**

### **Binding events return temporary Binding objects**

Both [BindingDataChangedEventArgs.binding](https://learn.microsoft.com/en-us/javascript/api/excel/excel.bindingdatachangedeventargs#excel-excel-bindingdatachangedeventargs-binding-member) and

[BindingSelectionChangedEventArgs.binding](https://learn.microsoft.com/en-us/javascript/api/excel/excel.bindingselectionchangedeventargs#excel-excel-bindingselectionchangedeventargs-binding-member) return a temporary Binding object that contains the ID of the Binding object that raised the event. Use this ID with BindingCollection.getItem(id) to retrieve the Binding object that raised the event.

The following code sample shows how to use this temporary binding ID to retrieve the related Binding object. In the sample, an event listener is assigned to a binding. The listener calls the getBindingId method when the onDataChanged event is triggered. The getBindingId method uses the ID of the temporary Binding object to retrieve the Binding object that raised the event.

```
JavaScript
async function run() {
 await Excel.run(async (context) => {
 // Retrieve your binding.
 let binding = context.workbook.bindings.getItemAt(0);

 await context.sync();

 // Register an event listener to detect changes to your binding
 // and then trigger the `getBindingId` method when the data changes.
```

{391}------------------------------------------------

```
 binding.onDataChanged.add(getBindingId);
 await context.sync();
 });
}
async function getBindingId(eventArgs) {
 await Excel.run(async (context) => {
 // Get the temporary binding object and load its ID. 
 let tempBindingObject = eventArgs.binding;
 tempBindingObject.load("id");
 // Use the temporary binding object's ID to retrieve the original
binding object. 
 let originalBindingObject =
context.workbook.bindings.getItem(tempBindingObject.id);
 // You now have the binding object that raised the event:
`originalBindingObject`. 
 });
}
```
### **Cell format useStandardHeight and useStandardWidth issues**

The [useStandardHeight](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellpropertiesformat#excel-excel-cellpropertiesformat-usestandardheight-member) property of CellPropertiesFormat doesn't work properly in Excel on the web. Due to an issue in the Excel on the web UI, setting the useStandardHeight property to true calculates height imprecisely on this platform. For example, a standard height of **14** is modified to **14.25** in Excel on the web.

On all platforms, the [useStandardHeight](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellpropertiesformat#excel-excel-cellpropertiesformat-usestandardheight-member) and [useStandardWidth](https://learn.microsoft.com/en-us/javascript/api/excel/excel.cellpropertiesformat#excel-excel-cellpropertiesformat-usestandardwidth-member) properties of CellPropertiesFormat are only intended to be set to true . Setting these properties to false has no effect.

### **Range getImage method unsupported on Excel for Mac**

The Range [getImage](https://learn.microsoft.com/en-us/javascript/api/excel/excel.range#excel-excel-range-getimage-member(1)) method isn't currently supported in Excel for Mac. See [OfficeDev/office-js Issue #235](https://github.com/OfficeDev/office-js/issues/235) for the current status.

#### **Range return character limit**

The [Worksheet.getRange(address)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet#excel-excel-worksheet-getrange-member(1)) and [Worksheet.getRanges(address)](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet#excel-excel-worksheet-getranges-member(1)) methods have an address string limit of 8192 characters. When this limit is exceeded, the address string is truncated to 8192 characters.

{392}------------------------------------------------

## **See also**

- Troubleshoot development errors with Office Add-ins
- Troubleshoot user errors with Office Add-ins

{393}------------------------------------------------

# **Create custom functions in Excel**

Article  11/11/2024

Custom functions enable developers to add new functions to Excel by defining those functions in JavaScript as part of an add-in. Users within Excel can access custom functions just as they would any native function in Excel, such as SUM() .

#### 7 **Note**

**Custom function** is a general term that is interchangeable with **user-defined function**. Both terms apply to VBA, COM, and Office.js add-ins. The Office Add-ins documentation uses the term **custom function** when referring to custom functions that use Office JavaScript APIs.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on the web
- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
	- volume-licensed perpetual Office 2021 and later
- Office on Mac

Excel custom functions aren't currently supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier on Windows

The following animated image shows your workbook calling a function you've created with JavaScript or TypeScript. In this example, the custom function =MYFUNCTION.SPHEREVOLUME calculates the volume of a sphere.

{394}------------------------------------------------

|   | A | B | C | D | E | F | G | F |
|---|---|---|---|---|---|---|---|---|
| 1 |   |   |   |   |   |   |   |   |
| 2 |   |   |   |   |   |   |   |   |
| 3 |   |   |   |   |   |   |   |   |
| 4 |   |   |   |   |   |   |   |   |
| 5 |   |   |   |   |   |   |   |   |
|  |   |   |   |   |   |   |   |   |
| 7 |   |   |   |   |   |   |   |   |
| 8 |   |   |   |   |   |   |   |   |
| 9 |   |   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |   |   |

The following code defines the custom function =MYFUNCTION.SPHEREVOLUME .

```
JavaScript
/**
 * Returns the volume of a sphere.
 * @customfunction
 * @param {number} radius
 */
function sphereVolume(radius) {
 return Math.pow(radius, 3) * 4 * Math.PI / 3;
}
```
## **How a custom function is defined in code**

If you use the Yeoman generator for Office Add-ins to create an Excel custom functions add-in project, it creates files which control your functions and task pane. We'll concentrate on the files that are important to custom functions.

| File                                                               | File<br>format                 | Description                                      |
|--------------------------------------------------------------------|--------------------------------|--------------------------------------------------|
| ./src/functions/functions.js<br>or<br>./src/functions/functions.ts | JavaScript<br>or<br>TypeScript | Contains the code that defines custom functions. |
| ./src/functions/functions.html                                     | HTML                           | Provides a <script></script>                     |

{395}------------------------------------------------

#### **Tip**

The Yeoman generator for Office Add-ins offers multiple **Excel Custom Functions** projects. We recommend selecting the project type **Excel Custom Functions using a Shared Runtime** and the script type **JavaScript**.

### **Script file**

The script file (**./src/functions/functions.js** or **./src/functions/functions.ts**) contains the code that defines custom functions and comments which define the function.

The following code defines the custom function add . The code comments are used to generate a JSON metadata file that describes the custom function to Excel. The required @customfunction comment is declared first, to indicate that this is a custom function. Next, two parameters are declared, first and second , followed by their description properties. Finally, a returns description is given. For more information about what comments are required for your custom function, see Autogenerate JSON metadata for custom functions.

```
JavaScript
/**
 * Adds two numbers.
 * @customfunction 
 * @param first First number.
 * @param second Second number.
 * @returns The sum of the two numbers.
 */
function add(first, second){
 return first + second;
}
```
#### **Tip**

In Excel on the web, custom function descriptions and parameter descriptions display inline. This gives users additional information when writing custom

{396}------------------------------------------------

functions. Learn how to configure the inline descriptions by exploring any of the **[custom functions Script Lab samples](https://github.com/OfficeDev/office-js-snippets/tree/prod/samples/excel/16-custom-functions)** in Excel on the web. See the following screenshot for an example.

|   | SCRIPTLAB.SAMPLE.SAMPLEFUNCTION(a, b)                       |  |
|---|-------------------------------------------------------------|--|
|   | Description                                                 |  |
|   | Custom function descriptions display inline in Excel on the |  |
|   | web. This function adds two values.                         |  |
| a | Parameter A is the first value.                             |  |
| b | Parameter B is the second value.                            |  |

### **Manifest file**

The add-in only manifest file for an add-in that defines custom functions (**./manifest.xml** in the project that the Yeoman generator for Office Add-ins creates) does several things.

- Defines the namespace for your custom functions. A namespace prepends itself to your custom functions to help customers identify your functions as part of your add-in.
- Uses **<ExtensionPoint>** and **<Resources>** elements that are unique to a custom functions manifest. These elements contain the information about the locations of the JavaScript, JSON, and HTML files.
- Specifies which runtime to use for your custom function. We recommend always using a shared runtime unless you have a specific need for another runtime, because a shared runtime allows for the sharing of data between functions and the task pane.

To see a full working manifest from a sample add-in, see the manifest in the [one of our](https://github.com/OfficeDev/Office-Add-in-samples/blob/main/Samples/excel-shared-runtime-global-state/manifest.xml) [Office Add-in samples Github repositories](https://github.com/OfficeDev/Office-Add-in-samples/blob/main/Samples/excel-shared-runtime-global-state/manifest.xml) .

{397}------------------------------------------------

If you'll be testing your add-in across multiple environments (for example, in development, staging, demo, etc.), we recommend that you maintain a different manifest file for each environment. In each manifest file, you can:

- Specify the URLs that correspond to the environment.
- Customize metadata values like DisplayName and labels within Resources to indicate the environment, so that end users will be able to identify a sideloaded add-in's corresponding environment.
- Customize the custom functions namespace to indicate the environment, if your add-in defines custom functions.

By following this guidance, you'll streamline the testing process and avoid issues that would otherwise occur when an add-in is simultaneously sideloaded for multiple environments.

# **Coauthoring**

Excel on the web and on Windows connected to a Microsoft 365 subscription allow end users to coauthor in Excel. If an end user's workbook uses a custom function, that end user's coauthoring colleague is prompted to load the corresponding custom functions add-in. Once both users have loaded the add-in, the custom function shares results through coauthoring.

For more information on coauthoring, see [About coauthoring in Excel](https://learn.microsoft.com/en-us/office/vba/excel/concepts/about-coauthoring-in-excel).

## **Next steps**

Want to try out custom functions? Check out the simple custom functions quick start or the more in-depth custom functions tutorial if you haven't already.

Another easy way to try out custom functions is to use [Script Lab](https://appsource.microsoft.com/product/office/WA104380862) , an add-in that allows you to experiment with custom functions right in Excel. You can try out creating your own custom function or play with the provided samples.

## **See also**

- [Learn about the Microsoft 365 Developer Program](https://aka.ms/m365devprogram)
- [Custom functions requirement sets](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/custom-functions-requirement-sets)
- Custom functions naming guidelines
- Make your custom functions compatible with XLL user-defined functions

{398}------------------------------------------------

- Configure your Office Add-in to use a shared runtime
- Runtimes in Office Add-ins

{399}------------------------------------------------

# **Get started developing Excel custom functions**

Article  01/07/2025

With custom functions, developers can add new functions to Excel by defining them in JavaScript or TypeScript as part of an add-in. Excel users can access custom functions just as they would any native function in Excel, such as SUM() .

### **Prerequisites**

- Node.js (the latest LTS version). Visit the [Node.js site](https://nodejs.org/) to download and install the right version for your operating system.
- The latest version of Yeoman and the Yeoman generator for Office Add-ins. To install these tools globally, run the following command via the command prompt.

command line npm install -g yo generator-office

#### 7 **Note**

Even if you've previously installed the Yeoman generator, we recommend you update your package to the latest version from npm.

- Office connected to a Microsoft 365 subscription (including Office on the web).
#### 7 **Note**

If you don't already have Office, you might qualify for a Microsoft 365 E5 developer subscription through the **[Microsoft 365 Developer Program](https://aka.ms/m365devprogram)** ; for details, see the **[FAQ](https://learn.microsoft.com/en-us/office/developer-program/microsoft-365-developer-program-faq#who-qualifies-for-a-microsoft-365-e5-developer-subscription-)**. Alternatively, you can **[sign up for a 1-month free trial](https://www.microsoft.com/microsoft-365/try)** or **[purchase a Microsoft 365 plan](https://www.microsoft.com/microsoft-365/business/compare-all-microsoft-365-business-products-g)** .

# **Build your first custom functions project**

To start, you'll use the Yeoman generator to create the custom functions project. This will set up your project with the correct folder structure, source files, and dependencies 

{400}------------------------------------------------

to begin coding your custom functions.

- 1. Run the following command to create an add-in project using the Yeoman generator. A folder that contains the project will be added to the current directory.
When you run the yo office command, you may receive prompts about the data collection policies of Yeoman and the Office Add-in CLI tools. Use the information that's provided to respond to the prompts as you see fit.

When prompted, provide the following information to create your add-in project.

- **Choose a project type:** Excel Custom Functions using a Shared Runtime
- **Choose a script type:** JavaScript
- **What do you want to name your add-in?** My custom functions add-in

The Yeoman generator will create the project files and install supporting Node components.

- 2. The Yeoman generator will give you some instructions in your command line about what to do with the project, but ignore them and continue to follow our instructions. Navigate to the root folder of the project.

{401}------------------------------------------------

- 3. Build the project.
command line npm run build

- 4. Start the local web server, which runs in Node.js. You can try out the custom function add-in in Excel. You may be prompted to open the add-in's task pane, although this is optional. You can still run your custom functions without opening your add-in's task pane.
Excel on the web

To test your add-in in Excel on the web, run the following command. When you run this command, the local web server will start. Replace "{url}" with the URL of an Excel document on your OneDrive or a SharePoint library to which you have permissions.

#### 7 **Note**

If you are developing on a Mac, enclose the {url} in single quotation marks. Do *not* do this on Windows.

command line

```
npm run start -- web --document {url}
```
The following are examples.

- npm run start -- web --document https://contoso.sharepoint.com/:t:/g/EZGxP7ksiE5DuxvY638G798BpuhwluxCMfF1W ZQj3VYhYQ?e=F4QM1R
- npm run start -- web --document https://1drv.ms/x/s!jkcH7spkM4EGgcZUgqthk4IK3NOypVw?e=Z6G1qp
- npm run start -- web --document https://contoso-my.sharepointdf.com/:t:/p/user/EQda453DNTpFnl1bFPhOVR0BwlrzetbXvnaRYii2lDr_oQ? e=RSccmNP

If your add-in doesn't sideload in the document, manually sideload it by following the instructions in Manually sideload add-ins to Office on the web.

{402}------------------------------------------------

- 7 **Note** Office Add-ins should use HTTPS, not HTTP, even while you're developing. If you're prompted to install a certificate after you run one of the following commands, accept the prompt to install the certificate that the Yeoman generator provides. You may also have to run your command prompt or terminal as an administrator for the changes to be made. If this is your first time developing an Office Add-in on your machine, you may be prompted in the command line to grant Microsoft Edge WebView a loopback exemption ("Allow localhost loopback for Microsoft Edge WebView?"). When prompted, enter Y to allow the exemption. Note that you'll need administrator privileges to allow the exemption. Once allowed, you shouldn't be prompted for an exemption when you sideload Office Add-ins in the future (unless you remove the exemption from your machine). To learn more, see **["We can't open this add-in from localhost"](https://learn.microsoft.com/en-us/office/troubleshoot/office-suite-issues/cannot-open-add-in-from-localhost) [when loading an Office Add-in or using Fiddler](https://learn.microsoft.com/en-us/office/troubleshoot/office-suite-issues/cannot-open-add-in-from-localhost)**.
# **Try out a prebuilt custom function**

The custom functions project that you created by using the Yeoman generator contains some prebuilt custom functions, defined within the **./src/functions/functions.js** file. The **./manifest.xml** file in the root directory of the project specifies that all custom functions belong to the CONTOSO namespace.

In your Excel workbook, try out the ADD custom function by completing the following steps.

- 1. Select a cell and type =CONTOSO . Notice that the autocomplete menu shows the list of all functions in the CONTOSO namespace.

{403}------------------------------------------------

- 2. Run the CONTOSO.ADD function, using numbers 10 and 200 as input parameters, by typing the value =CONTOSO.ADD(10,200) in the cell and pressing Enter .
The ADD custom function computes the sum of the two numbers that you specify as input parameters. Typing =CONTOSO.ADD(10,200) should produce the result **210** in the cell after you press Enter .

If the CONTOSO namespace isn't available in the autocomplete menu, take the following steps to register the add-in in Excel.

Excel on the web

- 1. Select **Home** > **Add-ins**, then select **More Settings**.
- 2. On the **Office Add-ins** dialog, select **Upload My Add-in**.
- 3. Choose **Browse...** and navigate to the root directory of the project that the Yeoman generator created.
- 4. Select the file **manifest.xml** and choose **Open**, then choose **Upload**.
- 5. Try out the new function. In cell **B1**, type the text **=CONTOSO.GETSTARCOUNT("OfficeDev", "Excel-Custom-Functions")** and press Enter . You should see that the result in cell **B1** is the current number of stars given to the [Excel-Custom-Functions Github repository](https://github.com/OfficeDev/Excel-Custom-Functions) .

When you want to stop the local web server and uninstall the add-in, follow the applicable instructions:

- To stop the server, run the following command. If you used npm start , the following command also uninstalls the add-in.

| command line |  |  |  |  |  |  |
|--------------|--|--|--|--|--|--|
| npm stop     |  |  |  |  |  |  |

- If you manually sideloaded the add-in, see Remove a sideloaded add-in.
## **Next steps**

{404}------------------------------------------------

Congratulations, you've successfully created a custom function in an Excel add-in! Next, build a more complex add-in with streaming data capability. The following link takes you through the next steps in the Excel add-in with custom functions tutorial.

**Excel custom functions add-in tutorial**

## **Troubleshooting**

- Ensure your environment is ready for Office development by following the instructions in Set up your development environment.
- Some of the sample code uses ES6 JavaScript. This isn't compatible with older versions of Office that use the Trident (Internet Explorer 11) browser engine. For information on how to support those platforms in your add-in, see Support older Microsoft webviews and Office versions. If you don't already have a Microsoft 365 subscription to use for development, you might qualify for a Microsoft 365 E5 developer subscription through the [Microsoft 365 Developer Program](https://aka.ms/m365devprogram) ; for details, see the [FAQ](https://learn.microsoft.com/en-us/office/developer-program/microsoft-365-developer-program-faq#who-qualifies-for-a-microsoft-365-e5-developer-subscription-). Alternatively, you can [sign up for a 1-month free trial](https://www.microsoft.com/microsoft-365/try) or [purchase a Microsoft 365 plan](https://www.microsoft.com/microsoft-365/business/compare-all-microsoft-365-business-products-g) .
- The automatic npm install step Yo Office performs may fail. If you see errors when trying to run npm start , navigate to the newly created project folder in a command prompt and manually run npm install . For more information about Yo Office, see Create Office Add-in projects using the Yeoman Generator.
- You may encounter issues if you run the quick start multiple times. If the Office cache already has an instance of a function with the same name, your add-in gets an error when it sideloads. You can prevent this by clearing the Office cache before running npm run start and making sure to run npm stop before restarting the add-in.

## **See also**

- Custom functions overview

{405}------------------------------------------------

- Custom functions metadata
- Runtime for Excel custom functions
- Using Visual Studio Code to publish

{406}------------------------------------------------

# **Tutorial: Create custom functions in Excel**

Article  05/07/2025

Custom functions enable you to add new functions to Excel by defining those functions in JavaScript as part of an add-in. Users within Excel can access custom functions as they would any native function in Excel, such as SUM() . You can create custom functions that perform simple tasks like calculations or more complex tasks such as streaming real-time data from the web into a worksheet.

In this tutorial, you will:

- " Create a custom function add-in using the Yeoman generator for Office Add-ins.
- " Use a prebuilt custom function to perform a simple calculation.
- " Create a custom function that gets data from the web.
- " Create a custom function that streams real-time data from the web.

## **Prerequisites**

- Node.js (the latest LTS version). Visit the [Node.js site](https://nodejs.org/) to download and install the right version for your operating system.
- The latest version of Yeoman and the Yeoman generator for Office Add-ins. To install these tools globally, run the following command via the command prompt.

command line

npm install -g yo generator-office

#### 7 **Note**

Even if you've previously installed the Yeoman generator, we recommend you update your package to the latest version from npm.

- Office connected to a Microsoft 365 subscription (including Office on the web).
#### 7 **Note**

If you don't already have Office, you might qualify for a Microsoft 365 E5 developer subscription through the **[Microsoft 365 Developer Program](https://aka.ms/m365devprogram)** ; for details, see the

{407}------------------------------------------------

**[FAQ](https://learn.microsoft.com/en-us/office/developer-program/microsoft-365-developer-program-faq#who-qualifies-for-a-microsoft-365-e5-developer-subscription-)**. Alternatively, you can **[sign up for a 1-month free trial](https://www.microsoft.com/microsoft-365/try)** or **[purchase a](https://www.microsoft.com/microsoft-365/business/compare-all-microsoft-365-business-products-g) [Microsoft 365 plan](https://www.microsoft.com/microsoft-365/business/compare-all-microsoft-365-business-products-g)** .

### **Create a custom functions project**

To start, create the code project to build your custom function add-in. The Yeoman generator for Office Add-ins will set up your project with some prebuilt custom functions that you can try out. If you've already run the custom functions quick start and generated a project, continue to use that project and skip to this step instead.

#### 7 **Note**

If you recreate the Yo Office project, you may get an error because the Office cache already has an instance of a function with the same name. You can prevent this by **clearing the Office cache** before running npm run start .

- 1. Run the following command to create an add-in project using the Yeoman generator. A folder that contains the project will be added to the current directory.
command line

yo office

#### 7 **Note**

When you run the yo office command, you may receive prompts about the data collection policies of Yeoman and the Office Add-in CLI tools. Use the information that's provided to respond to the prompts as you see fit.

When prompted, provide the following information to create your add-in project.

- **Choose a project type:** Excel Custom Functions using a Shared Runtime
- **Choose a script type:** JavaScript
- **What do you want to name your add-in?** My custom functions add-in

{408}------------------------------------------------

The Yeoman generator will create the project files and install supporting Node components.

- 2. Navigate to the root folder of the project.
command line

cd "My custom functions add-in"

- 3. Build the project.
command line

npm run build

#### 7 **Note**

Office Add-ins should use HTTPS, not HTTP, even when you are developing. If you are prompted to install a certificate after you run npm run build , accept the prompt to install the certificate that the Yeoman generator provides.

- 4. Start the local web server, which runs in Node.js. You can try out the custom function addin in Excel.
#### Excel on Windows or Mac

The command to test your add-in in Excel on Windows or Mac depends on when the project was created. If the "scripts" section of the project's package.json file has a "start:desktop" script, then run npm run start:desktop ; otherwise, run the command npm run start . The local web server will start and Excel will open with your add-in loaded.

{409}------------------------------------------------

```
7 Note
     Office Add-ins should use HTTPS, not HTTP, even while you're developing. If
     you're prompted to install a certificate after you run one of the following
     commands, accept the prompt to install the certificate that the Yeoman
     generator provides. You may also have to run your command prompt or
     terminal as an administrator for the changes to be made.
     If this is your first time developing an Office Add-in on your machine, you may
     be prompted in the command line to grant Microsoft Edge WebView a loopback
     exemption ("Allow localhost loopback for Microsoft Edge WebView?"). When
     prompted, enter Y to allow the exemption. Note that you'll need administrator
     privileges to allow the exemption. Once allowed, you shouldn't be prompted for
     an exemption when you sideload Office Add-ins in the future (unless you
     remove the exemption from your machine). To learn more, see "We can't open
     this add-in from localhost" when loading an Office Add-in or using Fiddler.
```
- When you first use Yeoman generator to develop an Office Add-in, your default browser opens a window where you'll be prompted to sign in to your Microsoft 365 account. If a sign-in window doesn't appear and you encounter a sideloading or login timeout error, run atk auth login m365 .
# **Try out a prebuilt custom function**

The custom functions project that you created contains some prebuilt custom functions, defined within the **./src/functions/functions.js** file. The **./manifest.xml** file specifies that all custom functions belong to the CONTOSO namespace. You'll use the CONTOSO namespace to access the custom functions in Excel.

Next, try out the ADD custom function by completing the following steps.

{410}------------------------------------------------

- 1. In Excel, go to any cell and enter =CONTOSO . Notice that the autocomplete menu shows the list of all functions in the CONTOSO namespace.
- 2. Run the CONTOSO.ADD function, with numbers 10 and 200 as input parameters, by typing the value =CONTOSO.ADD(10,200) in the cell and pressing Enter .

The ADD custom function computes the sum of the two numbers that you provided and returns the result of **210**.

If the CONTOSO namespace isn't available in the autocomplete menu, take the following steps to register the add-in in Excel.

| Excel on Windows or on Mac                                                                                                                     |  |
|------------------------------------------------------------------------------------------------------------------------------------------------|--|
| 1. In the Excel ribbon, select Home > Add-ins.<br>2. Under the Developer Add-ins section, select My custom functions add-in to register<br>it. |  |
|                                                                                                                                                |  |
|                                                                                                                                                |  |
|                                                                                                                                                |  |
|                                                                                                                                                |  |

{411}------------------------------------------------

See the **Troubleshooting** section of this article if you encounter errors when sideloading the add-in.

## **Create a custom function that requests data from the web**

Integrating data from the Web is a great way to extend Excel through custom functions. Next you'll create a custom function named getStarCount that shows how many stars a given Github repository possesses.

- 1. In the **My custom functions add-in** project, find the file **./src/functions/functions.js** and open it in your code editor.
- 2. In **function.js**, add the following code.

```
JS
/**
 * Gets the star count for a given Github repository.
 * @customfunction 
 * @param {string} userName string name of Github user or organization.
 * @param {string} repoName string name of the Github repository.
 * @return {number} number of stars given to a Github repository.
 */
 async function getStarCount(userName, repoName) {
 try {
 //You can change this URL to any web request you want to work with.
 const url = "https://api.github.com/repos/" + userName + "/" +
repoName;
 const response = await fetch(url);
 //Expect that status code is in 200-299 range
 if (!response.ok) {
 throw new Error(response.statusText)
 }
 const jsonResponse = await response.json();
 return jsonResponse.watchers_count;
 }
 catch (error) {
 return error;
 }
 }
```
- 3. Run the following command to rebuild the project.
command line

{412}------------------------------------------------

- 4. Complete the following steps (for Excel on the web, Windows, or Mac) to re-register the add-in in Excel. You must complete these steps before the new function will be available.
- 1. Close Excel and then reopen Excel.
- 2. In the Excel ribbon, select **Home** > **Add-ins**.
- 3. Under the **Developer Add-ins** section, select **My custom functions add-in** to register it.

| My Add-ins             |             |  |  |  |
|------------------------|-------------|--|--|--|
| Microsoft Visi<br>Flow |             |  |  |  |
| Developer Add-ins      |             |  |  |  |
| Logo<br>My custom      |             |  |  |  |
| Popular Add-ins        |             |  |  |  |
| <br>"T"                | Get Add-ins |  |  |  |

- 4. Try out the new function. In cell **B1**, type the text
**=CONTOSO.GETSTARCOUNT("OfficeDev", "Office-Add-in-Samples")** and press Enter . You should see that the result in cell **B1** is the current number of stars given to the [Office-Add-in-Samples repository](https://github.com/OfficeDev/Office-Add-in-Samples) .

{413}------------------------------------------------

See the **Troubleshooting** section of this article if you encounter errors when sideloading the add-in.

### **Create a streaming asynchronous custom function**

The getStarCount function returns the number of stars a repository has at a specific moment in time. Custom functions also return data that is continuously changing. These functions are called streaming functions. They must include an invocation parameter which refers to the cell that called the function. The invocation parameter is used to update the contents of the cell at any time.

In the following code sample, notice that there are two functions, currentTime and clock . The currentTime function is a static function that doesn't use streaming. It returns the date as a string. The clock function uses the currentTime function to provide the new time every second to a cell in Excel. It uses invocation.setResult to deliver the time to the Excel cell and invocation.onCanceled to handle function cancellation.

The **My custom functions add-in** project already contains the following two functions in the **./src/functions/functions.js** file.

```
JS
/**
 * Returns the current time
 * @returns {string} String with the current time formatted for the current
locale.
 */
function currentTime() {
 return new Date().toLocaleTimeString();
}

/**
 * Displays the current time once a second
 * @customfunction
 * @param {CustomFunctions.StreamingInvocation<string>} invocation Custom function
invocation
 */
function clock(invocation) {
 const timer = setInterval(() => {
 const time = currentTime();
 invocation.setResult(time);
 }, 1000);

 invocation.onCanceled = () => {
 clearInterval(timer);
```

{414}------------------------------------------------

 }; }

To try out the functions, type the text **=CONTOSO.CLOCK()** in cell **C1** and press Enter . You should see the current date, which streams an update every second. While this clock is just a timer on a loop, you can use the same idea of setting a timer on more complex functions that make web requests for real-time data.

## **Troubleshooting**

You may encounter issues if you run the tutorial multiple times. If the Office cache already has an instance of a function with the same name, your add-in gets an error when it sideloads.

You can prevent this conflict by clearing the Office cache before running npm run start . If your npm process is already running, enter npm stop , clear the Office cache, and then restart npm.

# **Next steps**

Congratulations! You've created a new custom functions project, tried out a prebuilt function, created a custom function that requests data from the web, and created a custom function that streams data. Next, learn how to Share custom function data with the task pane.

{415}------------------------------------------------

# **Tutorial: Share data and events between Excel custom functions and the task pane**

Article  08/29/2024

Share global data and send events between the task pane and custom functions of your Excel add-in with a shared runtime.

## **Share a state between custom function and task pane code**

The following instructions show how to share a global variable between custom function and task pane code. This tutorial assumes that you've completed the Excel custom functions tutorial, with a **Excel Custom Functions using a Shared Runtime** project using the script type **JavaScript**. Use the add-in you created in that tutorial to complete the following instructions.

#### **Create custom functions to get or store shared state**

- 1. In Visual Studio Code open the file **src/functions/functions.js**.
- 2. On line 1, insert the following code at the very top. This will initialize a global variable named **sharedState**.

- 3. Add the following code to create a custom function that stores values to the **sharedState** variable.

```
JavaScript
/**
 * Saves a string value to shared state with the task pane
 * @customfunction STOREVALUE
 * @param {string} value String to write to shared state with task
pane.
 * @return {string} A success value
 */
function storeValue(sharedValue) {
```

{416}------------------------------------------------

```
 window.sharedState = sharedValue;
 return "value stored";
}
```
- 4. Add the following code to create a custom function that gets the current value of the **sharedState** variable.

```
JavaScript
/**
 * Gets a string value from shared state with the task pane
 * @customfunction GETVALUE
 * @returns {string} String value of the shared state with task pane.
 */
function getValue() {
 return window.sharedState;
}
```
- 5. Save the file.
#### **Create task pane controls to work with global data**

- 1. Open the file **src/taskpane/taskpane.html**.
- 2. After the closing </main> element, add the following HTML. The HTML creates two text boxes and buttons used to get or store global data.

```
HTML
<ol>
 <li>
 Enter a value to send to the custom function and select
 <strong>Store</strong>.
 </li>
 <li>
 Enter <strong>=CONTOSO.GETVALUE()</strong> into a cell to retrieve
it.
 </li>
 <li>
 To send data to the task pane, in a cell, enter
 <strong>=CONTOSO.STOREVALUE("new value")</strong>
 </li>
 <li>Select <strong>Get</strong> to display the value in the task
pane.</li>
</ol>
<p>Store new value to shared state</p>
<div>
 <input type="text" id="storeBox" />
```

{417}------------------------------------------------

```
 <button onclick="storeSharedValue()">Store</button>
</div>
<p>Get shared state value</p>
<div>
 <input type="text" id="getBox" />
 <button onclick="getSharedValue()">Get</button>
</div>
```
- 3. Before the closing </body> element, add the following script. This code will handle the button click events when the user wants to store or get global data.

```
HTML
<script>
 function storeSharedValue() {
 let sharedValue = document.getElementById('storeBox').value;
 window.sharedState = sharedValue;
 }
 function getSharedValue() {
 document.getElementById('getBox').value = window.sharedState;
 }
</script>
```
- 4. Save the file.
- 5. Build the project.

### **Try sharing data between the custom functions and task pane**

- Start the project by using the following command.
command line npm run start

Once Excel starts, you can use the task pane buttons to store or get shared data. Enter =CONTOSO.GETVALUE() into a cell for the custom function to retrieve the same shared

{418}------------------------------------------------

data. Or use =CONTOSO.STOREVALUE("new value") to change the shared data to a new value.

#### 7 **Note**

Calling some Office APIs from custom functions using a shared runtime is possible. **See Call Microsoft Excel APIs from a custom function** for more details.

When you're ready to stop the dev server and uninstall the add-in, run the following command.

command line

npm run stop

## **See also**

- Excel custom functions tutorial
- Configure your Office Add-in to use a shared runtime

{419}------------------------------------------------

# **Best practices for custom functions in Excel**

06/22/2025

This article includes tips, best practices, and Office Add-ins ecosystem information for new developers of custom functions add-ins.

The following diagram illustrates the interaction between a custom function and the two main components involved in custom function add-ins: Excel and external services.

**Excel** allows you to integrate your own custom functions into the application and run them like built-in functions.

The **custom functions add-in** defines the logic for your functions and how they interact with Excel and Office JavaScript APIs. To learn how to create a custom functions add-in, see the custom functions tutorial.

An **external service** is optional. It can give your add-in capabilities like importing data from outside the workbook. The custom functions add-in specifies how external data is incorporated into the workbook. To learn more, see Receive and handle data with custom functions.

# **Optimize custom functions recalculation efficiency**

In general, custom functions recalculation follows the established pattern of [recalculation in](https://learn.microsoft.com/en-us/office/client-developer/excel/excel-recalculation) [Excel](https://learn.microsoft.com/en-us/office/client-developer/excel/excel-recalculation). When recalculation is triggered, Excel enters a three-stage process: construct a dependency tree, construct a calculation chain, and then recalculate the cells. To optimize recalculation efficiency in your add-in, consider the level of nesting within your custom functions, the Excel calculation mode, and the limitations of volatile functions.

### **Nesting in custom functions**

A custom function can accept another custom function as an argument, making the argument a nested custom function. The recalculation of the outer custom function depends on the result of the nested function, leading to increased time consumption with each additional nested function. Minimize the number of nested levels in your custom functions to improve recalculation efficiency. The following code snippets demonstrate two approaches for adding

{420}------------------------------------------------

values in the workbook that produce similar outputs. **Option 1** uses an array to call values as a single parameter, while **Option 2** calls each value as a separate parameter, so **Option 1** is more efficient.

#### **Option 1: Increase efficiency with limited nesting**

#### 7 **Note**

This is the recommended approach. It uses an array to call values as a single parameter and avoid unnecessary nesting, so it's more efficient than **Option 2**.

JavaScript

```
 /**
 * Returns the sum of input numbers.
 * @customfunction
 */
 function Add(args: number[]): number {
 let total = 0;
 args.forEach(value => {
 total += value;
 });
 return total;
 }
```
#### **Option 2: More nesting is inefficient**

#### 7 **Note**

This approach isn't recommended. **Option 1** and **Option 2** produce similar outputs, but **Option 2** uses more parameters and is less efficient.

JavaScript

```
 /**
 * Returns the sum of two numbers.
 * @customfunction
 */
 function Add(arg1: number, arg2: number): number {
 return arg1 + arg2;
 }
```

{421}------------------------------------------------

### **Excel calculation modes**

Excel has three calculation modes: Automatic, Automatic Except Tables, and Manual. To determine which calculation mode best fits your custom function design, refer to the [Calculation Modes, Commands, Selective Recalculation, and Data Table](https://learn.microsoft.com/en-us/office/client-developer/excel/excel-recalculation#calculation-modes-commands-selective-recalculation-and-data-tables#calculation-modes-commands-selective-recalculation-and-data-tables) section in the main [Excel Recalculation](https://learn.microsoft.com/en-us/office/client-developer/excel/excel-recalculation) article.

Set the calculation mode for your add-in with the [Excel.CalculationMode enum](https://learn.microsoft.com/en-us/javascript/api/excel/excel.calculationmode) based on your scenario. Note that automatic calculation mode may trigger recalculation often and reduce the efficiency of your add-in.

### **Volatile function limitations**

Custom functions allow you to create your own volatile functions, similar to the NOW and TODAY functions in Excel. During recalculation, Excel evaluates cells that contain volatile functions and all of their dependent cells. As a result, using many volatile functions may slow recalculation time so limit the number of volatile functions in your add-in to optimize efficiency. For additional information, see [Volatile and Non-Volatile Functions](https://learn.microsoft.com/en-us/office/client-developer/excel/excel-recalculation#volatile-and-non-volatile-functions).

## **Design approaches to improve efficiency**

Custom functions add-ins allow for flexible designs, which means that different add-in designs can produce the same output for your end users.

### **Multiple results**

You can return multiple results from your custom function with multiple functions or with one function.

To return multiple results with one function, use a dynamic array. This is usually the recommended approach because dynamic arrays only require updating a single cell to trigger recalculation for all results.

{422}------------------------------------------------

| =MyFunc() | 1 |
|-----------|---|
|           | 2 |
|           | 3 |
|           | 4 |

Keep in mind that using dynamic arrays becomes less efficient the larger your dataset is, because each recalculation processes more data. To learn more about dynamic arrays in custom functions, see Return multiple results from your custom function.

Another way to return multiple results is to use multiple functions and return a single result for each function. A benefit of using multiple functions is that your end user can decide precisely which formula they want to update and then only trigger recalculation for that formula. This is particularly helpful when relying on external services that may respond slowly.

### **Complex data structures**

Data types are the best way to handle complex data structures in custom functions add-ins. Data types support Excel errors and formatted numbers as doubles. Data types also allow for designing entity value cards, extending Excel data beyond the 2-dimensional grid.

## **Improve the user experience of calls to external services**

Custom functions can fetch data from remote locations beyond the workbook, such as the web or a server. For more information about fetching data from an external service, see Receive and handle data with custom functions. To maintain efficiency when calling external services,

{423}------------------------------------------------

consider batching external calls, minimizing roundtrip duration for each call, and including messages in your add-in to communicate delays to your end user.

### **Batch custom function remote calls**

If your custom functions call a remote service, use a batching pattern to reduce the number of network calls to the remote service. To learn more, see Batching custom function calls for a remote service.

### **Minimize roundtrip duration**

Remote service connections can have a large impact on custom function performance. To reduce this impact, use these strategies:

- Server-heavy processing should be handled efficiently in the remote server to shorten the end-to-end latency for a custom function. For example, have parallel computing designed on the server. If your service is deployed on Azure, consider optimization using [high](https://learn.microsoft.com/en-us/azure/architecture/topics/high-performance-computing)[performance computing on Azure.](https://learn.microsoft.com/en-us/azure/architecture/topics/high-performance-computing)
- Reduce the number of service calls by optimizing the add-in flow. For example, only send necessary calls to a remote service.

### **Improve user-perceived performance through add-in user experience (UX)**

While a custom function is calling an external service, the cell with the custom function displays the **#BUSY!** error. If a delay while calling an external service is inevitable, consider providing messages through the add-in task pane to explain the delay to your end users. This information helps manage their expectations. The following image shows an example.

{424}------------------------------------------------

|  | H | -<br>- | J | K | L | M |  |
|--|---|--------|---|---|---|---|--|
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |
|  |   |        |   |   |   |   |  |

For more information about how to share data between a custom function and a task pane, see Share data and events between Excel custom functions and the task pane.

To display a message in the add-in task pane that notifies users of a delay, make the following changes after ensuring that your add-in uses a shared runtime.

- 1. In **taskpane.js** add a function that calls the notification.

```
JavaScript
export function showNotification(message){
 const label = document.getElementById("item-subject");
 label.innerHTML = message;
}
```
- 2. In **function.js**, import the showNotification function.

```
JavaScript
export function showNotification(message){
 const label = document.getElementById("item-subject");
```

{425}------------------------------------------------

```
 label.innerHTML = message;
}
```
- 3. In **function.js**, call showNotification when running the calculation that may include a delay.

```
JavaScript
export async function longCalculation(param) {
 await Office.addin.showAsTaskpane();
 showNotification("It may take some time as we prepare the data.");
 // Perform long operation
 // ...
 // ...
 return answer;
}
```
## **See also**

- Receive and handle data with custom functions
- Batch custom function calls for a remote service
- Create custom functions in Excel tutorial

{426}------------------------------------------------

# **Custom functions naming and localization**

Article  03/11/2024

This article describes guidelines and best practices for naming custom functions. It also shows how to localize custom function names to languages other than English.

### **Custom functions naming guidelines**

A custom function is identified by an id and name property in the JSON metadata file.

- The function id is used to uniquely identify custom functions in your JavaScript code.
- The function name is used as the display name that appears to a user in Excel.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on the web
- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
	- volume-licensed perpetual Office 2021 and later
- Office on Mac

Excel custom functions aren't currently supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier on Windows

A function name can differ from the function id , such as for localization purposes. In general, a function's name should stay the same as the id if there is no reason for them to differ.

A function's name and id share some common requirements.

- A function's id may only use characters A through Z, numbers zero through nine, underscores, and periods.

{427}------------------------------------------------

- A function's name may use any Unicode alphabetic characters, underscores, and periods.
- Both function name and id must start with a letter and have a minimum limit of three characters.

Excel uses uppercase letters for built-in function names (such as SUM ). Use uppercase letters for your custom function's name and id as a best practice.

A function's name shouldn't be the same as:

- Any cells between A1 to XFD1048576 or any cells between R1C1 to R1048576C16384.
- Any Excel 4.0 Macro Function (such as RUN , ECHO ). For a full list of these functions, see [this Excel Macro Functions Reference document](https://www.myonlinetraininghub.com/cdn/files/Excel%204.0%20Macro%20Functions%20Reference.pdf) .

## **Naming conflicts**

If your function name is the same as a function name in an add-in that already exists, the **#REF!** error will appear in your workbook.

To fix a naming conflict, change the name in your add-in and try the function again. You can also uninstall the add-in with the conflicting name. Or, if you're testing your add-in in different environments, try using a different namespace to differentiate your function (such as NAMESPACE_NAMEOFFUNCTION ).

### **Best practices**

- Consider adding multiple arguments to a function rather than creating multiple functions with the same or similar names.
- Avoid ambiguous abbreviations in function names. Clarity is more important than brevity. Choose a name like =INCREASETIME rather than =INC .
- Function names should indicate the action of the function, such as =GETZIPCODE instead of ZIPCODE.
- Consistently use the same verbs for functions which perform similar actions. For example, use =DELETEZIPCODE and =DELETEADDRESS , rather than =DELETEZIPCODE and =REMOVEADDRESS .
- When naming a streaming function, consider adding a note to that effect in the description of the function or adding STREAM to the end of the function's name.

{428}------------------------------------------------

#### **Tip**

If you'll be testing your add-in across multiple environments (for example, in development, staging, demo, etc.), we recommend that you maintain a different manifest file for each environment. In each manifest file, you can:

- Specify the URLs that correspond to the environment.
- Customize metadata values like DisplayName and labels within Resources to indicate the environment, so that end users will be able to identify a sideloaded add-in's corresponding environment.
- Customize the custom functions namespace to indicate the environment, if your add-in defines custom functions.

By following this guidance, you'll streamline the testing process and avoid issues that would otherwise occur when an add-in is simultaneously sideloaded for multiple environments.

### **Localize custom functions**

You can localize both your add-in and your custom function names. To do so, provide localized function names in the functions' JSON file and locale information in the add-in only manifest file.

#### ) **Important**

Autogenerated metadata doesn't work for localization so you need to update the JSON file manually. To learn how to do this, see **Manually create JSON metadata for custom functions**.

#### **Localize function names**

To localize your custom functions, create a new JSON metadata file for each language. In each language JSON file, add name and description properties in the target language. The default file for English is named **functions.json**. Use the locale in the filename for each additional JSON file, such as **functions-de.json** to help identify them.

The name and description appear in Excel and are localized. However, the id of each function isn't localized. The id property is how Excel identifies your function as unique and shouldn't be changed once it is set.

{429}------------------------------------------------

#### ) **Important**

Avoid giving your functions an id or name that is a built-in Excel function in another language as this conflicts with localized functions.

The following JSON shows how to define a function with the id property "MULTIPLY". The name and description property of the function is localized for German. Each parameter name and description is also localized for German.

```
JSON
{
 "id": "MULTIPLY",
 "name": "SUMME",
 "description": "Summe zwei Zahlen",
 "helpUrl": "http://www.contoso.com",
 "result": {
 "type": "number",
 "dimensionality": "scalar"
 },
 "parameters": [
 {
 "name": "eins",
 "description": "Erste Nummer",
 "dimensionality": "scalar"
 },
 {
 "name": "zwei",
 "description": "Zweite Nummer",
 "dimensionality": "scalar"
 },
 ],
}
```
Compare the previous JSON with the following JSON for English.

```
JSON
{
 "id": "MULTIPLY",
 "name": "Multiply",
 "description": "Multiplies two numbers",
 "helpUrl": "http://www.contoso.com",
 "result": {
 "type": "number",
 "dimensionality": "scalar"
 },
 "parameters": [
 {
```

{430}------------------------------------------------

```
 "name": "one",
 "description": "first number",
 "dimensionality": "scalar"
 },
 {
 "name": "two",
 "description": "second number",
 "dimensionality": "scalar"
 },
 ],
}
```
#### **Localize your add-in**

After creating a JSON file for each language, update your add-in only manifest file with an override value for each locale that specifies the URL of each JSON metadata file. The following manifest XML shows a default en-us locale with an override JSON file URL for de-de (Germany). The **functions-de.json** file contains the localized German function names and IDs.

```
XML
<DefaultLocale>en-us</DefaultLocale>
...
<Resources>
 <bt:Urls>
 <bt:Url id="Contoso.Functions.Metadata.Url"
DefaultValue="https://localhost:3000/dist/functions.json"/>
 <bt:Override Locale="de-de"
Value="https://localhost:3000/dist/functions-de.json" />
 </bt:url>

 </bt:Urls>
</Resources>
```
For more information on the process of localizing an add-in, see Localization for Office Add-ins.

## **Next steps**

Learn about error handling best practices.

## **See also**

- Manually create JSON metadata for custom functions

{431}------------------------------------------------

#### 6 **Collaborate with us on GitHub**

The source for this content can be found on GitHub, where you can also create and review issues and pull requests. For more information, see [our](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md) [contributor guide](https://github.com/OfficeDev/office-js-docs-pr/blob/main/Contributing.md).

#### **Office Add-ins feedback**

Office Add-ins is an open source project. Select a link to provide feedback:

- [Open a documentation issue](https://github.com/OfficeDev/office-js-docs-pr/issues/new?template=3-customer-feedback.yml&pageUrl=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Foffice%2Fdev%2Fadd-ins%2Fexcel%2Fcustom-functions-naming&pageQueryParams=&contentSourceUrl=https%3A%2F%2Fgithub.com%2FOfficeDev%2Foffice-js-docs-pr%2Fblob%2Fmain%2Fdocs%2Fexcel%2Fcustom-functions-naming.md&documentVersionIndependentId=be1e524c-1198-c288-f71e-f9d7f84abeb7&feedback=%0A%0A%5BEnter+feedback+here%5D%0A&author=%40o365devx&metadata=*+ID%3A+714da1e2-6053-0328-b31e-0bf514ecc774+%0A*+Service%3A+**excel**%0A*+Sub-service%3A+**add-ins**)
- [Provide product feedback](https://aka.ms/office-addins-dev-questions)

{432}------------------------------------------------

# **Custom functions parameter options**

08/18/2025

Custom functions are configurable with many different parameter options.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on the web
- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
	- volume-licensed perpetual Office 2021 and later
- Office on Mac

Excel custom functions aren't currently supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier on Windows

#### 7 **Note**

The unified manifest for Microsoft 365 doesn't currently support custom functions projects. You must use the add-in only manifest for custom functions projects. For more information, see **Office Add-ins manifest**.

# **Optional parameters**

When a user invokes a function in Excel, optional parameters appear in brackets. In the following sample, the add function can optionally add a third number. This function appears as =CONTOSO.ADD(first, second, [third]) in Excel.

| JavaScript |                                               |
|------------|-----------------------------------------------|
| JavaScript |                                               |
| /**        | * Calculates the sum of the specified numbers |

{433}------------------------------------------------

```
* @customfunction
 * @param {number} first First number.
 * @param {number} second Second number.
 * @param {number} [third] Third number to add. If omitted, third = 0.
 * @returns {number} The sum of the numbers.
 */
function add(first, second, third) {
 if (third === null) {
 third = 0;
 }
 return first + second + third;
}
```
#### 7 **Note**

When no value is specified for an optional parameter, Excel assigns it the value null . This means default-initialized parameters in TypeScript will not work as expected. Don't use the syntax function add(first:number, second:number, third=0):number because it will not initialize third to 0. Instead use the TypeScript syntax as shown in the previous example.

When you define a function that contains one or more optional parameters, specify what happens when the optional parameters are null. In the following example, zipCode and dayOfWeek are both optional parameters for the getWeatherReport function. If the zipCode parameter is null, the default value is set to 98052 . If the dayOfWeek parameter is null, it's set to Wednesday.

| JavaScript                                                                         |
|------------------------------------------------------------------------------------|
|                                                                                    |
| JavaScript                                                                         |
| /**                                                                                |
| * Gets a weather report for a specified zipCode and dayOfWeek<br>* @customfunction |
| * @param {number} [zipCode] Zip code. If omitted, zipCode = 98052.                 |
| * @param {string} [dayOfWeek] Day of the week. If omitted, dayOfWeek =             |
| Wednesday.                                                                         |
| * @returns {string} Weather report for the day of the week in that zip code.       |
| */<br>function getWeatherReport(zipCode, dayOfWeek) {                              |
| if (zipCode === null) {                                                            |
| zipCode = 98052;                                                                   |
| }                                                                                  |
|                                                                                    |
| if (dayOfWeek === null) {                                                          |
| dayOfWeek = "Wednesday";                                                           |
| }                                                                                  |

{434}------------------------------------------------

```
 // Get weather report for specified zipCode and dayOfWeek.
 // ...
}
```
### **Range parameters**

Your custom function may accept a range of cell data as an input parameter. A function can also return a range of data. Excel will pass a range of cell data as a two-dimensional array.

For example, suppose that your function returns the second highest value from a range of numbers stored in Excel. The following function accepts the parameter values , and the JSDOC syntax number[][] sets the parameter's dimensionality property to matrix in the JSON metadata for this function.

```
JavaScript
/**
 * Returns the second highest value in a matrixed range of values.
 * @customfunction
 * @param {number[][]} values Multiple ranges of values.
 */
function secondHighest(values) {
 let highest = -Infinity,
 secondHighest = -Infinity;
 for (let i = 0; i < values.length; i++) {
 for (let j = 0; j < values[i].length; j++) {
 if (values[i][j] >= highest) {
 secondHighest = highest;
 highest = values[i][j];
 } else if (values[i][j] >= secondHighest) {
 secondHighest = values[i][j];
 }
 }
 }
 return secondHighest;
}
```
## **Repeating parameters**

A repeating parameter allows a user to enter a series of optional arguments to a function. When the function is called, the values are provided in an array for the parameter. If the parameter name ends with a number, each argument's number will increase incrementally, such as ADD(number1, [number2], [number3],) . This matches the convention used for built-in Excel functions.

{435}------------------------------------------------

#### 7 **Note**

For a custom function that takes multiple parameters, a repeating parameter must be the last input parameter in the function. A repeating parameter cannot be followed by another parameter. Similarly, a function can only have one repeating parameter.

The following function sums the total of numbers, cell addresses, as well as ranges, if entered.

```
TS
/**
* The sum of all of the numbers.
* @customfunction
* @param operands A number (such as 1 or 3.1415), a cell address (such as A1 or
$E$11), or a range of cell addresses (such as B3:F12)
*/
function ADD(operands: number[][][]): number {
 let total: number = 0;
 operands.forEach(range => {
 range.forEach(row => {
 row.forEach(num => {
 total += num;
 });
 });
 });
 return total;
}
```
This function shows =CONTOSO.ADD([operands], [operands]...) in the Excel workbook.

|  |  | =CONTOSO.ADD(1, 2 |                                        |  |  |
|--|--|-------------------|----------------------------------------|--|--|
|  |  |                   | CONTOSO.ADD([operands], [operands],  ) |  |  |
|  |  |                   |                                        |  |  |
|  |  |                   |                                        |  |  |

#### **Repeating single value parameter**

A repeating single value parameter allows multiple single values to be passed. For example, the user could enter **ADD(1,B2,3)**. The following sample shows how to declare a single value parameter.

{436}------------------------------------------------

```
/**
 * @customfunction
 * @param {number[]} singleValue An array of numbers that are repeating
parameters.
 */
function addSingleValue(singleValue) {
 let total = 0;
 singleValue.forEach(value => {
 total += value;
 })
 return total;
}
```
#### **Single range parameter**

A single range parameter isn't technically a repeating parameter, but it's included here because the declaration is very similar to repeating parameters. It would appear to the user as **ADD(A2:B3)**, where a single range is passed from Excel. The following sample shows how to declare a single range parameter.

```
JS
/**
 * @customfunction
 * @param {number[][]} singleRange
 */
function addSingleRange(singleRange) {
 let total = 0;
 singleRange.forEach(setOfSingleValues => {
 setOfSingleValues.forEach(value => {
 total += value;
 })
 })
 return total;
}
```
### **Repeating range parameter**

A repeating range parameter allows multiple ranges or numbers to be passed. For example, the user could enter **ADD(5,B2,C3,8,E5:E8)**. Repeating ranges are usually specified with the type number[][][] as they are three-dimensional matrices. For a sample, see the main sample listed for repeating parameters.

### **Declare repeating parameters**

{437}------------------------------------------------

To declare a repeating parameter, indicate that the parameter is multi-dimensional. For example in TypeScript, ADD(values: number[]) would indicate a one-dimensional array, ADD(values:number[][]) would indicate a two-dimensional array, and so on. In JavaScript, use @param values {number[]} for one-dimensional arrays, @param <name> {number[][]} for twodimensional arrays, and so on for more dimensions.

For manually-created JSON metadata, ensure that the parameter is specified as "repeating": true and "dimensionality": "matrix" in your JSON file.

## **Invocation parameter**

Every custom function is automatically passed an invocation argument as the last input parameter, even if it's not explicitly declared. This invocation parameter corresponds to the [Invocation](https://learn.microsoft.com/en-us/javascript/api/custom-functions-runtime/customfunctions.invocation) object. The Invocation object can be used to retrieve additional context, such as the address of the cell that invoked your custom function. To access the Invocation object, you must declare invocation as the last parameter in your custom function.

7 **Note**

The invocation parameter doesn't appear as a custom function argument for users in Excel.

The following sample shows how to use the invocation parameter to return the address of the cell that invoked your custom function. This sample uses the [address](https://learn.microsoft.com/en-us/javascript/api/custom-functions-runtime/customfunctions.invocation#custom-functions-runtime-customfunctions-invocation-address-member) property of the Invocation object. To access the Invocation object, first declare CustomFunctions.Invocation as a parameter in your JSDoc. Next, declare @requiresAddress in your JSDoc to access the address property of the Invocation object. Finally, within the function, retrieve and then return the address property.

JavaScript /** * Return the address of the cell that invoked the custom function. * @customfunction * @param {number} first First parameter. * @param {number} second Second parameter. * @param {CustomFunctions.Invocation} invocation Invocation object. * @requiresAddress */ function getAddress(first, second, invocation) { const address = invocation.address;

{438}------------------------------------------------

In Excel, a custom function calling the address property of the Invocation object will return the absolute address following the format SheetName!RelativeCellAddress in the cell that invoked the function. For example, if the input parameter is located on a sheet called **Prices** in cell F6, the returned parameter address value will be Prices!F6 .

#### 7 **Note**

If a blank space or any of the following characters is in a worksheet name: **~ ` ! @ # $ % ^ & ( ) - _ = + { } | ; : , ' < . >**, then the worksheet name in the returned address is enclosed in single quotation marks, so the format is 'SheetName'!RelativeCellAddress ; for example, 'Latest Prices'!F6 . If the single quotation mark (apostrophe) character, ', is in the name, the returned address has two such characters in a row; for example, 'Bob''s Region'!F6 .

The invocation parameter can also be used to send information to Excel. See Make a streaming function to learn more.

## **Detect the address of a parameter**

In combination with the invocation parameter, you can use the [Invocation](https://learn.microsoft.com/en-us/javascript/api/custom-functions-runtime/customfunctions.invocation) object to retrieve the address of a custom function input parameter. When invoked, the [parameterAddresses](https://learn.microsoft.com/en-us/javascript/api/custom-functions-runtime/customfunctions.invocation#custom-functions-runtime-customfunctions-invocation-parameteraddresses-member) property of the Invocation object allows a function to return the addresses of all input parameters.

This is useful in scenarios where input data types may vary. The address of an input parameter can be used to check the number format of the input value. The number format can then be adjusted prior to input, if necessary. The address of an input parameter can also be used to detect whether the input value has any related properties that may be relevant to subsequent calculations.

#### 7 **Note**

If you're working with **manually-created JSON metadata** to return parameter addresses instead of the **Yeoman generator for Office Add-ins**, the options object must have the requiresParameterAddresses property set to true , and the result object must have the dimensionality property set to matrix .

{439}------------------------------------------------

The following custom function takes in three input parameters, retrieves the parameterAddresses property of the Invocation object for each parameter, and then returns the addresses.

JavaScript /** * Return the addresses of three parameters. * @customfunction * @param {string} firstParameter First parameter. * @param {string} secondParameter Second parameter. * @param {string} thirdParameter Third parameter. * @param {CustomFunctions.Invocation} invocation Invocation object. * @returns {string[][]} The addresses of the parameters, as a 2-dimensional array. * @requiresParameterAddresses */ function getParameterAddresses(firstParameter, secondParameter, thirdParameter, invocation) { const addresses = [ [invocation.parameterAddresses[0]], [invocation.parameterAddresses[1]], [invocation.parameterAddresses[2]] ]; return addresses; }

When a custom function calling the parameterAddresses property runs, the parameter address is returned following the format SheetName!RelativeCellAddress in the cell that invoked the function. For example, if the input parameter is located on a sheet called **Costs** in cell D8, the returned parameter address value will be Costs!D8 . If the custom function has multiple parameters and more than one parameter address is returned, the returned addresses will spill across multiple cells, descending vertically from the cell that invoked the function.

#### 7 **Note**

If a blank space or any of the following characters is in a worksheet name: **~ ` ! @ # $ % ^ & ( ) - _ = + { } | ; : , ' < . >**, then the worksheet name in the returned address is enclosed in single quotation marks, so the format is 'SheetName'!RelativeCellAddress ; for example, 'Latest Prices'!F6 . If the single quotation mark (apostrophe) character, ', is in the name, the returned address has two such characters in a row; for example, 'Bob''s Region'!F6 .

## **Next steps**

{440}------------------------------------------------

Learn how to use volatile values in your custom functions.

## **See also**

- Receive and handle data with custom functions
- Autogenerate JSON metadata for custom functions
- Manually create JSON metadata for custom functions
- Create custom functions in Excel
- Excel custom functions tutorial

{441}------------------------------------------------

# **Handle and return errors from your custom function**

Article  07/21/2022

If something goes wrong while your custom function runs, return an error to inform the user. If you have specific parameter requirements, such as only positive numbers, test the parameters and throw an error if they aren't correct. You can also use a [try...catch](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/try...catch) block to catch any errors that occur while your custom function runs.

### **Detect and throw an error**

Let's look at a case where you need to ensure that a zip code parameter is in the correct format for the custom function to work. The following custom function uses a regular expression to check the zip code. If the zip code format is correct, then it will look up the city using another function and return the value. If the format isn't valid, the function returns a #VALUE! error to the cell.

TypeScript

```
/**
* Gets a city name for the given U.S. zip code.
* @customfunction
* @param {string} zipCode
* @returns The city of the zip code.
*/
function getCity(zipCode: string): string {
 let isValidZip = /(^\d{5}$)|(^\d{5}-\d{4}$)/.test(zipCode);
 if (isValidZip) return cityLookup(zipCode);
 let error = new
CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue, "Please
provide a valid U.S. zip code.");
 throw error;
}
```
## **The CustomFunctions.Error object**

The [CustomFunctions.Error](https://learn.microsoft.com/en-us/javascript/api/custom-functions-runtime/customfunctions.error) object is used to return an error back to the cell. When you create the object, specify which error you want to use by choosing one of the following ErrorCode enum values.

{442}------------------------------------------------

| ErrorCode enum<br>ErrorCode enum<br>value<br>value | Excel<br>Excel<br>cell<br>cell<br>value<br>value | Description<br>Description                                                                                                                                   |
|----------------------------------------------------|--------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| divisionByZero                                     | #DIV/0                                           | The function is attempting to divide by zero.                                                                                                                |
| invalidName                                        | #NAME?                                           | There is a typo in the function name. Note that this error is<br>supported as a custom function input error, but not as a custom<br>function output error.   |
| invalidNumber                                      | #NUM!                                            | There is a problem with a number in the formula.                                                                                                             |
| invalidReference                                   | #REF!                                            | The function refers to an invalid cell. Note that this error is<br>supported as a custom function input error, but not as a custom<br>function output error. |
| invalidValue                                       | #VALUE!                                          | A value in the formula is of the wrong type.                                                                                                                 |
| notAvailable                                       | #N/A                                             | The function or service isn't available.                                                                                                                     |
| nullReference                                      | #NULL!                                           | The ranges in the formula don't intersect.                                                                                                                   |

The following code sample shows how to create and return an error for an invalid number ( #NUM! ).

| TypeScript                                                                                         |
|----------------------------------------------------------------------------------------------------|
| let error = new<br>CustomFunctions.Error(CustomFunctions.ErrorCode.invalidNumber);<br>throw error; |

The #VALUE! and #N/A errors also support custom error messages. Custom error messages are displayed in the error indicator menu, which is accessed by hovering over the error flag on each cell with an error. The following example shows how to return a custom error message with the #VALUE! error.

```
TypeScript
// You can only return a custom error message with the #VALUE! and #N/A
errors.
let error = new
CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue, "The parameter
can only contain lowercase characters.");
throw error;
```
### **Handle errors when working with dynamic arrays**

{443}------------------------------------------------

In addition to returning a single error, a custom function can output a dynamic array that includes an error. For example, a custom function could output the array [1], [#NUM!],[3] . The following code sample shows how to input three parameters into a custom function, replace one of the input parameters with a #NUM! error, and then return a 2-dimensional array with the results of processing each input parameter.

```
JavaScript
/**
* Returns the #NUM! error as part of a 2-dimensional array.
* @customfunction
* @param {number} first First parameter.
* @param {number} second Second parameter.
* @param {number} third Third parameter.
* @returns {number[][]} Three results, as a 2-dimensional array.
*/
function returnInvalidNumberError(first, second, third) {
 // Use the `CustomFunctions.Error` object to retrieve an invalid number
error.
 const error = new CustomFunctions.Error(
 CustomFunctions.ErrorCode.invalidNumber, // Corresponds to the #NUM!
error in the Excel UI.
 );
 // Enter logic that processes the first, second, and third input
parameters.
 // Imagine that the second calculation results in an invalid number error.
 const firstResult = first;
 const secondResult = error;
 const thirdResult = third;
 // Return the results of the first and third parameter calculations and a
#NUM! error in place of the second result. 
 return [[firstResult], [secondResult], [thirdResult]];
}
```
#### **Errors as custom function inputs**

A custom function can evaluate even if the input range contains an error. For example, a custom function can take the range **A2:A7** as an input, even if **A6:A7** contains an error.

To process inputs that contain errors, a custom function must have the JSON metadata property allowErrorForDataTypeAny set to true . See Manually create JSON metadata for custom functions for more information.

) **Important**

{444}------------------------------------------------

The allowErrorForDataTypeAny property can only be used with **manually created JSON metadata**. This property doesn't work with the autogenerated JSON metadata process.

### **Use try...catch blocks**

In general, use [try...catch](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/try...catch) blocks in your custom function to catch any potential errors that occur. If you don't handle exceptions in your code, they will be returned to Excel. By default, Excel returns #VALUE! for unhandled errors or exceptions.

In the following code sample, the custom function makes a fetch call to a REST service. It's possible that the call will fail, for example, if the REST service returns an error or the network goes down. If this happens, the custom function will return #N/A to indicate that the web call failed.

```
TypeScript
/**
 * Gets a comment from the hypothetical contoso.com/comments API.
 * @customfunction
 * @param {number} commentID ID of a comment.
 */
function getComment(commentID) {
 let url = "https://www.contoso.com/comments/" + commentID;
 return fetch(url)
 .then(function (data) {
 return data.json();
 })
 .then(function (json) {
 return json.body;
 })
 .catch(function (error) {
 throw new
CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable);
 })
}
```
### **Next steps**

Learn how to troubleshoot problems with your custom functions.

## **See also**

- Custom functions debugging

{445}------------------------------------------------

- [Custom functions requirement sets](https://learn.microsoft.com/en-us/javascript/api/requirement-sets/excel/custom-functions-requirement-sets)
- Create custom functions in Excel

{446}------------------------------------------------

# **Autogenerate JSON metadata for custom functions**

07/11/2025

When an Excel custom function is written in JavaScript or TypeScript, [JSDoc tags](https://jsdoc.app/) are used to provide extra information about the custom function. We provide a [Webpack](https://webpack.js.org/) plugin that uses these JSDoc tags to automatically create the JSON metadata file at build time. Using the plugin saves you from the effort of manually editing the JSON metadata file.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on the web
- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
	- volume-licensed perpetual Office 2021 and later
- Office on Mac

Excel custom functions aren't currently supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier on Windows

#### 7 **Note**

The unified manifest for Microsoft 365 doesn't currently support custom functions projects. You must use the add-in only manifest for custom functions projects. For more information, see **Office Add-ins manifest**.

## **CustomFunctionsMetadataPlugin**

The plugin is [CustomFunctionsMetadataPlugin](https://github.com/OfficeDev/Office-Addin-Scripts/blob/master/packages/custom-functions-metadata-plugin/README.md) . To install and configure it, use the following steps.

7 **Note**

{447}------------------------------------------------

- The tool can be used only in a NodeJS-based project.
- These instructions assume that your project uses **[Webpack](https://webpack.js.org/)** and that you have it installed and configured.
- If your custom function add-in project is created with the **Yeoman generator for Office Add-ins**, Webpack is installed and all of these steps are done automatically, but when applicable, you must do the steps in **Multiple custom function source files** manually.
- 1. Open a Command Prompt or bash shell and, in the root of the project, run npm install custom-functions-metadata-plugin .
- 2. Open the webpack.config.js file and add the following line at the top: const CustomFunctionsMetadataPlugin = require("custom-functions-metadata-plugin"); .
- 3. Scroll down to the plugins array and add the following to the top of the array. Change the input path and filename as needed to match your project, but the output value must be "functions.json" . If you're using TypeScript, use the *.ts source file name, *not* the transpiled *.js file.

```
JavaScript
new CustomFunctionsMetadataPlugin({
 output: "functions.json",
 input: "./src/functions/functions.js", 
}),
```
### **Multiple custom function source files**

If, and only if, you have organized your custom functions into multiple source files, there are additional steps.

- 1. In the webpack.config.js file, replace the string value of input with an array of string URLs that point to each of the files. The following is an example:

```
JavaScript
new CustomFunctionsMetadataPlugin({
 output: "functions.json",
 input: [
 "./src/functions/someFunctions.js", 
 "./src/functions/otherFunctions.js"
```

{448}------------------------------------------------

- ], }),
- 2. Scroll to the entry.functions property, and replace its value with the same array you used in the preceding step. The following is an example:

```
JavaScript
entry: {
 polyfill: ["core-js/stable", "regenerator-runtime/runtime"],
 taskpane: ["./src/taskpane/taskpane.js", "./src/taskpane/taskpane.html"],
 functions: [
 "./src/functions/someFunctions.js", 
 "./src/functions/otherFunctions.js"
 ],
 },
```
### **Run the tool**

You don't have to do anything to run the tool. When Webpack runs, it creates the functions.json file and puts it in memory in development mode, or in the /dist folder in production mode.

## **Basics of JSDoc tags**

Add the @customfunction tag in the code comments for a JavaScript or TypeScript function to mark it as a custom function.

The function parameter types may be provided using the @param tag in JavaScript, or from the [Function type](https://www.typescriptlang.org/docs/handbook/functions.html) in TypeScript. For more information, see the @param tag and Types sections.

### **Add a description to a function**

The description is displayed to the user as help text when they need help to understand what your custom function does. The description doesn't require any specific tag. Just enter a short text description in the JSDoc comment. In general the description is placed at the start of the JSDoc comment section, but it will work no matter where it is placed.

To see examples of the built-in function descriptions, open Excel, go to the **Formulas** tab, and choose **Insert function**. You can then browse through all the function descriptions, and also see your own custom functions listed.

{449}------------------------------------------------

In the following example, the phrase "Calculates the volume of a sphere." is the description for the custom function.

```
JavaScript
/**
/* Calculates the volume of a sphere.
/* @customfunction VOLUME
...
 */
```
### **Supported JSDoc tags**

The following JSDoc tags are supported in Excel custom functions.

- @cancelable
- @capturesCallingObject
- @customenum *{type}*
- @customfunction *id name*
- @excludeFromAutoComplete
- @helpurl *url*
- @linkedEntityLoadService
- @param *{type} name description*
- @requiresAddress
- @requiresParameterAddresses
- @returns *{type}*
- @streaming
- @volatile

### **@cancelable**

Indicates that a custom function performs an action when the function is canceled.

The last function parameter must be of type CustomFunctions.CancelableInvocation . The function can assign a function to the oncanceled property to denote the result when the function is canceled.

If the last function parameter is of type CustomFunctions.CancelableInvocation , it will be considered @cancelable even if the tag isn't present.

A function can't have both @cancelable and @streaming tags.

{450}------------------------------------------------

### **@capturesCallingObject**

This tag works with Excel data types. It specifies that the data type being referenced by the custom function is passed as the first argument to the custom function. For more information, see Reference the entity value as a calling object.

#### **@customenum**

Syntax: @customenum *{type}*

This tag indicates that a set of values is a custom enum. For more information, see Create custom enums for your custom functions.

#### **@customfunction**

Syntax: @customfunction *id name*

This tag indicates that the JavaScript/TypeScript function is an Excel custom function. It is required to create metadata for the custom function.

The following shows an example of this tag.

```
JavaScript
/**
 * Increments a value once a second.
 * @customfunction
 * ...
 */
```
#### **id**

The id identifies a custom function.

- If id isn't provided, the JavaScript/TypeScript function name is converted to uppercase and disallowed characters are removed.
- The id must be unique for all custom functions.
- The allowed characters are limited to: A-Z, a-z, 0-9, underscores (_), and period (.).

In the following example, increment is the id and the name of the function.

```
JavaScript
```

{451}------------------------------------------------

```
/**
 * Increments a value once a second.
 * @customfunction INCREMENT
 * ...
 */
```
#### **name**

Provides the display name for the custom function.

- If name isn't provided, the id is also used as the name.
- Allowed characters: Letters [Unicode Alphabetic character](https://www.unicode.org/reports/tr44/tr44-22.html#Alphabetic) , numbers, period (.), and underscore (_).
- Must start with a letter.
- Maximum length is 128 characters.

In the following example, INC is the id of the function and increment is the name .

```
JavaScript
/**
 * Increments a value once a second.
 * @customfunction INC INCREMENT
 * ...
 */
```
### **description**

A description appears to users in Excel as they are entering the function and specifies what the function does. A description doesn't require any specific tag. Add a description to a custom function by adding a phrase to describe what the function does inside the JSDoc comment. By default, whatever text is untagged in the JSDoc comment section will be the description of the function.

In the following example, the phrase "A function that adds two numbers" is the description for the custom function with the id property of ADD .

JavaScript /** * A function that adds two numbers. * @customfunction ADD

{452}------------------------------------------------

### **@excludeFromAutoComplete**

The @excludeFromAutoComplete tag ensures that the custom function doesn't appear in the formula AutoComplete menu in Excel. For more information, see Exclude custom functions from the Excel UI.

A function can't have both @excludeFromAutoComplete and @linkedEntityLoadService tags.

### **@helpurl**

Syntax: @helpurl *url*

The provided *url* is displayed in Excel.

In the following example, the helpurl is http://www.contoso.com/weatherhelp .

JavaScript /** * A function which streams the temperature in a town you specify. * @customfunction getTemperature * @helpurl http://www.contoso.com/weatherhelp * ... */

### **@linkedEntityLoadService**

The @linkedEntityLoadService tag designates that the function is a linked entity load service that returns linked entity cell values for linked entity IDs requested by Excel.

A function can't have both @excludeFromAutoComplete and @linkedEntityLoadService tags.

### **@param**

#### **JavaScript**

JavaScript Syntax: @param {type} *name description*

{453}------------------------------------------------

- {type} specifies the type info within curly braces. See the Types section for more information about the types which may be used. If no type is specified, the default type any will be used.
- name specifies the parameter that the @param tag applies to. It is required.
- description provides the description which appears in Excel for the function parameter. It is optional.

To denote a custom function parameter as optional, put square brackets around the parameter name. For example, @param {string} [text] Optional text .

The following example shows an ADD function that adds two or three numbers, with the third number as an optional parameter.

JavaScript /** * A function which sums two, or optionally three, numbers. * @customfunction ADDNUMBERS * @param firstNumber {number} First number to add. * @param secondNumber {number} Second number to add. * @param [thirdNumber] {number} Optional third number you wish to add. * ... */

#### **TypeScript**

TypeScript Syntax: @param *name description*

- name specifies the parameter that the @param tag applies to. It is required.
- description provides the description which appears in Excel for the function parameter. It is optional.

See the Types section for more information about the function parameter types which may be used.

To denote a custom function parameter as optional, do one of the following:

- Use an optional parameter. For example: function f(text?: string)
- Give the parameter a default value. For example: function f(text: string = "abc")

{454}------------------------------------------------

For detailed description of the @param see: [JSDoc](https://jsdoc.app/tags-param.html)

7 **Note**

The default value for optional parameters is null .

The following example shows the add function that adds two numbers.

```
ts
/**
 * Adds two numbers.
 * @customfunction 
 * @param first First number
 * @param second Second number
 * @returns The sum of the two numbers.
 */
function add(first: number, second: number): number {
 return first + second;
}
```
### **@requiresAddress**

Indicates that the address of the cell where the function is being evaluated should be provided.

The last function parameter must be of type CustomFunctions.Invocation or a derived type to use @requiresAddress . When the function is called, the address property will contain the address.

The following sample shows how to use the invocation parameter in combination with @requiresAddress to return the address of the cell that invoked your custom function. See Invocation parameter for more information.

```
JavaScript
/**
 * Return the address of the cell that invoked the custom function. 
 * @customfunction
 * @param {number} first First parameter.
 * @param {number} second Second parameter.
 * @param {CustomFunctions.Invocation} invocation Invocation object. 
 * @requiresAddress 
 */
function getAddress(first, second, invocation) {
 const address = invocation.address;
```

{455}------------------------------------------------

#### **@requiresParameterAddresses**

Indicates that the function should return the addresses of input parameters.

The last function parameter must be of type CustomFunctions.Invocation or a derived type to use @requiresParameterAddresses . The JSDoc comment must also include an @returns tag specifying that the return value be a matrix, such as @returns {string[][]} or @returns {number[][]} . See Matrix types for additional information.

When the function is called, the parameterAddresses property will contain the addresses of the input parameters.

The following sample shows how to use the invocation parameter in combination with @requiresParameterAddresses to return the addresses of three input parameters. See Detect the address of a parameter for more information.

```
JavaScript
/**
 * Return the addresses of three parameters. 
 * @customfunction
 * @param {string} firstParameter First parameter.
 * @param {string} secondParameter Second parameter.
 * @param {string} thirdParameter Third parameter.
 * @param {CustomFunctions.Invocation} invocation Invocation object. 
 * @returns {string[][]} The addresses of the parameters, as a 2-dimensional
array.
 * @requiresParameterAddresses
 */
function getParameterAddresses(firstParameter, secondParameter, thirdParameter,
invocation) {
 const addresses = [
 [invocation.parameterAddresses[0]],
 [invocation.parameterAddresses[1]],
 [invocation.parameterAddresses[2]]
 ];
 return addresses;
}
```
### **@returns**

Syntax: @returns {*type*}

{456}------------------------------------------------

Provides the type for the return value.

If {type} is omitted, the TypeScript type info will be used. If there is no type info, the type will be any .

The following example shows the add function that uses the @returns tag.

```
ts
/**
 * Adds two numbers.
 * @customfunction 
 * @param first First number
 * @param second Second number
 * @returns The sum of the two numbers.
 */
function add(first: number, second: number): number {
 return first + second;
}
```
### **@streaming**

Used to indicate that a custom function is a streaming function.

The last parameter is of type CustomFunctions.StreamingInvocation<ResultType> . The function returns void .

Streaming functions don't return values directly, instead they call setResult(result: ResultType) using the last parameter.

Exceptions thrown by a streaming function are ignored. setResult() may be called with Error to indicate an error result. For an example of a streaming function and more information, see Make a streaming function.

Streaming functions can't be marked as @volatile.

### **@volatile**

A volatile function is one whose result isn't the same from one moment to the next, even if it takes no arguments or the arguments haven't changed. Excel re-evaluates cells that contain volatile functions, together with all dependents, every time that a calculation is done. For this reason, too much reliance on volatile functions can make recalculation times slow, so use them sparingly.

Streaming functions can't be volatile.

{457}------------------------------------------------

The following function is volatile and uses the @volatile tag.

```
JavaScript
/**
 * Simulates rolling a 6-sided die.
 * @customfunction
 * @volatile
 */
function roll6sided(): number {
 return Math.floor(Math.random() * 6) + 1;
}
```
# **Types**

By specifying a parameter type, Excel will convert values into that type before calling the function. If the type is any , no conversion will be performed.

### **Value types**

A single value may be represented using one of the following types: boolean , number , string .

### **Cell value type**

Use the type subfield cellValueType to specify that a custom function accept and return Excel data types. The type value must be any to use the cellValueType subfield. Accepted cellValueType values are:

- Excel.CellValue
- Excel.BooleanCellValue
- Excel.DoubleCellValue
- Excel.EntityCellValue
- Excel.ErrorCellValue
- Excel.LinkedEntityCellValue
- Excel.LocalImageCellValue
- Excel.StringCellValue
- Excel.WebImageCellValue

For a code sample using the Excel.EntityCellValue type, see Input an entity value.

{458}------------------------------------------------

### **Matrix type**

Use a two-dimensional array type to have the parameter or return value be a matrix of values. For example, the type number[][] indicates a matrix of numbers and string[][] indicates a matrix of strings.

### **Error type**

A non-streaming function can indicate an error by returning an Error type.

A streaming function can indicate an error by calling setResult() with an Error type.

#### **Promise**

A custom function can return a promise that provides the value when the promise is resolved. If the promise is rejected, then the custom function will throw an error.

### **Other types**

Any other type will be treated as an error.

## **Next steps**

Learn about naming and localization for custom functions.

# **See also**

- Manually create JSON metadata for custom functions
- Create custom functions in Excel

{459}------------------------------------------------

# **Manually create JSON metadata for custom functions**

07/11/2025

As described in the custom functions overview article, a custom functions project must include both a JSON metadata file and a script (either JavaScript or TypeScript) file to register a function, making it available for use. Custom functions are registered when the user runs the add-in for the first time and after that are available to the same user in all workbooks.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on the web
- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
	- volume-licensed perpetual Office 2021 and later
- Office on Mac

Excel custom functions aren't currently supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier on Windows

#### 7 **Note**

The unified manifest for Microsoft 365 doesn't currently support custom functions projects. You must use the add-in only manifest for custom functions projects. For more information, see **Office Add-ins manifest**.

We recommend using JSON autogeneration when possible instead of creating your own JSON file. Autogeneration is less prone to user error and the yo office scaffolded files already include this. For more information on JSDoc tags and the JSON autogeneration process, see Autogenerate JSON metadata for custom functions.

However, you can make a custom functions project from scratch. This process requires you to:

- Write your JSON file.

{460}------------------------------------------------

- Check that your manifest file is connected to your JSON file.
- Associate your functions' id and name properties in the script file in order to register your functions.

The following image explains the differences between using yo office scaffold files and writing JSON from scratch.

| Yo Office template                                 | No template                                  |
|----------------------------------------------------|----------------------------------------------|
| Create scaffolded files                            | Write JSON by hand                           |
| JSON automatically generates<br>from code comments | Associate functions to JSON                  |
|                                                    | <br>Reference JSON file in the<br>manifest |

#### 7 **Note**

Remember to connect your manifest to the JSON file you create, through the **<Resources>** section in your add-in only manifest file if you do not use the **Yeoman generator for Office Add-ins**.

## **Authoring metadata and connecting to the manifest**

Create a JSON file in your project and provide all the details about your functions in it, such as the function's parameters. See the following metadata example and the metadata reference for a complete list of function properties.

Ensure your add-in only manifest file references your JSON file in the **<Resources>** section, similar to the following example.

{461}------------------------------------------------

```
<Resources>
 <bt:Urls>
 <bt:Url id="JSON-URL"
DefaultValue="https://subdomain.contoso.com/config/customfunctions.json"/>
 <bt:Url id="JS-URL"
DefaultValue="https://subdomain.contoso.com/dist/win32/ship/index.win32.bundle"/>
 <bt:Url id="HTML-URL"
DefaultValue="https://subdomain.contoso.com/index.html"/>
 </bt:Urls>
 <bt:ShortStrings>
 <bt:String id="namespace" DefaultValue="CONTOSO"/>
 </bt:ShortStrings>
</Resources>
```
### **JSON metadata example**

JSON

The following example shows the contents of a JSON metadata file for an add-in that defines custom functions. The sections that follow this example provide detailed information about the individual properties within this JSON example.

```
JSON
{
 "allowCustomDataForDataTypeAny": true,
 "allowErrorForDataTypeAny": true,
 "functions": [
 {
 "id": "ADD",
 "name": "ADD",
 "description": "Add two numbers",
 "helpUrl": "http://www.contoso.com/help",
 "result": {
 "type": "number",
 "dimensionality": "scalar"
 },
 "parameters": [
 {
 "name": "first",
 "description": "first number to add",
 "type": "number",
 "dimensionality": "scalar"
 },
 {
 "name": "second",
 "description": "second number to add",
 "type": "number",
 "dimensionality": "scalar"
```
}

{462}------------------------------------------------

```
 ]
 },
 {
 "id": "GETDAY",
 "name": "GETDAY",
 "description": "Get the day of the week",
 "helpUrl": "http://www.contoso.com/help",
 "result": {
 "dimensionality": "scalar"
 },
 "parameters": []
 },
 {
 "id": "INCREMENTVALUE",
 "name": "INCREMENTVALUE",
 "description": "Count up from zero",
 "helpUrl": "http://www.contoso.com/help",
 "result": {
 "dimensionality": "scalar"
 },
 "parameters": [
 {
 "name": "increment",
 "description": "the number to be added each time",
 "type": "number",
 "dimensionality": "scalar"
 }
 ],
 "options": {
 "stream": true,
 "cancelable": true
 }
 },
 {
 "id": "GETPLANETS", 
 "name": "GETPLANETS", 
 "description": "A function that uses the custom enum as a parameter.", 
 "parameters": [ 
 { 
 "name": "value", 
 "type": "string", 
 "customEnumType": "PLANETS"
 }
 ]
 }
 ],
 "enums": [ 
 { 
 "id": "PLANETS", 
 "type": "string", 
 "values": [ 
 { 
 "name": "Mercury", 
 "value": "mercury", 
 "tooltip": "Mercury is the first planet from the sun."
```

{463}------------------------------------------------

```
 }, 
 { 
 "name": "Venus", 
 "value": "venus", 
 "tooltip": "Venus is the second planet from the sun."
 }
 ] 
 }
 ]
}
```
#### 7 **Note**

A complete sample JSON file is available in the **[OfficeDev/Excel-Custom-Functions](https://github.com/OfficeDev/Excel-Custom-Functions/blob/77760adb1dcc53469183049bea08196734dbc114/config/customfunctions.json)** GitHub repository's commit history. As the project has been adjusted to automatically generate JSON, a full sample of handwritten JSON is only available in previous versions of the project.

### **Metadata reference**

### **allowCustomDataForDataTypeAny**

The allowCustomDataForDataTypeAny property is a Boolean data type. Setting this value to true allows a custom function to accept data types as parameters and return values. To learn more, see Custom functions and data types.

#### 7 **Note**

Unlike most of the other JSON metadata properties, allowCustomDataForDataTypeAny is a top-level property and contains no sub-properties. See the preceding **JSON metadata code sample** for an example of how to format this property.

If your custom function uses the cellValueType parameter, then setting the

allowCustomDataForDataTypeAny isn't required to accept data types as parameters and return values.

### **allowErrorForDataTypeAny**

The allowErrorForDataTypeAny property is a Boolean data type. Setting the value to true allows a custom function to process errors as input values. All parameters with the type any or

{464}------------------------------------------------

any[][] can accept errors as input values when allowErrorForDataTypeAny is set to true . The default allowErrorForDataTypeAny value is false .

#### 7 **Note**

Unlike the other JSON metadata properties, allowErrorForDataTypeAny is a top-level property and contains no sub-properties. See the preceding **JSON metadata code sample** for an example of how to format this property.

#### **functions**

The functions property is an array of custom function objects. The following table lists the properties of each object.

####  **Expand table**

| Property    | Data<br>type | Required | Description                                                                                                                                                                               |
|-------------|--------------|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| description | string       | No       | The description of the function that end users see in Excel. For<br>example, Converts a Celsius value to Fahrenheit.                                                                      |
| helpUrl     | string       | No       | URL that provides information about the function. (It is displayed in a<br>task pane.) For example,<br>http://contoso.com/help/convertcelsiustofahrenheit.html .                          |
| id          | string       | Yes      | A unique ID for the function. This ID can only contain alphanumeric<br>characters and periods and should not be changed after it is set.                                                  |
| name        | string       | Yes      | The name of the function that end users see in Excel. In Excel, this<br>function name is prefixed by the custom functions namespace that's<br>specified in the add-in only manifest file. |
| options     | object       | No       | Enables you to customize some aspects of how and when Excel<br>executes the function. See options for details.                                                                            |
| parameters  | array        | Yes      | Array that defines the input parameters for the function. See<br>parameters for details.                                                                                                  |
| result      | object       | Yes      | Object that defines the type of information that is returned by the<br>function. See result for details.                                                                                  |

**enums**

{465}------------------------------------------------

The enums property is an array of [enum](https://www.typescriptlang.org/docs/handbook/enums.html) objects. The following table lists the properties of each object.

#### **Tip**

To learn about creating custom enums for your custom functions, see **Create custom enums for your custom functions**. To learn about editing metadata for custom enums, see **Edit custom enums in JSON metadata**.

####  **Expand table**

| Property | Data<br>type | Required | Description                                                                                     |
|----------|--------------|----------|-------------------------------------------------------------------------------------------------|
| name     | string       | Yes      | A brief description of the constant.                                                            |
| tooltip  | string       | No       | Additional information about the constant that can be shown as a<br>tooltip in user interfaces. |
| value    | string       | Yes      | The value of the constant.                                                                      |

### **options**

The options object enables you to customize some aspects of how and when Excel executes the function. The following table lists the properties of the options object.

| Property              | Data<br>type | Required                             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|-----------------------|--------------|--------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| cancelable            | Boolean      | No<br>Default<br>value is<br>false . | If true<br>, Excel calls the CancelableInvocation<br>handler whenever the user takes an action<br>that has the effect of canceling the function;<br>for example, manually triggering<br>recalculation or editing a cell that is<br>referenced by the function. Cancelable<br>functions are typically only used for<br>asynchronous functions that return a single<br>result and need to handle the cancellation of<br>a request for data. A function can't use both<br>the stream and cancelable properties. |
| capturesCallingObject | Boolean      | No                                   | If true<br>, the data type being referenced by<br>the custom function is passed as the first                                                                                                                                                                                                                                                                                                                                                                                                                 |

{466}------------------------------------------------

| Property                         | Data<br>type | Required                             | Description                                                                                                                                                                                                                                                                                                                                          |
|----------------------------------|--------------|--------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                  |              | Default<br>value is<br>false .       | argument to the custom function. For more<br>information, see Reference the entity value<br>as a calling object.                                                                                                                                                                                                                                     |
| excludeFromAutoComplete          | Boolean      | No<br>Default<br>value is<br>false . | If true<br>, the custom function doesn't appear<br>in the formula AutoComplete menu in Excel.<br>For more information, see Exclude custom<br>functions from the Excel UI. A function can't<br>have both excludeFromAutoComplete and<br>linkedEntityLoadService properties set to<br>true .                                                           |
| linkedEntityLoadService          | Boolean      | No<br>Default<br>value is<br>false . | If true<br>, the custom function provides a load<br>service that returns up-to-date linked entity<br>cell values for any linked entity IDs requested<br>by Excel. A function can't have both<br>excludeFromAutoComplete and<br>linkedEntityLoadService properties set to<br>true . For more information, see Linked<br>entity load service function. |
| requiresAddress                  | Boolean      | No<br>Default<br>value is<br>false . | If true<br>, your custom function can access the<br>address of the cell that invoked it. The<br>address property of the invocation<br>parameter contains the address of the cell<br>that invoked your custom function. A<br>function can't use both the stream and<br>requiresAddress properties.                                                    |
| requiresParameterAddresses       | Boolean      | No<br>Default<br>value is<br>false . | If true , your custom function can access the<br>addresses of the function's input parameters.<br>This property must be used in combination<br>with the dimensionality property of the<br>result object, and dimensionality must be<br>set to matrix<br>. See Detect the address of a<br>parameter for more information.                             |
| requiresStreamAddress            | Boolean      | No<br>Default<br>value is<br>false . | If true<br>, the function can access the address<br>of the cell calling the streaming function. The<br>address property of the invocation<br>parameter contains the address of the cell<br>that invoked your streaming function. The<br>function must also have stream set to true                                                                   |
| requiresStreamParameterAddresses | Boolean      | No<br>Default                        | If true<br>, the function can access the<br>parameter addresses of the cell calling the<br>streaming function. The parameterAddresses                                                                                                                                                                                                                |

{467}------------------------------------------------

| Property | Data<br>type | Required                             | Description                                                                                                                                                                                                                                                                                                                                                                                                     |
|----------|--------------|--------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|          |              | value is<br>false .                  | property of the invocation parameter<br>contains the parameter addresses for your<br>streaming function. The function must also<br>have stream set to true .                                                                                                                                                                                                                                                    |
| stream   | Boolean      | No<br>Default<br>value is<br>false . | If true<br>, the function can output repeatedly<br>to the cell even when invoked only once. This<br>option is useful for rapidly-changing data<br>sources, such as a stock price. The function<br>should have no return statement. Instead,<br>the result value is passed as the argument of<br>the StreamingInvocation.setResult callback<br>function. For more information, see Make a<br>streaming function. |
| volatile | Boolean      | No<br>Default<br>value is<br>false . | If true<br>, the function recalculates each time<br>Excel recalculates, instead of only when the<br>formula's dependent values have changed. A<br>function can't use both the stream and<br>volatile properties. If the stream and<br>volatile properties are both set to true ,<br>the volatile property will be ignored.                                                                                      |

#### **parameters**

The parameters property is an array of parameter objects. The following table lists the properties of each object.

| Property       | Data<br>type | Required | Description                                                                                                                         |
|----------------|--------------|----------|-------------------------------------------------------------------------------------------------------------------------------------|
| description    | string       | No       | A description of the parameter. This is displayed in Excel's<br>IntelliSense.                                                       |
| dimensionality | string       | No       | Must be either scalar (a non-array value) or matrix (a 2-<br>dimensional array).                                                    |
| name           | string       | Yes      | The name of the parameter. This name is displayed in Excel's<br>IntelliSense.                                                       |
| type           | string       | No       | The data type of the parameter. Can be boolean<br>, number<br>,<br>string , or any , which allows you to use of any of the previous |

{468}------------------------------------------------

| Property       | Data<br>type | Required | Description                                                                                                                                                                                                                                                                                                                                                                                                                  |
|----------------|--------------|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                |              |          | three types. If this property is not specified, the data type<br>defaults to any .                                                                                                                                                                                                                                                                                                                                           |
| cellValueType  | string       | No       | A subfield of the type property. Specifies the Excel data types<br>accepted by the custom function. Accepts the case-insensitive<br>values cellvalue<br>, booleancellvalue<br>, doublecellvalue<br>,<br>entitycellvalue , errorcellvalue<br>, linkedentitycellvalue<br>,<br>localimagecellvalue , stringcellvalue<br>, and webimagecellvalue<br>The type field must have the value any to use the<br>cellValueType subfield. |
| customEnumType | string       | No       | The id of the enum in the enums array. This associates the<br>custom enum with the function and enables Excel to display the<br>enum members in the formula AutoComplete menu.                                                                                                                                                                                                                                               |
| optional       | Boolean      | No       | If true<br>, the parameter is optional.                                                                                                                                                                                                                                                                                                                                                                                      |
| repeating      | Boolean      | No       | If true<br>, parameters populate from a specified array. Note that<br>all repeating parameters are considered optional parameters by<br>definition.                                                                                                                                                                                                                                                                          |

#### **Tip**

See the following code snippet for an example of how to format the cellValueType parameter in JSON metadata.

```
JSON
"parameters": [
 {
 "name": "range",
 "description": "the input range",
 "type": "any",
 "cellValueType": "webimagecellvalue"
 }
]
```
### **result**

The result object defines the type of information that is returned by the function. The following table lists the properties of the result object.

{469}------------------------------------------------

| Property       | Data<br>type | Required | Description                                                                                                                                                                                                          |
|----------------|--------------|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| dimensionality | string       | No       | Must be either scalar (a non-array value) or matrix (a 2-<br>dimensional array).                                                                                                                                     |
| type           | string       | No       | The data type of the result. Can be boolean<br>, number<br>, string<br>, or<br>any (which allows you to use of any of the previous three types).<br>If this property is not specified, the data type defaults to any |

### **Associate function names with JSON metadata**

For a function to work properly, you need to associate the function's id property with the JavaScript implementation. Make sure there is an association, otherwise the function won't be registered and isn't useable in Excel. The following code sample shows how to make the association using the CustomFunctions.associate() function. The sample defines the custom function add and associates it with the object in the JSON metadata file where the value of the id property is **ADD**.

```
JavaScript
/**
 * Add two numbers
 * @customfunction
 * @param {number} first First number
 * @param {number} second Second number
 * @returns {number} The sum of the two numbers.
 */
function add(first, second) {
 return first + second;
}
CustomFunctions.associate("ADD", add);
```
The following JSON shows the JSON metadata that is associated with the previous custom function JavaScript code.

```
JSON
{
 "functions": [
 {
 "description": "Add two numbers",
 "id": "ADD",
 "name": "ADD",
```

{470}------------------------------------------------

```
 "parameters": [
 {
 "description": "First number",
 "name": "first",
 "type": "number"
 },
 {
 "description": "Second number",
 "name": "second",
 "type": "number"
 }
 ],
 "result": {
 "type": "number"
 }
 }
 ]
}
```
Keep in mind the following best practices when creating custom functions in your JavaScript file and specifying corresponding information in the JSON metadata file.

- In the JSON metadata file, ensure that the value of each id property contains only alphanumeric characters and periods.
- In the JSON metadata file, ensure that the value of each id property is unique within the scope of the file. That is, no two function objects in the metadata file should have the same id value.
- Do not change the value of an id property in the JSON metadata file after it's been associated with a corresponding JavaScript function name. You can change the function name that end users see in Excel by updating the name property within the JSON metadata file, but you should never change the value of an id property after it's been established.
- In the JavaScript file, specify a custom function association using CustomFunctions.associate after each function.

The following sample shows the JSON metadata that corresponds to the functions defined in the preceding JavaScript code sample. The id and name property values are in uppercase, which is a best practice when describing your custom functions. You only need to add this JSON if you are preparing your own JSON file manually and not using autogeneration. For more information on autogeneration, see Autogenerate JSON metadata for custom functions.

{471}------------------------------------------------

```
{
 "$schema": "https://developer.microsoft.com/json-schemas/office-js/custom-
functions.schema.json",
 "functions": [
 {
 "id": "ADD",
 "name": "ADD",
 ...
 },
 {
 "id": "INCREMENT",
 "name": "INCREMENT",
 ...
 }
 ]
}
```
### **Edit custom enums in JSON metadata**

Create or edit enum metadata directly with the enums property. Each custom enum must have a unique ID value and type value of either string or number . Mixed type enums are not supported.

If you manually create the JSON metadata for your custom enum, you can associate those enums with either TypeScript or JavaScript custom functions. To learn more about creating custom enums, see Create custom enums for your custom functions.

The following JSON snippet shows the metadata for two enums: a PLANETS enum that contains the planets Mercury and Venus, and a DAYS enum that includes the days Monday and Tuesday.

```
JSON
"enums": [ 
 { 
 "id": "PLANETS", 
 "type": "string", 
 "values": [ 
 { 
 "name": "Mercury", 
 "value": "mercury", 
 "tooltip": "Mercury is the first planet from the sun."
 }, 
 { 
 "name": "Venus", 
 "value": "venus", 
 "tooltip": "Venus is the second planet from the sun."
 }
 ]
```

{472}------------------------------------------------

```
 },
 {
 "id": "DAYS", 
 "type": "number", 
 "values": [ 
 { 
 "name": "Monday",
 "value": 1,
 "tooltip": "Monday is the first working day of a week."
 },
 { 
 "name": "Tuesday",
 "value": 2,
 "tooltip": "Tuesday is the second working day of a week."
 }
 ] 
 }
]
```
Each constant in the values array of the enum is an object with the following properties.

- **value**: The value of the constant.
- **name**: A brief description of the constant.
- **tooltip** (Optional): Additional information about the constant that can be shown as a tooltip in user interfaces.

To associate the custom enum with a function, add the property customEnumType to the parameters object. The customEnumType value should match the id of the enum. Note that the customEnumType value is not case-sensitive. The following JSON snippet shows a functions object associated with the PLANETS enum.

```
JSON
"functions": [ 
 {
 "description": "A function that uses the custom enum as a parameter.", 
 "id": "GETPLANETS", 
 "name": "GETPLANETS", 
 "parameters": [ 
 { 
 "name": "value", 
 "type": "string", 
 "customEnumType": "PLANETS"
 }
 ], 
 "result": {} 
 } 
]
```

{473}------------------------------------------------

## **Next steps**

Learn the best practices for naming your function or discover how to localize your function using the previously described handwritten JSON method.

## **See also**

- Autogenerate JSON metadata for custom functions
- Custom functions parameter options
- Create custom functions in Excel

{474}------------------------------------------------

# **Create custom enums for your custom functions**

07/01/2025

Custom enums give users Excel AutoComplete options for your custom functions. The members in your enum show up in the formula bar as suggestions. The planets in the preceding screenshot are an example of a custom enum that provides a set list. This article describes how to create custom enums and use them as parameters in your custom functions.

## **Define the custom enum**

Define your enum with the JSDoc tag @customenum . The corresponding JSON properties are then autogenerated in your custom function metadata. For more information about JSDoc tags and custom functions, see Basics of JSDoc tags.

#### 7 **Note**

Custom enums created with the @customenum JSDoc tag are only supported in TypeScript. They are not supported in JavaScript. To use custom enums with JavaScript functions, you must manually create your own JSON metadata. To learn more, see **Manually create JSON metadata**.

The following code snippet shows how to define and use a simple custom enum as a parameter.

{475}------------------------------------------------

```
TypeScript
```

```
/** 
 * A custom enum with descriptions and tooltips. 
 * @customenum {string} 
 */
enum PLANETS { 
 /** Mercury is the first planet from the sun. */
 mercury = "Mercury", 
 /** Venus is the second planet from the sun. */
 venus = "Venus", 
 /** Earth is the third planet from the sun. */
 earth = "Earth", 
} 
/** 
 * A sample function that uses the custom enum as a parameter.
 * @customfunction 
 */
function getPlanets(value: PLANETS): any { 
 return value; 
}
```
### **Use a custom enum multiple times**

A custom enum can be reused in multiple functions, and it can be used as multiple parameters of a single function. A function can also have multiple enums as parameters at the same time. An enum parameter can be repeating or optional.

The following code sample shows a NUMBERS enum and a custom function that uses the enum multiple times as an input value.

```
TypeScript
/**
* Enum of numbers with descriptions and tooltips.
* @customenum {number}
*/
enum NUMBERS {
 /** One */
 One = 1,
 /** Two */
 Two = 2,
 /** Three */
 Three = 3,
```

{476}------------------------------------------------

```
 /** Four */
 Four = 4,
 /** Five */
 Five = 5
} 
/**
* Enter multiple numbers from the NUMBERS enum and get the sum.
* @customfunction
* @param input Enter enum numbers.
* @returns
*/
function addNumbers(input: NUMBERS[]): any {
 const sum = input.reduce((acc, num) => acc + num, 0); 
 return "Sum: " + sum; 
}
```
### **Localize your custom enums**

Localizing custom enums is similar to localizing custom functions. You must manually create your JSON metadata and then create a new JSON metadata file for each language.

Note that only the name and tooltip properties within an enum should be localized to the target language. The value property should remain unchanged to avoid the need for handling multiple languages within your function body.

The following JSON snippet shows the Chinese language localized values object for the planet Mercury.

```
JSON
"enums": [
 {
 "id": "PLANETS",
 "type": "string",
 "values": [
 {
 "name": "", 
 "value": "mercury",
 "tooltip": ""
 }
 ]
 }
],
```
## **Backwards compatibility**

{477}------------------------------------------------

Custom enums offer backwards compatibility. On older versions of Excel, parameters using a custom enum work as standard parameters without displaying in the Excel AutoComplete list.

## **See also**

- Manually create JSON metadata for custom functions
- Autogenerate JSON metadata for custom functions

{478}------------------------------------------------

# **Call Excel JavaScript APIs from a custom function**

Article  03/28/2023

Call Excel JavaScript APIs from your custom functions to get range data and obtain more context for your calculations. Calling Excel JavaScript APIs through a custom function can be helpful when:

- A custom function needs to get information from Excel before calculation. This information might include document properties, range formats, custom XML parts, a workbook name, or other Excel-specific information.
- A custom function will set the cell's number format for the return values after calculation.

#### ) **Important**

To call Excel JavaScript APIs from your custom function, you'll need to use a **shared runtime**. Use the **Yeoman generator for Office Add-ins** to install an **Excel Custom Functions using a Shared Runtime** project or see **Configure your Office Add-in to use a shared runtime** to learn more.

## **Code sample**

To call Excel JavaScript APIs from a custom function, you first need a context. Use the [Excel.RequestContext](https://learn.microsoft.com/en-us/javascript/api/excel/excel.requestcontext) object to get a context. Then use the context to call the APIs you need in the workbook.

The following code sample shows how to use Excel.RequestContext to get a value from a cell in the workbook. In this sample, the address parameter is passed into the Excel JavaScript API [Worksheet.getRange](https://learn.microsoft.com/en-us/javascript/api/excel/excel.worksheet#excel-excel-worksheet-getrange-member(1)) method and must be entered as a string. For example, the custom function entered into the Excel UI must follow the pattern =CONTOSO.GETRANGEVALUE("A1") , where "A1" is the address of the cell from which to retrieve the value.

```
JavaScript
/**
 * @customfunction
 * @param {string} address The address of the cell from which to retrieve
the value.
```

{479}------------------------------------------------

```
 * @returns The value of the cell at the input address.
 **/
async function getRangeValue(address) {
 // Retrieve the context object. 
 const context = new Excel.RequestContext();
 // Use the context object to access the cell at the input address. 
 const range =
context.workbook.worksheets.getActiveWorksheet().getRange(address);
 range.load("values");
 await context.sync();
 // Return the value of the cell at the input address.
 return range.values[0][0];
}
```
## **Limitations of calling Excel JavaScript APIs through a custom function**

A custom functions add-in can call Excel JavaScript APIs, but you should be cautious about which APIs it calls. Don't call Excel JavaScript APIs from a custom function that change cells outside of the cell running the custom function. Changing other cells or the Excel environment can result in poor performance, time outs, and infinite loops in the Excel application. This means your custom functions shouldn't do any of the following:

- Insert, delete, or format cells on the spreadsheet.
- Change another cell's value.
- Move, rename, delete, or add sheets to a workbook.
- Add names to a workbook.
- Set properties.
- Change any of the Excel environment options, such as calculation mode or screen views.

Your custom functions add-in can read information from cells outside the cell running the custom function, but it shouldn't perform write operations to other cells. Instead, make changes to other cells or to the Excel environment from the context of a ribbon button or a task pane. In addition, custom function calculations shouldn't run while an Excel recalculation is taking place, as this scenario creates unpredictable results.

## **Next steps**

- Fundamental programming concepts with the Excel JavaScript API

{480}------------------------------------------------

## **See also**

- Share data and events between Excel custom functions and task pane tutorial
- Configure your Office Add-in to use a shared runtime

{481}------------------------------------------------

# **Use data types with custom functions in Excel**

06/27/2025

Data types expand the Excel JavaScript API to support data types beyond the original four cell value types (string, number, boolean, and error). Data types include support for web images, formatted numbers, entities, and arrays within entities.

These data types amplify the power of custom functions, because custom functions accept data types as both input and output values. You can generate data types through custom functions, or take existing data types as function arguments into calculations. Once the JSON schema of a data type is set, this schema is maintained throughout the calculations.

To learn more about using data types with an Excel add-in, see Overview of data types in Excel add-ins.

### **How custom functions handle data types**

Custom functions can recognize data types and accept them as parameter values. A custom function can create a new data type for a return value. Custom functions use the same JSON schema for data types as the Excel JavaScript API, and this JSON schema is maintained as custom functions calculate and evaluate.

#### 7 **Note**

Custom functions do not support the full functionality of the enhanced error objects offered by data types. A custom function can accept a data types error object, but it won't be maintained throughout calculation. At this time, custom functions only support the errors included in the **CustomFunctions.Error object**.

## **Enable data types for custom functions**

Custom functions projects include a JSON metadata file. This JSON metadata file differs from the JSON schema used by data types APIs. To use the data types integration with custom functions, the custom functions JSON metadata file must be manually updated to include the property allowCustomDataForDataTypeAny . Set this property to true .

For a full description of the manual JSON metadata creation process, see Manually create JSON metadata for custom functions. See allowCustomDataForDataTypeAny for additional details

{482}------------------------------------------------

about this property.

## **Output a formatted number**

The following code sample shows how to create a formatted number with a custom function. This uses the [DoubleCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.doublecellvalue) object. The function takes a basic number and a format setting as the input parameters and returns a formatted number as double data type for the output.

```
JavaScript
/**
 * Take a number as the input value and return a double as the output.
 * @customfunction
 * @param {number} value
 * @param {string} format (e.g. "0.00%")
 * @returns A formatted number value.
 */
function createFormattedNumber(value, format) {
 return {
 type: "Double",
 basicValue: value,
 numberFormat: format
 }
}
```
## **Input an entity value**

The following code sample shows a custom function that takes an [EntityCellValue](https://learn.microsoft.com/en-us/javascript/api/excel/excel.entitycellvalue) data type as an input. If the attribute parameter is set to text , then the function returns the text property of the entity value. Otherwise, the function returns the basicValue property of the entity value.

```
JavaScript
/**
 * Accept an entity value data type as a function input.
 * @customfunction
 * @param {Excel.EntityCellValue} value
 * @param {string} attribute
 * @returns {any} The text value of the entity.
 */
function getEntityAttribute(value, attribute) {
 if (value.type == "Entity") {
 if (attribute == "text") {
 return value.text;
 } else {
 return value.properties[attribute].basicValue;
 }
```

{483}------------------------------------------------

```
 } else {
 return JSON.stringify(value);
 }
}
```
## **Next steps**

To experiment with custom functions and data types, install Script Lab in Excel and try out the [Data types: Custom functions](https://github.com/OfficeDev/office-js-snippets/blob/prod/samples/excel/16-custom-functions/data-types-custom-functions.yaml) snippet in our **Samples** library.

## **See also**

- Overview of data types in Excel add-ins
- Excel data types core concepts
- Configure your Office Add-in to use a shared runtime

{484}------------------------------------------------

# **Work with formula value preview mode in your custom functions**

Article  05/15/2025

You can control how your custom function calculates results when participating in formula value preview mode. Formula value preview mode is a feature that allows end users to select portions of a formula while editing the cell to preview the values. This feature helps users evaluate the formula as they edit it. The following image shows an example of the user editing a formula and selecting the text A1+A2 . The formula preview mode shows the value 7 above.

| (7)<br>Tables |            |        |  |   |                    |  |  |
|---------------|------------|--------|--|---|--------------------|--|--|
| A4            |            | :<br>V |  |   |   fx > =A1+A2+A3 |  |  |
|               | A          | B      |  | C | D                  |  |  |
| -             | 3          |        |  |   |                    |  |  |
| w N           | 4          |        |  |   |                    |  |  |
|               | 51         |        |  |   |                    |  |  |
| 4             | = A1+A2+A3 |        |  |   |                    |  |  |
| 5             |            |        |  |   |                    |  |  |

By default, custom functions (for example =getHousePrice(A1) ) can be previewed by the user. However, the following list shows some scenarios in which you may want to control how your custom function participates in formula value preview mode.

- Your custom function calls one or more APIs that charge a rate for using them.
- Your custom function accesses one or more scarce resources such as databases.
- Your custom function takes significant time to calculate the result, and it wouldn't be useful for a user during preview purposes.

You can change the behavior of your custom function to return a mock value instead. To do this use the invocation.isInValuePreview read-only property. The following code sample shows an example custom function named getHousePrice that looks up house prices through a monetized API. If isInValuePreview is true , the custom function returns a mock number to be used and avoids incurring any cost. If isInValuePreview is false , the custom function calls the API and returns the actual house price value for use in the Excel spreadsheet.

#### JavaScript

- /**
- * Get the listing price for a house on the market for the given address.
- * @customfunction
- * @param address The address of the house.
- * @param invocation Custom function handler.
- * @returns The price of the house at the address.

{485}------------------------------------------------

```
*/
export function getHousePrice(address: string, invocation:
CustomFunctions.Invocation): number {
 // Check if this call is for formula value preview mode.
 if (invocation.isInValuePreview) { 
 // Avoid long-running expensive service calls. 
 // Return a useable but fake number.
 return 450000; 
 } else { 
 // Make the actual service calls in this block. 
 const price = callHouseServiceAPI(address);
 return price; 
 } 
}
```
## **See also**

- Create custom functions in Excel

{486}------------------------------------------------

# **Batch custom function calls for a remote service**

Article  03/09/2023

If your custom functions call a remote service you can use a batching pattern to reduce the number of network calls to the remote service. To reduce network round trips you batch all the calls into a single call to the web service. This is ideal when the spreadsheet is recalculated.

For example, if someone used your custom function in 100 cells in a spreadsheet, and then recalculated the spreadsheet, your custom function would run 100 times and make 100 network calls. By using a batching pattern, the calls can be combined to make all 100 calculations in a single network call.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
- Office on Mac
- Office on the web

Excel custom functions are currently not supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier

## **View the completed sample**

To view the completed sample, follow this article and paste the code examples into your own project. For example, to create a new custom function project for TypeScript use the Yeoman generator for Office Add-ins, then add all the code from this article to the project. Run the code and try it out.

[Alternatively, download or view the complete sample project at Custom function](https://github.com/OfficeDev/Office-Add-in-samples/tree/main/Excel-custom-functions/Batching) batching pattern . If you want to view the code in whole before reading any further, take a look at the [script file](https://github.com/OfficeDev/Office-Add-in-samples/blob/main/Excel-custom-functions/Batching/src/functions/functions.js) .

{487}------------------------------------------------

## **Create the batching pattern in this article**

To set up batching for your custom functions you'll need to write three main sections of code.

- 1. A push operation to add a new operation to the batch of calls each time Excel calls your custom function.
- 2. A function to make the remote request when the batch is ready.
- 3. Server code to respond to the batch request, calculate all of the operation results, and return the values.

In the following sections, you'll learn how to construct the code one example at a time. It's recommended you create a brand-new custom functions project using the Yeoman generator for Office Add-ins generator. To create a new project, see Get started developing Excel custom functions. You can use TypeScript or JavaScript.

## **Batch each call to your custom function**

Your custom functions work by calling a remote service to perform the operation and calculate the result they need. This provides a way for them to store each requested operation into a batch. Later you'll see how to create a _pushOperation function to batch the operations. First, take a look at the following code example to see how to call _pushOperation from your custom function.

In the following code, the custom function performs division but relies on a remote service to do the actual calculation. It calls _pushOperation to batch the operation along with other operations to the remote service. It names the operation **div2**. You can use any naming scheme you want for operations as long as the remote service is also using the same scheme (more on the remote service later). Also, the arguments the remote service will need to run the operation are passed.

### **Add the div2 custom function**

Add the following code to your **functions.js** or **functions.ts** file (depending on if you used JavaScript or TypeScript).

```
JavaScript
/**
 * Divides two numbers using batching
 * @CustomFunction
 * @param dividend The number being divided
 * @param divisor The number the dividend is divided by
```

{488}------------------------------------------------

```
 * @returns The result of dividing the two numbers
 */
function div2(dividend, divisor) {
 return _pushOperation("div2", [dividend, divisor]);
}
```
### **Add global variables for tracking batch requests**

Next, add two global variables to your **functions.js** or **functions.ts** file.

_isBatchedRequestScheduled is important later for timing batch calls to the remote service.

```
JavaScript
let _batch = [];
let _isBatchedRequestScheduled = false;
```
### **Add the _pushOperation function**

When Excel calls your custom function, you need to push the operation into the batch array. The following **_pushOperation** function code shows how to add a new operation from a custom function. It creates a new batch entry, creates a new promise to resolve or reject the operation, and pushes the entry into the batch array.

This code also checks to see if a batch is scheduled. In this example, each batch is scheduled to run every 100ms. You can adjust this value as needed. Higher values result in bigger batches being sent to the remote service, and a longer wait time for the user to see results. Lower values tend to send more batches to the remote service, but with a quick response time for users.

The function creates an **invocationEntry** object that contains the string name of which operation to run. For example, if you had two custom functions named multiply and divide , you could reuse those as the operation names in your batch entries. args holds the arguments that were passed to your custom function from Excel. And finally, resolve or reject methods store a promise holding the information the remote service returns.

Add the following code to your **functions.js** or **functions.ts** file.

#### JavaScript

// This function encloses your custom functions as individual entries, // which have some additional properties so you can keep track of whether or

{489}------------------------------------------------

```
not
// a request has been resolved or rejected.
function _pushOperation(op, args) {
 // Create an entry for your custom function.
 console.log("pushOperation");
 const invocationEntry = {
 operation: op, // e.g., sum
 args: args,
 resolve: undefined,
 reject: undefined,
 };
 // Create a unique promise for this invocation,
 // and save its resolve and reject functions into the invocation entry.
 const promise = new Promise((resolve, reject) => {
 invocationEntry.resolve = resolve;
 invocationEntry.reject = reject;
 });
 // Push the invocation entry into the next batch.
 _batch.push(invocationEntry);
 // If a remote request hasn't been scheduled yet,
 // schedule it after a certain timeout, e.g., 100 ms.
 if (!_isBatchedRequestScheduled) {
 console.log("schedule remote request");
 _isBatchedRequestScheduled = true;
 setTimeout(_makeRemoteRequest, 100);
 }
 // Return the promise for this invocation.
 return promise;
}
```
### **Make the remote request**

The purpose of the _makeRemoteRequest function is to pass the batch of operations to the remote service, and then return the results to each custom function. It first creates a copy of the batch array. This allows concurrent custom function calls from Excel to immediately begin batching in a new array. The copy is then turned into a simpler array that does not contain the promise information. It wouldn't make sense to pass the promises to a remote service since they would not work. The _makeRemoteRequest will either reject or resolve each promise based on what the remote service returns.

Add the following code to your **functions.js** or **functions.ts** file.

JavaScript

{490}------------------------------------------------

```
// This is a private helper function, used only within your custom function
add-in.
// You wouldn't call _makeRemoteRequest in Excel, for example.
// This function makes a request for remote processing of the whole batch,
// and matches the response batch to the request batch.
function _makeRemoteRequest() {
 // Copy the shared batch and allow the building of a new batch while you
are waiting for a response.
 // Note the use of "splice" rather than "slice", which will modify the
original _batch array
 // to empty it out.
 try{
 console.log("makeRemoteRequest");
 const batchCopy = _batch.splice(0, _batch.length);
 _isBatchedRequestScheduled = false;
 // Build a simpler request batch that only contains the arguments for each
invocation.
 const requestBatch = batchCopy.map((item) => {
 return { operation: item.operation, args: item.args };
 });
 console.log("makeRemoteRequest2");
 // Make the remote request.
 _fetchFromRemoteService(requestBatch)
 .then((responseBatch) => {
 console.log("responseBatch in fetchFromRemoteService");
 // Match each value from the response batch to its corresponding
invocation entry from the request batch,
 // and resolve the invocation promise with its corresponding response
value.
 responseBatch.forEach((response, index) => {
 if (response.error) {
 batchCopy[index].reject(new Error(response.error));
 console.log("rejecting promise");
 } else {
 console.log("fulfilling promise");
 console.log(response);
 batchCopy[index].resolve(response.result);
 }
 });
 });
 console.log("makeRemoteRequest3");
 } catch (error) {
 console.log("error name:" + error.name);
 console.log("error message:" + error.message);
 console.log(error);
 }
}
```

{491}------------------------------------------------

The _makeRemoteRequest function calls _fetchFromRemoteService which, as you'll see later, is just a mock representing the remote service. This makes it easier to study and run the code in this article. But when you want to use this code for an actual remote service you should make the following changes.

- Decide how to serialize the batch operations over the network. For example, you may want to put the array into a JSON body.
- Instead of calling _fetchFromRemoteService you need to make the actual network call to the remote service passing the batch of operations.

## **Process the batch call on the remote service**

The last step is to handle the batch call in the remote service. The following code sample shows the _fetchFromRemoteService function. This function unpacks each operation, performs the specified operation, and returns the results. For learning purposes in this article, the _fetchFromRemoteService function is designed to run in your web add-in and mock a remote service. You can add this code to your **functions.js** or **functions.ts** file so that you can study and run all the code in this article without having to set up an actual remote service.

Add the following code to your **functions.js** or **functions.ts** file.

```
JavaScript
// This function simulates the work of a remote service. Because each
service
// differs, you will need to modify this function appropriately to work with
the service you are using. 
// This function takes a batch of argument sets and returns a promise that
may contain a batch of values.
// NOTE: When implementing this function on a server, also apply an
appropriate authentication mechanism
// to ensure only the correct callers can access it.
async function _fetchFromRemoteService(requestBatch) {
 // Simulate a slow network request to the server.
 console.log("_fetchFromRemoteService");
 await pause(1000);
 console.log("postpause");
 return requestBatch.map((request) => {
 console.log("requestBatch server side");
 const { operation, args } = request;
 try {
 if (operation === "div2") {
 // Divide the first argument by the second argument.
 return {
 result: args[0] / args[1]
```

{492}------------------------------------------------

```
 };
 } else if (operation === "mul2") {
 // Multiply the arguments for the given entry.
 const myResult = args[0] * args[1];
 console.log(myResult);
 return {
 result: myResult
 };
 } else {
 return {
 error: `Operation not supported: ${operation}`
 };
 }
 } catch (error) {
 return {
 error: `Operation failed: ${operation}`
 };
 }
 });
}
function pause(ms) {
 console.log("pause");
 return new Promise((resolve) => setTimeout(resolve, ms));
}
```
### **Modify _fetchFromRemoteService for your live remote service**

To modify the _fetchFromRemoteService function to run in your live remote service, make the following changes.

- Depending on your server platform (Node.js or others) map the client network call to this function.
- Remove the pause function which simulates network latency as part of the mock.
- Modify the function declaration to work with the parameter passed if the parameter is changed for network purposes. For example, instead of an array, it may be a JSON body of batched operations to process.
- Modify the function to perform the operations (or call functions that do the operations).
- Apply an appropriate authentication mechanism. Ensure that only the correct callers can access the function.
- Place the code in the remote service.

## **Next steps**

{493}------------------------------------------------

Learn about the various parameters you can use in your custom functions. Or review the basics behind making a web call through a custom function.

## **See also**

- Volatile values in functions
- Create custom functions in Excel
- Excel custom functions tutorial

{494}------------------------------------------------

# **Extend custom functions with XLL add-ins**

07/29/2025

#### 7 **Note**

An XLL add-in is an Excel add-in file with the file extension **.xll**. An XLL file is a type of dynamic link library (DLL) file that can only be opened by Excel. XLL add-in files must be written in C or C++. See **[Developing Excel XLLs](https://learn.microsoft.com/en-us/office/client-developer/excel/developing-excel-xlls)** to learn more.

If you have existing Excel XLL add-ins, you can build equivalent custom function add-ins using the Excel JavaScript API to extend your solution features to other platforms, such as Excel on the web or on a Mac. However, Excel JavaScript API add-ins don't have all of the functionality available in XLL add-ins. Depending on the functionality your solution uses, the XLL add-in may provide a better experience in Excel on Windows than the Excel JavaScript API add-in.

#### ) **Important**

The equivalent add-in feature is supported by the following platform and applications. COM, VSTO, and XLL add-ins can't be installed on any other platform, so on those platforms the manifest markup that is discussed later in this article is ignored.

- Excel, Word, and PowerPoint on Windows (Version 1904 or later)
- Classic Outlook on Windows (Version 2102 or later) against a supported Exchange server version
	- Exchange Online
	- Exchange Server Subscription Edition (SE)
	- Exchange 2019 Cumulative Update 10 or later (**[KB5003612](https://support.microsoft.com/topic/b1434cad-3fbc-4dc3-844d-82568e8d4344)** )
	- Exchange 2016 Cumulative Update 21 or later (**[KB5003611](https://support.microsoft.com/topic/b7ba1656-abba-4a0b-9be9-dac45095d969)** )

# **Specify equivalent XLL in the manifest**

To enable compatibility with an existing XLL add-in, identify the equivalent XLL add-in in the manifest of your Excel JavaScript API add-in. Excel then uses the XLL add-in functions when running on Windows, instead of your Excel JavaScript API add-in custom functions.

To set the equivalent XLL add-in for your custom functions, specify the FileName of the XLL file. When the user opens a workbook with functions from the XLL file, Excel converts the functions to compatible functions. The workbook then uses the XLL file when opened in Excel on

{495}------------------------------------------------

Windows, but it continues to use custom functions from your Excel JavaScript API add-in when opened on the web or on Mac.

The manifest configuration depends on what type of manifest the add-in uses.

Unified manifest for Microsoft 365

The following example shows how to specify both a COM add-in and an XLL add-in as equivalents in a unified manifest. Often you specify both. For completeness, this example shows both equivalents in context. They're identified by their ["alternates.prefer.comAddin.progId"](https://learn.microsoft.com/en-us/microsoft-365/extensibility/schema/extension-alternate-versions-array-prefer-com-addin#progid) and

"alternates.prefer.xllCustomFunctions.filename" respectively. For more information on COM add-in compatibility, see Make your Office Add-in compatible with an existing COM or VSTO add-in.

#### JSON

```
"extensions" [
 ...
 "alternates" [
 {
 "prefer": {
 "comAddin": {
 "progId": "ContosoCOMAddin"
 },
 "xllCustomFunctions": {
 "fileName": "contosofunctions.xll"
 }
 }
 }
 ]
]
```
#### 7 **Note**

If an Excel JavaScript API add-in declares its custom functions to be compatible with an XLL add-in, changing the manifest at a later time could break a user's workbook because it will change the file format.

## **Custom function behavior for XLL compatible functions**

{496}------------------------------------------------

An add-in's XLL functions are converted to XLL compatible custom functions when a spreadsheet is opened and there is an equivalent add-in available. On the next save, the XLL functions are written to the file in a compatible mode so that they work with both the XLL addin and Excel JavaScript API add-in custom functions (when on platforms unsupported by XLL).

The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel JavaScript API add-in custom functions.

####  **Expand table**

|                                            | XLL user-defined<br>function                               | XLL compatible custom<br>functions                                 | Excel JavaScript API<br>add-in custom<br>function |
|--------------------------------------------|------------------------------------------------------------|--------------------------------------------------------------------|---------------------------------------------------|
| Supported                                  | Windows                                                    | Windows, macOS, web                                                | Windows, macOS, web                               |
| platforms                                  |                                                            | browser                                                            | browser                                           |
| Supported file<br>formats                  | XLSX, XLSB, XLSM, XLS                                      | XLSX, XLSB, XLSM                                                   | XLSX, XLSB, XLSM                                  |
| Formula<br>autocomplete                    | No                                                         | Yes                                                                | Yes                                               |
| Streaming                                  | Possible via xlfRTD and<br>XLL callback.                   | Yes                                                                | Yes                                               |
| Localization of<br>functions               | No                                                         | No. The Name and ID must<br>match the existing XLL's<br>functions. | Yes                                               |
| Volatile functions                         | Yes                                                        | Yes                                                                | Yes                                               |
| Multi-threaded<br>recalculation<br>support | Yes                                                        | Yes                                                                | Yes                                               |
| Calculation<br>behavior                    | No UI. Excel can be<br>unresponsive during<br>calculation. | Users see #BUSY! until a<br>result is returned.                    | Users see #BUSY! until a<br>result is returned.   |
| Requirement sets                           | N/A                                                        | CustomFunctions 1.1 and<br>later                                   | CustomFunctions 1.1<br>and later                  |

### **See also**

- Make your Office Add-in compatible with an existing COM or VSTO add-in
- Excel custom functions tutorial

{497}------------------------------------------------

# **Return multiple results from your custom function**

Article  12/08/2022

You can return multiple results from your custom function which will be returned to neighboring cells. This behavior is called spilling. When your custom function returns an array of results, it's known as a dynamic array formula. For more information on dynamic array formulas in Excel, see [Dynamic arrays and spilled array behavior](https://support.microsoft.com/office/205c6b06-03ba-4151-89a1-87a7eb36e531) .

The following image shows how the SORT function spills down into neighboring cells. Your custom function can also return multiple results like this.

|  | fre   |   | =SORT(D2:D11,1,-1) |  |
|--|-------|---|--------------------|--|
|  | D     | E | F                  |  |
|  |       |   |                    |  |
|  | Units |   | Units              |  |
|  | 622   |   | aei                |  |
|  | ae1   |   | 783                |  |
|  | 691   |   | 691                |  |
|  | 445   |   | 650                |  |
|  | 378   |   | 622                |  |
|  | 483   |   | 483                |  |
|  | 650   |   | 445                |  |
|  | 783   |   | 404                |  |
|  | 142   |   | 378                |  |
|  | 404   |   | 142                |  |
|  |       |   |                    |  |

To create a custom function that is a dynamic array formula, it must return a twodimensional array of values. If the results spill into neighboring cells that already have values, the formula will display a #SPILL! error.

## **Code samples**

The first example shows how to return a dynamic array that spills down.

```
JavaScript
/**
 * Get text values that spill down.
 * @customfunction
 * @returns {string[][]} A dynamic array with multiple results.
 */
function spillDown() {
```

{498}------------------------------------------------

```
 return [['first'], ['second'], ['third']];
}
```
The second example shows how to return a dynamic array that spills right.

JavaScript

```
/**
 * Get text values that spill to the right.
 * @customfunction
 * @returns {string[][]} A dynamic array with multiple results.
 */
function spillRight() {
 return [['first', 'second', 'third']];
}
```
The third example shows how to return a dynamic array that spills both down and right.

JavaScript /** * Get text values that spill both right and down. * @customfunction * @returns {string[][]} A dynamic array with multiple results. */ function spillRectangle() { return [ ['apples', 1, 'pounds'], ['oranges', 3, 'pounds'], ['pears', 5, 'crates'] ]; }

The fourth example shows how to return a dynamic spill array from a streaming function. The results spill down, like the first example, and increment once a second based on the amount parameter. To learn more about streaming functions, see Make a streaming function.

```
JavaScript
/**
 * Increment the cells with a given amount every second. Creates a dynamic
spilled array with multiple results
 * @customfunction
 * @param {number} amount The amount to add to the cell value on each
increment.
 * @param {CustomFunctions.StreamingInvocation<number[][]>} invocation
Parameter to send results to Excel or respond to the user canceling the
function. A dynamic array.
```

{499}------------------------------------------------

```
 */
function increment(amount: number, invocation:
CustomFunctions.StreamingInvocation<number[][]>): void {
 let firstResult = 0;
 let secondResult = 1;
 let thirdResult = 2;
 const timer = setInterval(() => {
 firstResult += amount;
 secondResult += amount;
 thirdResult += amount;
 invocation.setResult([[firstResult], [secondResult], [thirdResult]]);
 }, 1000);
 invocation.onCanceled = () => {
 clearInterval(timer);
 };
}
```
### **See also**

- [Dynamic arrays and spilled array behavior](https://support.microsoft.com/office/205c6b06-03ba-4151-89a1-87a7eb36e531)
- Options for Excel custom functions

{500}------------------------------------------------

# **Volatile values in functions**

Article  03/22/2022

Volatile functions are functions in which the value changes each time the cell is calculated. The value can change even if none of the function's arguments change. These functions recalculate every time Excel recalculates. For example, imagine a cell that calls the function NOW . Every time NOW is called, it will automatically return the current date and time.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
- Office on Mac
- Office on the web

Excel custom functions are currently not supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier

Excel contains several built-in volatile functions, such as RAND and TODAY . For a comprehensive list of Excel's volatile functions, see [Volatile and Non-Volatile Functions](https://learn.microsoft.com/en-us/office/client-developer/excel/excel-recalculation#volatile-and-non-volatile-functions).

Custom functions allow you to create your own volatile functions, which may be useful [when handling dates, times, random numbers, and modeling. For example, Monte Carlo](https://en.wikipedia.org/wiki/Monte_Carlo_method) simulations require the generation of random inputs to determine an optimal solution.

If choosing to autogenerate your JSON file, declare a volatile function with the JSDoc comment tag @volatile . From more information on autogeneration, see Autogenerate JSON metadata for custom functions.

An example of a volatile custom function follows, which simulates rolling a six-sided dice.

{501}------------------------------------------------

|   | A | B | C | D | E | F | G | H |
|---|---|---|---|---|---|---|---|---|
| 1 |   |   |   |   |   |   |   |   |
| 2 |   |   |   |   |   |   |   |   |
| 3 |   |   |   |   |   |   |   |   |
| 4 |   |   |   |   |   |   |   |   |
| 5 |   |   |   |   |   |   |   |   |
|  |   |   |   |   |   |   |   |   |
| 7 |   |   |   |   |   |   |   |   |
| 8 |   |   |   |   |   |   |   |   |
| 9 |   |   |   |   |   |   |   |   |

```
JS
/**
 * Simulates rolling a 6-sided dice.
 * @customfunction
 * @volatile
 */
function roll6sided() {
 return Math.floor(Math.random() * 6) + 1;
}
```
### **Next steps**

- Learn about custom functions parameter options.
## **See also**

- Manually create JSON metadata for custom functions
- Create custom functions in Excel

{502}------------------------------------------------

# **Receive and handle data with custom functions**

Article  04/13/2023

One of the ways that custom functions enhances Excel's power is by receiving data from locations other than the workbook, such as the web or a server (through [WebSockets](https://developer.mozilla.org/docs/Web/API/WebSockets_API) ). You can request external data through an API like [Fetch](https://developer.mozilla.org/docs/Web/API/Fetch_API) or by using XmlHttpRequest [(XHR)](https://developer.mozilla.org/docs/Web/API/XMLHttpRequest) , a standard web API that issues HTTP requests to interact with servers.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
- Office on Mac
- Office on the web

Excel custom functions are currently not supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier

|   | A | B | C | D | E | F | G | H |
|---|---|---|---|---|---|---|---|---|
| 1 |   |   |   |   |   |   |   |   |
| 2 |   |   |   |   |   |   |   |   |
| 3 |   |   |   |   |   |   |   |   |
| 4 |   |   |   |   |   |   |   |   |
| 5 |   |   |   |   |   |   |   |   |
|  |   |   |   |   |   |   |   |   |
| 7 |   |   |   |   |   |   |   |   |
| 8 |   |   |   |   |   |   |   |   |
| 9 |   |   |   |   |   |   |   |   |
|   |   |   |   |   |   |   |   |   |

## **Functions that return data from external sources**

If a custom function retrieves data from an external source such as the web, it must:

{503}------------------------------------------------

- 1. Return a [JavaScript Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise) to Excel.
- 2. Resolve the Promise with the final value using the callback function.

#### **Fetch example**

In the following code sample, the webRequest function reaches out to a hypothetical external API that tracks the number of people currently on the International Space Station. The function returns a JavaScript Promise and uses fetch to request information from the hypothetical API. The resulting data is transformed into JSON and the names property is converted into a string, which is used to resolve the promise.

When developing your own functions, you may want to perform an action if the web request does not complete in a timely manner or consider batching up multiple API requests.

```
JS
/**
 * Requests the names of the people currently on the International Space
Station.
 * Note: This function requests data from a hypothetical URL. In practice,
replace the URL with a data source for your scenario.
 * @customfunction
 */
function webRequest() {
 let url = "https://www.contoso.com/NumberOfPeopleInSpace"; // This is a
hypothetical URL.
 return new Promise(function (resolve, reject) {
 fetch(url)
 .then(function (response){
 return response.json();
 }
 )
 .then(function (json) {
 resolve(JSON.stringify(json.names));
 })
 })
}
```
#### 7 **Note**

Using fetch avoids nested callbacks and may be preferable to XHR in some cases.

#### **XHR example**

{504}------------------------------------------------

In the following code sample, the getStarCount function calls the Github API to discover the amount of stars given to a particular user's repository. This is an asynchronous function which returns a JavaScript Promise . When data is obtained from the web call, the promise is resolved which returns the data to the cell.

```
TS
/**
 * Gets the star count for a given Github organization or user and
repository.
 * @customfunction
 * @param userName string name of organization or user.
 * @param repoName string name of the repository.
 * @return number of stars.
 */
async function getStarCount(userName: string, repoName: string) {
 const url = "https://api.github.com/repos/" + userName + "/" + repoName;
 let xhttp = new XMLHttpRequest();
 return new Promise(function(resolve, reject) {
 xhttp.onreadystatechange = function() {
 if (xhttp.readyState !== 4) return;
 if (xhttp.status == 200) {
 resolve(JSON.parse(xhttp.responseText).watchers_count);
 } else {
 reject({
 status: xhttp.status,
 statusText: xhttp.statusText
 });
 }
 };
 xhttp.open("GET", url, true);
 xhttp.send();
 });
}
```
## **Make a streaming function**

Streaming custom functions enable you to output data to cells that updates repeatedly, without requiring a user to explicitly refresh anything. This can be useful to check live data from a service online, like the function in the custom functions tutorial.

To declare a streaming function, you can use either of the following two options.

{505}------------------------------------------------

- The @streaming JSDoc tag.
- The CustomFunctions.StreamingInvocation invocation parameter.

The following code sample is a custom function that adds a number to the result every second. Note the following about this code.

- Excel displays each new value automatically using the setResult method.
- The second input parameter, invocation , is not displayed to end users in Excel when they select the function from the autocomplete menu.
- The onCanceled callback defines the function that runs when the function is canceled.
- Streaming isn't necessarily tied to making a web request. In this case, the function isn't making a web request but is still getting data at set intervals, so it requires the use of the streaming invocation parameter.

```
JS
/**
 * Increments a value once a second.
 * @customfunction INC increment
 * @param {number} incrementBy Amount to increment
 * @param {CustomFunctions.StreamingInvocation<number>} invocation
 */
function increment(incrementBy, invocation) {
 let result = 0;
 const timer = setInterval(() => {
 result += incrementBy;
 invocation.setResult(result);
 }, 1000);
 invocation.onCanceled = () => {
 clearInterval(timer);
 };
}
```
#### 7 **Note**

For an example of how to return a dynamic spill array from a streaming function, see **Return multiple results from your custom function: Code samples**.

## **Cancel a function**

Excel cancels the execution of a function in the following situations.

{506}------------------------------------------------

- When the user edits or deletes a cell that references the function.
- When one of the arguments (inputs) for the function changes. In this case, a new function call is triggered following the cancellation.
- When the user triggers recalculation manually. In this case, a new function call is triggered following the cancellation.

You can also consider setting a default streaming value to handle cases when a request is made but you are offline.

#### 7 **Note**

There is also a category of functions called cancelable functions which use the @cancelable JSDoc tag. Cancelable functions allow a web request to be terminated in the middle of the request.

A streaming function can't use the @cancelable tag, but streaming functions can include an onCanceled callback function. Only asynchronous custom functions which return one value can use the @cancelable JSDoc tag. See **Autogenerate JSON metadata: @cancelable** to learn more about the @cancelable tag.

#### **Use an invocation parameter**

The invocation parameter is the last parameter of any custom function by default. The invocation parameter gives context about the cell (such as its address and contents) and allows you to use the setResult method and onCanceled event to define what a function does when it streams ( setResult ) or is canceled ( onCanceled ).

The invocation handler needs to be of type [CustomFunctions.StreamingInvocation](https://learn.microsoft.com/en-us/javascript/api/custom-functions-runtime/customfunctions.streaminginvocation) or [CustomFunctions.CancelableInvocation](https://learn.microsoft.com/en-us/javascript/api/custom-functions-runtime/customfunctions.cancelableinvocation) to process web requests.

See Invocation parameter to learn about other potential uses of the invocation argument and how it corresponds with the [Invocation](https://learn.microsoft.com/en-us/javascript/api/custom-functions-runtime/customfunctions.invocation) object.

## **Receiving data via WebSockets**

Within a custom function, you can use [WebSockets](https://developer.mozilla.org/docs/Web/API/WebSockets_API) to exchange data over a persistent connection with a server. Using WebSockets, your custom function can open a connection with a server and then automatically receive messages from the server when certain events occur, without having to explicitly poll the server for data.

{507}------------------------------------------------

#### **WebSockets example**

The following code sample establishes a WebSocket connection and then logs each incoming message from the server.

```
JavaScript
let ws = new WebSocket('wss://bundles.office.com');
ws.onmessage(message) {
 console.log(`Received: ${message}`);
}
ws.onerror(error){
 console.err(`Failed: ${error}`);
}
```
## **Next steps**

- Learn about different parameter types your functions can use.
- Discover how to batch multiple API calls.

## **See also**

- Volatile values in functions
- Create JSON metadata for custom functions
- Manually create JSON metadata for custom functions
- Create custom functions in Excel
- Excel custom functions tutorial

{508}------------------------------------------------

# **Authentication for custom functions without a shared runtime**

Article  02/13/2024

In some scenarios, a custom function that doesn't use a shared runtime will need to authenticate the user in order to access protected resources. Custom functions that don't use a shared runtime run in a JavaScript-only runtime. Because of this, if the addin has a task pane, you'll need to pass data back and forth between the JavaScript-only runtime and the HTML-supporting runtime used by the task pane. You do this by using the [OfficeRuntime.storage](https://learn.microsoft.com/en-us/javascript/api/office-runtime/officeruntime.storage) object and a special Dialog API.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
- Office on Mac
- Office on the web

Excel custom functions are currently not supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier

#### 7 **Note**

We recommend using custom functions with a **shared runtime**, unless you have a specific reason not to use a shared runtime. Note that using a shared runtime means your add-in will use WebView2 (Microsoft Edge Chromium-based) if conditions are met, and otherwise your add-in will use Trident (Internet Explorer 11) regardless of the Windows or Microsoft 365 version. For a description of the WebView2 conditions, see **Browsers and webview controls used by Office Add-ins**. For more information about runtimes, see **Runtimes in Office Add-ins** and **[Runtimes](https://learn.microsoft.com/en-us/javascript/api/manifest/runtimes)**.

{509}------------------------------------------------

## **OfficeRuntime.storage object**

The JavaScript-only runtime doesn't have a localStorage object available on the global window, where you typically store data. Instead, your code should share data between custom functions and task panes by using OfficeRuntime.storage to set and get data.

### **Suggested usage**

When you need to authenticate from a custom function add-in that doesn't use a shared runtime, your code should check OfficeRuntime.storage to see if the access token was already acquired. If not, use [OfficeRuntime.displayWebDialog](https://learn.microsoft.com/en-us/javascript/api/office-runtime#office-runtime-officeruntime-displaywebdialog-function(1)) to authenticate the user, retrieve the access token, and then store the token in OfficeRuntime.storage for future use.

# **Dialog API**

If a token doesn't exist, you should use the OfficeRuntime.dialog API to ask the user to sign in. After a user enters their credentials, the resulting access token can be stored as an item in OfficeRuntime.storage .

#### 7 **Note**

The JavaScript-only runtime uses a dialog object that is slightly different from the dialog object in the browser runtime used by task panes. They're both referred to as the "Dialog API", but use **[OfficeRuntime.displayWebDialog](https://learn.microsoft.com/en-us/javascript/api/office-runtime#office-runtime-officeruntime-displaywebdialog-function(1))** to authenticate users in the JavaScript-only runtime, *not* **[Office.ui.displayDialogAsync](https://learn.microsoft.com/en-us/javascript/api/office/office.ui#office-office-ui-displaydialogasync-member(1))**.

The following diagram outlines this basic process. The dotted line indicates that custom functions and your add-in's task pane are both part of your add-in as a whole, though they use separate runtimes.

- 1. You issue a custom function call from a cell in an Excel workbook.
- 2. The custom function uses OfficeRuntime.dialog to pass your user credentials to a website.
- 3. This website then returns an access token to the page in the dialog.
- 4. Your JavaScript in the dialog calls the [Office.ui.messageParent](https://learn.microsoft.com/en-us/javascript/api/office/office.ui#office-office-ui-messageparent-member(1)) function to send the access token to the custom function. For more information about this function, see Send information from the dialog box to the host page.
- 5. Your custom function then sets this access token to an item in the OfficeRuntime.storage .

{510}------------------------------------------------

6. Your add-in's task pane accesses the token from OfficeRuntime.storage .

| Excel application     |                    |
|-----------------------|--------------------|
|                       | Excel Add-In       |
| A                     | C                  |
| B                     | D                  |
| =CONTOSO.GETSTOCK(B1) | Task Pane          |
| 1                     |                   |
| 2<br>3                | Stock Quotes       |
| 4                     | Quote 1            |
| 5                     | Quote 2            |
| 6                     |                    |
| Custom function<br>   |                    |
| Token<br>2<br>3       | 4 Token<br>5 Token |
| Dialog API            | AsyncStorage API   |

### **Storing the token**

The following examples are from the [Using OfficeRuntime.storage in custom functions](https://github.com/OfficeDev/Office-Add-in-samples/tree/main/Excel-custom-functions/AsyncStorage) code sample. Refer to this code sample for a complete example of sharing data between custom functions and the task pane in add-ins that don't use a shared runtime.

If the custom function authenticates, then it receives the access token and will need to store it in OfficeRuntime.storage . The following code sample shows how to call the storage.setItem method to store a value. The storeValue function is a custom function that stores a value from the user. You can modify this to store any token value you need.

```
JavaScript
/**
 * Stores a key-value pair into OfficeRuntime.storage.
 * @customfunction
 * @param {string} key Key of item to put into storage.
 * @param {*} value Value of item to put into storage.
 */
function storeValue(key, value) {
 return OfficeRuntime.storage.setItem(key, value).then(function (result) {
 return "Success: Item with key '" + key + "' saved to storage.";
 }, function (error) {
 return "Error: Unable to save item with key '" + key + "' to storage.
" + error;
```

{511}------------------------------------------------

When the task pane needs the access token, it can retrieve the token from the OfficeRuntime.storage item. The following code sample shows how to use the storage.getItem method to retrieve the token.

```
JavaScript
/**
 * Read a token from storage.
 * @customfunction GETTOKEN
 */
function receiveTokenFromCustomFunction() {
 const key = "token";
 const tokenSendStatus = document.getElementById('tokenSendStatus');
 OfficeRuntime.storage.getItem(key).then(function (result) {
 tokenSendStatus.value = "Success: Item with key '" + key + "' read from
storage.";
 document.getElementById('tokenTextBox2').value = result;
 }, function (error) {
 tokenSendStatus.value = "Error: Unable to read item with key '" + key +
"' from storage. " + error;
 });
}
```
## **General guidance**

Office Add-ins are web-based and you can use any web authentication technique. There is no particular pattern or method you must follow to implement your own authentication with custom functions. You may wish to consult the documentation about various authentication patterns, starting with this article about authorizing via external services.

Avoid using the following locations to store data when developing custom functions:

- localStorage : custom functions that don't use a shared runtime don't have access to the global window object and therefore have no access to data stored in localStorage .
- Office.context.document.settings : This location isn't secure and information can be extracted by anyone using the add-in.

# **Dialog box API example**

{512}------------------------------------------------

In the following code sample, the function getTokenViaDialog uses the OfficeRuntime.displayWebDialog function to display a dialog box. This sample is provided to show the capabilities of the method, not demonstrate how to authenticate.

JavaScript

```
/**
* Function retrieves a cached token or opens a dialog box if there is no
saved token. Note that this isn't a sufficient example of authentication but
is intended to show the capabilities of the displayWebDialog method.
* @param {string} url URL for a stored token.
*/
function getTokenViaDialog(url) {
 return new Promise (function (resolve, reject) {
 if (_dialogOpen) {
 // Can only have one dialog box open at once. Wait for previous dialog
box's token.
 let timeout = 5;
 let count = 0;
 const intervalId = setInterval(function () {
 count++;
 if(_cachedToken) {
 resolve(_cachedToken);
 clearInterval(intervalId);
 }
 if(count >= timeout) {
 reject("Timeout while waiting for token");
 clearInterval(intervalId);
 }
 }, 1000);
 } else {
 _dialogOpen = true;
 OfficeRuntime.displayWebDialog(url, {
 height: '50%',
 width: '50%',
 onMessage: function (message, dialog) {
 _cachedToken = message;
 resolve(message);
 dialog.close();
 return;
 },
 onRuntimeError: function(error, dialog) {
 reject(error);
 },
 }).catch(function (e) {
 reject(e);
 });
 }
 });
}
```

{513}------------------------------------------------

## **Next steps**

Learn how to debug custom functions.

## **See also**

- JavaScript-only runtime for custom functions
- Excel custom functions tutorial
- JavaScript-only runtime

{514}------------------------------------------------

# **JavaScript-only runtime for custom functions**

Article  08/23/2022

Custom functions that don't use a shared runtime use a JavaScript-only runtime that is designed to optimize performance of calculations.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
- Office on Mac
- Office on the web

Excel custom functions are currently not supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier

#### 7 **Note**

We recommend using custom functions with a **shared runtime**, unless you have a specific reason not to use a shared runtime. Note that using a shared runtime means your add-in will use WebView2 (Microsoft Edge Chromium-based) if conditions are met, and otherwise your add-in will use Trident (Internet Explorer 11) regardless of the Windows or Microsoft 365 version. For a description of the WebView2 conditions, see **Browsers and webview controls used by Office Add-ins**. For more information about runtimes, see **Runtimes in Office Add-ins** and **[Runtimes](https://learn.microsoft.com/en-us/javascript/api/manifest/runtimes)**.

This JavaScript-only runtime provides access to APIs in the OfficeRuntime namespace that can be used by custom functions and the task pane (which runs in a different runtime) to store data.

{515}------------------------------------------------

## **Request external data**

Within a custom function, you can request external data by using an API like [Fetch](https://developer.mozilla.org/docs/Web/API/Fetch_API) or by using [XmlHttpRequest (XHR)](https://developer.mozilla.org/docs/Web/API/XMLHttpRequest) , a standard web API that issues HTTP requests to interact with servers.

Be aware that custom functions must use additional security measures when making XmlHttpRequests, requiring [Same Origin Policy](https://developer.mozilla.org/docs/Web/Security/Same-origin_policy) and simple [CORS](https://www.w3.org/TR/cors/) .

A simple CORS implementation cannot use cookies and only supports simple methods (GET, HEAD, POST). Simple CORS accepts simple headers with field names Accept , Accept-Language , Content-Language . You can also use a Content-Type header in simple CORS, provided that the content type is application/x-www-form-urlencoded , text/plain , or multipart/form-data .

## **Store and access data**

Within a custom function that doesn't use a shared runtime, you can store and access data by using the [OfficeRuntime.storage](https://learn.microsoft.com/en-us/javascript/api/office-runtime/officeruntime.storage) object. The Storage object is a persistent, unencrypted, key-value storage system that provides an alternative to [localStorage](https://developer.mozilla.org/docs/Web/API/Window/localStorage) , which cannot be used by custom functions that use the JavaScript-only runtime. The Storage object offers 10 MB of data per domain. Domains can be shared by more than one add-in.

The Storage object is a shared storage solution, meaning multiple parts of an add-in are able to access the same data. For example, tokens for user authentication may be stored in the Storage object because it can be accessed by both a custom function (using the JavaScript-only runtime) and a task pane (using a full webview runtime). Similarly, if two add-ins share the same domain (for example, www.contoso.com/addin1 , www.contoso.com/addin2 ), they are also permitted to share information back and forth through the Storage object. Note that add-ins which have different subdomains will have different instances of Storage (for example, subdomain.contoso.com/addin1 , differentsubdomain.contoso.com/addin2 ).

Because the Storage object can be a shared location, it is important to realize that it is possible to override key-value pairs.

The following methods are available on the Storage object.

- getItem
- getItems

{516}------------------------------------------------

- setItem
- setItems
- removeItem
- removeItems
- getKeys

#### 7 **Note**

There's no method for clearing all information (such as clear ). Instead, you should instead use removeItems to remove multiple entries at a time.

#### **OfficeRuntime.storage example**

The following code sample calls the OfficeRuntime.storage.setItem method to set a key and value into storage .

#### JavaScript function StoreValue(key, value) { return OfficeRuntime.storage.setItem(key, value).then(function (result) { return "Success: Item with key '" + key + "' saved to storage."; }, function (error) { return "Error: Unable to save item with key '" + key + "' to storage. " + error; }); }

## **Next steps**

Learn how to debug custom functions.

## **See also**

- Authentication for custom functions without a shared runtime
- Create custom functions in Excel
- Custom functions tutorial
- JavaScript-only runtime

{517}------------------------------------------------

# **Custom functions debugging in a nonshared runtime**

Article  12/26/2024

This article discusses debugging only for custom functions that **don't use a shared runtime**. To debug custom functions add-ins that use a shared runtime, see Overview of debugging Office Add-ins.

#### ) **Important**

Note that Excel custom functions are available on the following platforms.

- Office on the web
- Office on Windows
	- Microsoft 365 subscription
	- retail perpetual Office 2016 and later
	- volume-licensed perpetual Office 2021 and later
- Office on Mac

Excel custom functions aren't currently supported in the following:

- Office on iPad
- volume-licensed perpetual versions of Office 2019 or earlier on Windows

#### 7 **Note**

We recommend using custom functions with a **shared runtime**, unless you have a specific reason not to use a shared runtime. Note that using a shared runtime means your add-in will use WebView2 (Microsoft Edge Chromium-based) if conditions are met, and otherwise your add-in will use Trident (Internet Explorer 11) regardless of the Windows or Microsoft 365 version. For a description of the WebView2 conditions, see **Browsers and webview controls used by Office Add-ins**. For more information about runtimes, see **Runtimes in Office Add-ins**.

#### **Tip**

The debugging techniques that are described in this article don't work with projects that are created with the **Office Add-in project containing the manifest only**

{518}------------------------------------------------

option in the Yeoman generator. The scripts that are referred to later in this article aren't installed with that option. To debug an add-in that is created with this option, see the instructions in one of the following articles, as appropriate.

- **Debug add-ins using developer tools in Microsoft Edge (Chromium-based)**
- **Debug add-ins using developer tools in Internet Explorer**
- **Debug Office Add-ins on a Mac**

The process of debugging a custom function for add-ins that don't use a shared runtime varies depending on the target platform (Windows, Mac, or web) and on whether you are using Visual Studio Code or a different IDE. Use the links in the following table to visit sections of this article that are relevant to your debugging scenario. In this table, "CF-NSR" refers to custom functions in a non-shared runtime.

####  **Expand table**

| Target<br>platform  | Visual Studio Code                                                                                                     | Other IDE                                                                                                                       |
|---------------------|------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| Excel on<br>the web | Use VS Code and the browser<br>development tools                                                                       | Use the command line tools                                                                                                      |
| Excel on<br>Windows | Use VS Code and the browser<br>development tools                                                                       | Debugging CF-NSR that are running in<br>Excel on Windows outside VS Code isn't<br>supported. Debug against Excel on the<br>web. |
| Excel on<br>Mac     | VS Code debugging of CF-NSR that are<br>running in Excel on Mac isn't<br>supported. Debug against Excel on the<br>web. | Use the command line tools                                                                                                      |

## **Use the browser developer tools to debug custom functions in Excel on the web**

You can use the browser developer tools to debug custom functions that don't use a shared runtime in Excel on the web. The following steps work for both Windows and macOS.

### **Run your add-in from Visual Studio Code**

- 1. Open your custom functions root project folder in [Visual Studio Code (VS Code)](https://code.visualstudio.com/) .

{519}------------------------------------------------

- 2. Choose **Terminal** > **Run Task** and type or select **Watch**. This will monitor and rebuild for any file changes.
- 3. Choose **Terminal** > **Run Task** and type or select **Dev Server**.

### **Sideload your add-in**

- 1. Open [Office on the web](https://office.live.com/) .
- 2. Open a new Excel workbook.
- 3. Select **Home** > **Add-ins**, then select **More Settings**.
- 4. On the **Office Add-ins** dialog, select **Upload My Add-in**.
- 5. **Browse** to the add-in manifest file, and then select **Upload**.

| Upload Add-in                                         |        |        |
|-------------------------------------------------------|--------|--------|
| This feature is for developers to test their add-ins. |        |        |
| Choose your add-in manifest                           |        |        |
|                                                       |        | Browse |
|                                                       |        |        |
|                                                       | Upload | Cancel |

#### 7 **Note**

Once you've sideloaded to the document, it will remain sideloaded each time you open the document.

### **Start debugging**

- 1. Open developer tools in the browser. For Chrome and most browsers F12 will open the developer tools.
- 2. In developer tools, open your source code script file using Cmd + P or Ctrl + P (**functions.js** or **functions.ts**).
- 3. [Set a breakpoint](https://code.visualstudio.com/Docs/editor/debugging#_breakpoints) in the custom function source code.

If you need to change the code you can make edits in VS Code and save the changes. Refresh the browser to see the changes loaded.

{520}------------------------------------------------

## **Use the command line tools to debug**

If you aren't using VS Code, you can use the command line (such as bash, or PowerShell) to run your add-in. You'll need to use the browser developer tools to debug your code in Excel on the web. You cannot debug the desktop version of Excel using the command line.

- 1. From the command line run npm run watch to watch for and rebuild when code changes occur.
- 2. Open a second command line window (the first one will be blocked while running the watch.)
- 3. If you want to start your add-in in the desktop version of Excel and the "scripts" section of the project's package.json file has a "start:desktop" script, then run npm run start:desktop ; otherwise, run npm run start .

Or if you prefer to start your add-in in Excel on the web run the following command.

npm run start -- web --document {url} (where {url} is the URL of an Excel file on OneDrive or SharePoint)

#### 7 **Note**

If you are developing on a Mac, enclose the {url} in single quotation marks. Do *not* do this on Windows.

If your add-in doesn't sideload in the document, follow the steps in Sideload your add-in to sideload your add-in. Then continue to the next section to start debugging.

- 4. Open developer tools in the browser. For Chrome and most browsers F12 will open the developer tools.
- 5. In developer tools, open your source code script file (**functions.js** or **functions.ts**). Your custom functions code may be located near the end of the file.
- 6. In the custom function source code, apply a breakpoint by selecting a line of code.

If you need to change the code, you can make edits in VS Code and save the changes. Refresh the browser to see the changes loaded.

{521}------------------------------------------------

### **Commands for building and running your add-in**

There are several build tasks available.

- npm run watch : builds for development and automatically rebuilds when a source file is saved
- npm run build-dev : builds for development once
- npm run build : builds for production
- npm run dev-server : runs the web server used for development

You can use the following tasks to start debugging on desktop or online.

- npm run start:desktop : Starts Excel on desktop and sideloads your add-in. If the "start:desktop" script isn't present in the "scripts" section of the project's package.json file, then run npm run start instead.
- npm run start -- web --document {url} (where {url} is the URL of an Excel file on OneDrive or SharePoint): Starts Excel on the web and sideloads your add-in.

7 **Note**

If you are developing on a Mac, enclose the {url} in single quotation marks. Do *not* do this on Windows.

- npm run stop : Stops Excel and debugging.
## **Next steps**

Learn about Authentication for custom functions without a shared runtime.

## **See also**

- Custom functions troubleshooting
- Error handling for custom functions in Excel
- Create custom functions in Excel
- JavaScript-only runtime

{522}------------------------------------------------

# **Troubleshoot custom functions**

#### 08/26/2025

When developing custom functions, you may encounter errors in the product while creating and testing your functions.

| )<br>Important                                                             |
|----------------------------------------------------------------------------|
| Note that Excel custom functions are available on the following platforms. |
| Office on the web                                                          |
| Office on Windows                                                          |
| Microsoft 365 subscription                                                 |
| retail perpetual Office 2016 and later                                     |
| volume-licensed perpetual Office 2021 and later                            |
| Office on Mac                                                              |
| Excel custom functions aren't currently supported in the following:        |
| Office on iPad                                                             |

- volume-licensed perpetual versions of Office 2019 or earlier on Windows
#### 7 **Note**

The unified manifest for Microsoft 365 doesn't currently support custom functions projects. You must use the add-in only manifest for custom functions projects. For more information, see **Office Add-ins manifest**.

To resolve issues, you can enable runtime logging to capture errors and refer to Excel's native error messages. Also, check for common mistakes such as leaving promises unresolved.

# **Debugging custom functions**

To debug custom functions add-ins that use a shared runtime, see Overview of debugging Office Add-ins.

To debug custom functions add-ins that don't use a shared runtime, see Custom functions debugging.

{523}------------------------------------------------

## **Enable runtime logging**

If you're testing your add-in in Office on Windows, you should enable runtime logging. Runtime logging delivers console.log statements to a separate log file you create to help you uncover issues. The statements cover a variety of errors, including errors pertaining to your add-in's manifest file, runtime conditions, or installation of your custom functions. For more information about runtime logging, see Debug your add-in with runtime logging.

#### **Check for Excel error messages**

Excel has a number of built-in error messages which are returned to a cell if there is calculation error. Custom functions only use the following error messages: #NULL! , #DIV/0! , #VALUE! , #REF! , #NAME? , #NUM! , #N/A , and #BUSY! .

Generally, these errors correspond to the errors you might already be familiar with in Excel. The are only a few exceptions specific to custom functions, listed here:

- A #NAME? error generally means there has been an issue registering your functions. For additional information, see Custom functions showing #NAME? error.
- A #N/A error is also maybe a sign that that function while registered could not be run. This is typically due to a missing CustomFunctions.associate command.
- A #VALUE! error typically indicates an error in the functions' script file.
- A #REF! error may indicate that your function name is the same as a function name in an add-in that already exists.

## **Clear the Office cache**

Information about custom functions is cached by Office. Sometimes while developing and repeatedly reloading an add-in with custom functions your changes may not appear. You can fix this by clearing the Office cache. For more information, see Clear the Office cache.

### **Clear the custom functions cache when your add-in runs**

There may be times when you need to clear the custom functions cache for an add-in deployed to your end users, so that add-in updates and custom functions setting changes are incorporated at the same time. Without triggering a custom functions cache clear, changes to the **functions.json** and **functions.js** files may take up to 24 hours to reach your end users, while changes to **taskpane.html** reach end users more quickly.

{524}------------------------------------------------

Once this setting is turned on for a document, it takes effect the next time the document is opened with the add-in. It doesn't apply immediately after the function is called.

To ensure that the custom functions cache is cleared by your add-in, add the following code to your **functions.js** file, and then call the setForceRefreshOn method in your Office.onReady call or other add-in initialization logic.

#### ) **Important**

This process for clearing the custom functions cache is only supported for custom functions add-ins that use a **shared runtime**.

```
JavaScript
```

```
// To enable custom functions cache clearing, add this method to your functions.js
// file, and then call the `setForceRefreshOn` method in your `Office.onReady`
call.
function setForceRefreshOn() { 
 Office.context.document.settings.set( 
 'Office.ForceRefreshCustomFunctionsCache',
 true 
 ); 
 Office.context.document.settings.saveAsync(); 
}
```
#### **Tip**

Frequently refreshing the custom functions cache can impact performance, so clearing the custom functions cache with setForceRefreshOn should only be used during add-in development or to resolve bugs. Once a custom functions add-in is stabilized, stop forcing cache refreshes.

To disable the custom functions cache clear in your add-in, set

Office.ForceRefreshCustomFunctionsCache to false and call the method in your Office.onReady call. The following code sample shows an example with a setForceRefreshOff method.

JavaScript

```
// To disable custom functions cache clearing, add this method to your
functions.js 
// file, and then call the `setForceRefreshOff` method in your `Office.onReady`
call.
```

{525}------------------------------------------------

```
function setForceRefreshOff() { 
 Office.context.document.settings.set( 
 'Office.ForceRefreshCustomFunctionsCache',
 false 
 ); 
 Office.context.document.settings.saveAsync(); 
}
```
## **Common problems and solutions**

### **Custom functions showing #NAME? error**

When opening a workbook that uses a custom functions add-in, sometimes a #NAME? error displays in custom function cells instead of the formula result. IntelliSense for custom functions may also not appear in the workbook when authoring new formulas. The likely cause of this issue is that the custom functions add-in hasn't registered successfully.

To resolve the issue, try the following approaches:

- Refresh the add-in by selecting your add-in icon. Select **Home** > **Add-ins** > **My Add-ins** and then your add-in icon.
- Follow the guidance to automatically clear the Office cache when Office opens, and then restart Excel.

### **Can't open add-in from localhost: Use a local loopback exemption**

If you see the error "We can't open this add-in from localhost," you will need to enable a local loopback exemption. For details on how to do this, see [this Microsoft support article](https://learn.microsoft.com/en-us/office/troubleshoot/office-suite-issues/cannot-open-add-in-from-localhost).

### **Runtime logging reports "TypeError: Network request failed" on Excel on Windows**

If you see the error "TypeError: Network request failed" in your runtime log while making calls to your localhost server, you'll need to enable a local loopback exception. For details on how to do this, see *Option #2* in [this Microsoft support article.](https://learn.microsoft.com/en-us/office/troubleshoot/office-suite-issues/cannot-open-add-in-from-localhost)

### **Ensure promises return**

When Excel is waiting for a custom function to complete, it displays #BUSY! in the cell. If your custom function code returns a promise, but the promise does not return a result, Excel will

{526}------------------------------------------------

continue showing #BUSY! . Check your functions to make sure that any promises are properly returning a result to a cell.

### **Error: The dev server is already running on port 3000**

Sometimes when running npm start you may see an error that the dev server is already running on port 3000 (or whichever port your add-in uses). You can stop the dev server by running npm stop or by closing the Node.js window. In some cases, it can take a few minutes for the dev server to stop running.

### **My functions won't load: associate functions**

In cases where your JSON has not been registered and you have authored your own JSON metadata, you may see a #VALUE! error or receive a notification that your add-in cannot be loaded. This usually means you need to associate each custom function with its id property specified in the JSON metadata file. This is done by using the CustomFunctions.associate() function. Typically this function call is made after each function or at the end of the script file. If a custom function is not associated, it will not work.

The following example shows an add function, followed by the function's name add being associated with the corresponding JSON id ADD .

```
JavaScript
/**
 * Add two numbers.
 * @customfunction
 * @param {number} first First number.
 * @param {number} second Second number.
 * @returns {number} The sum of the two numbers.
 */
function add(first, second) {
 return first + second;
}
CustomFunctions.associate("ADD", add);
```
For more information on this process, see Associate function names with JSON metadata.

## **Known issues**

Known issues are tracked and reported in the [Excel Custom Functions GitHub repository](https://github.com/OfficeDev/Excel-Custom-Functions/issues) .

{527}------------------------------------------------

## **Reporting feedback**

If you are encountering issues that aren't documented here, let us know. There are two ways to report issues.

### **In Excel on Windows or on Mac**

If using Excel on Windows or on Mac, you can report feedback to the Office extensibility team directly from Excel. To do this, select **File** > **Feedback** > **Send a Frown**. Sending a frown will provide the necessary logs to understand the issue you are hitting.

### **In Github**

Feel free to submit an issue you encounter either through the "Content feedback" feature at the bottom of any documentation page, or by [filing a new issue directly to the custom](https://github.com/OfficeDev/Excel-Custom-Functions/issues) [functions repository](https://github.com/OfficeDev/Excel-Custom-Functions/issues) .

### **Next steps**

Learn how to make your custom functions compatible with XLL user-defined functions.

## **See also**

- Autogenerate JSON metadata for custom functions
- Create custom functions in Excel
- Custom functions debugging

{528}------------------------------------------------

# **OneNote add-ins documentation**

OneNote add-ins let you use familiar web technologies such as HTML, CSS, and JavaScript to build a solution that runs in OneNote on the web. Learn how to build, test, debug, and publish OneNote add-ins.

| b<br>GET STARTED                       |  |
|----------------------------------------|--|
| Build your first OneNote add-in        |  |
| Sample: Rubric Grader Task Pane Add-in |  |
|                                        |  |
|                                        |  |
| About OneNote add-ins                  |  |
| e<br>OVERVIEW                          |  |
| What are OneNote add-ins?              |  |
| OneNote JavaScript API Overview        |  |

Use the OneNote JavaScript API to interact with objects and notebook content

#### **Key Office Add-ins concepts**

e **OVERVIEW**

Office Add-ins platform overview

p **CONCEPT**

Core concepts for Office Add-ins

Design Office Add-ins